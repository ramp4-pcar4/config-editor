const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./point-icon-Dd_kLleb-CbM64_RA.js","./index-12gn5LMs.js","./index-6GCfk1Ih.css","./polyline-icon-BmsBSMJm-boxDx6dz.js","./polygon-icon-CnplOIHx-BS7xS8W2.js","./circle-icon-qM-Cul3g-CjYUfR1b.js","./rectangle-icon-DaWElXKE-BJKCGj-2.js","./edit-icon-BBpkepd0-CS6V-_jr.js"])))=>i.map(i=>d[i]);
var U=Object.defineProperty;var X=(c,o,t)=>o in c?U(c,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[o]=t;var B=(c,o,t)=>X(c,typeof o!="symbol"?o+"":o,t);import{fw as T,fv as P,fx as ee,g8 as F,fz as V,fA as D,hi as N,fC as H,fD as i,fP as r,g0 as E,fF as C,fG as m,fI as f,g6 as g,hj as _,fB as I,fZ as k,f_ as L,fE as b,f$ as M,fH as Y,h3 as q,fK as $,fM as te,fY as oe,fN as ae,fO as Z,fQ as j,fJ as w,g2 as ne,_ as y}from"./index-12gn5LMs.js";import{y as ie}from"./draw-store-DnCf4IRI-CE8r8fwE.js";const se={},le={class:"border-b p-0 self-center w-2/3"};function re(c,o){return i(),r("span",le)}const K=T(se,[["render",re]]),pe=P({__name:"zoom-nav",setup(c){const{t:o}=V(),t=D("iApi"),a=N(400,!0,()=>t.geo.map.zoomIn()),s=N(400,!0,()=>t.geo.map.zoomOut());return(e,u)=>{const p=H("mapnav-button");return i(),r("div",null,[E(p,{onClickFunction:f(a),tooltip:f(o)("mapnav.zoomIn")},{default:C(()=>u[0]||(u[0]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[m("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),m("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),E(K),E(p,{onClickFunction:f(s),tooltip:f(o)("mapnav.zoomOut")},{default:C(()=>u[1]||(u[1]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[m("path",{d:"M19 13H5v-2h14v2z"}),m("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),ce={class:"mapnav-section bg-white-75 hover:bg-white"},ve=P({__name:"draw-nav-section",props:{showOutline:{type:Boolean,default:!1}},setup(c){const o=D("iApi"),{t}=V(),a=ie(),s=[{type:"point",icon:g(_(()=>y(()=>import("./point-icon-Dd_kLleb-CbM64_RA.js"),__vite__mapDeps([0,1,2]),import.meta.url)))},{type:"polyline",icon:g(_(()=>y(()=>import("./polyline-icon-BmsBSMJm-boxDx6dz.js"),__vite__mapDeps([3,1,2]),import.meta.url)))},{type:"polygon",icon:g(_(()=>y(()=>import("./polygon-icon-CnplOIHx-BS7xS8W2.js"),__vite__mapDeps([4,1,2]),import.meta.url)))},{type:"circle",icon:g(_(()=>y(()=>import("./circle-icon-qM-Cul3g-CjYUfR1b.js"),__vite__mapDeps([5,1,2]),import.meta.url)))},{type:"rectangle",icon:g(_(()=>y(()=>import("./rectangle-icon-DaWElXKE-BJKCGj-2.js"),__vite__mapDeps([6,1,2]),import.meta.url)))}],e=I(()=>{const v=s.filter(h=>a.supportedTypes.some(x=>x.type===h.type));return v.push({type:"edit",icon:g(_(()=>y(()=>import("./edit-icon-BBpkepd0-CS6V-_jr.js"),__vite__mapDeps([7,1,2]),import.meta.url)))}),v}),u=v=>{a.activeTool===v?a.setActiveTool(null):a.setActiveTool(v)},p=()=>{o.geo.map.setMouseFocus()};return(v,h)=>{const x=H("mapnav-button");return i(),r("div",ce,[(i(!0),r(k,null,L(e.value,(d,A)=>(i(),b(x,{key:d.type,onMousedown:p,onClickFunction:()=>u(d.type),tooltip:f(t)(`draw.${d.type}.tooltip`),class:Y({"active-tool":f(a).activeTool===d.type}),style:q({marginBottom:A!==e.value.length-1?"0px":"0"}),showOutline:c.showOutline},{default:C(()=>[(i(),b(M(d.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","class","style","showOutline"]))),128))])}}}),Q=T(ve,[["__scopeId","data-v-0dac0135"]]),ue={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},me=["content"],he={class:"mapnav-section bg-white-75 hover:bg-white"},de={key:1,class:"mapnav-section bg-white-75 hover:bg-white"},fe=["content"],ge={key:0},_e=P({__name:"mapnav",setup(c){var R;const o=$(void 0),t=D("iApi"),a=F(),{t:s}=V(),e=$(),u=I(()=>t.getConfig().fixtures.mapnav.items.some(n=>n==="draw")),p=$((R=t.$rootEl)==null?void 0:R.clientHeight),v=$(!1),h=$(0),x=()=>{var n;p.value=(n=t.$rootEl)==null?void 0:n.clientHeight},d=()=>{e.value._tippy.hide()},A=n=>{var l;n.key==="Tab"&&((l=e.value)!=null&&l.matches(":focus"))&&e.value._tippy.show()};te(()=>{var n,l;(n=e.value)==null||n.addEventListener("blur",d),(l=e.value)==null||l.addEventListener("keyup",A),o.value=new ResizeObserver(x),o.value.observe(t.$rootEl),oe(()=>{h.value=z.value.length*82})}),ae(()=>{var n,l;(n=e.value)==null||n.removeEventListener("blur",d),(l=e.value)==null||l.removeEventListener("keyup",A),o.value.disconnect()});const z=I(()=>a.order.map(n=>a.items[n]).filter(n=>n.componentId&&n.id!=="draw"));return(n,l)=>{const W=H("mapnav-button"),G=Z("focus-list"),S=Z("tippy");return i(),r("div",ue,[j((i(),r("div",{class:"mapnav-section flex flex-col",content:f(s)("panels.controls.items"),ref_key:"el",ref:e},[u.value&&p.value>h.value?(i(),r(k,{key:0},[E(Q),l[0]||(l[0]=m("span",{class:"py-1"},null,-1))],64)):w("",!0),E(pe,{class:"mapnav-section bg-white-75 hover:bg-white"}),l[2]||(l[2]=m("span",{class:"py-1"},null,-1)),m("div",he,[p.value<=h.value?(i(),b(W,{key:0,class:"self-center",onClickFunction:()=>{v.value=!v.value},tooltip:v.value?n.$t("mapnav.closeMenu"):n.$t("mapnav.openMenu")},{default:C(()=>[(i(),r("svg",{xmlns:"http://www.w3.org/2000/svg","shape-rendering":"geometricPrecision","text-rendering":"geometricPrecision","image-rendering":"optimizeQuality","fill-rule":"evenodd","clip-rule":"evenodd",viewBox:"0 0 319 511.61",class:Y(["fill-current w-6 mx-auto transition-all transform",{"rotate-180":v.value}])},l[1]||(l[1]=[m("path",{d:"m270.08 5.89 43.04 43.04c7.85 7.86 7.83 20.72 0 28.54L134.77 255.82l178.35 178.35c7.85 7.86 7.8 20.73 0 28.54l-43.04 43.04c-7.83 7.82-20.71 7.82-28.54 0L49.29 313.49l-.37-.36-43.04-43.04c-7.82-7.83-7.86-20.68 0-28.54l43.04-43.04.37-.36L241.54 5.89c7.85-7.85 20.68-7.85 28.54 0z"},null,-1)]),2))]),_:1},8,["onClickFunction","tooltip"])):w("",!0)]),p.value>h.value?(i(),r("div",de,[(i(!0),r(k,null,L(z.value,(O,J)=>(i(),r(k,{key:O.id+"button"},[(i(),b(M(O.id+"-nav-button"))),J!==z.value.length-1?(i(),b(K,{key:0,class:"mapnav-divider"})):w("",!0)],64))),128))])):w("",!0)],8,me)),[[G],[S,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]]),p.value<=h.value&&v.value?j((i(),r("div",{key:0,class:"mapnav-section flex flex-col flex-wrap-reverse shadow-tm absolute right-56 bottom-36 sm:bottom-48 items-start z-50 gap-0.5",style:q({maxHeight:`${(p.value-70)*.8}px`,height:"fit-content",width:"fit-content"}),content:f(s)("panels.controls.items")},[u.value?(i(),r("div",ge,[E(Q,{showOutline:""})])):w("",!0),(i(!0),r(k,null,L(z.value,O=>(i(),b(M(O.id+"-nav-button"),{key:O.id+"button",class:"mapnav-section bg-white-75 hover:bg-white",showOutline:""}))),128))],12,fe)),[[S,{trigger:"manual",placement:"top-end",maxWidth:190}]]):w("",!0)])}}}),we=T(_e,[["__scopeId","data-v-d62d1b77"]]);class ye extends ne{constructor(){super(...arguments);B(this,"mapnavStore",F(this.$vApp.$pinia))}get config(){return super.config}_parseConfig(t){if(!t)return;const a=t.items.map(s=>({id:s}));this.mapnavStore.items=a.reduce((s,e)=>(s[e.id]=e,s),{}),this.mapnavStore.order=a.map(s=>s.id),this._validateItems()}_validateItems(){const t=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(a=>{(this.$iApi.fixture.exists(a)||t.includes(a))&&(this.mapnavStore.items[a].componentId=`${a}-nav-button`)})}}const be={en:{"mapnav.openMenu":"Open navigation","mapnav.closeMenu":"Close navigation","mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.openMenu":"Ouvrir la navigation","mapnav.closeMenu":"Fermer la navigation","mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arrière","mapnav.home":"Accueil","mapnav.fullscreen":"Plein Écran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refusée. Veuillez vérifier les paramètres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu être trouvé."}};class $e extends ye{async added(){Object.entries(be).forEach(e=>this.$iApi.$i18n.mergeLocaleMessage(...e));const{destroy:o,el:t}=this.mount(we,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(t.childNodes[0]),this._parseConfig(this.config);const a=this.$vApp.$watch(()=>this.config,e=>this._parseConfig(e)),s=this.$iApi.event.on(ee.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{a(),this.$iApi.event.off(s);const e=F(this.$vApp.$pinia),u={...e.items};Object.keys(u).forEach(p=>e.removeItem(p)),e.$reset(),o()}}}export{$e as default};
