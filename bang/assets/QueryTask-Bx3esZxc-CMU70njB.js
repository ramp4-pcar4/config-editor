const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./meshFeatureSet-DJUAHsml-De3EWm7d.js","./index-BeTPrQ6f.js","./index-BlWAJbpo.css","./Mesh-CWZE92hA-C2oMEFcN.js","./axisAngleDegrees-StGk9lM5-YzC5iFyo.js","./mat4-R0VY9B_E-DoEP887i.js","./quat-B6H0knG8-DtO1-hlf.js","./quatf64-C16JxGFv-BKWK1F8U.js","./vec32-CI1xtKog-DFVYRcgb.js","./vec42-DHp-FUwt-Br7hmYJs.js","./MeshComponent-BEAtZpvD-CC9545AO.js","./imageUtils-DITyjHV4-jEv5aA2D.js","./meshProperties-CXB3HhQQ-DyV7lL-U.js","./MeshLocalVertexSpace-CxmyTFZH-DhgfYuby.js","./MeshTransform-DfLVYScT-Cq2gdNT7.js","./MeshVertexAttributes-SXUaA7ll-eeFzs1Wm.js","./meshVertexSpaceUtils-EbHpWZGf-CmRuaT8m.js","./triangulationUtils-BIEW4TIq-CnOT_xJp.js","./earcut-C6NeZYSh-P2HUZ781.js","./Indices-CAn-HCVv-hWNN5onC.js","./plane-wUwHaY3K-ZwGBF7HQ.js","./vectorStacks-B2ngxq6F-myhPBoPk.js","./vec2f64-CkowXrDb-3zFQ3LNH.js","./vec4f64-DD-nkcCV-CSNWKRqG.js","./deduplicate-Cqg-F-nU-CWiUqVRS.js","./projectPointToVector-BHS0gJJf-DOVZH8Fn.js","./projectionUtils-CsX1UTBu-DsZaU4xz.js","./projectBuffer-CMNsPBq1-CMpE7Jo3.js","./zscale-PLuFqpaL-BIEnWBsg.js","./vertexSpaceConversion-okU9QrPr-BoK2nOGp.js","./spatialReferenceEllipsoidUtils-Ty3j4VoE-BUAsRqCF.js","./computeTranslationToOriginAndRotation-CsOb5S2S-CE5ZgVBy.js","./vec3-DXB2oTmo-oxnUpQ4G.js","./BufferView-B6RYETl3-CMoUTBv6.js","./vec4-Dua3dSaz-Cy3KWGYf.js","./External-Dm_9qsZE-WC8_5qS7.js","./infoFor3D-BeWnZejW-CnXQECJx.js","./FeatureSet-BIUKCqNW-D9YRl-VE.js","./Field-Dn1Bgq7n-CJCGLoNR.js","./fieldType-DvW5hpfa-DYUbIy_X.js","./meshFeatureAttributes-CEZ3_9vy-F8JrvLd2.js","./RelationshipQuery-Cf-_aN1Z-mThKQ0J2.js","./Query-DKLDaFaA-I4zhlfzt.js","./executeRelationshipQuery-t-Kr_b60-D5HJuzKe.js","./utils-CRANtbnc-C6zyufvL.js","./query-DALknG0A-COo-2vjI.js","./normalizeUtils-DK5542Ty-DtqBcgc2.js","./Cyclical-Bzwh_QaL-CXh-hbnA.js","./normalizeUtilsCommon-5DjefBp7-CQyUDMQp.js","./utils-t279O251-BBk6rV0U.js","./pbfQueryUtils-DYXcN4x1-BpgjQRlR.js","./pbf-42TrGguk-Dw0lh_Mv.js","./memoryEstimations-C_GUL8g_-JniNFd5l.js","./OptimizedGeometry-BYxlP_oK-DvAqrgO1.js","./OptimizedFeature-C33SioFK-sn7DeAq-.js","./OptimizedFeatureSet-Dz5hF8Qm-CgsRgxJh.js","./queryZScale-B66ZWsfS-D7Zc2_Zh.js","./queryAttachments-BSnOIRvt-DkX1V0Sq.js","./AttachmentInfo-DVdiZMh6-Bn8Eo_Wz.js","./executeAttributeBinsQuery-BgIcy0pZ-BXp0nfDR.js","./AttributeBinsFeatureSet-DnObQnDw-BXW4BoEx.js","./AttributeBinsQuery-DAANgUPd-DDdVeBeY.js","./queryUtils-BwthgOFW-CkUF_Za8.js","./FixedIntervalBinParameters-Bn9Pye3B-_d3f8Yp4.js","./NormalizationBinParametersMixin-DuEmpnQx-abBJwXnQ.js","./timeZoneUtils-CdK7eU4Y-fyhJ3EFx.js","./executePivotQuery-DsbOgJ6--C5wVYLGb.js","./PivotQuery-CAYSNQs8-u-iDIs8l.js","./executeTopFeaturesQuery-CWvls7xw-DfKFh0oz.js","./queryTopFeatures-CztlL0yw-DdePuElQ.js","./TopFeaturesQuery-CpTJDOLl-BniYeodj.js","./executeForTopIds-DdRkJtKl-CyvS_TS3.js","./executeForTopExtents-DT3iGVXV-DpIiHft5.js","./executeForTopCount-CTiR2-L1-zufKSymk.js"])))=>i.map(i=>d[i]);
import{aj as I,t as O,ah as R,aS as a,_ as i,l as h,aW as g,m as u,E as n,n as E}from"./index-BeTPrQ6f.js";import{C as v}from"./infoFor3D-BeWnZejW-CnXQECJx.js";import{b as V,R as y}from"./Query-DKLDaFaA-I4zhlfzt.js";import{g as T}from"./utils-CRANtbnc-C6zyufvL.js";import{m as q,e as A}from"./executeForIds-DFVmsUAr-DrGG0Xkw.js";import{b as w,G as Q}from"./executeQueryPBF-yxq1TYEd-CcQ_Hw5o.js";import{f as P}from"./executeQueryJSON-CB62-HPg-BYZFd1td.js";import{c as L}from"./FeatureSet-BIUKCqNW-D9YRl-VE.js";let o=class extends I{constructor(t){super(t),this.dynamicDataSource=null,this.fieldsIndex=null,this.gdbVersion=null,this.infoFor3D=null,this.pbfSupported=!1,this.queryAttachmentsSupported=!1,this.sourceSpatialReference=null,this.uniqueIdFields=null,this.url=null}get parsedUrl(){return O(this.url)}async execute(t,e){const r=await this.executeJSON(t,e);return this.featureSetFromJSON(t,r,e)}async executeJSON(t,e){var d;const r=this._normalizeQuery(t),s=((d=t.outStatistics)==null?void 0:d[0])!=null,l=R("featurelayer-pbf-statistics"),c=(!s||l)&&t.returnTrueCurves!==!0;let p;if(this.pbfSupported&&c)try{p=await w(this.url,r,e,{uniqueIdFields:this.uniqueIdFields})}catch(m){if(m.name!=="query:parsing-pbf")throw m;this.pbfSupported=!1}return this.pbfSupported&&c||(p=await P(this.url,r,e,{uniqueIdFields:this.uniqueIdFields})),this._normalizeFields(p.fields),p}async featureSetFromJSON(t,e,r){if(!this._queryIs3DObjectFormat(t)||this.infoFor3D==null||!e.features)return L.fromJSON(e);const{meshFeatureSetFromJSON:s}=await a(i(()=>import("./meshFeatureSet-DJUAHsml-De3EWm7d.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]),import.meta.url),r);return s(t,this.infoFor3D,e)}executeForCount(t,e){return q(this.url,this._normalizeQuery(t),e,{uniqueIdFields:this.uniqueIdFields})}executeForExtent(t,e){return Q(this.url,this._normalizeQuery(t),e)}executeForIds(t,e){return A(this.url,this._normalizeQuery(t),e,{uniqueIdFields:this.uniqueIdFields})}async executeRelationshipQuery(t,e){const[{default:r},{executeRelationshipQuery:s}]=await a(Promise.all([i(()=>import("./RelationshipQuery-Cf-_aN1Z-mThKQ0J2.js"),__vite__mapDeps([41,1,2,42,38,39]),import.meta.url).then(l=>l.R),i(()=>import("./executeRelationshipQuery-t-Kr_b60-D5HJuzKe.js"),__vite__mapDeps([43,44,1,2,45,46,47,48,49,50,51,52,53,54,55,56,28,37,38,39,41,42]),import.meta.url)]),e);return t=r.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),s(this.url,t,e)}async executeRelationshipQueryForCount(t,e){const[{default:r},{executeRelationshipQueryForCount:s}]=await a(Promise.all([i(()=>import("./RelationshipQuery-Cf-_aN1Z-mThKQ0J2.js"),__vite__mapDeps([41,1,2,42,38,39]),import.meta.url).then(l=>l.R),i(()=>import("./executeRelationshipQuery-t-Kr_b60-D5HJuzKe.js"),__vite__mapDeps([43,44,1,2,45,46,47,48,49,50,51,52,53,54,55,56,28,37,38,39,41,42]),import.meta.url)]),e);return t=r.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),s(this.url,t,e)}async executeAttachmentQuery(t,e){const{executeAttachmentQuery:r,fetchAttachments:s,processAttachmentQueryResult:l}=await a(i(()=>import("./queryAttachments-BSnOIRvt-DkX1V0Sq.js"),__vite__mapDeps([57,1,2,45,46,47,48,44,49,50,51,52,53,54,55,56,28,58]),import.meta.url),e),c=T(this.url);return l(c,await(this.queryAttachmentsSupported?r(c,t,e):s(c,t,e)))}async executeAttributeBinsQuery(t,e){const{executeAttributeBinsQuery:r}=await a(i(()=>import("./executeAttributeBinsQuery-BgIcy0pZ-BXp0nfDR.js"),__vite__mapDeps([59,44,1,2,46,47,48,49,45,50,51,52,53,54,55,56,28,60,37,38,39,61,62,26,27,63,64,42,65]),import.meta.url),e);return r(this.parsedUrl,t,e)}async executePivotQuery(t,e){const{executePivotQuery:r}=await a(i(()=>import("./executePivotQuery-DsbOgJ6--C5wVYLGb.js"),__vite__mapDeps([66,44,1,2,46,47,48,49,45,50,51,52,53,54,55,56,28,37,38,39,67,42]),import.meta.url),e);return r(this.parsedUrl,t,e)}async executeTopFeaturesQuery(t,e){const{executeTopFeaturesQuery:r}=await a(i(()=>import("./executeTopFeaturesQuery-CWvls7xw-DfKFh0oz.js"),__vite__mapDeps([68,44,1,2,69,46,47,48,49,45,50,51,52,53,54,55,56,28,37,38,39,70,42]),import.meta.url),e);return r(this.parsedUrl,t,this.sourceSpatialReference,e)}async executeForTopIds(t,e){const{executeForTopIds:r}=await a(i(()=>import("./executeForTopIds-DdRkJtKl-CyvS_TS3.js"),__vite__mapDeps([71,44,1,2,69,46,47,48,49,45,50,51,52,53,54,55,56,28,70,42,38,39]),import.meta.url),e);return r(this.parsedUrl,t,e)}async executeForTopExtents(t,e){const{executeForTopExtents:r}=await a(i(()=>import("./executeForTopExtents-DT3iGVXV-DpIiHft5.js"),__vite__mapDeps([72,1,2,44,69,46,47,48,49,45,50,51,52,53,54,55,56,28,70,42,38,39]),import.meta.url),e);return r(this.parsedUrl,t,e)}async executeForTopCount(t,e){const{executeForTopCount:r}=await a(i(()=>import("./executeForTopCount-CTiR2-L1-zufKSymk.js"),__vite__mapDeps([73,44,1,2,69,46,47,48,49,45,50,51,52,53,54,55,56,28,70,42,38,39]),import.meta.url),e);return r(this.parsedUrl,t,e)}_normalizeQuery(t){let e=V.from(t);e.sourceSpatialReference=e.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(e=e===t?e.clone():e,e.gdbVersion=t.gdbVersion||this.gdbVersion,e.dynamicDataSource=t.dynamicDataSource?y.from(t.dynamicDataSource):this.dynamicDataSource);const{infoFor3D:r}=this;if(r!=null&&this._queryIs3DObjectFormat(t)){if(e=e===t?e.clone():e,e.formatOf3DObjects=v(r),!e.formatOf3DObjects)throw new h("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if(e.outSpatialReference&&!g(e.outSpatialReference,this.sourceSpatialReference))throw new h("query:unsupported-out-spatial-reference","3D object feature services do not support projection of geometries");if(e.outFields==null||!e.outFields.includes("*")){e=e===t?e.clone():e,e.outFields==null&&(e.outFields=[]);const{originX:s,originY:l,originZ:c,translationX:p,translationY:d,translationZ:m,scaleX:f,scaleY:_,scaleZ:S,rotationX:F,rotationY:D,rotationZ:b,rotationDeg:x}=r.transformFieldRoles;e.outFields.push(s,l,c,p,d,m,f,_,S,F,D,b,x)}}return e}_normalizeFields(t){if(this.fieldsIndex!=null&&t!=null)for(const e of t){const r=this.fieldsIndex.get(e.name);r&&Object.assign(e,r.toJSON())}}_queryIs3DObjectFormat(t){return this.infoFor3D!=null&&t.returnGeometry===!0&&t.multipatchOption!=="xyFootprint"&&!t.outStatistics}};u([n({type:y})],o.prototype,"dynamicDataSource",void 0),u([n()],o.prototype,"fieldsIndex",void 0),u([n()],o.prototype,"gdbVersion",void 0),u([n()],o.prototype,"infoFor3D",void 0),u([n({readOnly:!0})],o.prototype,"parsedUrl",null),u([n()],o.prototype,"pbfSupported",void 0),u([n()],o.prototype,"queryAttachmentsSupported",void 0),u([n()],o.prototype,"sourceSpatialReference",void 0),u([n()],o.prototype,"uniqueIdFields",void 0),u([n({type:String})],o.prototype,"url",void 0),o=u([E("esri.layers.graphics.sources.support.QueryTask")],o);export{o};
