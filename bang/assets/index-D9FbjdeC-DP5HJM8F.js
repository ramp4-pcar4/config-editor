const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./point-icon-DkINEOM7-CEENOrUi.js","./index-BeTPrQ6f.js","./index-BlWAJbpo.css","./polyline-icon-CHRNkL-v-BtITG78O.js","./polygon-icon-nxFnmVpc-ISMF6OL3.js","./circle-icon-CY-pgLZB-DIywXXLG.js","./rectangle-icon-DSbog25R-DESFthbN.js","./edit-icon-BKw9252x-C-FG-Mbv.js"])))=>i.map(i=>d[i]);
var U=Object.defineProperty;var K=(u,a,o)=>a in u?U(u,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[a]=o;var N=(u,a,o)=>K(u,typeof a!="symbol"?a+"":a,o);import{hf as P,gT as ee,hv as F,gV as te,gS as R,gX as k,hk as V,gZ as B,gY as I,g_ as oe,h3 as ae,h1 as ne,hl as S,h4 as Z,h6 as r,h7 as i,h5 as j,hc as f,hj as h,h8 as E,hm as m,h9 as A,hb as b,hg as C,hd as T,ha as L,he as M,iz as q,iS as Q,hy as ie,ht as _,iT as w,_ as y}from"./index-BeTPrQ6f.js";import{y as se}from"./draw-store-DwCnUTPl-Dp2Sl1TU.js";const le={},re={class:"border-b p-0 self-center w-2/3"};function pe(u,a){return i(),r("span",re)}const J=P(le,[["render",pe]]),ue=R({__name:"zoom-nav",setup(u){const{t:a}=B(),o=V("iApi"),e=Q(400,!0,()=>o.geo.map.zoomIn()),s=Q(400,!0,()=>o.geo.map.zoomOut());return(t,c)=>{const p=S("mapnav-button");return i(),r("div",null,[E(p,{onClickFunction:h(e),tooltip:h(a)("mapnav.zoomIn")},{default:C(()=>c[0]||(c[0]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[m("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),m("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),E(J),E(p,{onClickFunction:h(s),tooltip:h(a)("mapnav.zoomOut")},{default:C(()=>c[1]||(c[1]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[m("path",{d:"M19 13H5v-2h14v2z"}),m("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),ve=R({__name:"draw-nav-section",props:{showOutline:{type:Boolean,default:!1}},setup(u){const a=V("iApi"),{t:o}=B(),e=se();e.mapNavEl=ie("mapNavEl");const s=[{type:"point",icon:_(w(()=>y(()=>import("./point-icon-DkINEOM7-CEENOrUi.js"),__vite__mapDeps([0,1,2]),import.meta.url)))},{type:"polyline",icon:_(w(()=>y(()=>import("./polyline-icon-CHRNkL-v-BtITG78O.js"),__vite__mapDeps([3,1,2]),import.meta.url)))},{type:"polygon",icon:_(w(()=>y(()=>import("./polygon-icon-nxFnmVpc-ISMF6OL3.js"),__vite__mapDeps([4,1,2]),import.meta.url)))},{type:"circle",icon:_(w(()=>y(()=>import("./circle-icon-CY-pgLZB-DIywXXLG.js"),__vite__mapDeps([5,1,2]),import.meta.url)))},{type:"rectangle",icon:_(w(()=>y(()=>import("./rectangle-icon-DSbog25R-DESFthbN.js"),__vite__mapDeps([6,1,2]),import.meta.url)))}],t=I(()=>{const v=s.filter(d=>e.supportedTypes.some(x=>x.type===d.type));return v.push({type:"edit",icon:_(w(()=>y(()=>import("./edit-icon-BKw9252x-C-FG-Mbv.js"),__vite__mapDeps([7,1,2]),import.meta.url)))}),v}),c=v=>{e.activeTool===v?e.setActiveTool(null):e.setActiveTool(v)},p=()=>{a.geo.map.setMouseFocus()};return(v,d)=>{const x=S("mapnav-button");return i(),r("div",{class:T([{active:h(e).activeTool||h(e).activeTool==""},"mapnav-section bg-white-75 hover:bg-white"])},[(i(!0),r(A,null,L(t.value,(g,$)=>(i(),b(x,{key:g.type,onMousedown:p,onClickFunction:()=>c(g.type),tooltip:h(o)(`draw.${g.type}.tooltip`),style:q({marginBottom:$!==t.value.length-1?"0px":"0"}),showOutline:u.showOutline,class:T({"active-tool":h(e).activeTool===g.type}),ref_for:!0,ref:"mapNavEl"},{default:C(()=>[(i(),b(M(g.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","style","showOutline","class"]))),128))],2)}}}),Y=P(ve,[["__scopeId","data-v-2036016d"]]),ce={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},me=["content"],he={class:"mapnav-section bg-white-75 hover:bg-white"},de={key:1,class:"mapnav-section bg-white-75 hover:bg-white"},ge=["content"],fe={key:0},_e=R({__name:"mapnav",setup(u){var D;const a=k(void 0),o=V("iApi"),e=F(),{t:s}=B(),t=k(),c=I(()=>o.getConfig().fixtures.mapnav.items.some(n=>n==="draw")),p=k((D=o.$rootEl)==null?void 0:D.clientHeight),v=k(!1),d=k(0),x=()=>{var n;p.value=(n=o.$rootEl)==null?void 0:n.clientHeight},g=()=>{t.value._tippy.hide()},$=n=>{var l;n.key==="Tab"&&((l=t.value)!=null&&l.matches(":focus"))&&t.value._tippy.show()};oe(()=>{var n,l;(n=t.value)==null||n.addEventListener("blur",g),(l=t.value)==null||l.addEventListener("keyup",$),a.value=new ResizeObserver(x),a.value.observe(o.$rootEl),ae(()=>{d.value=z.value.length*82})}),ne(()=>{var n,l;(n=t.value)==null||n.removeEventListener("blur",g),(l=t.value)==null||l.removeEventListener("keyup",$),a.value.disconnect()});const z=I(()=>e.order.map(n=>e.items[n]).filter(n=>n.componentId&&n.id!=="draw"));return(n,l)=>{const W=S("mapnav-button"),X=Z("focus-list"),H=Z("tippy");return i(),r("div",ce,[j((i(),r("div",{class:"mapnav-section flex flex-col",content:h(s)("panels.controls.items"),ref_key:"el",ref:t},[c.value&&p.value>d.value?(i(),r(A,{key:0},[E(Y),l[0]||(l[0]=m("span",{class:"py-1"},null,-1))],64)):f("",!0),E(ue,{class:"mapnav-section bg-white-75 hover:bg-white"}),l[2]||(l[2]=m("span",{class:"py-1"},null,-1)),m("div",he,[p.value<=d.value?(i(),b(W,{key:0,class:"self-center",onClickFunction:()=>{v.value=!v.value},tooltip:v.value?n.$t("mapnav.closeMenu"):n.$t("mapnav.openMenu")},{default:C(()=>[(i(),r("svg",{xmlns:"http://www.w3.org/2000/svg","shape-rendering":"geometricPrecision","text-rendering":"geometricPrecision","image-rendering":"optimizeQuality","fill-rule":"evenodd","clip-rule":"evenodd",viewBox:"0 0 319 511.61",class:T(["fill-current w-6 mx-auto transition-all transform",{"rotate-180":v.value}])},l[1]||(l[1]=[m("path",{d:"m270.08 5.89 43.04 43.04c7.85 7.86 7.83 20.72 0 28.54L134.77 255.82l178.35 178.35c7.85 7.86 7.8 20.73 0 28.54l-43.04 43.04c-7.83 7.82-20.71 7.82-28.54 0L49.29 313.49l-.37-.36-43.04-43.04c-7.82-7.83-7.86-20.68 0-28.54l43.04-43.04.37-.36L241.54 5.89c7.85-7.85 20.68-7.85 28.54 0z"},null,-1)]),2))]),_:1},8,["onClickFunction","tooltip"])):f("",!0)]),p.value>d.value?(i(),r("div",de,[(i(!0),r(A,null,L(z.value,(O,G)=>(i(),r(A,{key:O.id+"button"},[(i(),b(M(O.id+"-nav-button"))),G!==z.value.length-1?(i(),b(J,{key:0,class:"mapnav-divider"})):f("",!0)],64))),128))])):f("",!0)],8,me)),[[X],[H,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]]),p.value<=d.value&&v.value?j((i(),r("div",{key:0,class:"mapnav-section flex flex-col flex-wrap-reverse shadow-tm absolute right-56 bottom-36 sm:bottom-48 items-start z-50 gap-0.5",style:q({maxHeight:`${(p.value-70)*.8}px`,height:"fit-content",width:"fit-content"}),content:h(s)("panels.controls.items")},[c.value?(i(),r("div",fe,[E(Y,{showOutline:""})])):f("",!0),(i(!0),r(A,null,L(z.value,O=>(i(),b(M(O.id+"-nav-button"),{key:O.id+"button",class:"mapnav-section bg-white-75 hover:bg-white",showOutline:""}))),128))],12,ge)),[[H,{trigger:"manual",placement:"top-end",maxWidth:190}]]):f("",!0)])}}}),we=P(_e,[["__scopeId","data-v-d62d1b77"]]);class ye extends te{constructor(){super(...arguments);N(this,"mapnavStore",F(this.$vApp.$pinia))}get config(){return super.config}_parseConfig(o){if(!o)return;const e=o.items.map(s=>({id:s}));this.mapnavStore.items=e.reduce((s,t)=>(s[t.id]=t,s),{}),this.mapnavStore.order=e.map(s=>s.id),this._validateItems()}_validateItems(){const o=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(e=>{(this.$iApi.fixture.exists(e)||o.includes(e))&&(this.mapnavStore.items[e].componentId=`${e}-nav-button`)})}}const be={en:{"mapnav.openMenu":"Open navigation","mapnav.closeMenu":"Close navigation","mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.openMenu":"Ouvrir la navigation","mapnav.closeMenu":"Fermer la navigation","mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arrière","mapnav.home":"Accueil","mapnav.fullscreen":"Plein Écran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refusée. Veuillez vérifier les paramètres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu être trouvé."}};class ke extends ye{async added(){Object.entries(be).forEach(t=>this.$iApi.$i18n.mergeLocaleMessage(...t));const{destroy:a,el:o}=this.mount(we,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(o.childNodes[0]),this._parseConfig(this.config);const e=this.$vApp.$watch(()=>this.config,t=>this._parseConfig(t)),s=this.$iApi.event.on(ee.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{e(),this.$iApi.event.off(s);const t=F(this.$vApp.$pinia),c={...t.items};Object.keys(c).forEach(p=>t.removeItem(p)),t.$reset(),a()}}}export{ke as default};
