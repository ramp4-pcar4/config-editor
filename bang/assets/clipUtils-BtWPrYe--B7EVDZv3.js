const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./intersectsOperator-CJZC9CBi-BzN4JHuK.js","./ProjectionTransformation-BXUROh_s-kKBZ5FDB.js","./Envelope2D-2iYexKQo-BCKocNS7.js","./Point2D-BVUQyGsf-qih0ZuJV.js","./Transformation2D-CZCvoz9N-B-IhcWnl.js","./SimpleGeometryCursor-DSF_YyIm-TAMgMsbK.js","./index-BeTPrQ6f.js","./index-BlWAJbpo.css","./OperatorDefinitions-DJdq_wrt-DP7_WWTp.js","./jsonConverter-CiKBkr5U-C590VlCu.js","./OperatorIntersects-D3hvPVgP-DsdTZPTQ.js","./apiConverter-Djde5pBD-Dr3vspB4.js","./containsOperator-BlGSPZO6-DkFragCI.js"])))=>i.map(i=>d[i]);
import{_ as O,F as b,a4 as q,B}from"./index-BeTPrQ6f.js";import{f as E}from"./PixelBlock-DwvqalBN-B5no8ogH.js";function L(e,h){if(e.spatialReference.equals(h))return e;const t=q(e.spatialReference),i=q(h);if(t===i)return e;const a=t/i;return{x:e.x*a,y:e.y*a}}async function Q(e,h,t){if(t.type==="extent")return F(e,h,t);const{width:i,height:a}=e,n=new Uint8Array(i*a);return(await O(()=>import("./intersectsOperator-CJZC9CBi-BzN4JHuK.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url).then(r=>r.i)).execute(h,t)?t.type==="polyline"?G(e,h,t):(await O(()=>import("./containsOperator-BlGSPZO6-DkFragCI.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,11]),import.meta.url).then(r=>r.c)).execute(t,h)?e:V(e,h,t):new E({pixelType:e.pixelType,width:i,height:a,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function V(e,h,t){if(!e)return e;const{width:i,height:a}=e,n=$({geometry:t,size:[i,a],srcExtent:h,srcMask:e.mask});return new E({pixelType:e.pixelType,width:i,height:a,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function $(e){const{geometry:h,size:t,srcExtent:i,srcMask:a}=e,[n,r]=t;let x;const s=i.width/n,y=i.height/r,{xmin:m,ymax:o}=i;if(h.type==="extent"){const f=(h.xmin-m)/s,l=(h.xmax-m)/s,p=(o-h.ymax)/y,c=(o-h.ymin)/y;x=[[[f,p],[f,c],[l,c],[l,p],[f,p]]]}else x=h.rings.map(f=>f.map(([l,p])=>[(l-m)/s,(o-p)/y]));return j(x,t,a)}function j(e,h,t){const[i,a]=h,n=new OffscreenCanvas(i,a).getContext("2d");n.fillStyle="#f00",n.beginPath(),e.forEach(m=>{n.moveTo(m[0][0],m[0][1]);for(let o=0;o<m.length;o++)n.lineTo(m[o][0],m[o][1]);n.closePath()}),n.fill();const r=n.getImageData(0,0,i,a).data,x=i*a,s=new Uint8Array(x);let y=!1;for(let m=0;m<x;m++)t&&!t[m]||(r[4*m+3]>127?s[m]=255:y=!0);return y||t?s:void 0}function F(e,h,t){const{width:i,height:a}=e,n=new Uint8Array(i*a),r=h.width/i,x=h.height/a;if(t.width/r<.5||t.height/x<.5)return new E({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});const{xmin:s,xmax:y,ymin:m,ymax:o}=h,{xmin:f,xmax:l,ymin:p,ymax:c}=t,u=Math.max(s,f),_=Math.min(y,l),R=Math.max(m,p),v=Math.min(o,c),S=.5*r,T=.5*x;if(_-u<S||v-R<T||_<s+S||u>y-S||R>o-T||v<m+T)return new E({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});const z=Math.max(0,(u-s)/r),P=Math.min(i,Math.max(0,(_-s)/r)),A=Math.max(0,(o-v)/x),g=Math.min(a,Math.max(0,(o-R)/x)),M=Math.round(z),d=Math.round(P)-1,w=Math.round(A),I=Math.round(g)-1;if(M===d&&z%1>.5&&P%1<.5||w===I&&A%1>.5&&g%1<.5)return new E({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});if(M===0&&w===0&&d===i&&I===a)return e;const U=e.mask;for(let k=w;k<=I;k++)for(let C=M;C<=d;C++){const D=k*i+C;n[D]=U?U[D]:255}return new E({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]})}function G(e,h,t){const{width:i,height:a}=e,n=new Uint8Array(i*a),r=h.width/i,x=h.height/a,{xmin:s,ymax:y}=h,{paths:m}=t,o=e.mask;for(let f=0;f<m.length;f++){const l=m[f];for(let p=0;p<l.length-1;p++){const[c,u]=l[p],[_,R]=l[p+1],v=Math.min(u,R),S=Math.max(u,R),T=Math.max(0,Math.floor((y-S)/x)),z=Math.min(a-1,Math.floor((y-v)/x));if(!(z<T))if(T===z){const P=Math.min(c,_),A=Math.max(c,_),g=Math.max(0,Math.floor((P-s)/r)),M=Math.min(i-1,Math.floor((A-s)/r));if(M<g)continue;const d=T*i;for(let w=d+g;w<=d+M;w++)n[w]=o?o[w]:255}else{const P=(c-s)/r,A=(_-c)/(R-u)/r,g=x*A;for(let M=T;M<=z;M++){const d=A*(y-M*x-u)+P,w=Math.max(0,Math.floor(g>0?d-g:d)),I=Math.min(i-1,Math.floor(g>0?d:d-g));if(I<w)continue;const U=M*i;for(let k=U+w;k<=U+I;k++)n[k]=o?o[k]:255}}}}return new E({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]})}function K(e,h){const{extent:t}=H(e,h,new B({x:e.pixelSize.x,y:e.pixelSize.y,spatialReference:e.spatialReference})),{extent:i}=e.extent;if(t.xmax=Math.min(t.xmax,i.xmax),t.ymax=Math.min(t.ymax,i.ymax),t.xmin<t.xmax&&t.ymin<t.ymax){const{x:a,y:n}=e.pixelSize,r=Math.round(t.width/a),x=Math.round(t.height/n);e.extent=t,e.width=r,e.height=x}}function H(e,h,t,i=!0){const{spatialReference:a}=e,{x:n,y:r}=L(t,a);let x,s,y;const m=h.type==="extent"?h:h.extent;let{xmin:o,xmax:f,ymax:l,ymin:p}=m;const{xmin:c,ymax:u}=e.extent;return i?(o=c+(o>c?n*Math.round((o-c)/n):0),l=u-(l<u?r*Math.round((u-l)/r):0),f=c+(f>c?n*Math.round((f-c)/n):0),p=u-(p<u?r*Math.round((u-p)/r):0),x=new b({xmin:o,ymax:l,xmax:f,ymin:p,spatialReference:a}),s=Math.round(x.width/n),y=Math.round(x.height/r)):(s=Math.floor((f-o)/n+.8),y=Math.floor((l-p)/r+.8),o=c+(o>c?n*Math.floor((o-c)/n+.1):0),l=u-(l<u?r*Math.floor((u-l)/r+.1):0),f=o+s*n,p=l-y*r,x=new b({xmin:o,ymax:l,xmax:f,ymin:p,spatialReference:a})),{extent:x,width:s,height:y}}export{K as $,H as B,Q as H,$ as j};
