const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./unitConversion-BxD3RA9Y-D7ME_iQX.js","./enum-g1DWyQyu-DbyUc3c9.js","./index-12gn5LMs.js","./index-6GCfk1Ih.css"])))=>i.map(i=>d[i]);
import{b8 as m,$ as y,i as g,o as x,B as L,_ as $,l as b,Z as R,m as k,cf as nn,bq as B,U as en,N as z}from"./index-12gn5LMs.js";import{i as O,A as D,k as an,U as tn,T as rn,m as on,q as sn,r as un,t as H}from"./arcade-BoHTeCSG-DLvAkBSZ.js";import{w,a as h,y as Q,A as G,z as K,p as W,b as v,J as E,K as U,M,H as _,R as C,L as V,N as P,T as cn,q as j,j as T,i as Z}from"./aiServices-u5nRiq9H-Dp7t_Wta.js";import{l as o,r as s}from"./enum-g1DWyQyu-DbyUc3c9.js";import{V as J}from"./TimeOnly-CGkId3bj-B_DrnhBv.js";import{n as Y}from"./portalUtils-COohlq76-BiYFpKvR.js";import{n as d}from"./operatorsWorkerConnection-TmW3NQ3Q-Bdvhpcn9.js";import"./featureConversionUtils-Bjjlcfdo-BkL49fWM.js";import"./OptimizedFeature-mIz_HhJg-DX72O90S.js";import"./memoryEstimations-DeWfxwaV-ZhTZyAJQ.js";import"./OptimizedGeometry-pzfNw1AT-BerfWeod.js";import"./OptimizedFeatureSet-Dz5hF8Qm-B1brSkRC.js";import"./FieldsIndex-Bt0Y8aWr-bnm7YOAs.js";import"./UnknownTimeZone-DxjyzFvs-BVA_pH2M.js";import"./timeZoneUtils-d5p0Jda1-Dw4XhjBV.js";import"./ImmutableArray-CiJxhY8_-Kqx7aWRu.js";import"./shared-DttuBH5Z-D9bPnLk7.js";import"./Field-BIQ-quF4-DssnJ4fn.js";import"./fieldType-PhcL4ff8-TJALxuGf.js";import"./WhereClause-D4rZJkVN-Dc9gI3X7.js";import"./unitConversion-BxD3RA9Y-D7ME_iQX.js";import"./number-mnL_JN3f-snqe3yN5.js";import"./uuid-Dj9mdEVg-BaKSCiyT.js";import"./commonProperties-D1Pjvz5u-DHiB1uzW.js";import"./utils-BO8hgPs3-CSpNGQF8.js";import"./workers-CeRXsnNJ-DmAccjPJ.js";import"./Queue-DV3gpSdl-CInt-_Hb.js";import"./intl-BAA1onnp-Eg1Cq3Wo.js";async function X(t,e,a){var n,i;if(!((n=en)!=null&&n.findCredential(t.restUrl)))return null;if(t.loadStatus==="loaded"&&e===""&&((i=t.user)!=null&&i.sourceJSON)&&a===!1)return t.user.sourceJSON;const c={responseType:"json",query:{f:"json"}};if(a&&(c.query.returnUserLicenseTypeExtensions=!0),e===""){const r=await z(t.restUrl+"/community/self",c);if(r.data){const u=r.data;if(u!=null&&u.username)return u}return null}const l=await z(t.restUrl+"/community/users/"+e,c);if(l.data){const r=l.data;return r.error?null:r}return null}function N(t){if(t==null)return t;switch(typeof t){case"string":case"number":return t;default:throw new o(null,s.InvalidParameter,null)}}function En(t){t.mode==="async"&&(t.functions.disjoint=function(e,a){return t.standardFunctionAsync(e,a,(c,l,n)=>(n=w(n),O(n,e,a),n[0]===null||n[1]===null||d("disjoint",[n[0].toJSON(),n[1].toJSON()])))},t.functions.intersects=function(e,a){return t.standardFunctionAsync(e,a,(c,l,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("intersects",[n[0].toJSON(),n[1].toJSON()])))},t.functions.touches=function(e,a){return t.standardFunctionAsync(e,a,(c,l,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("touches",[n[0].toJSON(),n[1].toJSON()])))},t.functions.crosses=function(e,a){return t.standardFunctionAsync(e,a,(c,l,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("crosses",[n[0].toJSON(),n[1].toJSON()])))},t.functions.within=function(e,a){return t.standardFunctionAsync(e,a,(c,l,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("within",[n[0].toJSON(),n[1].toJSON()])))},t.functions.contains=function(e,a){return t.standardFunctionAsync(e,a,(c,l,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("contains",[n[0].toJSON(),n[1].toJSON()])))},t.functions.overlaps=function(e,a){return t.standardFunctionAsync(e,a,(c,l,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("overlaps",[n[0].toJSON(),n[1].toJSON()])))},t.functions.equals=function(e,a){return t.standardFunctionAsync(e,a,(c,l,n)=>(h(n,2,2,e,a),n[0]===n[1]||(n[0]instanceof m&&n[1]instanceof m?d("equals",[n[0].toJSON(),n[1].toJSON()]):(Q(n[0])&&Q(n[1])||!!(G(n[0])&&G(n[1])||K(n[0])&&K(n[1])))&&n[0].equals(n[1]))))},t.functions.relate=function(e,a){return t.standardFunctionAsync(e,a,(c,l,n)=>{if(n=w(n),h(n,3,3,e,a),n[0]instanceof m&&n[1]instanceof m)return d("relate",[n[0].toJSON(),n[1].toJSON(),W(n[2])]);if(n[0]instanceof m&&n[1]===null||n[1]instanceof m&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new o(e,s.InvalidParameter,a)})},t.functions.intersection=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>(n=w(n),O(n,e,a),n[0]===null||n[1]===null?null:y(await d("intersection",[n[0].toJSON(),n[1].toJSON()]))))},t.functions.union=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if((n=w(n)).length===0)throw new o(e,s.WrongNumberOfParameters,a);const i=[];if(n.length===1)if(g(n[0])){for(const r of w(n[0]))if(r!==null){if(!(r instanceof m))throw new o(e,s.InvalidParameter,a);i.push(r.toJSON())}}else{if(!v(n[0])){if(n[0]instanceof m)return E(J(n[0]),e.spatialReference);if(n[0]===null)return null;throw new o(e,s.InvalidParameter,a)}for(const r of w(n[0].toArray()))if(r!==null){if(!(r instanceof m))throw new o(e,s.InvalidParameter,a);i.push(r.toJSON())}}else for(const r of n)if(r!==null){if(!(r instanceof m))throw new o(e,s.InvalidParameter,a);i.push(r.toJSON())}return i.length===0?null:y(await d("union",[i]))})},t.functions.difference=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>(n=w(n),O(n,e,a),n[0]===null?null:n[1]===null?J(n[0]):y(await d("difference",[n[0].toJSON(),n[1].toJSON()]))))},t.functions.symmetricdifference=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>(n=w(n),O(n,e,a),n[0]===null&&n[1]===null?null:n[0]===null?J(n[1]):n[1]===null?J(n[0]):y(await d("symmetricDifference",[n[0].toJSON(),n[1].toJSON()]))))},t.functions.clip=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,2,2,e,a),!(n[1]instanceof x)&&n[1]!==null)throw new o(e,s.InvalidParameter,a);if(n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);return n[1]===null?null:y(await d("clip",[n[0].toJSON(),n[1].toJSON()]))})},t.functions.cut=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,2,2,e,a),!(n[1]instanceof L)&&n[1]!==null)throw new o(e,s.InvalidParameter,a);if(n[0]===null)return[];if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);return n[1]===null?[J(n[0])]:(await d("cut",[n[0].toJSON(),n[1].toJSON()])).map(i=>y(i))})},t.functions.area=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(h(n,1,2,e,a),n=w(n),U(n[0])){const r=await n[0].sumArea(N(n[1]),null,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,a);return r}let i=n[0];if((g(i)||v(i))&&(i=M(n[0],e.spatialReference)),i===null)return 0;if(!(i instanceof m))throw new o(e,s.InvalidParameter,a);return d("area",[i.toJSON(),N(n[1])])})},t.functions.areageodetic=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{h(n,1,3,e,a);let i=(n=w(n))[0];(g(i)||v(i))&&(i=M(i,e.spatialReference));const r=N(n[1]),u=D(n[2]);if(U(i)){const f=await i.sumArea(r,u,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,a);return f}if(i==null)return 0;if(!_(i))throw new o(e,s.InvalidParameter,a);return d("geodeticArea",[i.toJSON(),r,u])})},t.functions.length=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(h(n,1,2,e,a),n=w(n),U(n[0])){const r=await n[0].sumLength(N(n[1]),null,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,a);return r}let i=n[0];if((g(n[0])||v(n[0]))&&(i=C(n[0],e.spatialReference)),i===null)return 0;if(!(i instanceof m))throw new o(e,s.InvalidParameter,a);return d("length",[i.toJSON(),N(n[1])])})},t.functions.length3d=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(h(n,1,2,e,a),(n=w(n))[0]===null)return 0;let i=n[0];if((g(n[0])||v(n[0]))&&(i=C(n[0],e.spatialReference)),i===null)return 0;if(!(i instanceof m))throw new o(e,s.InvalidParameter,a);if(i.hasZ===!0){const{convertFromSpatialReferenceUnit:r,toLengthUnit:u}=await $(()=>import("./unitConversion-BxD3RA9Y-D7ME_iQX.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),f=an(i);return r(i.spatialReference,u(n[1]),f)}return d("length",[i.toJSON(),N(n[1])])})},t.functions.lengthgeodetic=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{h(n,1,3,e,a);let i=(n=w(n))[0];(g(n[0])||v(n[0]))&&(i=C(n[0],e.spatialReference));const r=N(n[1]),u=D(n[2]);if(U(i)){const f=await i.sumLength(r,u,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,a);return f}if(i===null)return 0;if(!_(i))throw new o(e,s.InvalidParameter,a);return d("geodeticLength",[i.toJSON(),r,u])})},t.functions.distance=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{n=w(n),h(n,2,3,e,a);let i=n[0];if((g(n[0])||v(n[0]))&&(i=V(n[0],e.spatialReference)),!(i instanceof m))throw new o(e,s.InvalidParameter,a);let r=n[1];if((g(n[1])||v(n[1]))&&(r=V(n[1],e.spatialReference)),!(r instanceof m))throw new o(e,s.InvalidParameter,a);return d("distance",[i.toJSON(),r.toJSON(),N(n[2])])})},t.functions.distancegeodetic=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{n=w(n),h(n,2,4,e,a);const i=n[0];if(!(i instanceof b))throw new o(e,s.InvalidParameter,a);const r=n[1];if(!(r instanceof b))throw new o(e,s.InvalidParameter,a);const u=new L({paths:[],spatialReference:i.spatialReference});return u.addPath([i,r]),d("geodeticLength",[u.toJSON(),N(n[2]),D(n[3])])})},t.functions.densify=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,2,3,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);const i=P(n[1]);if(isNaN(i))throw new o(e,s.InvalidParameter,a);if(i<=0)throw new o(e,s.InvalidParameter,a);switch(n[0].type){case"polygon":case"polyline":case"extent":return y(await d("densify",[n[0].toJSON(),i,N(n[2])]));default:return n[0]}})},t.functions.densifygeodetic=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{n=w(n),h(n,2,4,e,a);const i=n[0];if(i==null)return null;if(!_(i))throw new o(e,s.InvalidParameter,a);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,a);if(r<=0)throw new o(e,s.InvalidParameter,a);const u=N(n[2]),f=D(n[3]);switch(i.type){case"polygon":case"polyline":case"extent":return y(await d("geodeticDensify",[i.toJSON(),r,u,f]));default:return i}})},t.functions.generalize=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,2,4,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);const i=P(n[1]);if(isNaN(i))throw new o(e,s.InvalidParameter,a);const r=cn(j(n[2],!0));return y(await d("generalize",[n[0].toJSON(),i,N(n[3]),{removeDegenerateParts:r}]))})},t.functions.buffer=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,2,3,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);const i=P(n[1]);if(isNaN(i))throw new o(e,s.InvalidParameter,a);return i===0?J(n[0]):y(await d("buffer",[n[0].toJSON(),i,N(n[2])]))})},t.functions.buffergeodetic=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{n=w(n),h(n,2,4,e,a);const i=n[0];if(i==null)return null;if(!_(i))throw new o(e,s.InvalidParameter,a);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,a);if(r===0)return J(i);const u=N(n[2]),f=D(n[3]);return y(await d("geodesicBuffer",[i.toJSON(),r,u,f]))})},t.functions.offset=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,2,6,e,a),n[0]===null)return null;if(!(n[0]instanceof R||n[0]instanceof L))throw new o(e,s.InvalidParameter,a);const i=P(n[1]);if(isNaN(i))throw new o(e,s.InvalidParameter,a);const r=tn(n[3]),u=P(j(n[4],10));if(isNaN(u))throw new o(e,s.InvalidParameter,a);const f=P(j(n[5],0));if(isNaN(f))throw new o(e,s.InvalidParameter,a);return y(await d("offset",[n[0].toJSON(),i,N(n[2]),{joins:r,miterLimit:u,flattenError:f}]))})},t.functions.rotate=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{var f;if(n=w(n),h(n,2,3,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);const i=n[0]instanceof x?R.fromExtent(n[0]):n[0],r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,a);const u=j(n[2],null);if(u===null){const p=i.type==="point"?i:(f=i.extent)==null?void 0:f.center;return y(await d("rotate",[i.toJSON(),r,p==null?void 0:p.x,p==null?void 0:p.y]))}if(u instanceof b)return y(await d("rotate",[i.toJSON(),r,u.x,u.y]));throw new o(e,s.InvalidParameter,a)})},t.functions.centroid=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,1,2,e,a),n[0]===null)return null;const i=rn(n[1]);let r=n[0];if((g(n[0])||v(n[0]))&&(r=i==="geometric"?V(n[0],e.spatialReference):M(n[0],e.spatialReference),r===null))return null;if(!(r instanceof m))throw new o(e,s.InvalidParameter,a);return y(i==="geometric"?await d("centroid",[r.toJSON()]):await d("labelPoint",[r.toJSON()]))})},t.functions.measuretocoordinate=function(e,a){return t.standardFunctionAsync(e,a,on)},t.functions.pointtocoordinate=function(e,a){return t.standardFunctionAsync(e,a,sn)},t.functions.distancetocoordinate=function(e,a){return t.standardFunctionAsync(e,a,un)},t.functions.multiparttosinglepart=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,1,1,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);if(n[0]instanceof b)return[E(J(n[0]),e.spatialReference)];if(n[0]instanceof x)return[E(J(n[0]),e.spatialReference)];const i=y(await d("simplify",[n[0].toJSON()]));if(i instanceof R){const r=[],u=[];for(let f=0;f<i.rings.length;f++)if(i.isClockwise(i.rings[f])){const p=y({rings:[i.rings[f]],hasZ:i.hasZ===!0,hasM:i.hasM===!0,spatialReference:i.spatialReference.toJSON()});r.push(p)}else u.push({ring:i.rings[f],pt:i.getPoint(f,0)});for(let f=0;f<u.length;f++)for(let p=0;p<r.length;p++)if(r[p].contains(u[f].pt)){r[p].addRing(u[f].ring);break}return r}if(i instanceof L){const r=[];for(let u=0;u<i.paths.length;u++){const f=y({paths:[i.paths[u]],hasZ:i.hasZ===!0,hasM:i.hasM===!0,spatialReference:i.spatialReference.toJSON()});r.push(f)}return r}if(n[0]instanceof k){const r=[],u=E(J(n[0]),e.spatialReference);for(let f=0;f<u.points.length;f++)r.push(u.getPoint(f));return r}return null})},t.functions.isselfintersecting=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{h(n,1,1,c,l);let i=(n=w(n))[0];if((g(n[0])||v(n[0]))&&(i=C(n[0],c.spatialReference)),i instanceof k){const r=i.points;for(let u=0;u<r.length;u++)for(let f=u+1;f<r.length;f++)if(nn(r[u],r[f]))return!0;return!1}return(i instanceof L||i instanceof R)&&await d("isSelfIntersecting",[i.toJSON()])})},t.functions.issimple=function(e,a){return t.standardFunctionAsync(e,a,(c,l,n)=>{if(n=w(n),h(n,1,1,e,a),n[0]===null)return!0;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);return d("isSimple",[n[0].toJSON()])})},t.functions.simplify=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,1,1,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);return y(await d("simplify",[n[0].toJSON()]))})},t.functions.convexhull=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,1,1,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);return y(await d("convexHull",[n[0].toJSON()]))})},t.functions.getuser=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{var f,p;h(n,0,2,e,a);let i=j(n[1],""),r=i===!0;if(i=i===!0||i===!1?"":W(i),n.length===0||n[0]instanceof H){let I;I=(f=e.services)!=null&&f.portal?e.services.portal:B.getDefault(),n.length>0&&(I=Y(n[0],I));const F=await X(I,i,r);if(F){const A=JSON.parse(JSON.stringify(F));for(const S of["lastLogin","created","modified"])A[S]!==void 0&&A[S]!==null&&(A[S]=new Date(A[S]));return T.convertObjectToArcadeDictionary(A,Z(e))}return null}let u=null;if(U(n[0])&&(u=n[0]),u){if(r=!1,i)return null;await u.load();const I=await u.getOwningSystemUrl();if(!I){if(!i){const S=await u.getIdentityUser();return S?T.convertObjectToArcadeDictionary({username:S},Z(e)):null}return null}let F;F=(p=e.services)!=null&&p.portal?e.services.portal:B.getDefault(),F=Y(new H(I),F);const A=await X(F,i,r);if(A){const S=JSON.parse(JSON.stringify(A));for(const q of["lastLogin","created","modified"])S[q]!==void 0&&S[q]!==null&&(S[q]=new Date(S[q]));return T.convertObjectToArcadeDictionary(S,Z(e))}return null}throw new o(e,s.InvalidParameter,a)})},t.functions.nearestcoordinate=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,2,2,e,a),!(n[0]instanceof m||n[0]===null))throw new o(e,s.InvalidParameter,a);if(!(n[1]instanceof b||n[1]===null))throw new o(e,s.InvalidParameter,a);if(n[0]===null||n[1]===null)return null;const i=n[0]instanceof x?R.fromExtent(n[0]):n[0],r=await d("getNearestCoordinate",[i.toJSON(),n[1].toJSON(),{calculateLeftRightSide:!0}]);return r===null?null:T.convertObjectToArcadeDictionary({coordinate:y(r.coordinate),distance:r.distance,sideOfLine:r.distance===0?"straddle":r.isRightSide?"right":"left"},Z(e),!1,!0)})},t.functions.nearestvertex=function(e,a){return t.standardFunctionAsync(e,a,async(c,l,n)=>{if(n=w(n),h(n,2,2,e,a),!(n[0]instanceof m||n[0]===null))throw new o(e,s.InvalidParameter,a);if(!(n[1]instanceof b||n[1]===null))throw new o(e,s.InvalidParameter,a);if(n[0]===null||n[1]===null)return null;const i=n[0]instanceof x?R.fromExtent(n[0]):n[0],r=await d("getNearestVertex",[i.toJSON(),n[1].toJSON()]);return r===null?null:T.convertObjectToArcadeDictionary({coordinate:y(r.coordinate),distance:r.distance,sideOfLine:r.distance===0?"straddle":r.isRightSide?"right":"left"},Z(e),!1,!0)})})}export{En as registerFunctions};
