import{bo as S,Y as F,B as C,C as y,H as w,m as s,E as a,n as z,R as k,bP as j}from"./index-BeTPrQ6f.js";import{E as R}from"./cimSymbolUtils-BJ01Nooc-BfOR3Irv.js";import{_ as O}from"./utils-DvP1Tc7W-CK5sH9q2.js";let g=class extends S(F){constructor(t){super(t),this.frameCenter=null,this.frameOutline=null,this.lineOfSight=null,this.sensorLocation=null,this.sensorTrail=null}};s([a({type:C})],g.prototype,"frameCenter",void 0),s([a({type:y})],g.prototype,"frameOutline",void 0),s([a({type:w})],g.prototype,"lineOfSight",void 0),s([a({type:C})],g.prototype,"sensorLocation",void 0),s([a({type:w})],g.prototype,"sensorTrail",void 0),g=s([z("esri.layers.support.TelemetryData")],g);const m={type:Boolean,json:{write:!0}};let p=class extends S(F){constructor(e){super(e),this.frame=!1,this.frameCenter=!1,this.frameOutline=!0,this.lineOfSight=!0,this.sensorLocation=!0,this.sensorTrail=!0}};s([a(m)],p.prototype,"frame",void 0),s([a(m)],p.prototype,"frameCenter",void 0),s([a(m)],p.prototype,"frameOutline",void 0),s([a(m)],p.prototype,"lineOfSight",void 0),s([a(m)],p.prototype,"sensorLocation",void 0),s([a(m)],p.prototype,"sensorTrail",void 0),p=s([z("esri.layers.support.TelemetryDisplay")],p);let d=class extends S(F){constructor(t){super(t),this.duration=null,this.end=null,this.start=null,this.timezone="UTC"}readEnd(t,e){return e.end!=null?new Date(e.end):null}writeEnd(t,e){e.end=t?t.getTime():null}readStart(t,e){return e.start!=null?new Date(e.start):null}writeStart(t,e){e.start=t?t.getTime():null}};s([a({type:Number,json:{write:{allowNull:!0}}})],d.prototype,"duration",void 0),s([a({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"end",void 0),s([k("end")],d.prototype,"readEnd",null),s([j("end")],d.prototype,"writeEnd",null),s([a({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"start",void 0),s([k("start")],d.prototype,"readStart",null),s([j("start")],d.prototype,"writeStart",null),s([a({type:String})],d.prototype,"timezone",void 0),d=s([z("esri.layers.support.VideoTimeExtent")],d);const U=d,P="application/x-mpegURL",I="video/mp4",J="video/webm",r={PlatformHeadingAngle:10005,PlatformPitchAngle:10006,PlatformRollAngle:10007,SensorLatitude:10013,SensorLongitude:10014,SensorTrueAltitude:10015,SensorHorizontalFOV:10016,SensorVerticalFOV:10017,SensorAzimuthAngle:10018,SensorElevationAngle:10019,SensorRollAngle:10020,FrameCenterLatitude:10023,FrameCenterLongitude:10024,FrameCenterElevation:10025,OffsetCorner1Latitude:10026,OffsetCorner1Longitude:10027,OffsetCorner2Latitude:10028,OffsetCorner2Longitude:10029,OffsetCorner3Latitude:10030,OffsetCorner3Longitude:10031,OffsetCorner4Latitude:10032,OffsetCorner4Longitude:10033,SensorEllipsoidHeight:10075,FrameCenterAboveEllipsoid:10078,EsriVideoWidth:90001,EsriVideoHeight:90002,EsriFrameCenterLatitude:90050,EsriFrameCenterLongitude:90051,EsriCornerLatitudePt1:90052,EsriCornerLongitudePt1:90053,EsriCornerLatitudePt2:90054,EsriCornerLongitudePt2:90055,EsriCornerLatitudePt3:90056,EsriCornerLongitudePt3:90057,EsriCornerLatitudePt4:90058,EsriCornerLongitudePt4:90059,EsriFrameOutline:90060,EsriSensorPosition:90061,EsriHorizonPixelPack:90063,EsriGroundControlPoints:90064};function tt(t,e=1e4){if(!t||!t.length)return[];let n=[],o=[];for(let u=0;u<t.length;u++){const l=t[u],f=l!=null&&l.text?JSON.parse(l.text):null;(f==null?void 0:f.source)==="EsriVideoServer"&&(n=[...f.data])}const i=n.find(u=>u.tagId===e);return Array.isArray(i==null?void 0:i.value)&&(o=[...i.value]),o}function et(t){const{duration:e,end:n,start:o,timezone:i="UTC"}=t||{};return typeof e!="number"?null:new U({duration:e||null,end:typeof n=="number"?new Date(n):null,start:typeof o=="number"?new Date(o):null,timezone:i})}function rt(t,e){const n=[...e],o=n.findIndex(i=>i.equals(t));return o>-1&&n.splice(o),n.push(t),n}function nt(t){if(!(t!=null&&t.size))return new g;const e=Z(t),n=$(t),o=G(t),i=W(e,n);return new g({frameCenter:n,frameOutline:o,lineOfSight:i,sensorLocation:e})}function ot(t){var e;return t!=null&&t.size?((e=t.get(r.EsriGroundControlPoints))==null?void 0:e.value)??null??null:null}function it(t){var e;return t!=null&&t.size?((e=t.get(r.EsriHorizonPixelPack))==null?void 0:e.value)??null:null}function $(t){return q(t)??B(t)}function st(t){if(!t)return P;const e=t.match(/\.(\w{3,4})(?:$|\?)/i);if(!e)return P;switch(e[1].toLowerCase()){case"mp4":return I;case"webm":return J;default:return P}}function ut(t){const e=t==null?void 0:t.layers;return e!=null&&e.length?e.map(n=>({layerId:n.id,posterUrl:n.poster,sourceType:n.serviceType,title:n.name,type:n.type||"Video Layer"})):[]}function at(t,e,n){var i;if(!t)return null;const o=t.clone();switch(o.type){case"simple-fill":O(o,n),o.outline.color=e;break;case"simple-line":O(o,e);break;case"simple-marker":O(o,e),(i=o==null?void 0:o.outline)!=null&&i.color&&(o.outline.color=e);break;case"cim":R(o,e)}return o}function lt(t){const{cameraAzimuth:e,platformHeading:n,source:o=null,symbolOffset:i=0}=t||{};let u=0;if(!o)return u;u=o==="platformHeading"?n+i:n+e+i;const l=u>360?u-360:u;return Math.round(Math.abs(l))}function q(t){var e,n;return t&&t.has(r.EsriFrameCenterLatitude)&&t.has(r.EsriFrameCenterLongitude)?new C({x:t.get(r.EsriFrameCenterLongitude).value,y:t.get(r.EsriFrameCenterLatitude).value,z:((e=t.get(r.FrameCenterAboveEllipsoid))==null?void 0:e.value)??((n=t.get(r.FrameCenterElevation))==null?void 0:n.value)}):null}function B(t){var e,n,o;return t&&t.has(r.FrameCenterLatitude)&&t.has(r.FrameCenterLongitude)?new C({x:(e=t.get(r.FrameCenterLongitude))==null?void 0:e.value,y:(n=t.get(r.FrameCenterLatitude))==null?void 0:n.value,z:(o=t.get(r.FrameCenterElevation))==null?void 0:o.value}):null}function G(t){var n;if(!t)return null;const e=(n=t.get(r.EsriFrameOutline))==null?void 0:n.value;return e?y.fromJSON(e.geometry):M(t)??Y(t)}function M(t){var u,l,f,h,v,E,L,c;if(!(t.has(r.EsriCornerLatitudePt1)&&t.has(r.EsriCornerLongitudePt1)&&t.has(r.EsriCornerLatitudePt2)&&t.has(r.EsriCornerLongitudePt2)&&t.has(r.EsriCornerLatitudePt3)&&t.has(r.EsriCornerLongitudePt3)&&t.has(r.EsriCornerLatitudePt4)&&t.has(r.EsriCornerLongitudePt4)))return null;const e=[(u=t.get(r.EsriCornerLongitudePt1))==null?void 0:u.value,(l=t.get(r.EsriCornerLatitudePt1))==null?void 0:l.value],n=[(f=t.get(r.EsriCornerLongitudePt2))==null?void 0:f.value,(h=t.get(r.EsriCornerLatitudePt2))==null?void 0:h.value],o=[(v=t.get(r.EsriCornerLongitudePt3))==null?void 0:v.value,(E=t.get(r.EsriCornerLatitudePt3))==null?void 0:E.value],i=[(L=t.get(r.EsriCornerLongitudePt4))==null?void 0:L.value,(c=t.get(r.EsriCornerLatitudePt4))==null?void 0:c.value];return new y({rings:[[e,n,o,i]]})}function Y(t){var L,c,x,T,b,A,H,D,V,N;if(!(t.has(r.OffsetCorner1Latitude)&&t.has(r.OffsetCorner1Longitude)&&t.has(r.OffsetCorner2Latitude)&&t.has(r.OffsetCorner2Longitude)&&t.has(r.OffsetCorner3Latitude)&&t.has(r.OffsetCorner3Longitude)&&t.has(r.OffsetCorner4Latitude)&&t.has(r.OffsetCorner4Longitude)&&t.has(r.FrameCenterLatitude)&&t.has(r.FrameCenterLongitude)))return null;const e=(L=t.get(r.FrameCenterLatitude))==null?void 0:L.value,n=(c=t.get(r.FrameCenterLongitude))==null?void 0:c.value,o=e+((x=t.get(r.OffsetCorner1Latitude))==null?void 0:x.value),i=n+((T=t.get(r.OffsetCorner1Longitude))==null?void 0:T.value),u=e+((b=t.get(r.OffsetCorner2Latitude))==null?void 0:b.value),l=n+((A=t.get(r.OffsetCorner2Longitude))==null?void 0:A.value),f=e+((H=t.get(r.OffsetCorner3Latitude))==null?void 0:H.value),h=n+((D=t.get(r.OffsetCorner3Longitude))==null?void 0:D.value),v=e+((V=t.get(r.OffsetCorner4Latitude))==null?void 0:V.value),E=n+((N=t.get(r.OffsetCorner4Longitude))==null?void 0:N.value);return new y({rings:[[[i,o],[l,u],[h,f],[E,v]]]})}function W(t,e){if(!t||!e)return null;const n=[t.x,t.y,t.z??0],o=[e.x,e.y,e.z??0];return new w({paths:[[n,o]]})}function Z(t){var e,n,o,i;if(!(t!=null&&t.size))return null;if(t.has(r.EsriSensorPosition)){const u=(e=t.get(r.EsriSensorPosition))==null?void 0:e.value;if(u)return C.fromJSON(u.geometry)}return t.has(r.SensorLongitude)&&t.has(r.SensorLatitude)?new C({x:(n=t.get(r.SensorLongitude))==null?void 0:n.value,y:(o=t.get(r.SensorLatitude))==null?void 0:o.value,z:(i=t.get(r.SensorTrueAltitude))==null?void 0:i.value}):null}export{et as D,st as G,tt as H,ut as I,at as J,lt as M,ot as N,rt as V,g as d,p as f,it as j,nt as k,r as t,U as w};
