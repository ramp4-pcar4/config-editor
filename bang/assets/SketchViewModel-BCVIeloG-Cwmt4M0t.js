const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SelfSnappingEngine-Bl56UoIA-DDaH1Nrp.js","./index-BeTPrQ6f.js","./index-BlWAJbpo.css","./Cyclical-Bzwh_QaL-CXh-hbnA.js","./quantityUtils-v7kjLywD-Cq6IoGLM.js","./elevationInfoUtils-DFX5QvG8-DWLx2t7K.js","./ElevationInfo-tlrAM5SV-D86C1F9d.js","./lengthUtils-CopeXEyE-DjCEitlq.js","./angularMeasurementUtils-CVK8K4WU-C6RO-Ta3.js","./vec2f64-CkowXrDb-3zFQ3LNH.js","./vec32-CI1xtKog-DFVYRcgb.js","./projectVectorToVector-OCoJKalB-CQIDHzSm.js","./projectionUtils-CsX1UTBu-DsZaU4xz.js","./projectBuffer-CMNsPBq1-CMpE7Jo3.js","./zscale-PLuFqpaL-BIEnWBsg.js","./projectPointToVector-BHS0gJJf-DOVZH8Fn.js","./geodesicUtils-DHDMXkUY-CP5HeHA5.js","./UpdatingHandles-XotKWqvb-CyHJIoZx.js","./GraphicsLayer-DPoztXf7-DWF8RDJT.js","./GraphicsCollection-CT-y6p3H-4XYPvC_j.js","./BlendLayer-D8oJmNCO-A0sTzbOF.js","./layerContainerType-CJrPp4UB-BIF7XAYP.js","./jsonUtils-Bl9MVnOR-Be8hf0yA.js","./parser-CXoJuqeV-C7irlk5U.js","./mat4f32-BdRMyjXW-CWt6U0BP.js","./mat4-R0VY9B_E-DoEP887i.js","./ScaleRangeLayer-DkZwCH6_-C95kTMqN.js","./editableLayers-BTZOOiKD-ByJ-Oydo.js","./utils-DqlCEhl6-DBO0-7VG.js","./Queue-CK6TduSr-C-T211SM.js","./signal-DHxLvooI-Bin-tnuW.js","./Version-DSJSGSLA-Cg87msWM.js","./asyncUtils-Cu__bxqs-ecCTUaGV.js","./Query-DKLDaFaA-I4zhlfzt.js","./Field-Dn1Bgq7n-CJCGLoNR.js","./fieldType-DvW5hpfa-DYUbIy_X.js","./vec42-DHp-FUwt-Br7hmYJs.js","./vec4f64-DD-nkcCV-CSNWKRqG.js","./plane-wUwHaY3K-ZwGBF7HQ.js","./vectorStacks-B2ngxq6F-myhPBoPk.js","./quatf64-C16JxGFv-BKWK1F8U.js","./sphere-CIGsF4vz-C3zVQu9y.js","./geodeticLengthOperator-CMi-Z1ZN-WUImro4E.js","./geodeticCurveType-D_etKnbP-CirnHLSB.js","./earcut-C6NeZYSh-P2HUZ781.js","./triangle-DA_o7I-u-CHbj6sRJ.js","./lineSegment-D8lwRkdT-CnWWOaLb.js","./spatialReferenceEllipsoidUtils-Ty3j4VoE-BUAsRqCF.js","./GridSnappingEngine-Dq-tYQYn-CmIdnZRX.js","./normalizeUtils-DK5542Ty-DtqBcgc2.js","./normalizeUtilsCommon-5DjefBp7-CQyUDMQp.js","./utils-CRANtbnc-C6zyufvL.js","./utils-t279O251-BBk6rV0U.js","./scaleUtils-Ckma21r5-DhwWQymd.js","./gridUtils-DpRsTzHe-j68kmuS2.js","./FeatureSnappingEngine-B7r4319G-BgwA9gE4.js","./mapCollectionUtils-DHlvEs72-DKXw-TcU.js","./FeatureFilter-D0iZ4sKI-BBZH0Xo9.js","./floorFilterUtils-4r-vVdzs-u-jw2p7F.js","./layerViewUtils-BBTk5dU--BemaIlLi.js","./geometryEngine-63haXLQ5-mLTbn98B.js","./geometryEngineBase-CPp2o-tC-BaYhYMQU.js","./_commonjsHelpers-BITg13Vk-KnjfkSck.js","./editingTools-Owi9EJyN-BIXDePDC.js","./SnappingVisualizer2D-C1_WGevN-BkQ_4UbX.js","./TooltipInfoWithCoordinates-Ddvg_E_1-DHPxpvzo.js","./PointSnappingHint-NgOvzAAk-CFqn5eSp.js","./SketchTooltipInfo-EowXqHHv-Yp97uw3T.js","./messages-DQ10DjvF-6kk0dzjG.js","./MeshTransform-DfLVYScT-Cq2gdNT7.js","./quat-B6H0knG8-DtO1-hlf.js","./axisAngleDegrees-StGk9lM5-YzC5iFyo.js","./meshVertexSpaceUtils-EbHpWZGf-CmRuaT8m.js","./MeshLocalVertexSpace-CxmyTFZH-DhgfYuby.js","./modeUtils-V6BDu_YT-Dq8o_RJK.js","./jsxFactory-DN-m49_5-CUFCpKPo.js","./intl-DRhjUnwt-Dihhq8dq.js","./uuid-CFz2qBzH-cIdlpVG-.js","./sanitizerUtils-CrdmaILo-DztC6Qnx.js","./a11yUtils-tU3tY6-a-CmHbThdR.js","./unitFormatUtils-BbVpiips-i7yyYN--.js","./getDefaultUnitForView-CEAuCsu_-B1vEtX96.js","./index-C3e3iuYi-s8xSrC2z.js","./draw-store-DwCnUTPl-Dp2Sl1TU.js","./drapedUtils-D9z307XM-CQXlJXY2.js","./utils-C0LvbFCo-RMQaTNpt.js","./widget-Yo6nzRYu-BBI8jxq5.js","./substitute-Cl1SJAIb-D0XLv0xK.js","./editPlaneUtils-DVPHOAL2-C25USCi0.js","./drawSurfaces--K8ToToC-FllffqSc.js","./ReactiveSet-DP8oFB7N-DSfeDz8k.js","./diffUtils-D3O4EfgX-CznKxD4n.js","./SnappingContext-pR4ApgxC--JaBRde9.js","./rotate-ClH9iv5s-CoX5oM8l.js","./curveOperationUtils-ClbIvhut-17Ywjz26.js","./hydratedFeatures-82j52esm-6EbRngQ4.js","./Scheduler-D_tOhFWn-SFGb1GBz.js","./debugFlags-vZXEBr68-Bc51Oe-E.js","./createUtils-QoBeynM5-wXx8RLRA.js","./distanceOperator-C3n_j88h-CjjOO0Zj.js","./Point2D-BVUQyGsf-qih0ZuJV.js","./Distance2DCalculator-CXhBP-8I-CW7HDKXX-kSux2duE.js","./ProjectionTransformation-BXUROh_s-kKBZ5FDB.js","./Envelope2D-2iYexKQo-BCKocNS7.js","./Transformation2D-CZCvoz9N-B-IhcWnl.js","./SimpleGeometryCursor-DSF_YyIm-TAMgMsbK.js","./OperatorDefinitions-DJdq_wrt-DP7_WWTp.js","./apiConverter-Djde5pBD-Dr3vspB4.js","./jsonConverter-CiKBkr5U-C590VlCu.js","./simplifyOperator-CK8t6p1S-COLMjdqn.js","./operatorSimplify-BRKLCaj2-DisWK8Yh.js","./mat2d-Cf4xHr3Z-u09Kv-lR.js","./mat2df64-VxtldH1S-CqyKAV7h.js","./boundedPlane-CehKkKe3-4WekUEh5.js","./cimSymbolUtils-BJ01Nooc-BfOR3Irv.js","./utils-CIm5uQvO-CtKf129F.js","./defaultCIMValues-BWu-APou-XI-Li77m.js","./GraphicManipulator-CkOY4Z_k-BgpI7zKu.js","./colorUtils-DlmOacVt-BnN0T6wa.js","./drawUtils-IdZShl4g-YZikzVNa.js","./ImageMaterial.glsl-C9IVRq6S-CsryHqFn.js","./TextOverlayItem-5NFsakI7-CpLCqR0o.js","./frustum-D1Y7pP8E-DUyP3Dvr.js","./RibbonLine.glsl-wB3eQn3n-0F1lPIwt.js","./orientedBoundingBox-DAJ-bKlA-DbqXagWB.js","./computeTranslationToOriginAndRotation-CsOb5S2S-CE5ZgVBy.js","./OutputColorHighlightOID.glsl-fUhBGshN-Ctm9N97M.js","./enums-DDJfd4_p-D3z9tmVA.js","./Texture-DLw7oaIg-fTsxdRzn.js","./Indices-CAn-HCVv-hWNN5onC.js","./BufferView-B6RYETl3-CMoUTBv6.js","./renderState-CsafAKLy-B8R8ns_l.js","./glsl-CfY1Aoj6-DPHSeNd9.js","./VertexAttributeLocations-DBgVVQz--D3wovAvC.js","./VertexElementDescriptor-DLvjNrmQ-Cuvx5w94.js","./Octree-CuXix3EP-CfBHKjXe.js","./InterleavedLayout-CuMGnz6O-DkraWivs.js","./types-l27bT09Q-DE0QfIFp.js","./HUDMaterial.glsl-CxXm6elT-D8B376d1.js","./vec3f32-GX_cKsFD-UJPpzdNc.js","./ShaderBuilder-ufvKEDd5-DMnPqr6U.js","./DefaultLayouts-D6e0ipo3-CAKHUQ6x.js","./triangulationUtils-BIEW4TIq-CnOT_xJp.js","./deduplicate-Cqg-F-nU-CWiUqVRS.js","./VertexArrayObject-BAcBN849-N8lUr7x7.js","./memoryEstimations-C_GUL8g_-JniNFd5l.js","./BufferObject-RHe5uojV-C-IINTcZ.js","./VertexBuffer-7GCTDD7e-CbRHEILO.js","./NestedMap-BCg8I1M1-D2deq-hj.js","./Texture-Daa63Q6u-Bl4xeC_t.js","./videoUtils-ZWM8l9ln-fGQ142sg.js","./requestImageUtils-CrIBaPUj-khjAqpU7.js","./sdfPrimitives-KBv8JuXI-GIoUdHpt.js","./SelectedVertexTooltipInfo-CJDbmWdK-C9zXxAOj.js","./TranslateTooltipInfo-DAX-YrWE-Bq4gCa04.js","./utils-DvP1Tc7W-CK5sH9q2.js","./LRUCache-CvGiiws0-B3io5Jp4.js","./MemCache-TG-MhOJy-BkjKRNR7.js","./ExtentScaleTooltipInfo-HFWOYSN4-B-CajZu0.js","./LineCallout.glsl-Banmijl9-BP40ctOV.js","./projectionUtils-BXtVkW1R-Dp6FsH61.js","./HeightModelInfo-Cjals-AI-DMpn5Tsh.js","./visualVariableUtils-DzY4BXXy-D_1S-x1B.js","./dehydratedFeatures-Ck57tKcB-BDo0po7B.js","./UniqueValueRenderer-4zUMozui-C0Y5GPGV.js","./commonProperties-CYpRbAZr-PcmW9U_y.js","./colorRamps-C5pnMn-A-BSSJ2zvJ.js","./ColorStop-CBXZUZ6o-_LZdJKea.js","./RendererLegendOptions-_ue7FeM0-ROeRce-g.js","./styleUtils-DoTsJ8ze-DHY40A2q.js","./rendererConversion-BQaBjHLq-BdxfewoA.js","./RealisticTree.glsl-BeXElkve-nSLXNDlV.js","./DefaultMaterial-BRCr1DHi-kRRyJwPx.js","./edgeUtils-7PcBwngp-C8mR0Y3j.js","./OptimizedFeature-C33SioFK-sn7DeAq-.js","./OptimizedGeometry-BYxlP_oK-DvAqrgO1.js","./optimizedFeatureQueryEngineAdapter-BJ0qb0D_-CJYoLogA.js","./vec2f32-hTAvipMV-C0AQcwEv.js","./featureConversionUtils-CZmIxyv5-DHwRSztU.js","./OptimizedFeatureSet-Dz5hF8Qm-CgsRgxJh.js","./PooledRBush-CJtyGgW1-FNinHJNO.js","./quickselect-DHTstthl-Ds_Aj0x5.js","./popupUtils-0qrvMVFA-DW3AaJvU.js","./LayerView-DBq501tj-9r8g88Ff.js","./highlightOptionsUtils-D6RCaXjG-zpB2TL72.js","./GraphicMover-DhdSHNnj-BRs2Gnjj.js","./Box-Bl0kNUz2-BY1z6oY5.js","./settings-CqHj8nr3-CluyVpKZ.js","./Reshape-BN0WJMw6-BYAhd0i4.js","./symbolUtils-BWODOwTq-BEtrWlLF.js","./mat2df32-fg3OHsAI-BF2V2zqo.js"])))=>i.map(i=>d[i]);
import{j as zt,fG as yi,fY as In,fX as Un,hZ as Vn,a7 as we,h_ as Nn,h$ as qn,as as ye,at as Me,aB as Ui,bc as Ft,ar as We,_ as D,aT as jn,ay as Et,V as gi,aW as mt,i0 as $n,i1 as zn,i2 as J,i3 as fi,P as Vi,l as Fn,aJ as mi,aS as Zn,bh as vi,aj as ce,bz as Wn,aG as Bn,N as Ot,i as Kn,al as Jn,Y as Ni,bp as lt,i4 as pt,aP as Qn,eq as _,i5 as Yn,i6 as pe,ba as Xn,by as er,hW as tr,i7 as ir,ab as I,i8 as ee,a5 as nr,af as qi,ae as ke,cj as rr,i9 as or,ia as sr,ib as ji,gu as ar,ic as Te,a3 as lr,id as pr,g4 as cr,bd as je,ie as hr,es as ur,et as $i,eu as dr,ep as yr,a8 as gr,ig as fr,fc as zi,d4 as mr,ih as vr,a2 as Fi,eD as _r,m as c,E as u,n as L,H as br,fv as De,ii as _i}from"./index-BeTPrQ6f.js";import{i as wr}from"./UpdatingHandles-XotKWqvb-CyHJIoZx.js";import{J as Sr,G as Tr,L as Er,W as It,N as Or}from"./projectionUtils-CsX1UTBu-DsZaU4xz.js";import Gr from"./GraphicsLayer-DPoztXf7-DWF8RDJT.js";import{u as Mr}from"./editableLayers-BTZOOiKD-ByJ-Oydo.js";import{d as xr,_ as x,I as bi,V as G,$ as wi,m as Ar}from"./utils-DqlCEhl6-DBO0-7VG.js";import{g as Cr}from"./asyncUtils-Cu__bxqs-ecCTUaGV.js";import{E as xe,q as kr,A as Zi,c as Pr}from"./elevationInfoUtils-DFX5QvG8-DWLx2t7K.js";import{p as Wi,n as $e,f as nt}from"./projectVectorToVector-OCoJKalB-CQIDHzSm.js";import{p as Ut,q as vt,j as Rr,R as O,S as Dr,A as Zt,g as Ne,_ as te,L as P,v as Bi,T as Lr,k as V,z as U,Q as ct,U as Vt,l as Hr}from"./vec32-CI1xtKog-DFVYRcgb.js";import{b as Ir}from"./Query-DKLDaFaA-I4zhlfzt.js";import{o as K,r as rt,l as Ur}from"./vec2f64-CkowXrDb-3zFQ3LNH.js";import{y as Vr,o as Nr}from"./vec42-DHp-FUwt-Br7hmYJs.js";import{o as qr}from"./vec4f64-DD-nkcCV-CSNWKRqG.js";import{i as jr}from"./projectBuffer-CMNsPBq1-CMpE7Jo3.js";import{E as Ki,$ as Wt,W as Bt,c as $r,h as zr,O as Nt}from"./geodesicUtils-DHDMXkUY-CP5HeHA5.js";import{L as $,X as Ji,W as _t,V as Fr,Z as Kt,g as Zr,s as Qi,b as qt,R as Yi,q as Wr,M as Xi,r as Br}from"./plane-wUwHaY3K-ZwGBF7HQ.js";import{r as Kr,Q as Jr,G as Qr,w as Yr}from"./sphere-CIGsF4vz-C3zVQu9y.js";import{i as me,s as Jt}from"./quantityUtils-v7kjLywD-Cq6IoGLM.js";import{m as Xr,l as en}from"./geodeticLengthOperator-CMi-Z1ZN-WUImro4E.js";import{m as eo}from"./earcut-C6NeZYSh-P2HUZ781.js";import{h as to}from"./triangle-DA_o7I-u-CHbj6sRJ.js";import{m as io,M as no}from"./spatialReferenceEllipsoidUtils-Ty3j4VoE-BUAsRqCF.js";let Oe=class extends ce{constructor(t){super(t),this.length=null,this.verticalLength=null,this.area=null}};c([u()],Oe.prototype,"length",void 0),c([u()],Oe.prototype,"verticalLength",void 0),c([u()],Oe.prototype,"area",void 0),Oe=c([L("esri.views.interactive.sketch.Units")],Oe);const ht=Oe;let ue=class extends ce{constructor(t){super(t),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?"relative-bilateral":"relative";case"absolute":return"absolute"}}get displayUnits(){return this._get("displayUnits")??new ht}set displayUnits(t){this._set("displayUnits",t)}get inputUnits(){return this._get("inputUnits")??new ht}set inputUnits(t){this._set("inputUnits",t)}};c([u({type:String,nonNullable:!0})],ue.prototype,"directionMode",void 0),c([u({type:Boolean,nonNullable:!0})],ue.prototype,"relativeDirectionIsBilateral",void 0),c([u()],ue.prototype,"effectiveDirectionMode",null),c([u({type:ht,nonNullable:!0})],ue.prototype,"displayUnits",null),c([u({type:ht,nonNullable:!0})],ue.prototype,"inputUnits",null),ue=c([L("esri.views.interactive.sketch.SketchValueOptions")],ue);const Qt=ue;function Si(t){switch(t){case 0:break;case 1:return"not owned by a graphics layer";case 2:return"no geometry";case 3:return"the geometry type is not supported";case 4:return"the symbol type is not supported"}return""}function ro(t){var i,n;if(t.graphic&&((i=t.graphic.layer)==null?void 0:i.type)!=="graphics")return 1;const e=(n=t.operations)==null?void 0:n.data.type;if(!e)return 3;switch(e){case"polygon":case"point":case"polyline":case"mesh":break;default:return 3}return 0}function oo(t){return so(t).result}function so(t){var n;if(t.graphic&&((n=t.graphic.layer)==null?void 0:n.type)!=="graphics")return{result:1};if(!t.operations)return{result:2};const e=t.operations.data.type,i=t.operations.data.geometry;return e==="point"||e==="mesh"||e==="polyline"||e==="polygon"?{result:0,geometry:i}:{result:3}}function ao(t){var i;if(((i=t.layer)==null?void 0:i.type)!=="graphics")return 1;if(t.geometry==null)return 2;switch(t.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return 0;default:return 3}const e=t.symbol!=null&&t.symbol.type==="point-3d"&&t.symbol.symbolLayers;return e&&e.some(n=>n.type==="object")?0:4}function Ti(t,e,i){if(!e||!(t!=null&&t.map))return;const{map:n}=t;n.layers.find(r=>r===e)||n.add(e,i)}function ga(t,e){const i=(e==null?void 0:e.type)==="subtype-sublayer"?e.parent:e;return t.allLayerViews.find(n=>{const r=n.layer;return r===i||"sublayers"in r&&r.sublayers!=null&&r.sublayers.includes(i)})}function fa(t){return Mr(t)||er(t)||tr(t)||ir(t)}let ot=class extends ce{constructor(t){super(t),this.enabled=!1}};c([u({type:Boolean,nonNullable:!0})],ot.prototype,"enabled",void 0),ot=c([L("esri.views.interactive.sketch.SketchLabelOptions")],ot);const Yt=ot;let qe=class extends ce{constructor(t){super(t),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};c([u({type:String,nonNullable:!0})],qe.prototype,"mode",void 0),qe=c([L("esri.views.interactive.sketch.SketchTooltipElevationOptions")],qe);let R=class extends ce{constructor(t){super(t),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};c([u({type:Boolean,nonNullable:!0})],R.prototype,"area",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"coordinates",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"direction",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"distance",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"elevation",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"header",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"helpMessage",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"orientation",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"radius",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"rotation",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"scale",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"size",void 0),c([u({type:Boolean,nonNullable:!0})],R.prototype,"totalLength",void 0),R=c([L("esri.views.interactive.sketch.SketchTooltipVisibleElements")],R);const tn=R;let H=class extends ce{constructor(t){super(t),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new qe,this.placement="auto",this.offset=null,this.visibleElements=new tn,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};c([u({type:Boolean,nonNullable:!0})],H.prototype,"enabled",void 0),c([u()],H.prototype,"forceEnabled",void 0),c([u()],H.prototype,"effectiveEnabled",null),c([u()],H.prototype,"helpMessage",void 0),c([u()],H.prototype,"helpMessageIcon",void 0),c([u({type:Boolean,nonNullable:!0})],H.prototype,"inputEnabled",void 0),c([u({type:qe,nonNullable:!0})],H.prototype,"elevation",void 0),c([u()],H.prototype,"placement",void 0),c([u()],H.prototype,"offset",void 0),c([u({type:tn,nonNullable:!0})],H.prototype,"visibleElements",void 0),c([u()],H.prototype,"visualVariables",void 0),c([u()],H.prototype,"xyMode",void 0),H=c([L("esri.views.interactive.sketch.SketchTooltipOptions")],H);const Xt=H;let Ge=class extends ce{constructor(t){super(t),this.labels=new Yt,this.tooltips=new Xt,this.values=new Qt}};c([u({nonNullable:!0,type:Yt})],Ge.prototype,"labels",void 0),c([u({nonNullable:!0,type:Xt})],Ge.prototype,"tooltips",void 0),c([u({nonNullable:!0,type:Qt})],Ge.prototype,"values",void 0),Ge=c([L("esri.views.interactive.sketch.SketchOptions")],Ge);const nn=Ge;function rn(t,e,i){return N(t,e,i)}function N(t=0,e=0,i=0){return pt(t,e,i)}function ma(t){return t}function va(t){return t}function fe(t,e,i){return pt(t,e,i)}function Ae(t){const[e,i,n]=t;return t.length>3?[e,i,n,t[3]]:[e,i,n]}function Gt(t){return t[3]=1|((t.length>3?t[3]:void 0)??0),t}function _a(t){return!!(1&((t.length>3?t[3]:void 0)??0))}function Ei(t,e,{coordinateHelper:i,elevationInfo:n},r){return t?Ve(i.vectorToDehydratedPoint(t,lo),e,n,r):null}function Ve(t,e,i,n=N()){return n[0]=t.x,n[1]=t.y,n[2]=t.z??0,e==null||(e.type==="2d"?n[2]=0:n[2]=kr(e,t,i,xe)??0),n}function ba(t,e,i){return i?(Wi(i,t[0],t[1],t[2],e),i):$e(t[0],t[1],t[2],e)}function Oi(t,e,{z:i,m:n},r,o){const{spatialReference:s,elevationInfo:p}=r;let l;i==null&&n==null?l=void 0:e==null||e.type==="2d"?l=i??void 0:l=Zi(e,t,s,xe,p)??0;const[a,h]=t;return o?Wi(o,a,h,l,s):o=$e(a,h,l,s),n!=null&&(o.m=n,o.hasM=!0),o}function wa(t,e,i,n,r=N()){const[o,s]=t;return r[0]=o,r[1]=s,t.length>3&&(r[3]=t[3]??0),(i==null?void 0:i.type)!=="3d"?(r[2]=e.value,r):(r[2]=Pr(i,o,s,e.value,n,e.elevationInfo,xe)??0,r)}const lo=$e(0,0,0,null);let W=class extends Ni{constructor(){super(...arguments),this.enabled=!0}};c([u({type:Boolean})],W.prototype,"enabled",void 0),W=c([L("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],W);let E=class extends Ni{constructor(t){super(t),this.lineSnapper=new W,this.parallelLineSnapper=new W,this.rightAngleSnapper=new W,this.rightAngleTriangleSnapper=new W,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new lt([255,127,0]),this.orangeTransparent=new lt([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};c([u({type:W,constructOnly:!0,nonNullable:!0,json:{write:!0}})],E.prototype,"lineSnapper",void 0),c([u({type:W,constructOnly:!0,nonNullable:!0,json:{write:!0}})],E.prototype,"parallelLineSnapper",void 0),c([u({type:W,constructOnly:!0,nonNullable:!0,json:{write:!0}})],E.prototype,"rightAngleSnapper",void 0),c([u({type:W,constructOnly:!0,nonNullable:!0,json:{write:!0}})],E.prototype,"rightAngleTriangleSnapper",void 0),c([u({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],E.prototype,"shortLineThreshold",void 0),c([u({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],E.prototype,"distance",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],E.prototype,"pointThreshold",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],E.prototype,"intersectionParallelLineThreshold",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],E.prototype,"parallelLineThreshold",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],E.prototype,"verticalLineThresholdMeters",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],E.prototype,"touchSensitivityMultiplier",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],E.prototype,"pointOnLineThreshold",void 0),c([u({type:lt,nonNullable:!0})],E.prototype,"orange",void 0),c([u({type:lt,nonNullable:!0})],E.prototype,"orangeTransparent",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],E.prototype,"lineHintWidthReference",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],E.prototype,"lineHintWidthTarget",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],E.prototype,"lineHintFadedExtensions",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],E.prototype,"parallelLineHintWidth",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],E.prototype,"parallelLineHintLength",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],E.prototype,"parallelLineHintOffset",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],E.prototype,"rightAngleHintSize",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],E.prototype,"rightAngleHintOutlineSize",void 0),c([u({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],E.prototype,"satisfiesConstraintScreenThreshold",void 0),E=c([L("esri.views.interactive.snapping.Settings.Defaults")],E);const ut=new E;let ae=class extends ce{constructor(t){super(t),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new we}};c([u({constructOnly:!0})],ae.prototype,"layer",void 0),c([u()],ae.prototype,"enabled",void 0),c([u()],ae.prototype,"updating",void 0),c([u()],ae.prototype,"availability",void 0),c([u()],ae.prototype,"sublayerSources",void 0),ae=c([L("esri.views.interactive.snapping.FeatureSnappingLayerSource")],ae);let A=class extends ce{constructor(t){super(t),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new we,this.distance=ut.distance,this.touchSensitivityMultiplier=ut.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){var p;const t=this.featureSources;t.some(Gi)&&Vi.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const e=t.filter(co),i=((p=this._get("_effectiveFeatureSources"))==null?void 0:p.filter(Gi))??new we;for(const l of e){const a=i.find(h=>h.layer===l.layer.parent);if(a)a.sublayerSources.includes(l)||a.sublayerSources.add(l);else if(l.layer.parent){const h=new ae({layer:l.layer.parent});h.sublayerSources.add(l),i.add(h)}}for(const l of i){const a=l.sublayerSources.filter(h=>!e.includes(h));l.sublayerSources.removeMany(a)}i.removeMany(i.filter(l=>l.sublayerSources.length===0));const n=t.filter(po),r=this._get("_effectiveFeatureSources")??new we,{added:o,removed:s}=Wn(r.toArray(),[...n,...i]);return r.removeMany(s),r.addMany(o),r}};function Gi(t){return t.layer.type==="subtype-group"}function po(t){return t.layer.type!=="subtype-group"}function co(t){return t.layer.type==="subtype-sublayer"}c([u()],A.prototype,"enabled",void 0),c([u()],A.prototype,"enabledToggled",void 0),c([u()],A.prototype,"forceDisabled",void 0),c([u()],A.prototype,"selfEnabled",void 0),c([u()],A.prototype,"featureEnabled",void 0),c([u()],A.prototype,"gridEnabled",void 0),c([u()],A.prototype,"attributeRulesEnabled",void 0),c([u({type:we.ofType(ae)})],A.prototype,"featureSources",void 0),c([u()],A.prototype,"distance",void 0),c([u()],A.prototype,"touchSensitivityMultiplier",void 0),c([u({readOnly:!0})],A.prototype,"effectiveEnabled",null),c([u({readOnly:!0})],A.prototype,"effectiveGridEnabled",null),c([u({readOnly:!0})],A.prototype,"effectiveSelfEnabled",null),c([u({readOnly:!0})],A.prototype,"effectiveFeatureEnabled",null),c([u({readOnly:!0})],A.prototype,"_effectiveFeatureSources",null),A=c([L("esri.views.interactive.snapping.SnappingOptions")],A);const Sa=Symbol("grid-placement-graphic");function on(t,e){const i=t.x-e.x,n=t.y-e.y;return i*i+n*n}function Ta(t,e){return Math.sqrt(on(t,e))}function ho(t,e){e.sort((i,n)=>Ut(i.targetPoint,t)-Ut(n.targetPoint,t))}function Ea({parameters:{point:t,distance:e,returnEdge:i,vertexMode:n,coordinateHelper:{spatialReference:r},filter:o},mode:s,returnZ:p,filter:l}){const a=(l==null?void 0:l.clone())??new Ir({where:"1=1"});return a.returnZ=p??s==="3d",o&&(a.geometry=o.geometry,a.distance=o.distance,a.spatialRelationship=o.spatialRelationship,a.where=rr(a.where,o.where),a.timeExtent=or(a.timeExtent,o.timeExtent),a.objectIds=uo(a.objectIds,o.objectIds)),{point:$e(t[0],t[1],t[2],r.toJSON()),mode:s,distance:e,returnEdge:i,vertexMode:n,query:a.toJSON()}}function uo(t,e){return t||e?e?t?Array.from(pr(new Set(t),new Set(e))):e:t:null}function Oa(t,e,i){return{left:Ei(t.leftVertex.pos,e,i),right:Ei(t.rightVertex.pos,e,i)}}const Mi=Symbol("snapping-toggle");function yo(t,e=()=>{}){const i=ye(()=>({view:t.view,snappingOptions:t.snappingOptions}),({view:n,snappingOptions:r})=>{if(t.removeHandles(Mi),!n||!r)return;const o=x.TOOL,s=[n.on("key-down",p=>{p.key!==wi.toggle||p.repeat||(r.enabledToggled=!0,e())},o),n.on("key-up",p=>{p.key===wi.toggle&&(r.enabledToggled=!1,e())},o),n.on("pointer-move",p=>{const l=p.native.ctrlKey;r.enabledToggled!==l&&(r.enabledToggled=l,e())},o)];t.addHandles(s,Mi)},Me);t.addHandles(i)}function Ga(t){var e;return Ar(t)&&"utilityNetworks"in t&&!!((e=t.utilityNetworks)!=null&&e.length)}function Ma(t){return(t==null?void 0:t.type)==="line"}function Mt(t,e){return t[0]*e[1]-t[1]*e[0]}function go(t,e,i){const n=ke(i,e)/Te(i);return lr(t,i,n)}function xa(t,e,i,n,r=i){return I(Se,n,i),I(dt,e,r),go(Ce,dt,Se),nr(t,r,Ce)}function Aa(t,e,i,n){I(Se,e,i);const r=n/qi(Se);return ee(t,i,Se,r)}function Ca(t,e){const i=t.start,n=t.end,r=e.start,o=e.end,s=I(Se,n,i),p=I(sn,o,r),l=Mt(s,p);if(Math.abs(l)<=mo)return[];const a=I(dt,i,r),h=Mt(p,a)/l;return Mt(s,a)/l,h>=0?[ee(Ce,i,s,h)]:[ee(Ce,i,s,h)]}function fo(t,e,i){const n=[],r=I(Se,t.end,t.start),o=I(sn,t.start,e),s=Te(r),p=2*ke(r,o),l=p*p-4*s*(Te(o)-i*i);if(l===0){const a=-p/(2*s);n.push(ee(Ce,t.start,r,a))}else if(l>0){const a=Math.sqrt(l),h=(-p+a)/(2*s);n.push(ee(Ce,t.start,r,h));const y=(-p-a)/(2*s);n.push(ee(dt,t.start,r,y))}return n}const mo=1e-6,Se=K(),sn=K(),dt=K(),Ce=K();function ei({start:t,end:e,type:i},n,r){const o=[],s=I(ze,e,t),p=I(bt,t,n),l=Te(s),a=2*ke(s,p),h=a*a-4*l*(Te(p)-r*r);if(h===0){const y=-a/(2*l);(i===0||y>=0)&&o.push(ee(K(),t,s,y))}else if(h>0){const y=Math.sqrt(h),f=(-a+y)/(2*l);(i===0||f>=0)&&o.push(ee(K(),t,s,f));const d=(-a-y)/(2*l);(i===0||d>=0)&&o.push(ee(K(),t,s,d))}return o}function an(t,e){const i=t.start,n=t.end,r=I(ze,n,i),o=te(St,-r[1],r[0],0),s=e.start,p=e.end,l=V(ii,p,s),a=U(l,o),h=te(gn,i[0],i[1],0),y=V(fn,h,s),f=U(y,o),d=je();if(Math.abs(a)<d)return[];const m=P(mn,s,l,f/a);if(e.type===0){const g=V(jt,m,s);if(U(g,l)<-d)return[]}if(t.type===1){const g=gr(bt,m,i);if(ke(g,r)<-d)return[]}return[pe(m)]}function vo(t,e){return bo(yt(ni,e[2],t),e)}function ln(t,e){return dn(yt(ni,0,t),yt(Eo,0,e)).map(([i,n])=>rt(i,n))}function pn(t,e,i){return hn(t,yt(ni,t[2],e),i)}function cn(t,e,i,n=_()){const r=I(ze,t,e),o=qi(r);return ee(n,e,r,o===0?1:i/o),n[2]=t[2],n}function hn(t,{start:e,end:i,type:n},r=_()){const o=V(wt,t,e),s=V(St,i,e),p=U(o,s)/U(s,s);return P(r,e,s,n===0?Math.max(p,0):p)}const _o=(()=>{const t=_(),e=_(),i=_();return({start:n,end:r},{center:o,radius:s,normal:p,slicePlane:l})=>{const a=_t(o,p,To);if(T(qt(a,n),0)&&T(qt(a,r),0)){Yi(p,t,e);const y=(m,g)=>(vt(i,g,o),Fi(m,U(i,t),U(i,e)),m),f=fo({start:y(ze,n),end:y(bt,r)},Ur,s),d=[];for(const[m,g]of f){const v=Zt(_(),o);P(v,v,t,m),P(v,v,e,g),l&&!ge(l,v)||d.push(v)}return d}const h=_();return Qi(a,n,r,h)?!T(Ne(h,o),s)||l&&!ge(l,h)?[]:[h]:[]}})();function un({start:t,end:e,type:i},n,r){const o=[],s=vt(wt,e,t),p=I(bt,t,n),l=Te(s),a=2*ke(s,p),h=a*a-4*l*(Te(p)-r*r);if(h===0){const y=-a/(2*l);(i===1||y>=0)&&o.push(P(_(),t,s,y))}else if(h>0){const y=Math.sqrt(h),f=(-a+y)/(2*l);(i===1||f>=0)&&o.push(P(_(),t,s,f));const d=(-a-y)/(2*l);(i===1||d>=0)&&o.push(P(_(),t,s,d))}return o}function dn(t,e){const i=t.start,n=t.end,r=e.start,o=e.end,s=V(wt,n,i),p=V(St,o,r),l=V(ii,r,i),a=ct(gn,s,p);if(!T(U(l,a),0))return[];const h=Vt(a);if(T(h,0))return[];const y=ct(fn,l,p),f=U(y,a)/h,d=P(mn,i,s,f);if(t.type===0){const m=V(jt,d,i);if(U(s,m)<-je())return[]}if(e.type===0){const m=V(jt,d,r);if(U(p,m)<-je())return[]}return[pe(d)]}function bo({start:t,end:e,type:i},n){const r=V(wt,n,t),o=V(St,e,t),s=ct(ii,o,r),p=Vt(s)/Vt(o),l=je();if(p<l)switch(i){case 1:return[pe(n)];case 0:return U(o,r)<-l?[]:[pe(n)]}return[]}function ti(t,e,i,n){const[r,o]=t,[s,p]=i,l=s-r,a=p-o,h=l*l+a*a,y=Math.sqrt(h);if(y>e+n)return[];if(y<Math.abs(e-n))return[];if(T(y,0)&&T(e,n))return[];const f=(e*e-n*n+h)/(2*y),d=Math.sqrt(e*e-f*f),m=d*a/y,g=d*l/y,[v,w]=fr(ze,t,i,f/y);return T(m,g)?[rt(v,w)]:[rt(v+m,w-g),rt(v-m,w+g)]}function yt(t,e,{start:i,end:n,type:r}){return te(t.start,i[0],i[1],e),te(t.end,n[0],n[1],e),t.type=So[r],t}function yn(t,e){return T(t[2],e[2])}function T(t,e){return cr(Math.abs(t-e),0,je())}function wo(t,e){return e.filter(i=>ge(t,i))}function ge(t,e){return Br(t,e)}const So={0:1,1:0},ze=K(),bt=K(),wt=_(),St=_(),ii=_(),gn=_(),fn=_(),mn=_(),jt=_(),To=$(),ni={start:_(),end:_(),type:1},Eo={start:_(),end:_(),type:1};class z{intersect(e){return ne(this,e)}closestPoints(e){return[this.closestTo(e)]}}class Pe extends z{constructor(e){super(),this.point=e}equals(e){return this===e||F(e)&&O(this.point,e.point)}closestTo(){return Ae(this.point)}}class ri extends z{constructor(e,i,n){super(),this.start=e,this.end=i,this.lineLike={start:e,end:i,type:n}}equals(e){return this===e||Q(e)&&this.lineLike.type===e.lineLike.type&&O(this.start,e.start)&&O(this.end,e.end)}closestTo(e){const i=N();return hn(e,this.lineLike,i),i}}class oi extends ri{constructor(e,i){super(e,i,1)}}class Oo extends ri{constructor(e,i){super(e,i,0)}}class vn extends z{constructor(e){super(),this.constraints=e}equals(e){return this===e||$t(e)&&mr(this.constraints,e.constraints,(i,n)=>i.equals(n))}closestTo(e){let i,n=1/0;for(const r of this.constraints){const o=r.closestTo(e),s=Ut(e,o);s<n&&(n=s,i=o)}return Ae(i??e)}closestPoints(e){return this.constraints.flatMap(i=>i===this?[]:i.closestPoints(e))}}class _n extends z{constructor(e,i){super(),this.center=e,this.radius=i}equals(e){return this===e||X(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const i=N();return cn(e,this.center,this.radius,i),i}}class si extends z{constructor(e,i){super(),this.center=e,this.radius=i}equals(e){return this===e||oe(e)&&O(this.center,e.center)&&this.radius===e.radius}closestTo(e){const i=N();return cn(e,this.center,this.radius,i),i[2]=this.center[2],i}asCircle(){return new ai(Ae(this.center),this.radius,fe(0,0,1))}}class ai extends z{constructor(e,i,n,r=void 0){super(),this.center=e,this.radius=i,this.normal=n,this.slicePlane=r}equals(e){return this===e||de(e)&&O(this.center,e.center)&&O(this.normal,e.normal)&&this.radius===e.radius}closestTo(e){var a;const{center:i,radius:n}=this;Xi(this.getPlane(Go),e,xt);const r=V(xt,xt,i),o=Bi(r);if(T(o,0))return Ae(e);const s=n/Math.sqrt(o),p=N();P(p,i,r,s);const{slicePlane:l}=this;return l&&!ge(l,p)?((a=pi(l,this))==null?void 0:a.closestTo(e))??Ae(e):p}getPlane(e=$()){return _t(this.center,this.normal,e)}}const xt=_(),Go=$();class Mo extends z{constructor(e){super(),this.z=e}equals(e){return this===e||re(e)&&this.z===e.z}closestTo(e){return fe(e[0],e[1],this.z)}getPlane(e=$()){return te(xi,0,0,this.z),_t(xi,vr,e)}}const xi=_();class li extends z{constructor(e,i,n){super(),this.start=e,this.end=i,this.planeLike={start:e,end:i,type:n}}equals(e){return this===e||Y(e)&&this.planeLike.type===e.planeLike.type&&O(this.start,e.start)&&O(this.end,e.end)}closestTo(e){const i=N();return pn(e,this.planeLike,i),i}closestEndTo(e){const{start:i,end:n}=this.planeLike;return Math.sign(ke(I(xo,n,i),I(Ao,e,i)))>0?this.end:this.start}getPlane(e=$()){const i=Zt(Ai,this.end);return i[2]+=1,Ji(this.start,this.end,i,e)}getSlicePlane(e=$()){const{start:i,end:n,type:r}=this.planeLike;if(r===0)return;const o=te(Ai,i[0],i[1],0),s=te(Ci,n[0],n[1],0),p=vt(Ci,s,o);return _t(o,p,e),e}}const xo=K(),Ao=K(),Ai=_(),Ci=_();class ka extends li{constructor(e,i){super(e,i,1)}}class bn extends li{constructor(e,i){super(e,i,0)}}class Co extends z{constructor(e,i){super(),this.sphere=Jr(e,i),this._center=pe(e)}equals(e){return this===e||se(e)&&Qr(this.sphere,e.sphere)}closestTo(e){const i=N();return Yr(this.sphere,e,i),i}get center(){return this._center}get radius(){return this.sphere[3]}}class wn extends z{constructor(e,i,n){super(),this.start=e,this.end=i,this.getZ=n,this.planeLike={start:e,end:i,type:0}}equals(e){return this===e||gt(e)&&O(this.start,e.start)&&O(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return Ho(this,e)}addIfOnTheGround(e,i){for(const n of i){const r=this.getZ(n[0],n[1])??0;T(n[2],r)&&(n[2]=r,e.push(n))}}}class ko extends z{constructor(e,i,n){super(),this._x=e,this._y=i,this._z=n}equals(e){return this===e||Yo(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,i,n]){return rn(this._x??e,this._y??i,this._z??n)}}class Po extends z{constructor(e,i,n,r,o){super(),this._origin=e,this._spatialReference=i,this._distanceMeters=n,this._z=r,this._directionDegrees=o}equals(e){return this===e||Qo(e)&&_i(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._z===e._z&&this._directionDegrees===e._directionDegrees}closestTo([e,i,n]){return Fi(Le,e,i),_i(Le,this._origin)||this._applyDirectionAndDistance(Le),rn(Le[0],Le[1],this._z??n)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)Nt(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)Do(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:i}=Wt(Ro,this._origin,e,this._spatialReference);Nt(e,this._origin,i??0,this._distanceMeters,this._spatialReference)}}}const Le=[0,0],Ro=new Bt;function Do(t,e,i,n,r){let{azimuth:o,distance:s}=Wt(Lo,e,n,r);o??(o=0);let p=s*Math.cos((o-i)*jr);p=Math.max(0,p),Nt(t,e,i,p,r)}const Lo=new Bt;function Ho(t,e){const i=N();return pn(e,t.planeLike,i),i[2]=t.getZ(i[0],i[1])??Tn,i}function ne(t,e){if($t(t)){const i=[];for(const n of t.constraints){const r=n.intersect(e);r&&i.push(r)}return ci(i)}if($t(e))return ne(e,t);if(gt(t))return ki(t,e);if(gt(e))return ki(e,t);if(F(t)){const{point:i}=t;if(F(e))return O(i,e.point)?t:void 0;const n=e.closestTo(i);return Lr(n,i)?t:void 0}if(Q(t)){if(F(e))return ne(e,t);if(Q(e))return B(dn(t.lineLike,e.lineLike));if(re(e))return Io(t,e);if(Y(e))return B(an(e.planeLike,t.lineLike));if(X(e))return B(un(t.lineLike,e.center,e.radius));if(de(e))return B(_o(t.lineLike,e));if(oe(e))return Uo(t,e);if(se(e))return Vo(t,e)}else if(re(t)){if(F(e)||Q(e))return ne(e,t);if(re(e))return No(t,e);if(Y(e))return qo(t,e);if(X(e))return jo(t,e);if(de(e))return zo(t,e);if(oe(e))return $o(t,e);if(se(e))return Fo(t,e)}else if(Y(t)){if(F(e)||Q(e)||re(e))return ne(e,t);if(Y(e))return At(ln(t.planeLike,e.planeLike));if(X(e))return At(ei(t.planeLike,e.center,e.radius));if(de(e))return Wo(t,e);if(oe(e))return Zo(t,e);if(se(e))return Bo(t,e)}else if(X(t)){if(F(e)||Q(e)||re(e)||Y(e))return ne(e,t);if(X(e))return At(ti(t.center,t.radius,e.center,e.radius));if(de(e))return;if(oe(e))return Ko(t,e);if(se(e))return}else if(de(t)){if(F(e)||Q(e)||re(e)||Y(e)||X(e))return ne(e,t);if(de(e))return;if(oe(e))return e.asCircle(),void 0;if(se(e))return}else if(oe(t)){if(F(e)||Q(e)||re(e)||Y(e)||X(e)||de(e))return ne(e,t);if(oe(e))return Jo(e,t);if(se(e))return}else if(se(t)){if(F(e)||Q(e)||re(e)||Y(e)||X(e)||oe(e))return ne(e,t);if(se(e))return}}const Io=(()=>{const t=$();return(e,i)=>{const{start:n,end:r}=e;if(yn(n,r)&&T(n[2],i.z))return e;const o=N();return Qi(i.getPlane(t),n,r,o)?new Pe(o):void 0}})();function Uo({lineLike:t},{center:e,radius:i}){const n=e[2];return B(un(t,e,i).filter(r=>T(r[2],n)))}function Vo({lineLike:t},{sphere:e}){return B(Kr(e,t.start,t.end))}const pi=(()=>{const t=qr(),e=_(),i=_();return(n,r,o)=>{const{normal:s,center:p,radius:l}=r;Yi(s,e,i);const a=Kt(n),h=l*U(a,e),y=l*U(a,i);Vr(t,p[0],p[1],p[2],1);const f=Nr(n,t),d=Math.hypot(h,y),m=T(d,0);if(T(qt(n,p),0)){if(m)return r;if(T(l,0))return!o||ge(o,p)?new Pe(Ae(p)):void 0;ct(e,a,s),Hr(e,e);const Ee=new Array,Fe=pe(p);P(Fe,Fe,e,l),o&&!ge(o,Fe)||Ee.push(Fe);const Ze=pe(p);return P(Ze,Ze,e,-l),o&&!ge(o,Ze)||Ee.push(Ze),B(Ee)}if(m)return;const g=-f/d;if(Math.abs(g)>1||T(g,1))return;const v=Math.atan(h/y),w=_r(g)-v,C=Math.PI-w,ve=new Array,_e=_();P(_e,p,e,l*Math.cos(w)),P(_e,_e,i,l*Math.sin(w)),ve.push(_e);const S=_();return P(S,p,e,l*Math.cos(C)),P(S,S,i,l*Math.sin(C)),ve.push(S),B(o?wo(o,ve):ve)}})();function No(t,e){return T(t.z,e.z)?t:void 0}function qo({z:t},{planeLike:e}){const[i,n]=e.start,[r,o]=e.end,s=fe(i,n,t),p=fe(r,o,t);return e.type===0?new oi(s,p):new Oo(s,p)}function jo(t,e){const[i,n]=e.center;return new si(fe(i,n,t.z),e.radius)}function $o(t,e){return T(e.center[2],t.z)?e:void 0}const zo=(()=>{const t=$();return(e,i)=>pi(e.getPlane(t),i,i.slicePlane)})();function Fo(t,{center:e,radius:i}){const n=Math.abs(e[2]-t.z);if(n>i&&!T(n,i))return;const r=fe(e[0],e[1],t.z),o=Math.sqrt(i**2-n**2);return T(o,0)?void 0:new si(r,o)}const Zo=(()=>{const t=$();return(e,{center:i,radius:n})=>{const r=ei(e.planeLike,i,n),o=i[2];e.getSlicePlane(t);const s=new Array;for(const[p,l]of r){const a=[p,l,o];ge(t,a)&&s.push(a)}return B(s)}})(),Wo=(()=>{const t=$(),e=$();return(i,n)=>pi(i.getPlane(t),n,i.getSlicePlane(e))})(),Bo=(()=>{const t=$();return(e,{center:i,radius:n})=>{const r=e.getPlane(t),o=Wr(r,i),s=Math.abs(o);if(s>n&&!T(s,n))return;const p=Math.sqrt(n**2-o**2);if(T(p,0)){const h=N();return Xi(r,i,h),new Pe(h)}const l=N(),a=pe(Kt(r));return P(l,i,a,o),new ai(l,p,a,e.getSlicePlane())}})();function Ko(t,e){const i=zi(t.center,e.center);return T(i,0)&&T(t.radius,e.radius)?e:Sn(ti(t.center,t.radius,e.center,e.radius),e.center[2])}function Jo(t,e){if(!yn(t.center,e.center))return;const i=zi(t.center,e.center);return T(i,0)&&T(t.radius,e.radius)?t:Sn(ti(t.center,t.radius,e.center,e.radius),t.center[2])}function ki(t,e){const{planeLike:i,getZ:n}=t,r=new Array;if(F(e))t.addIfOnTheGround(r,vo(i,e.point));else if(Q(e))t.addIfOnTheGround(r,an(i,e.lineLike));else if(X(e))for(const[o,s]of ei(i,e.center,e.radius)){const p=n(o,s);p!=null&&r.push(pt(o,s,p))}else if(Y(e)||gt(e))for(const[o,s]of ln(i,e.planeLike)){const p=n(o,s)??Tn;r.push(pt(o,s,p))}return B(r)}function At(t){return ci(t.map(([e,i])=>{const n=fe(e,i,0),r=fe(e,i,1);return new oi(n,r)}))}function B(t){return ci(t.map(e=>e?new Pe(e):void 0))}function Sn(t,e){return B(t.map(([i,n])=>[i,n,e]))}function ci(t){if(t.length!==0)return t.length===1?t[0]??void 0:new vn(t.filter(Ui))}function $t(t){return t instanceof vn}function F(t){return t instanceof Pe}function Q(t){return t instanceof ri}function re(t){return t instanceof Mo}function Y(t){return t instanceof li}function X(t){return t instanceof _n}function oe(t){return t instanceof si}function de(t){return t instanceof ai}function se(t){return t instanceof Co}function gt(t){return t instanceof wn}function Qo(t){return t instanceof Po}function Yo(t){return t instanceof ko}const Tn=0;let Re=class{constructor(t,e,i,n){this.targetPoint=t,this.constraint=e,this.isDraped=i,this.domain=n}},En=class extends Re{constructor({targetPoint:t,objectId:e,constraint:i,isDraped:n}){super(t,i,n,1),this.objectId=e}},Tt=class{constructor(t,e){this.isDraped=t,this.domain=e}},ie=class On extends Tt{constructor(e,i,n,r,o=3,s=!0,p=!0){super(r,o),this.type=e,this.lineStart=i,this.lineEnd=n,this.fadeLeft=s,this.fadeRight=p}equals(e){return e instanceof On&&this.type===e.type&&O(this.lineStart,e.lineStart)&&O(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}get length(){return Ne(this.lineStart,this.lineEnd)}},Xo=class extends En{constructor(t){super({...t,isDraped:!0,constraint:new wn(t.edgeStart,t.edgeEnd,t.getGroundElevation)})}get hints(){return[new ie(1,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},es=class extends En{constructor(t){super({...t,constraint:new oi(t.edgeStart,t.edgeEnd)})}get hints(){return[new ie(1,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},ts=class Gn extends Tt{constructor(e,i,n=3){super(i,n),this.intersectionPoint=e}equals(e){return e instanceof Gn&&O(this.intersectionPoint,e.intersectionPoint)}},st=class extends Re{constructor(t,e,i,n){super(t,new Pe(t),n,3),this.first=e,this.second=i}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new ts(this.targetPoint,this.isDraped,this.domain)]}},is=class extends Re{constructor({lineStart:t,lineEnd:e,targetPoint:i,isDraped:n}){super(i,new bn(t,e),n,2),this._referenceLineHint=new ie(2,t,e,n,this.domain)}get hints(){return[this._referenceLineHint,new ie(0,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}},ns=class Mn extends Tt{constructor(e,i,n,r=3){super(n,r),this.lineStart=e,this.lineEnd=i}equals(e){return e instanceof Mn&&O(this.lineStart,e.lineStart)&&O(this.lineEnd,e.lineEnd)}},rs=class extends Re{constructor({referenceLine:t,lineStart:e,targetPoint:i,isDraped:n}){const r=pe(e),{left:o,right:s}=t;vt(r,Rr(r,r,s),o),super(i,new bn(e,r),n,2),this._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new ie(0,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new ns(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(t=>new ie(1,t.edge.left,t.edge.right,this.isDraped,this.domain,t.fadeLeft,t.fadeRight))]}addReferenceLine(t){const e={edge:t,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(i=>{O(t.right,i.edge.left)&&(i.fadeLeft=!1,e.fadeRight=!1),O(t.right,i.edge.right)&&(i.fadeRight=!1,e.fadeRight=!1),O(t.left,i.edge.right)&&(i.fadeRight=!1,e.fadeLeft=!1),O(t.left,i.edge.left)&&(i.fadeLeft=!1,e.fadeLeft=!1)}),this._referenceLines.push(e)}},xn=class An extends Tt{constructor(e,i,n,r,o=3){super(r,o),this.previousVertex=e,this.centerVertex=i,this.nextVertex=n}equals(e){return e instanceof An&&O(this.previousVertex,e.previousVertex)&&O(this.centerVertex,e.centerVertex)&&O(this.nextVertex,e.nextVertex)}},os=class extends Re{constructor({targetPoint:t,constraint:e,previousVertex:i,otherVertex:n,otherVertexType:r,isDraped:o,selfSnappingType:s,objectId:p,domain:l}){super(t,e,o,l??2),this.previousVertex=i,this.otherVertex=n,this.otherVertexType=r,this.selfSnappingType=s??0,this.objectId=p??null}get hints(){const t=this.previousVertex,e=this.otherVertexType===1?this.otherVertex:this.targetPoint,i=this.otherVertexType===1?this.targetPoint:this.otherVertex;return[new ie(0,e,i,this.isDraped,this.domain),new ie(1,t,e,this.isDraped,this.domain),new xn(this.previousVertex,e,i,this.isDraped,this.domain)]}},ss=class extends Re{constructor({targetPoint:t,point1:e,point2:i,isDraped:n}){super(t,new _n(Dr(_(),e,i,.5),.5*Xn(e,i)),n,2),this._p1=e,this._p2=i}get hints(){return[new ie(1,this.targetPoint,this._p1,this.isDraped,this.domain),new ie(1,this.targetPoint,this._p2,this.isDraped,this.domain),new xn(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}};function as(t,e,i,n,r=_()){const o=Zt(ls,t);return o[2]=Zi(n,o,e,i)||0,n.renderCoordsHelper.toRenderCoords(o,e,r),r}const ls=_();function ps(t,e,i,n){return n.type==="2d"?(Be.x=t[0],Be.y=t[1],Be.spatialReference=e,n.toScreen(Be)):(as(t,e,i,n,Pi),n.state.camera.projectToScreen(Pi,Ct),Qn(Ct[0],Ct[1]))}const Be=$e(0,0,0,null),Pi=_(),Ct=Yn();function Pa(t){return Ki(t)||$i(t)}function hi(t,e,i,...n){return Ki(t)?e.apply(void 0,n):t.isWebMercator?i.apply(void 0,n):null}function cs(t){const{spatialReference:e}=t;return hi(e,gs,fs,t)}function hs(t,e){if(!mt(t.spatialReference,e.spatialReference))return null;const{spatialReference:i}=t;return Ke[0]=t.x,Ke[1]=t.y,Ke[2]=t.hasZ?t.z:0,Je[0]=e.x,Je[1]=e.y,Je[2]=e.hasZ?e.z:0,Cn(Ke,Je,i)}function Cn(t,e,i){return hi(i,ds,ys,t,e,i)}const us={geodesicLength:cs,geodesicDistanceBetweenPoints:hs,geodesicDistance:Cn};async function kn(){return await Xr(),us}function ds(t,e,i){return me(Wt(vs,t,e,i).distance,"meters")}function ys(t,e,i){return me(en(ms(t,e,i),{unit:"meters"}),"meters")}function gs(t){return me($r([t],"meters")[0],"meters")}function fs(t){return me(en(t,{unit:"meters"}),"meters")}function ms(t,e,i){return new br({spatialReference:i,paths:[[[...t],[...e]]]})}const vs=new Bt,Ke=_(),Je=_();let Z=class extends zt{constructor(t){super(t),this.options=new A,this._engineCache=new Map,this._loadTask=null,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=0}initialize(){this.addHandles([ye(()=>{const{distance:t,touchSensitivityMultiplier:e,effectiveSelfEnabled:i,effectiveFeatureEnabled:n,effectiveGridEnabled:r}=this.options;return{selfEnabled:i,featureEnabled:n,gridEnabled:this.view.type==="2d"&&r,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:t,touchSensitivityMultiplier:e}},(t,e)=>{var i;e&&(this.doneSnapping(),this.emit("changed")),(i=this._loadTask)==null||i.abort(),this._loadTask=Cr(n=>this._updateEngines(t,e,n))},Me),ye(()=>this.options,t=>{for(const e of this._engines)e.options=t},Bn)])}destroy(){var t;(t=this._loadTask)==null||t.abort(),this._destroyEngines()}get updating(){var t;return this._engines.some(e=>e.updating)||!((t=this._loadTask)!=null&&t.finished)}_destroyEngines(){this._engineCache.forEach(t=>t.destroy()),this._engineCache.clear(),this._engines=[]}async _updateEngines(t,e,i){var o;if(!t.viewReady)return void this._destroyEngines();(e==null?void 0:e.viewSpatialReference)!==t.viewSpatialReference&&this._destroyEngines();const n=this._engineCache,r=await Promise.allSettled([t.featureEnabled&&!n.has("feature")?this._createFeatureSnappingEngine(i):void 0,t.selfEnabled&&!n.has("self")?this._createSelfSnappingEngine(i):void 0,t.gridEnabled&&!n.has("grid")?this._createGridSnappingEngine(i):void 0]);if(i.aborted)for(const s of r)s.status==="fulfilled"&&((o=s.value)==null||o.engine.destroy());else{for(const s of r)s.status==="fulfilled"&&s.value&&n.set(s.value.type,s.value.engine);this._engines=Array.from(n.values())}}async _createSelfSnappingEngine(t){const[{SelfSnappingEngine:e},i]=await Promise.all([D(()=>import("./SelfSnappingEngine-Bl56UoIA-DDaH1Nrp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]),import.meta.url),kn()]);return Ot(t),{type:"self",engine:new e({view:this.view,options:this.options,geodesicLengthMeasurementUtils:i})}}async _createGridSnappingEngine(t){const{view:e}=this;if(e.type!=="2d")return;const{GridSnappingEngine:i}=await D(()=>import("./GridSnappingEngine-Dq-tYQYn-CmIdnZRX.js"),__vite__mapDeps([48,1,2,10,12,13,14,49,3,50,51,52,53,54,16,17,18,19,20,21,22,23,24,25,26,6,7,27,28,29,30,31,32,5,11,15,33,34,35,9,36,37,38,39,40,41,4,42,43,44,45,46,47]),import.meta.url);return Ot(t),{type:"grid",engine:new i({view:e,options:this.options})}}async _createFeatureSnappingEngine(t){const{FeatureSnappingEngine:e}=await D(()=>import("./FeatureSnappingEngine-B7r4319G-BgwA9gE4.js"),__vite__mapDeps([55,1,2,56,32,10,17,5,6,7,57,33,34,35,58,59,12,13,14,18,19,20,21,22,23,24,25,26,27,28,29,30,31,11,15,9,36,37,16,38,39,40,41,4,42,43,44,45,46,47]),import.meta.url);Ot(t);const{view:i,options:n}=this,{spatialReference:r}=i;return{type:"feature",engine:new e({view:i,options:n,spatialReference:r})}}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:t,touchSensitivityMultiplier:e}=this.options,i=t*e;return i*i}snap(t){return ws(t)?this._snapMultiPoint(t):this._snapSinglePoint(t)}update(t){const{point:e,context:i}=t;this._removeVisualization();const n=this._currentMainCandidate;if(n==null)return e;const r=this._selectUpdateInput(t);if(r==null)return e;const{spatialReference:o}=i,s=It(r,o);if(s==null)return e;const{view:p}=this,{elevationInfo:l,visualizer:a}=i,h=[],y=Ve(s,p,l),f=n.constraint.closestTo(y);if(!this._arePointsWithinScreenThreshold(y,f,i)||!Pt(n,i.drawConstraints))return this._resetSnappingState(),e;n.targetPoint=Gt(f),h.push(...n.hints);for(const d of this._currentOtherActiveCandidates)Pt(d,i.drawConstraints)&&(d.targetPoint=Gt(f),h.push(...d.hints));return a!=null&&this.addHandles(a.draw(h,{spatialReference:o,elevationInfo:Ss(i),view:p,selfSnappingZ:i.selfSnappingZ}),kt),Oi(f,p,e,i)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:t,scenePoint:e}){switch(this._currentSnappedType){case 0:return t;case 1:return e}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=0}_removeVisualization(){this.removeHandles(kt)}async _snapSinglePoint({point:t,context:e,signal:i}){const{view:n}=this,{elevationInfo:r}=e,o=Ve(t,n,r),s=await this._fetchCandidates(o,3,e,i);return this._createSnapResult(o,0,s,n,t,e,i)}async _snapMultiPoint({point:t,scenePoint:e,context:i,signal:n}){const{view:r}=this,{coordinateHelper:o,elevationInfo:s,spatialReference:p}=i;await Or(e.spatialReference,p);const l=It(e,p),a=Ve(l,r,s),h=await this._fetchCandidates(a,1,i,n);if(h.length>0){const d=await this._fetchCandidates(a,2,i,n);return this._createSnapResult(a,1,[...h,...d],r,l,i,n)}const y=Ve(t,r,s),f=await this._fetchCandidates(y,2,i,n);return this._createSnapResult(y,0,f,r,{z:o.hasZ()&&t.hasZ?t.z??0:void 0,m:o.hasM()&&t.hasM?t.m??0:void 0},i,n)}async _fetchCandidates(t,e,i,n){return(await Promise.all(this._engines.map(r=>r.fetchCandidates(t,e,i,n)))).flat()}_createSnapResult(t,e,i,n,r,o,s){return{get valid(){return!Kn(s)},apply:()=>{const{spatialReference:p}=o,{snappedPoint:l,hints:a}=this._processCandidates(t,e,i,o);return this._removeVisualization(),o.visualizer!=null&&this.addHandles(o.visualizer.draw(a,{spatialReference:p,elevationInfo:xe,view:n,selfSnappingZ:o.selfSnappingZ}),kt),Oi(l,n,r,o)}}}_processCandidates(t,e,i,n){if(i.length<1)return this.doneSnapping(),{snappedPoint:t,hints:[]};this._currentSnappedType!==e&&this._resetSnappingState(),ho(t,i);const r=this._currentMainCandidate;if(r!=null){const o=bs(r,i);if(o>=0){if(!(i[o]instanceof st))return this._intersectWithOtherCandidates(o,i,t,e,n);if(this._arePointsWithinScreenThreshold(t,r.targetPoint,n))return this._updateSnappingCandidate(r,e,i,n)}}return this._intersectWithOtherCandidates(0,i,t,e,n)}_intersectWithOtherCandidates(t,e,i,n,r){const{coordinateHelper:o}=r,s=e[t],p=[];for(let l=0;l<e.length;++l){if(l===t)continue;const a=e[l],h=s.constraint.intersect(a.constraint);if(h)for(const y of h.closestPoints(s.targetPoint))p.push([new st(Gt(y),s,a,a.isDraped),this._squaredScreenDistance(i,y,o)])}return p.length>0&&(p.sort((l,a)=>l[1]-a[1]),p[0][1]<this._squaredPointProximityThreshold(r.pointer))?this._updateSnappingCandidate(p[0][0],n,e,r):Pt(s,r.drawConstraints)?this._updateSnappingCandidate(s,n,e,r):{snappedPoint:i,hints:[]}}_updateSnappingCandidate(t,e,i,n){this.doneSnapping(),this._currentMainCandidate=t,this._currentSnappedType=e;const r=this._currentMainCandidate.targetPoint,o=[];o.push(...t.hints);for(const s of i){if(t instanceof st){if(s.constraint.equals(t.first.constraint)||s.constraint.equals(t.second.constraint))continue}else if(s.constraint.equals(t.constraint))continue;const p=s.constraint.closestTo(r);this._squaredScreenDistance(p,r,n.coordinateHelper)<_s()&&(s.targetPoint=r,this._currentOtherActiveCandidates.push(s),o.push(...s.hints))}return{snappedPoint:r,hints:o}}_squaredPointProximityThreshold(t){return t==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(t,e,i){return this._squaredScreenDistance(t,e,i.coordinateHelper)<this._squaredPointProximityThreshold(i.pointer)}_squaredScreenDistance(t,e,i){return on(this._toScreen(t,i),this._toScreen(e,i))}_toScreen(t,e){return ps(t,e.spatialReference,xe,this.view)}get test(){}};c([u({constructOnly:!0})],Z.prototype,"view",void 0),c([u()],Z.prototype,"options",void 0),c([u({readOnly:!0})],Z.prototype,"updating",null),c([u()],Z.prototype,"_loadTask",void 0),c([u()],Z.prototype,"_engines",void 0),c([u()],Z.prototype,"_squaredMouseProximityThreshold",null),c([u()],Z.prototype,"_squaredTouchProximityThreshold",null),Z=c([L("esri.views.interactive.snapping.SnappingManager")],Z);const kt="visualization-handle";function _s(){return ut.satisfiesConstraintScreenThreshold*ut.satisfiesConstraintScreenThreshold}function Pt(t,e){return!e||e.direction==null&&e.distance==null||!(t instanceof Xo||t instanceof es||t instanceof is||t instanceof rs||t instanceof ss)&&(!(t instanceof os)||e.direction==null&&t.selfSnappingType===1)}function bs(t,e){return t instanceof st?Rt(e,t.first)>=0&&Rt(e,t.second)>=0?0:-1:Rt(e,t)}function Rt(t,e){let i=-1;for(let n=0;n<t.length;++n)if(e.constraint.equals(t[n].constraint)){i=n;break}return i}function ws(t){return t.scenePoint!=null}function Ss({coordinateHelper:t,elevationInfo:e}){return t.hasZ()?xe:e}function ui(t){return hr(t)?ur(t)||$i(t)||dr(t)||yr(t)?io:t:no(t)}function Ts(t,e=ft()){return Pn(t,e)}function Es(t,e=ft()){return Pn(t,e,!1)}function Pn(t,e,i=t.hasZ){const n=ui(t.spatialReference),r=sr(n);if(r==null)return null;const o=(p,l)=>!(l.length<2)&&(te(p,l[0],l[1],i&&l[2]||0),!0);let s=0;for(const p of t.rings){const l=p.length;if(l<3)continue;const{positionsWorldCoords:a}=e;for(;a.length<l;)a.push(_());const h=Os,y=te(Gs,0,0,0),f=1/l;for(let g=0;g<l;g++){if(!o(h,p[g])||!nt(h,t.spatialReference,a[g],n))return null;P(y,y,a[g],f)}const d=Ji(a[0],a[1],y,Fr());if(Bi(Kt(d))===0)continue;for(let g=0;g<l;g++)Zr(d,y,a[g],a[g]);const m=Ms(a);for(let g=0;g<m.length;g+=3)s+=to(a[m[g]],a[m[g+1]],a[m[g+2]])}return Jt(s,r)}const Os=_(),Gs=_();function ft(){return{positionsWorldCoords:[]}}function Ms(t){return eo(xs(t),[],2)}function xs(t){const e=new Float64Array(2*t.length);for(let i=0;i<t.length;++i){const n=t[i],r=2*i;e[r]=n[0],e[r+1]=n[1]}return e}const As=t=>({geodesicArea(e){const{spatialReference:i}=e;return hi(i,ks,n=>Ps(t,n),e)}});async function Cs(){const t=await D(()=>import("./geometryEngine-63haXLQ5-mLTbn98B.js"),__vite__mapDeps([60,1,2,61,62]),import.meta.url);return As(t)}function ks(t){return Jt(Math.abs(zr([t],"square-meters")[0]),"square-meters")}function Ps(t,e){try{return Jt(Math.abs(t.geodesicArea(e,"square-meters")),"square-meters")}catch{return null}}const Rs=t=>({autoAreaByElevationMode(e,i,n=ft()){return i==="on-the-ground"?t.geodesicArea(e)??Es(e,n):Ts(e,n)},autoArea2D(e,i=ft()){return this.autoAreaByElevationMode(e,"on-the-ground",i)}});let Dt=null;async function Qe(){return Dt||(Dt=Rs(await Cs())),Dt}function Ds(t){return Ls(t)}function Ls(t,e){const{hasZ:i,spatialReference:n}=t,r=ui(n);let o=0;const s=ji(r);if(s==null)return null;const p=di;for(const l of t.paths){if(l.length<2)continue;const a=l.length-1;for(let h=0;h<a;++h){const y=l[h];q[0]=y[0],q[1]=y[1],q[2]=i?y[2]:0;const f=l[h+1];j[0]=f[0],j[1]=f[1],j[2]=i?f[2]:0;const d=p(q,j,n);if(d==null)return null;o+=d.value}}return me(o,s)}function Hs(t,e){const{spatialReference:i}=t;return mt(i,e.spatialReference)?(q[0]=t.x,q[1]=t.y,q[2]=t.hasZ?t.z:0,j[0]=e.x,j[1]=e.y,j[2]=e.hasZ?e.z:0,di(q,j,i)):null}function Ra(t,e){const{spatialReference:i}=t;return mt(i,e.spatialReference)?(q[0]=t.x,q[1]=t.y,q[2]=t.hasZ?t.z:0,j[0]=e.x,j[1]=e.y,j[2]=e.hasZ?e.z:0,Us(q,j,i)):null}function Da(t){return t!=null?Is(t.hasZ?t.z:0,t.spatialReference):null}function Is(t,e){const i=ar(e);return i!=null?me(t??0,i):null}function di(t,e,i){const n=Rn(t,e,i,1);return n!=null?me(n.horizontal,n.unit):null}function Us(t,e,i){const n=Rn(t,e,i,2);return n!=null?me(n.verticalSigned,n.unit):null}function Rn(t,e,i,n){const r=ui(i),o=ji(r);if(o==null)return null;const s=e[2]-t[2];if(n===2)return{verticalSigned:s,unit:o};if(!nt(t,i,Lt,r)||!nt(e,i,Ye,r))return null;if(n===0)return{direct:Ne(Ye,Lt),unit:o};if(te(Xe,t[0],t[1],e[2]),!nt(Xe,i,Xe,r))return null;const p=Ne(Xe,Ye);return n===1?{horizontal:p,unit:o}:{direct:Ne(Ye,Lt),horizontal:p,vertical:Math.abs(s),unit:o}}const q=_(),j=_(),Lt=_(),Ye=_(),Xe=_();function Vs(t){return{autoLength2D:e=>t.geodesicLength(e)??Ds(e),autoDistanceBetweenPoints2D:(e,i)=>t.geodesicDistanceBetweenPoints(e,i)??Hs(e,i),autoDistance2D:(e,i,n)=>(He[0]=e[0],He[1]=e[1],He[2]=e.length===3?e[2]:0,Ie[0]=i[0],Ie[1]=i[1],Ie[2]=i.length===3?i[2]:0,t.geodesicDistance(He,Ie,n)??di(He,Ie,n))}}async function be(){return Vs(await kn())}const He=_(),Ie=_();function Ns(t){return(t==null?void 0:t.type)==="graphic"}function qs(t){return t.find(Ns)??null}class Dn{constructor(e){this.layer=e}get elevationInfo(){return this.layer.elevationInfo}add(e){this.layer.add(e)}addMany(e){this.layer.addMany(e)}onGraphicsChange(e){const{layer:i}=this;return Ft(()=>i.graphics,"change",n=>e(n))}has(e){return e.layer===this.layer}remove(e){this.layer.remove(e)}removeMany(e){this.layer.removeMany(e)}removeAll(){this.layer.removeAll()}}c([u()],Dn.prototype,"elevationInfo",null);class Ln{constructor(e){this.layer=e}get elevationInfo(){}add(e,i){var n;(n=this._getSublayerForCreateTool(i)??this._getSublayerForGraphic(e))==null||n.add(e)}addMany(e,i){if(i){const n=this._getSublayerForCreateTool(i);if(n)return void n.addMany(e)}e.forEach(n=>{var r;return(r=this._getSublayerForGraphic(n))==null?void 0:r.add(n)})}onGraphicsChange(e){var n,r;const{layer:i}=this;if((n=i.sublayers)!=null&&n.length)return Jn((r=i.sublayers)==null?void 0:r.toArray().map(o=>Ft(()=>o.graphics,"change",s=>e(s))))}has(e){var n;const{layer:i}=this;return e.layer===i||e.sourceLayer===i||!!((n=i.sublayers)!=null&&n.some(r=>e.layer===r||e.sourceLayer===r))}remove(e){var i;(i=this._getSublayerForGraphic(e))==null||i.remove(e)}removeMany(e){e.forEach(i=>{var n;return(n=this._getSublayerForGraphic(i))==null?void 0:n.remove(i)})}removeAll(){var e;(e=this.layer.sublayers)==null||e.forEach(i=>i.removeAll())}_getSublayerForCreateTool(e){const{layer:i}=this;switch(e){case"point":return i.pointLayer;case"polyline":return i.polylineLayer;case"polygon":return i.polygonLayer;case"multipoint":return i.multipointLayer;case"text":return i.textLayer}}_getSublayerForGraphic(e){var n;const{layer:i}=this;if(e!=null&&e.geometry)switch(e.geometry.type){case"point":return((n=e.symbol)==null?void 0:n.type)==="text"?i.textLayer:i.pointLayer;case"polyline":return i.polylineLayer;case"polygon":return i.polygonLayer;case"multipoint":return i.multipointLayer}}}c([u()],Ln.prototype,"elevationInfo",null);let k=class extends zt{constructor(t){super(t),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){var e;const{activeComponent:t}=this;if(!t)return null;switch(t.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":return((e=t.graphicSymbol)==null?void 0:e.type)==="text"?"text":t.geometryType;case"draw-3d":return t.geometryType}return null}addToHistory(t){this.history.redo=[],this.history.undo.push(t)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var t;(t=this.activeComponent)==null||t.reset()}refreshComponent(){const t=this.activeComponent;t&&(t.type!=="box"&&t.type!=="reshape"&&t.type!=="graphic-mover"||t.refresh())}set undo(t){this._set("undo",()=>{this.canUndo()&&t()})}set redo(t){this._set("redo",()=>{this.canRedo()&&t()})}};c([u()],k.prototype,"activeComponent",void 0),c([u()],k.prototype,"cancelled",void 0),c([u()],k.prototype,"history",void 0),c([u()],k.prototype,"tool",null),c([u()],k.prototype,"type",void 0),c([u()],k.prototype,"canUndo",null),c([u()],k.prototype,"canRedo",null),c([u()],k.prototype,"onEnd",void 0),c([u()],k.prototype,"undo",null),c([u()],k.prototype,"redo",null),c([u()],k.prototype,"toggleTool",void 0),c([u()],k.prototype,"addToSelection",void 0),c([u()],k.prototype,"removeFromSelection",void 0),k=c([L("esri.widgets.Sketch.support.OperationHandle")],k);let at=class extends k{};c([u()],at.prototype,"activeComponent",void 0),at=c([L("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],at);let le=class extends k{};c([u()],le.prototype,"activeComponent",void 0),le=c([L("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],le);function js(t,e){return e==="freehandPolygon"||e==="freehandPolyline"?"freehand":t??(e==="rectangle"||e==="circle"?"hybrid":"click")}function $s(t){switch(t){case"freehandPolygon":return"polygon";case"freehandPolyline":return"polyline";case"text":return"point";default:return t}}function Ri(t){var i;if(t.length>1)return!1;const e=(i=t.at(0))==null?void 0:i.geometry;return(e==null?void 0:e.type)==="point"||(e==null?void 0:e.type)==="multipoint"&&e.points.length<2}const Di={defaultZ:0},Ue={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0,name:xr},tool:"transform"},Ht=Symbol(),Li=Symbol();let b=class extends zt{constructor(e){var i;super(e),this._defaultSnappingManager=null,this._internalGraphicsLayer=new Gr({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._updatingHandles=new wr,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new yi({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new In({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new Un({color:[130,130,130,1],width:2}),this.meshSymbol=new Vn({symbolLayers:new we([new Nn])}),this.textSymbol=new qn({text:"text"}),this.updateGraphics=new we,this.updateOnGraphicClick=!0,this.creationMode="single",this.vertexSymbol=new yi({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new nn,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._sketchContinuationFlag=!1,this._onLayerAdapterChange=async()=>{const{_layerAdapter:n}=this;if(this.removeHandles(Li),!n)return;const r=[n.onGraphicsChange(o=>this._onLayerGraphicsChangeCallback(o)),ye(()=>n.elevationInfo,o=>{o!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=o)},Me)].filter(Ui);this.addHandles(r,Li)},this._originalPopupEnabled=null,this.defaultCreateOptions=Di,this.defaultUpdateOptions=Ue,this.snappingOptions=((i=e==null?void 0:e.snappingManager)==null?void 0:i.options)??(e==null?void 0:e.snappingOptions)??new A}initialize(){this.addHandles([Ft(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.layers},"change",e=>{this.layer&&e.removed.includes(this.layer)&&this.cancel()}),ye(()=>this._layerAdapter,()=>this._onLayerAdapterChange(),Me),ye(()=>this.view,e=>{this._defaultSnappingManager=We(this._defaultSnappingManager),e&&(this.snappingManager||(this._defaultSnappingManager=new Z({view:e,options:this.snappingOptions})),e.type==="2d"?D(()=>import("./editingTools-Owi9EJyN-BIXDePDC.js"),__vite__mapDeps([63,1,2,64,9,65,66,10,4,67,32,68,69,25,70,40,36,71,72,73,28,29,30,31,17,74,75,76,77,78,79,5,6,7,80,3,81,8,11,12,13,14,15,16,82,83,18,19,20,21,22,23,24,26,59,84,85,86,87,27,33,34,35,37,38,39,41,42,43,44,45,46,47,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119]),import.meta.url):e.type==="3d"&&(D(()=>import("./ImageMaterial.glsl-C9IVRq6S-CsryHqFn.js"),__vite__mapDeps([120,1,2,118,36,37,10,5,6,7,76,68,32,67,4,69,25,70,40,71,72,73,28,29,30,31,17,74,75,77,78,79,80,3,81,8,9,11,12,13,14,15,16,82,83,18,19,20,21,22,23,24,26,59,84,85,86,87,27,33,34,35,38,39,41,42,43,44,45,46,47,121,122,123,124,125,126,127,128,129,130,131,132,49,50,51,52,133,134,135,136,137,138,95,139,140,141,142,143,144,145,146,147,148,149,150,151,96,97,152,65,66,153,88,89,90,91,92,93,94,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,154,155,114,115,116,156,157,158,117]),import.meta.url).then(i=>i.e),D(()=>import("./LineCallout.glsl-Banmijl9-BP40ctOV.js"),__vite__mapDeps([159,1,2,160,161,12,13,14,15,11,5,6,7,123,10,37,124,70,40,36,47,125,25,38,39,9,126,127,128,3,129,130,45,41,46,131,132,122,49,50,51,52,133,134,135,136,137,138,72,73,95,139,140,91,17,162,157,29,163,145,34,35,164,165,166,167,168,169,170,24,68,171,172,147,146,173,96,30,97,174,175,176,32,177,178,179,180,181,182,28,31,59,183,184]),import.meta.url).then(i=>i.G)))},Me),ye(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,i)=>{e&&i&&!e.equals(i)&&this.cancel()})]),yo(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=We(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this._updatingHandles.destroy(),this.emit("destroy")}get _layerAdapter(){const{layer:e}=this;switch(e==null?void 0:e.type){case"graphics":return new Dn(e);case"map-notes":return new Ln(e);default:return null}}get activeTool(){var e;return((e=this._operationHandle)==null?void 0:e.tool)??null}get activeCreateToolDrawMode(){var e;return((e=this._operationHandle)==null?void 0:e.type)==="create"&&this._operationHandle.activeComponent&&"mode"in this._operationHandle.activeComponent?this._operationHandle.activeComponent.mode:null}get activeTooltip(){const{activeComponent:e,destroyed:i}=this,n=!i&&e&&"tooltip"in e?e.tooltip:null;return n!=null&&n.visible?n:null}get activeComponent(){var e;return((e=this._operationHandle)==null?void 0:e.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...Di,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...Ue,...e,reshapeOptions:{...Ue.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...Ue.highlightOptions,...e==null?void 0:e.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get snappingOptions(){var e;return((e=this.snappingManager)==null?void 0:e.options)??this._get("snappingOptions")}set snappingOptions(e){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=e),this._set("snappingOptions",e)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(e){if(e)this._isOverridden("snappingManager")||(this._defaultSnappingManager=We(this._defaultSnappingManager)),this._override("snappingManager",e);else{const{view:i}=this;!this._defaultSnappingManager&&i&&(this._defaultSnappingManager=new Z({options:this.snappingOptions,view:i})),this._clearOverride("snappingManager")}}get state(){var n;const e=!(!((n=this.view)!=null&&n.ready)||!this.layer),i=this._operationHandle;return e&&i?"active":e?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get updating(){var e;return!(!this._updatingHandles.updating&&!((e=this.snappingManager)!=null&&e.updating))}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}get view(){return this._get("view")}set view(e){const i=this._get("view");if(i){const{container:r,map:o}=i;r&&this._clearCursor(),o==null||o.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const n="view-ready";this.removeHandles(n),e&&this.addHandles(jn(()=>e.ready,r=>{this.removeHandles(this._viewHandlesKey),r&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)},Me),n),this._set("view",e)}addGraphic(e){var i;(i=this._layerAdapter)==null||i.add(e)}addGraphics(e){var i;(i=this._layerAdapter)==null||i.addMany(e)}hasGraphic(e){var i;return!!((i=this._layerAdapter)!=null&&i.has(e))}removeGraphic(e){var i;(i=this._layerAdapter)==null||i.remove(e)}removeGraphics(e){var i;(i=this._layerAdapter)==null||i.removeMany(e)}removeAllGraphics(){var e;(e=this._layerAdapter)==null||e.removeAll()}cancel(){this._moduleLoaderAbortController=Et(this._moduleLoaderAbortController),this._viewReadyAbortController=Et(this._viewReadyAbortController),this._sketchContinuationFlag=!0,this._operationHandle&&this._operationHandle.cancel()}complete(){var e;(e=this._operationHandle)==null||e.complete()}delete(){const{state:e,updateGraphics:i}=this;if(e==="active"&&i.length){const{activeTool:n}=this,r=i.toArray();this.removeGraphics(r),this.cancel(),this._emitDeleteEvent({graphics:r,tool:n})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const e=this.updateGraphics.map(i=>i.clone()).toArray();return this.addGraphics(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,i){var p;this.cancel(),await this._waitViewReady();const{view:n,layer:r}=this;if(!n||this.state==="disabled")throw r||this._logMissingLayer(),gi();if(n.activeTool!=null&&(n.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");Ti(n,this._internalGraphicsLayer);const o=await this._updatingHandles.addPromise(this._setupCreateOperation(e,i));if(o==null||this.destroyed)return void((p=n.map)==null?void 0:p.remove(this._internalGraphicsLayer));const s=()=>{var l,a;if(o===this._operationHandle){const h=this.createGraphic,y=this._operationHandle.cancelled;if(this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),(a=(l=this.view)==null?void 0:l.map)==null||a.remove(this._internalGraphicsLayer),o.cancelled||h==null||this.addGraphic(h),this._sketchContinuationFlag=!1,this.emit("create",{graphic:h,state:y?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"}),y||this._sketchContinuationFlag)return;const{creationMode:f}=this;if(f==="continuous"){if(i!=null&&i.geometryToPlace)return;this._updatingHandles.addPromise(vi(this.create(e,i)))}else f==="update"&&h&&this._updatingHandles.addPromise(vi(this.update([h])))}};o.on("complete",s),this._operationHandle=o,n.ready&&n.focus()}async place(e,i){return await e.load(),this.create("mesh",{mode:"click",hasZ:e.hasZ,geometryToPlace:e,...i})}async update(e,i){this.cancel(),await this._waitViewReady();const{layer:n,view:r,state:o}=this;if(!r||o==="disabled")throw n||this._logMissingLayer(),gi();r.activeTool!=null&&(r.activeTool=null);const s=Array.isArray(e)?e:[e];if(e==null||!(s!=null&&s.length))return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(s.some(l=>this.hasGraphic(l)?l.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0)))return;const p=await this._updatingHandles.addPromise(this._setupUpdateOperation(s,i));this.destroyed||p==null||M(p)||(Ti(r,this._internalGraphicsLayer),this._setUpdateOperationHandle(p,i),this.emit("update",{graphics:s,state:"start",aborted:!1,tool:p.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const i=this.view;if(i){e=Array.isArray(e)?e:[e];for(const n of e)n.geometry==null||n.geometry.type==="mesh"||mt(n.geometry.spatialReference,i.spatialReference)||(Sr(n.geometry.spatialReference,i.spatialReference)||Tr()||await Er(),n.geometry=It(n.geometry,i.spatialReference))}else this._logMissingView()}undo(){var e;this.canUndo()&&((e=this._operationHandle)==null||e.undo())}redo(){var e;this.canRedo()&&((e=this._operationHandle)==null||e.redo())}canUndo(){var e;return!!((e=this._operationHandle)!=null&&e.canUndo())}canRedo(){var e;return!!((e=this._operationHandle)!=null&&e.canRedo())}toggleUpdateTool(){var e;(e=this._operationHandle)==null||e.toggleTool()}async _getFirstHit(e){const i=this.view;if(!i)return this._logMissingView(),null;if(i.type==="2d"){const o=[];i.map.allLayers.forEach(p=>{p.type!=="vector-tile"&&p.type!=="imagery"||o.push(p)});const s=await i.hitTest(e,{exclude:o});return qs(s.results)}const n=[i.map.ground];i.map.allLayers.forEach(o=>{$n(o)&&n.push(o)});const r=await i.hitTest(e,{exclude:n});if(r.results.length>0){const o=r.results[0];if(o!=null&&o.type==="graphic"&&o.graphic&&(!r.ground.mapPoint||i.map.ground.opacity<1||r.ground.distance-(o.distance??0)>-Math.min(3*r.ground.distance,i.viewingMode==="global"?zn(i.renderCoordsHelper.spatialReference).radius/i.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return o}return null}_generateViewHandles(e){return[e.on("immediate-click",async i=>{var r;const n=this.state==="active"&&((r=this._operationHandle)==null?void 0:r.type)==="create";this.state!=="disabled"&&!n&&this.updateOnGraphicClick&&await this._updatingHandles.addPromise(this._handleImmediateClick(i))},x.WIDGET)]}async _handleImmediateClick(e){var r;const i=await e.defer(()=>this._getFirstHit(bi(e)));let n=null;if(i!=null){const o=i.graphic;this.updateGraphics.includes(o)||this.hasGraphic(o)?(e.stopPropagation(),n=o):((r=this.view)==null?void 0:r.type)!=="2d"||this._isComponentGraphic(o)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();n==null||this.updateGraphics.includes(n)||await this.update([n],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}})}async _setupCreateOperation(e,i){const n=this.view;if(!n)return this._logMissingView(),null;const r={hasZ:n.type==="3d",...this.defaultCreateOptions,...i},o=await this._setupDrawGraphicTool(e,n,r);return o==null?null:(n.tools.add(o),n.activeTool=o,this._setupCreateOperationHandle(o,e))}async _setupDrawGraphicTool(e,i,n){var v;if(e==="multipoint"&&i.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!i)return this._logMissingView(),null;const{cursor:r,defaultZ:o,hasZ:s,geometryToPlace:p,graphicProperties:l,mode:a,preserveAspectRatio:h}=n,y=js(a,e),f=$s(e),d=(v=n==null?void 0:n.optionsPerTool)!=null&&v.has(e)?n.optionsPerTool.get(e):{},m=(d==null?void 0:d.preserveAspectRatio)??h??e!=="rectangle",g={centered:e!=="rectangle"&&!(e==="circle"&&!m),cursor:r,defaultZ:o,forceUniformSize:m,graphicProperties:{...l,attributes:{...l==null?void 0:l.attributes}},geometryToPlace:p,geometryType:f,mode:y,graphicSymbol:this._getGraphicSymbolFromTool(e),hasZ:s,snappingManager:this.snappingManager,snapToScene:!1,view:i,...d};return i.type==="2d"?this._makeDrawGraphicTool2D(g):this._makeDrawGraphicTool3D(g)}async _makeDrawGraphicTool2D(e){const[i,n,r]=await Promise.all([this._requireModule(D(()=>import("./editingTools-Owi9EJyN-BIXDePDC.js"),__vite__mapDeps([63,1,2,64,9,65,66,10,4,67,32,68,69,25,70,40,36,71,72,73,28,29,30,31,17,74,75,76,77,78,79,5,6,7,80,3,81,8,11,12,13,14,15,16,82,83,18,19,20,21,22,23,24,26,59,84,85,86,87,27,33,34,35,37,38,39,41,42,43,44,45,46,47,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119]),import.meta.url)),Qe(),be()]);return M(i)||this.destroyed?null:new i.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:Fs(e.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:n,automaticLengthMeasurementUtils:r})}async _makeDrawGraphicTool3D(e){var o;const[i,n,r]=await Promise.all([this._requireModule(D(()=>import("./ImageMaterial.glsl-C9IVRq6S-CsryHqFn.js"),__vite__mapDeps([120,1,2,118,36,37,10,5,6,7,76,68,32,67,4,69,25,70,40,71,72,73,28,29,30,31,17,74,75,77,78,79,80,3,81,8,9,11,12,13,14,15,16,82,83,18,19,20,21,22,23,24,26,59,84,85,86,87,27,33,34,35,38,39,41,42,43,44,45,46,47,121,122,123,124,125,126,127,128,129,130,131,132,49,50,51,52,133,134,135,136,137,138,95,139,140,141,142,143,144,145,146,147,148,149,150,151,96,97,152,65,66,153,88,89,90,91,92,93,94,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,154,155,114,115,116,156,157,158,117]),import.meta.url).then(s=>s.e)),Qe(),be()]);return M(i)||this.destroyed?null:new i.module.DrawGraphicTool3D({...e,elevationInfo:(o=this._layerAdapter)==null?void 0:o.elevationInfo,snapToScene:!0,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:n,automaticLengthMeasurementUtils:r})}_setupCreateOperationHandle(e,i){const n=this.view;if(!n)return this._logMissingView(),null;let r=null;const o=e.forceUniformSize,s=e.centered,p=[n.on("key-down",a=>{if(a.key===G.pan)a.stopPropagation(),a.repeat||(e.enabled=!1);else if(a.key===G.complete)a.stopPropagation(),e.completeCreateOperation();else if(a.key!==G.vertexAdd||a.repeat)a.key===G.undo?(a.stopPropagation(),l.undo()):a.key===G.redo?(a.stopPropagation(),l.redo()):a.key!==G.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||a.repeat?a.key===G.center&&(a.repeat||(e.centered=!s,a.stopPropagation())):(e.forceUniformSize=!o,a.stopPropagation());else{const h=e.drawOperation.geometryType;h!=="polyline"&&h!=="polygon"&&h!=="multipoint"||(a.stopPropagation(),e.drawOperation.commitStagedVertex())}},x.WIDGET),n.on("key-up",a=>{a.key===G.pan?e.enabled=!0:a.key!==G.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?a.key===G.center&&(e.centered=s,a.stopPropagation()):(e.forceUniformSize=o,a.stopPropagation())},x.WIDGET),e.on("vertex-add",a=>{switch(r=r==null?"start":"active",a.operation){case"apply":this.emit("create",{graphic:e.graphic,state:r,tool:this.activeTool,toolEventInfo:a,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",a=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:a.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",a=>{switch(a.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:a,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",a=>{this._set("createGraphic",a.graphic),r="complete",a.aborted?l&&l.cancel():l&&l.complete()}),ye(()=>this._getGraphicSymbolFromTool(i),a=>{e.graphicSymbol=a})],l=new at({activeComponent:e,type:"create",onEnd:()=>{var a;J(p),(a=n.tools)==null||a.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return l}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":case"freehandPolyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":case"freehandPolygon":return this.polygonSymbol;case"mesh":return this.meshSymbol;case"text":return this.textSymbol}}async _setupUpdateOperation(e,i){const{view:n}=this;if(!n)return this._logMissingView(),null;const r={...this.defaultUpdateOptions,...i,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...i==null?void 0:i.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...i==null?void 0:i.highlightOptions}};let o=r.tool??Ue.tool;if(this.removeGraphics(e),this.addGraphics(e),n.type==="3d"){if(e.length===0)return null;switch(o){case"move":return this._setupMove3DOperation(e,r,n,o);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(e[0],r,n);case"transform":return this._setupGraphicTransform3DOperation(e,r,n)}}switch(o){case"move":return this._setupMove2DOperation(e,r,n);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(e,o,r,n);case"transform":return Ri(e)&&(o="reshape"),this._setupTransformOrReshape2DOperation(e,o,r,n)}}async _setupMove3DOperation(e,i,n,r,o=!1){const[s,p]=await Promise.all([this._requireModule(D(()=>import("./ImageMaterial.glsl-C9IVRq6S-CsryHqFn.js"),__vite__mapDeps([120,1,2,118,36,37,10,5,6,7,76,68,32,67,4,69,25,70,40,71,72,73,28,29,30,31,17,74,75,77,78,79,80,3,81,8,9,11,12,13,14,15,16,82,83,18,19,20,21,22,23,24,26,59,84,85,86,87,27,33,34,35,38,39,41,42,43,44,45,46,47,121,122,123,124,125,126,127,128,129,130,131,132,49,50,51,52,133,134,135,136,137,138,95,139,140,141,142,143,144,145,146,147,148,149,150,151,96,97,152,65,66,153,88,89,90,91,92,93,94,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,154,155,114,115,116,156,157,158,117]),import.meta.url).then(g=>g.e)),be()]);if(M(s))return s;const{ManipulatedObject3DGraphic:l,MoveTool3D:a}=s.module,h=new Map,y=()=>{h.forEach(g=>g.destroy()),h.clear()};for(const g of e){const v=new l({view:n,graphic:g}),w=ro(v);if(w!==0)return y(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${Si(w)}).`),null;h.set(g,v)}const f=new a({view:n,enableZ:i.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,autoLengthMeasurementUtils:p});n.tools.add(f),f.objects.addMany(Array.from(h.values())),o||this.updateGraphics.addMany(e);const d=[],m=new le({activeComponent:f,tool:r,type:"update",onEnd:()=>{J(d),it(n,f),y()},undo:()=>{Ii(this.view,f),et(m,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},redo:()=>{tt(m,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:g=>{this.updateGraphics.push(g);const v=new l({view:n,graphic:g});h.set(g,v),f.objects.push(v),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:g=>{const v=this.updateGraphics.indexOf(g);if(m.history.undo.forEach(C=>C.updates.splice(v,1)),m.history.redo.forEach(C=>C.updates.splice(v,1)),this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),this.updateGraphics.length===0)return void m.complete();const w=h.get(g);w&&(f.objects.remove(w),w.destroy(),h.delete(g))},toggleTool:async()=>{if(this.updateGraphics.length!==1||i.toggleToolOnClick===!1||r!=="transform")return;const g=this.updateGraphics.at(0),v=await this._setupReshape3DOperation(g,i,n,!0);v&&!M(v)&&(m.onEnd(),m.destroy(),this._setUpdateOperationHandle(v,i))}});return d.push(...this._getHandlesForComponent(m,i),n.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(m,g,i),x.WIDGET),n.on("key-down",g=>{this._getCommonUpdateOperationKeyDownHandlers(m,g)},x.WIDGET)),m}_setupGraphicTransform3DOperation(e,i,n,r=!1){if(e.length===1&&ao(e[0])===0){const o=e[0],s=o.geometry;if(s!=null&&(s.type==="point"||s.type==="mesh"))return this._setupPointTransform3DOperation(o,i,n);if(s!=null&&(s.type==="polygon"||s.type==="polyline"))return this._setupPolyTransform3DOperation(o,i,n,r)}return this._setupMove3DOperation(e,i,n,"transform",r)}async _setupPointTransform3DOperation(e,i,n){const r="transform",{enableRotation:o,enableScaling:s,enableZ:p}=i,l=await this._requireModule(D(()=>import("./ImageMaterial.glsl-C9IVRq6S-CsryHqFn.js"),__vite__mapDeps([120,1,2,118,36,37,10,5,6,7,76,68,32,67,4,69,25,70,40,71,72,73,28,29,30,31,17,74,75,77,78,79,80,3,81,8,9,11,12,13,14,15,16,82,83,18,19,20,21,22,23,24,26,59,84,85,86,87,27,33,34,35,38,39,41,42,43,44,45,46,47,121,122,123,124,125,126,127,128,129,130,131,132,49,50,51,52,133,134,135,136,137,138,95,139,140,141,142,143,144,145,146,147,148,149,150,151,96,97,152,65,66,153,88,89,90,91,92,93,94,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,154,155,114,115,116,156,157,158,117]),import.meta.url).then(g=>g.e));if(M(l))return l;const{TransformTool3D:a,ManipulatedObject3DGraphic:h}=l.module,y=new h({graphic:e,view:n}),f=new a({object:y,view:n,enableRotation:o,enableScaling:s,enableZ:p,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});n.tools.add(f),this.updateGraphics.add(e);const d=[],m=new le({activeComponent:f,tool:r,type:"update",onEnd:()=>{J(d),it(n,f),y.destroy()},undo:()=>{Ii(this.view,f),et(m,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},redo:()=>{tt(m,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:async g=>{this.updateGraphics.add(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"}),m.onEnd(),m.destroy();const v=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,n,"transform",!0);M(v)||this._setUpdateOperationHandle(v,i)},removeFromSelection:g=>{this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),m.complete()},toggleTool:()=>{}});return d.push(...this._getHandlesForComponent(m,i),n.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(m,g,i),x.WIDGET),n.on("key-down",g=>{this._getCommonUpdateOperationKeyDownHandlers(m,g)},x.WIDGET)),m}async _setupPolyTransform3DOperation(e,i,n,r=!1){var ve,_e;const o="transform",{enableRotation:s,enableScaling:p,enableZ:l,preserveAspectRatio:a}=i,[h,y]=await Promise.all([this._requireModule(D(()=>import("./ImageMaterial.glsl-C9IVRq6S-CsryHqFn.js"),__vite__mapDeps([120,1,2,118,36,37,10,5,6,7,76,68,32,67,4,69,25,70,40,71,72,73,28,29,30,31,17,74,75,77,78,79,80,3,81,8,9,11,12,13,14,15,16,82,83,18,19,20,21,22,23,24,26,59,84,85,86,87,27,33,34,35,38,39,41,42,43,44,45,46,47,121,122,123,124,125,126,127,128,129,130,131,132,49,50,51,52,133,134,135,136,137,138,95,139,140,141,142,143,144,145,146,147,148,149,150,151,96,97,152,65,66,153,88,89,90,91,92,93,94,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,154,155,114,115,116,156,157,158,117]),import.meta.url).then(S=>S.e)),be()]);if(M(h))return h;const{ManipulatedObject3DGraphic:f,ExtentTransformTool:d}=h.module,m=(_e=(ve=this.view)==null?void 0:ve.inputManager)==null?void 0:_e.isModifierKeyDown(G.constraint),g=new f({view:n,graphic:e}),v=new d({object:g,view:n,enableRotation:s,enableScaling:p,enableZ:l,preserveAspectRatio:!!a!=!!m,sketchOptions:this.sketchOptions,automaticLengthMeasurementUtils:y});n.tools.add(v),r||this.updateGraphics.add(e);const w=[],C=new le({activeComponent:v,tool:o,type:"update",onEnd:()=>{J(w),it(n,v),g.destroy()},canUndo:()=>!v.destroyed&&v.canUndo,undo:()=>{v.destroyed||(v.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},canRedo:()=>!v.destroyed&&v.canRedo,redo:()=>{v.destroyed||(v.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},addToSelection:async S=>{this.updateGraphics.add(S),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[S],removed:[],type:"selection-change"},type:"update"}),C.onEnd(),C.destroy();const Ee=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,n,"transform",!0);M(Ee)||this._setUpdateOperationHandle(Ee,i)},removeFromSelection:S=>{this.updateGraphics.remove(S),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[S],type:"selection-change"},type:"update"}),C.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||i.toggleToolOnClick===!1)return;const S=await this._setupReshape3DOperation(e,i,n,!0);S&&!M(S)&&(C.onEnd(),C.destroy(),this._setUpdateOperationHandle(S,i))}});return w.push(...this._getHandlesForComponent(C,i),n.on("immediate-click",S=>this._getCommonUpdateOperationClickHandlers(C,S,i),x.WIDGET),n.on("key-down",S=>this._getCommonUpdateOperationKeyDownHandlers(C,S),x.WIDGET),n.on("key-down",S=>{S.key!==G.constraint||S.repeat||(v.preserveAspectRatio=!v.preserveAspectRatio,S.stopPropagation())},x.WIDGET),n.on("key-up",S=>{S.key===G.constraint&&(v.preserveAspectRatio=!v.preserveAspectRatio,S.stopPropagation())},x.WIDGET)),C}async _setupMove2DOperation(e,i,n){const r="move";this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const o=await this._getGraphicMover(e,i,n);if(M(o))return o;const s=new le({activeComponent:o,tool:r,type:"update",onEnd:()=>{var h;this._clearCursor(),J(a),J(l),o.destroy(),(h=this._internalGraphicsLayer)==null||h.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const h=this.updateGraphics.toArray();et(s,h),s.refreshComponent(),this._emitUndoEvent({graphics:h,tool:r})},redo:()=>{const h=this.updateGraphics.toArray();tt(s,h),s.refreshComponent(),this._emitRedoEvent({graphics:h,tool:r})},addToSelection:async h=>{await this._updatingHandles.addPromise(this._updateSpatialReference(h)),this.updateGraphics.push(h),o.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[h],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:h=>{const y=this.updateGraphics.indexOf(h);s.history.undo.forEach(d=>d.updates.splice(y,1)),s.history.redo.forEach(d=>d.updates.splice(y,1)),this.updateGraphics.remove(h);const f=this.updateGraphics.toArray();this.emit("update",{graphics:f,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[h],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?o.graphics=f:s.complete()}});let p=!1;const l=[n.on("immediate-click",h=>this._getCommonUpdateOperationClickHandlers(s,h,i),x.WIDGET),n.on("key-down",h=>{this._getCommonUpdateOperationKeyDownHandlers(s,h),h.key!==G.constraint||h.repeat||(p=!0,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},x.WIDGET),n.on("key-up",h=>{h.key===G.constraint&&p&&(p=!1,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},x.WIDGET)],a=this._getHandlesForComponent(s,i);return s}async _setupReshape3DOperation(e,i,n,r=!1){const o="reshape",[s,p,l]=await Promise.all([this._requireModule(D(()=>import("./ImageMaterial.glsl-C9IVRq6S-CsryHqFn.js"),__vite__mapDeps([120,1,2,118,36,37,10,5,6,7,76,68,32,67,4,69,25,70,40,71,72,73,28,29,30,31,17,74,75,77,78,79,80,3,81,8,9,11,12,13,14,15,16,82,83,18,19,20,21,22,23,24,26,59,84,85,86,87,27,33,34,35,38,39,41,42,43,44,45,46,47,121,122,123,124,125,126,127,128,129,130,131,132,49,50,51,52,133,134,135,136,137,138,95,139,140,141,142,143,144,145,146,147,148,149,150,151,96,97,152,65,66,153,88,89,90,91,92,93,94,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,154,155,114,115,116,156,157,158,117]),import.meta.url).then(w=>w.e)),Qe(),be()]);if(M(s))return s;const{ManipulatedObject3DGraphic:a,ReshapeTool3D:h}=s.module,y=new a({view:n,graphic:e}),f=oo(y);if(f!==0)return y.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${Si(f)}).`),null;const d=i.reshapeOptions,m=new h({view:n,object:y,enableZVertex:i.enableZ&&(d==null?void 0:d.vertexOperation)==="move",enableZShape:i.enableZ&&(d==null?void 0:d.shapeOperation)==="move",enableMoveObject:(d==null?void 0:d.shapeOperation)==="move"||(d==null?void 0:d.shapeOperation)==="move-xy",enableMidpoints:(d==null?void 0:d.edgeOperation)==="split",enableEdgeOffset:(d==null?void 0:d.edgeOperation)==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:p,automaticLengthMeasurementUtils:l});n.tools.add(m),r||this.updateGraphics.add(y.graphic);const g=[],v=new le({activeComponent:m,tool:o,type:"update",onEnd:()=>{J(g),it(n,m),y.destroy()},canUndo:()=>!m.destroyed&&m.canUndo,undo:()=>{m.destroyed||(m.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},canRedo:()=>!m.destroyed&&m.canRedo,redo:()=>{m.destroyed||(m.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},addToSelection:async w=>{this.updateGraphics.add(w),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[w],removed:[],type:"selection-change"},type:"update"}),v.onEnd(),v.destroy();const C=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,n,"transform",!0);M(C)||this._setUpdateOperationHandle(C,i)},removeFromSelection:w=>{this.updateGraphics.remove(w),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[w],type:"selection-change"},type:"update"}),v.complete()},toggleTool:async()=>{if(i.toggleToolOnClick===!1)return;v.onEnd(),v.destroy();const w=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),i,n,!0);M(w)||this._setUpdateOperationHandle(w,i)}});return g.push(...this._getHandlesForComponent(v,i),n.on("immediate-click",w=>this._getCommonUpdateOperationClickHandlers(v,w,i),x.WIDGET),n.on("key-down",w=>{this._getCommonUpdateOperationKeyDownHandlers(v,w)},x.WIDGET)),v}async _setupTransformOrReshape2DOperation(e,i,n,r){this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const o=i==="transform"?await this._getBox(e,n,r):await this._getReshape(e,n,r);if(M(o))return o;const s=new le({activeComponent:o,type:"update",onEnd:()=>{J(l),J(p),s.activeComponent&&!s.activeComponent.destroyed&&s.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{et(s,this.updateGraphics.toArray()),s.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s.tool})},redo:()=>{tt(s,this.updateGraphics.toArray()),s.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s.tool})},addToSelection:async a=>{let h=s.activeComponent;if((h==null?void 0:h.type)==="reshape"){const y=[...this.updateGraphics,a];this.updateGraphics.removeAll(),s.onEnd(),s.destroy();const f=await this._setupTransformOrReshape2DOperation(y,"transform",n,r);if(M(f))return;this._setUpdateOperationHandle(f,n)}else this.updateGraphics.add(a),h.graphics=this.updateGraphics.toArray(),h.refresh(),s.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[a],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:a=>{const h=this.updateGraphics.indexOf(a);s.history.undo.forEach(f=>f.updates.splice(h,1)),s.history.redo.forEach(f=>f.updates.splice(h,1)),this.updateGraphics.remove(a);const y=this.updateGraphics.toArray();y.length===0?s.complete():Ri(y)?s.toggleTool():s.activeComponent.graphics=y,this.emit("update",{graphics:y,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[a],type:"selection-change"},type:"update"})},toggleTool:async()=>{var f;if(this.updateGraphics.length>1)return;const a=this.updateGraphics.at(0),h=a.geometry;if(h!=null&&(s.tool==="reshape"&&h.type==="point"||s.tool==="transform"&&h.type==="extent"))return;let y=null;s.tool==="transform"?y=await this._getReshape([a],n,r):s.tool==="reshape"&&(y=await this._getBox([a],n,r)),M(y)||((f=s.activeComponent)==null||f.destroy(),s.activeComponent=y,s.activeComponent&&(J(l),l=this._getHandlesForComponent(s,n)))}}),p=[r.on("immediate-click",a=>this._getCommonUpdateOperationClickHandlers(s,a,n),x.WIDGET),r.on("key-down",a=>{if(this._getCommonUpdateOperationKeyDownHandlers(s,a),a.key===G.constraint&&!a.repeat&&s){const h=s.activeComponent;h&&h.type==="box"&&(h.preserveAspectRatio=!h.preserveAspectRatio)}},x.WIDGET),r.on("key-up",a=>{if(a.key===G.constraint&&s){const h=s.activeComponent;h&&h.type==="box"&&(h.preserveAspectRatio=!h.preserveAspectRatio)}},x.WIDGET)];let l=this._getHandlesForComponent(s,n);return s}async _getGraphicMover(e,i,n){const{enableMoveAllGraphics:r,highlightOptions:o}=i,s=await this._requireModule(D(()=>import("./GraphicMover-DhdSHNnj-BRs2Gnjj.js"),__vite__mapDeps([185,1,2,18,19,20,21,22,23,24,25,26,6,7,119,94,28,29,30,31,59,117,10,12,13,14,15,5,84,17,27,32,11,33,34,35,9,36,37,16,38,39,40,41,4,42,43,44,45,46,47]),import.meta.url).then(p=>p.G));return M(s)?s:new s.module.default({enableMoveAllGraphics:r,highlightName:o==null?void 0:o.name,highlightsEnabled:!!(o!=null&&o.enabled),indicatorsEnabled:!1,graphics:e,view:n,callbacks:{onGraphicMoveStart:({dx:p,dy:l,graphic:a})=>{this._displayCursor("grabbing"),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:l,mover:a,type:"move-start"},type:"update"})},onGraphicMove:({dx:p,dy:l,graphic:a})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:l,mover:a,type:"move"},type:"update"}),onGraphicMoveStop:({dx:p,dy:l,graphic:a})=>{this._displayCursor("pointer"),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:l,mover:a,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayCursor("move"),onGraphicPointerOut:()=>this._clearCursor()}})}async _getBox(e,i,n){var y,f;const{enableRotation:r,enableScaling:o,highlightOptions:s,preserveAspectRatio:p}=i,[l,a]=await Promise.all([this._requireModule(D(()=>import("./Box-Bl0kNUz2-BY1z6oY5.js"),__vite__mapDeps([186,1,2,4,93,119,94,185,18,19,20,21,22,23,24,25,26,6,7,28,29,30,31,59,117,10,12,13,14,15,5,84,17,27,32,11,33,34,35,9,36,37,16,38,39,40,41,42,43,44,45,46,47,187,67,68,69,70,71,72,73,74,75,76,77,78,79,80,3,81,8,82,83,85,86,87,158,154]),import.meta.url)),be()]);if(M(l))return l;const h=(f=(y=this.view)==null?void 0:y.inputManager)==null?void 0:f.isModifierKeyDown(G.constraint);return new l.module.default({graphics:e,enableRotation:r,enableScaling:o,highlightName:s==null?void 0:s.name,highlightsEnabled:!!(s!=null&&s.enabled),preserveAspectRatio:!!p!=!!h,layer:this._internalGraphicsLayer,view:n,sketchOptions:this.sketchOptions,automaticLengthMeasurementUtils:a,callbacks:{onMoveStart:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onMove:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onMoveStop:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onScaleStart:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onScale:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onScaleStop:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onRotateStart:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onRotate:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onRotateStop:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"})}})}async _getReshape(e,i,n){const{highlightOptions:r,reshapeOptions:o}=i,s=(o==null?void 0:o.edgeOperation)==="split",p=(o==null?void 0:o.shapeOperation)==="move",l=!!(o!=null&&o.enableCreateCurveFromStraightEdge),[a,h,y]=await Promise.all([this._requireModule(D(()=>import("./Reshape-BN0WJMw6-BYAhd0i4.js"),__vite__mapDeps([188,1,2,32,107,100,103,102,104,105,106,108,18,19,20,21,22,23,24,25,26,6,7,64,9,65,66,10,4,67,68,69,70,40,36,71,72,73,28,29,30,31,17,74,75,76,77,78,79,5,80,3,81,8,11,12,13,14,15,16,82,83,59,84,85,86,87,27,33,34,35,37,38,39,41,42,43,44,45,46,47,189,155,114,115,116,156,157,118,190,111,153,119,94,185,117,154,187,92,93]),import.meta.url)),Qe(),be()]);return M(a)?a:new a.module.default({enableMidpoints:s,enableMovement:p,enableCurveOnMidpoint:l,graphic:e[0],highlightName:r==null?void 0:r.name,highlightsEnabled:!!(r!=null&&r.enabled),layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,automaticAreaMeasurementUtils:h,automaticLengthMeasurementUtils:y,view:n,callbacks:{onReshapeStart:f=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...f},type:"update"}),onReshape:f=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...f},type:"update"}),onReshapeStop:({mover:f,type:d})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:f,type:d},type:"update"}),onMoveStart:({dx:f,dy:d,mover:m,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:f,dy:d,mover:m,type:g},type:"update"}),onMove:({dx:f,dy:d,mover:m,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:f,dy:d,mover:m,type:g},type:"update"}),onMoveStop:({dx:f,dy:d,mover:m,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:f,dy:d,mover:m,type:g},type:"update"}),onVertexAdd:({added:f,type:d,vertices:m})=>{const g=f.map(v=>fi(v.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:g,vertices:m,type:d},type:"update"})},onVertexRemove:({removed:f,type:d,vertices:m})=>{const g=f.map(v=>fi(v.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:g,vertices:m,type:d},type:"update"})}}})}_getHandlesForComponent(e,i){const n=e.activeComponent;if(!n)return[];switch(n.type){case"graphic-mover":return[n.on("graphic-click",({graphic:r,viewEvent:o})=>{var s;(s=o.native)!=null&&s.shiftKey&&i.multipleSelectionEnabled&&(o.stopPropagation(),e.removeFromSelection(r))}),n.on("graphic-move-start",r=>e.addToHistory(he(r.allGraphics)))];case"box":return[n.on("graphic-click",r=>this._onTransformOrReshape2DGraphicClick(e,i,r)),n.on("move-start",r=>e.addToHistory(he(r.graphics))),n.on("rotate-start",r=>e.addToHistory(he(r.graphics))),n.on("scale-start",r=>e.addToHistory(he(r.graphics)))];case"reshape":return[n.on("graphic-click",r=>this._onTransformOrReshape2DGraphicClick(e,i,r)),n.on("move-start",r=>e.addToHistory(he([r.mover]))),n.on("reshape-start",r=>e.addToHistory(he([r.graphic]))),n.on("vertex-add",r=>e.addToHistory(he([r.oldGraphic]))),n.on("vertex-remove",r=>e.addToHistory(he([r.oldGraphic])))];case"move-3d":return[n.events.on("record-undo",({updates:r})=>{e.addToHistory({updates:r})}),n.events.on("move-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:r.objects.length>0?r.objects[0].graphic:null,type:"move-start"},type:"update"})}),n.events.on("move",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:r.dx,dy:r.dy,mover:r.objects.length>0?r.objects[0].graphic:null,type:"move"},type:"update"})}),n.events.on("move-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:r.objects.length>0?r.objects[0].graphic:null,type:"move-stop"},type:"update"})}),n.events.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.object.graphic],e,i):e.toggleTool()})];case"transform-3d":return[n.events.on("record-undo",({updates:r})=>{e.addToHistory({updates:r})}),n.events.on("translate-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move-start"},type:"update"})}),n.events.on("translate-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move-stop"},type:"update"})}),n.events.on("rotate-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,angle:r.angle,type:"rotate-start"},type:"update"})}),n.events.on("rotate-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,angle:r.angle,type:"rotate-stop"},type:"update"})}),n.events.on("scale-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale-start"},type:"update"})}),n.events.on("scale-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale-stop"},type:"update"})}),n.events.on("translate",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move"},type:"update"})}),n.events.on("rotate",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,angle:r.angle,type:"rotate"},type:"update"})}),n.events.on("scale",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.object.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale"},type:"update"})}),n.events.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.object.graphic],e,i):e.toggleTool()})];case"reshape-3d":return[n.events.on("reshape",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...r,mover:r.object.graphic},type:"update"})}),n.events.on("move",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...r,mover:r.object.graphic},type:"update"})}),n.events.on("vertex-add",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),n.events.on("vertex-remove",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),n.events.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.object.graphic],e,i):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,i,n){var s;const{graphic:r,viewEvent:o}=n;return(s=o.native)!=null&&s.shiftKey&&this.hasGraphic(r)?(o.stopPropagation(),e.removeFromSelection(r)):i.toggleToolOnClick?(o.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,i){var o;this._operationHandle=e;const n=(o=this.view)==null?void 0:o.map;this._disablePopup(i);const r=()=>{if(e===this._operationHandle){const s=this.updateGraphics.toArray(),p=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),n&&n.remove(this._internalGraphicsLayer),this._restorePopup(i),this.emit("update",{graphics:s,state:"complete",aborted:e.cancelled,tool:p,toolEventInfo:null,type:"update"})}};e.on("complete",r)}async _getCommonUpdateOperationClickHandlers(e,i,n){const r=bi(i),o=await i.defer(()=>this._getFirstHit(r));if(o==null)return void e.complete();if(i.native.shiftKey&&this._toggleSelection([o.graphic],e,n))return void i.stopPropagation();this.updateGraphics.includes(o.graphic)?i.stopPropagation():e.complete()}_toggleSelection(e,i,n){const r=!!n.multipleSelectionEnabled;return e.some(o=>o!=null&&!(!r||!this.hasGraphic(o))&&(this.updateGraphics.includes(o)?i.removeFromSelection(o):i.addToSelection(o),!0))}_getCommonUpdateOperationKeyDownHandlers(e,i){if(!e)return;const n=i.key;n===G.undo&&e.canUndo()?(i.stopPropagation(),e.undo()):n===G.redo&&e.canRedo()?(i.stopPropagation(),e.redo()):n===G.cancel?(i.stopPropagation(),e.cancel()):this.allowDeleteKey&&G.delete.includes(n)&&this._onDeleteKey(i)}_onDeleteKey(e){var r;if(!this._operationHandle||this._operationHandle.type!=="update")return;const i=this.activeComponent,n=this.updateGraphics.toArray();i!=null&&(i.type!=="reshape"||n.length===1&&((r=n[0].geometry)==null?void 0:r.type)==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){var e,i;this._internalGraphicsLayer&&((i=(e=this.view)==null?void 0:e.map)==null||i.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=We(this._internalGraphicsLayer))}_isComponentGraphic(e){var n;const{activeComponent:i}=this;return!(!e||i==null)&&(((n=e.attributes)==null?void 0:n.esriSketchTool)||i.type==="draw-2d"&&i.graphic===e||(i.type==="box"||i.type==="reshape")&&i.isUIGraphic(e))}_clearCursor(){this.removeHandles(Ht)}_displayCursor(e){var i;this.removeHandles(Ht),(i=this.view)!=null&&i.container&&e!=null&&this.addHandles(this.view.acquireCursor(e,"high"),Ht)}_logError(e,i,n){Vi.getLogger(this).error(new Fn(e,i,n))}async _requireModule(e){const i=new AbortController;this._moduleLoaderAbortController=i;const n=await e;return this._moduleLoaderAbortController!==i||i.signal.aborted?{requireError:"aborted"}:{module:n}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}_onLayerGraphicsChangeCallback(e){if(this._operationHandle!=null){const{updateGraphics:i}=this;for(const n of e.removed)if(i.includes(n)){if(!(i.length>1)){this._operationHandle.cancel();break}this._operationHandle.removeFromSelection(n)}}}get test(){}wait(){return mi(()=>!this.updating)}_disablePopupEnabled(e){var i;return((i=this.view)==null?void 0:i.type)!=="3d"||this.updateOnGraphicClick||((e==null?void 0:e.toggleToolOnClick)??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?(Et(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await Zn(mi(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",Hi("view"))}_logMissingLayer(){this._logError(zs,Hi("layer"))}};c([u()],b.prototype,"_defaultSnappingManager",void 0),c([u()],b.prototype,"_layerAdapter",null),c([u()],b.prototype,"_operationHandle",void 0),c([u({readOnly:!0})],b.prototype,"_updatingHandles",void 0),c([u({readOnly:!0})],b.prototype,"activeTool",null),c([u({readOnly:!0})],b.prototype,"activeCreateToolDrawMode",null),c([u()],b.prototype,"activeTooltip",null),c([u({types:De})],b.prototype,"activeFillSymbol",void 0),c([u()],b.prototype,"activeLineSymbol",void 0),c([u()],b.prototype,"activeVertexSymbol",void 0),c([u()],b.prototype,"allowDeleteKey",void 0),c([u({readOnly:!0})],b.prototype,"createGraphic",null),c([u()],b.prototype,"defaultCreateOptions",null),c([u()],b.prototype,"defaultUpdateOptions",null),c([u({type:Yt,nonNullable:!0})],b.prototype,"labelOptions",null),c([u()],b.prototype,"layer",void 0),c([u({types:De})],b.prototype,"pointSymbol",void 0),c([u({types:De})],b.prototype,"polygonSymbol",void 0),c([u({types:De})],b.prototype,"polylineSymbol",void 0),c([u()],b.prototype,"meshSymbol",void 0),c([u()],b.prototype,"textSymbol",void 0),c([u({type:A,nonNullable:!0})],b.prototype,"snappingOptions",null),c([u()],b.prototype,"snappingManager",null),c([u({readOnly:!0})],b.prototype,"state",null),c([u({type:Xt,nonNullable:!0})],b.prototype,"tooltipOptions",null),c([u({readOnly:!0})],b.prototype,"updateGraphics",void 0),c([u()],b.prototype,"updateOnGraphicClick",void 0),c([u()],b.prototype,"updating",null),c([u()],b.prototype,"creationMode",void 0),c([u({type:Qt,nonNullable:!0})],b.prototype,"valueOptions",null),c([u({types:De})],b.prototype,"vertexSymbol",void 0),c([u({value:null})],b.prototype,"view",null),c([u({constructOnly:!0,type:nn})],b.prototype,"sketchOptions",void 0),b=c([L("esri.widgets.Sketch.SketchViewModel")],b);const zs="sketch:missing-property",Hi=t=>`Property '${t}' is missing on SketchViewModel.`;function Fs(t){return t==="polygon"||t==="rectangle"||t==="circle"}function et(t,e){Hn("undo",t.history.undo,t.history.redo,e)}function tt(t,e){Hn("redo",t.history.redo,t.history.undo,e)}function Hn(t,e,i,n){const r=e.pop();if(!r)return;const o=r.updates,s=[];n.forEach((p,l)=>{const a=o[l];a!=null&&("geometry"in a&&a.geometry!=null&&(s.push({geometry:p.geometry}),p.geometry=a.geometry),"symbol"in a&&a.symbol!=null&&(s.push({symbol:p.symbol}),p.symbol=a.symbol),"undo"in a&&(s.push(a),a[t](p)))}),i.push({updates:s})}function Ii(t,e){t!=null&&e.hasGrabbedManipulators&&(t.activeTool=null)}function he(t){return{updates:t.map(({geometry:e})=>(e==null?void 0:e.type)==="mesh"?{geometry:e.cloneShallow()}:{geometry:e})}}function it(t,e){var i;(i=t.tools)==null||i.remove(e),e.destroyed||e.destroy()}function M(t){return"requireError"in t&&t.requireError==="aborted"}export{es as $,Gt as A,ie as B,va as C,fe as D,on as E,xa as F,rs as G,ps as H,N as I,ma as J,is as K,Sa as L,A as M,Is as N,ga as O,os as P,ho as Q,Aa as R,ss as S,hn as T,rn as U,qs as V,Oi as W,st as X,ae as Y,Ei as Z,En as _,Yt as a,Xo as a0,Ta as a1,Ga as a2,ro as a3,ba as a4,Us as a5,as as a6,wa as a7,_a as a8,Ra as a9,Ti as aa,fa as ab,Ea as ac,b,ko as c,Mo as d,Pe as e,Ca as f,be as g,Qe as h,ut as i,Da as j,ts as k,ns as l,Pa as m,Tt as n,_n as o,Ma as p,F as q,ka as r,Qt as s,yo as t,xn as u,Oa as v,Po as w,Ve as x,ci as y,nn as z};
