import{i4 as K,cx as gs,i6 as cr,eq as _,hN as fi,aj as di,am as nt,lI as _s,b4 as te,X as Ae,aR as ys,ah as xs,lJ as ws,kg as bs,lK as Ss,P as pi,lL as zi,d4 as Ms,is as X,lg as it,d8 as Ts,a2 as ii,kG as Oi,cy as mi,lM as Cs,lN as Ps,aq as zs,ii as Os,i5 as Es,lO as As,ih as Ei,kB as Ai,lP as Is,as as Fs,aH as Ds,l as wt,lQ as Rs,ir as ur,lR as at,lS as rt,gj as Ls,kF as Vs,s as vi,lT as $s,z as ke,m as d,E as m,n as gi,F as hr,b8 as Ve,aO as ae,i1 as Ns,be as ks,bj as Bs,C as ri,eD as Dt,d3 as fr,ij as si,bd as dr,lU as Hs}from"./index-BeTPrQ6f.js";import{E as Us,A as js,D as kt,C as Bt,U as qs,_ as pr,L as Ht}from"./enums-DDJfd4_p-D3z9tmVA.js";import{H as ni,w as Ws}from"./Texture-DLw7oaIg-fTsxdRzn.js";import{S as Ct,p as Gs,k as ve,_ as $,A as j,X as ge,b as Y,L as Se,Q as fe,l as Pe,q as Te,j as oe,g as mr,R as Ie,z as ue,U as Ii,F as oi,E as W,W as vr,C as Xs,N as gr}from"./vec32-CI1xtKog-DFVYRcgb.js";import{w as Ys,o as Ks}from"./Indices-CAn-HCVv-hWNN5onC.js";import{d as B,T as bt,O as _r,g as Js,M as Zs,c as Fi,E as Di,J as Ri,b as Qs,x as en,o as tn}from"./BufferView-B6RYETl3-CMoUTBv6.js";import{x as rn}from"./triangle-DA_o7I-u-CHbj6sRJ.js";import{N as sn,D as nn,O as on,T as yr,o as an,w as ln}from"./renderState-CsafAKLy-B8R8ns_l.js";import{h as xr,q as wr,N as Pt,Y as Ge,k as zt,Z as St,G as ai,e as cn,x as un,b as hn,E as fn,V as dn,B as pn,L as mn,J as br,K as vn,t as gn,o as _n,$ as yn}from"./mat4-R0VY9B_E-DoEP887i.js";import{o as v,i as se}from"./glsl-CfY1Aoj6-DPHSeNd9.js";import{y as Ot,z as Li,O as Vi,E as Ut,p as je,b as $i,D as lt,q as xn}from"./vec42-DHp-FUwt-Br7hmYJs.js";import{o as Re,r as Ni,i as wn}from"./vec4f64-DD-nkcCV-CSNWKRqG.js";import{m as ki}from"./lengthUtils-CopeXEyE-DjCEitlq.js";import"./projectBuffer-CMNsPBq1-CMpE7Jo3.js";import"./projectionUtils-CsX1UTBu-DsZaU4xz.js";import{f as Bi}from"./projectVectorToVector-OCoJKalB-CQIDHzSm.js";import{o as _i,r as Sr,u as Hi}from"./vec2f64-CkowXrDb-3zFQ3LNH.js";import{J as Mr,K as bn,O as Tr,A as Sn,w as Mn,P as Tn,Q as Cn,S as Pn,T as zn,W as On}from"./frustum-D1Y7pP8E-DUyP3Dvr.js";import{A as Rt,a as Cr,j as Pr,C as zr,y as Or,e as En,Y as An}from"./sphere-CIGsF4vz-C3zVQu9y.js";import{B as In}from"./vectorStacks-B2ngxq6F-myhPBoPk.js";import{i as Fn,F as Dn}from"./orientedBoundingBox-DAJ-bKlA-DbqXagWB.js";import{n as Ui}from"./projectPointToVector-BHS0gJJf-DOVZH8Fn.js";import{M as Rn,y as Ln,R as Vn}from"./lineSegment-D8lwRkdT-CnWWOaLb.js";import{W as ji,L as qi,F as $n,r as Wi,e as Nn,x as kn,Z as Bn}from"./plane-wUwHaY3K-ZwGBF7HQ.js";import{c as Hn}from"./Cyclical-Bzwh_QaL-CXh-hbnA.js";import{h as Un}from"./normalizeUtils-DK5542Ty-DtqBcgc2.js";import{c as Er}from"./VertexAttributeLocations-DBgVVQz--D3wovAvC.js";import{c as Ar}from"./VertexElementDescriptor-DLvjNrmQ-Cuvx5w94.js";function Oc(e,t=!1){return e<=mi?t?new Array(e).fill(0):new Array(e):new Float32Array(e)}function Ec(e){return(Array.isArray(e)?e.length:e.byteLength/8)<=mi?Array.from(e):new Float32Array(e)}function Ac(e,t,i){return Array.isArray(e)?e.slice(t,t+i):e.subarray(t,t+i)}let H=class extends di{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1}};d([m()],H.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),d([m()],H.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),d([m()],H.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),d([m()],H.prototype,"DECONFLICTOR_SHOW_GRID",void 0),d([m()],H.prototype,"LABELS_SHOW_BORDER",void 0),d([m()],H.prototype,"TEXT_SHOW_BASELINE",void 0),d([m()],H.prototype,"TEXT_SHOW_BORDER",void 0),d([m()],H.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),d([m()],H.prototype,"OVERLAY_SHOW_CENTER",void 0),d([m()],H.prototype,"SHOW_POI",void 0),d([m()],H.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),d([m()],H.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),d([m()],H.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),d([m()],H.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),d([m()],H.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),d([m()],H.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),d([m()],H.prototype,"I3S_TREE_SHOW_TILES",void 0),d([m()],H.prototype,"I3S_SHOW_MODIFICATIONS",void 0),d([m()],H.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),d([m()],H.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),d([m()],H.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),d([m()],H.prototype,"LINE_WIREFRAMES",void 0),H=d([gi("esri.views.3d.support.debugFlags")],H);const jn=new H,ct=()=>pi.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),qn=542327876,Wn=131072,Gn=4;function yi(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function Xn(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}const Yn=yi("DXT1"),Kn=yi("DXT3"),Jn=yi("DXT5"),Zn=31,Qn=0,eo=1,to=2,io=3,ro=4,so=7,no=20,oo=21;function Ic(e,t,i){const r=ao(i,t.hasMipmap??!1);if(r==null)throw new Error("DDS texture data is null");const{textureData:s,internalFormat:n,width:o,height:a}=r;return t.samplingMode=s.levels.length>1?9987:9729,t.hasMipmap=s.levels.length>1,t.internalFormat=n,t.width=o,t.height=a,new Ws(e,t,s)}function ao(e,t){const i=new Int32Array(e.buffer,e.byteOffset,Zn);if(i[Qn]!==qn)return ct().error("Invalid magic number in DDS header"),null;if(!(i[no]&Gn))return ct().error("Unsupported format, must contain a FourCC code"),null;const r=i[oo];let s,n;switch(r){case Yn:s=8,n=Ht.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case Kn:s=16,n=Ht.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case Jn:s=16,n=Ht.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return ct().error("Unsupported FourCC code:",Xn(r)),null}let o=1,a=i[ro],l=i[io];(3&a||3&l)&&(ct().warn("Rounding up compressed texture size to nearest multiple of 4."),a=a+3&-4,l=l+3&-4);const h=a,c=l;let u,p;i[to]&Wn&&t!==!1&&(o=Math.max(1,i[so]));let y=e.byteOffset+i[eo]+4;const f=[];for(let b=0;b<o;++b)p=(a+3>>2)*(l+3>>2)*s,u=new Uint8Array(e.buffer,y,p),f.push(u),y+=p,a=Math.max(1,a>>1),l=Math.max(1,l>>1);return{textureData:{type:"compressed",levels:f},internalFormat:n,width:h,height:c}}function lo(e){if(e.length<mi)return Array.from(e);if(Array.isArray(e))return Float64Array.from(e);if(!("BYTES_PER_ELEMENT"in e))return Array.from(e);switch(e.BYTES_PER_ELEMENT){case 1:return Uint8Array.from(e);case 2:return Cs(e)?tn().from(e):Ps(e)?Uint16Array.from(e):Int16Array.from(e);case 4:return Float32Array.from(e);default:return Float64Array.from(e)}}let co=class Ir{get center(){return K(this._data[0],this._data[1],this._data[2])}get radius(){return this._data[3]}get bbMin(){return K(this._data[4],this._data[5],this._data[6])}get bbMax(){return K(this._data[7],this._data[8],this._data[9])}constructor(t,i,r){this.primitiveIndices=t,this._numIndexPerPrimitive=i,this.position=r,this._data=[.1,0,0,0,0,0,0,0,0,0],this._children=void 0,B(t.length>=1),B(r.size===3||r.size===4);const{data:s,size:n,indices:o}=r;B(o.length%this._numIndexPerPrimitive===0),B(o.length>=t.length*this._numIndexPerPrimitive);const a=t.length;let l=n*o[this._numIndexPerPrimitive*t[0]];Fe.clear(),Fe.push(l);const h=K(s[l],s[l+1],s[l+2]),c=cr(h);for(let f=0;f<a;++f){const b=this._numIndexPerPrimitive*t[f];for(let w=0;w<this._numIndexPerPrimitive;++w){l=n*o[b+w],Fe.push(l);let z=s[l];h[0]=Math.min(z,h[0]),c[0]=Math.max(z,c[0]),z=s[l+1],h[1]=Math.min(z,h[1]),c[1]=Math.max(z,c[1]),z=s[l+2],h[2]=Math.min(z,h[2]),c[2]=Math.max(z,c[2])}}for(let f=0;f<3;++f)this._data[4+f]=h[f],this._data[7+f]=c[f];const u=Ct(_(),this.bbMin,this.bbMax,.5);let p=.5*Math.max(Math.max(c[0]-h[0],c[1]-h[1]),c[2]-h[2]),y=p*p;for(let f=0;f<Fe.length;++f){l=Fe.at(f);const b=s[l]-u[0],w=s[l+1]-u[1],z=s[l+2]-u[2],O=b*b+w*w+z*z;if(O<=y)continue;const C=Math.sqrt(O),E=.5*(C-p);p+=E,y=p*p;const D=E/C;u[0]+=b*D,u[1]+=w*D,u[2]+=z*D}this._data[3]=p;for(let f=0;f<3;++f)this._data[0+f]=u[f];Fe.clear()}getChildren(){if(this._children||Gs(this.bbMin,this.bbMax)<=1)return this._children;const t=Ct(_(),this.bbMin,this.bbMax,.5),i=this.primitiveIndices.length,r=new Uint8Array(i),s=new Array(8);for(let c=0;c<8;++c)s[c]=0;const{data:n,size:o,indices:a}=this.position;for(let c=0;c<i;++c){let u=0;const p=this._numIndexPerPrimitive*this.primitiveIndices[c];let y=o*a[p],f=n[y],b=n[y+1],w=n[y+2];for(let z=1;z<this._numIndexPerPrimitive;++z){y=o*a[p+z];const O=n[y],C=n[y+1],E=n[y+2];O<f&&(f=O),C<b&&(b=C),E<w&&(w=E)}f<t[0]&&(u|=1),b<t[1]&&(u|=2),w<t[2]&&(u|=4),r[c]=u,++s[u]}let l=0;for(let c=0;c<8;++c)s[c]>0&&++l;if(l<2)return;const h=new Array(8);for(let c=0;c<8;++c)h[c]=s[c]>0?new Uint32Array(s[c]):void 0;for(let c=0;c<8;++c)s[c]=0;for(let c=0;c<i;++c){const u=r[c];h[u][s[u]++]=this.primitiveIndices[c]}this._children=new Array;for(let c=0;c<8;++c)h[c]!==void 0&&this._children.push(new Ir(h[c],this._numIndexPerPrimitive,this.position));return this._children}static prune(){Fe.prune()}};const Fe=new gs({deallocator:null});let uo=class{constructor(e){this.id=fi(),this._attributes=new Map;for(const[t,i]of e)this._attributes.set(t,{...i,indices:Ks(i.indices)})}get attributes(){return this._attributes}};function ho(e,t){if(!e)return!1;const{size:i,data:r,indices:s}=e;$(t,0,0,0),$(ne,0,0,0);let n=0,o=0;for(let a=0;a<s.length-2;a+=3){const l=s[a]*i,h=s[a+1]*i,c=s[a+2]*i;$(G,r[l],r[l+1],r[l+2]),$(we,r[h],r[h+1],r[h+2]),$(ut,r[c],r[c+1],r[c+2]);const u=rn(G,we,ut);u?(oe(G,G,we),oe(G,G,ut),W(G,G,1/3*u),oe(t,t,G),n+=u):(oe(ne,ne,G),oe(ne,ne,we),oe(ne,ne,ut),o+=3)}return(o!==0||n!==0)&&(n!==0?(W(t,t,1/n),!0):o!==0&&(W(t,ne,1/o),!0))}function fo(e,t){if(!e)return!1;const{size:i,data:r,indices:s}=e;$(t,0,0,0);let n=-1,o=0;for(let a=0;a<s.length;a++){const l=s[a]*i;n!==l&&(t[0]+=r[l],t[1]+=r[l+1],t[2]+=r[l+2],o++),n=l}return o>1&&W(t,t,1/o),o>0}function po(e,t,i){if(!e)return!1;$(i,0,0,0),$(ne,0,0,0);let r=0,s=0;const{size:n,data:o,indices:a}=e,l=a.length-1,h=l+(t?2:0);for(let c=0;c<h;c+=2){const u=c<l?c+1:0,p=a[c<l?c:l]*n,y=a[u]*n;G[0]=o[p],G[1]=o[p+1],G[2]=o[p+2],we[0]=o[y],we[1]=o[y+1],we[2]=o[y+2],W(G,oe(G,G,we),.5);const f=Xs(G,we);f>0?(oe(i,i,W(G,G,f)),r+=f):r===0&&(oe(ne,ne,G),s++)}return r!==0?(W(i,i,1/r),!0):s!==0&&(W(i,ne,1/s),!0)}const G=_(),we=_(),ut=_(),ne=_();let Fr=class{constructor(){this.uid=fi()}},mo=class extends Fr{constructor(e){super(),this.highlightName=e,this.channel=0}},Fc=class extends Fr{constructor(){super(...arguments),this.channel=1}},Dc=class Dr extends uo{constructor(t,i,r=null,s=0,n=null,o=-1,a){super(i),this.material=t,this.mapPositions=r,this.type=s,this.olidColor=n,this.edgeIndicesLength=o,this.baseGeometry=a,this._highlights=null,this._highlightOptionsCounts=null,this.visible=!0,this._boundingInfo=null;const l=this.positionAttribute;l!=null&&this.edgeIndicesLength<0&&(this.edgeIndicesLength=l.indices.length)}instantiate(t={}){const i=new Dr(t.material||this.material,[],this.mapPositions,this.type,this.olidColor,this.edgeIndicesLength,this.baseGeometry);return this._attributes.forEach((r,s)=>{r.exclusive=!1,i._attributes.set(s,r)}),i._boundingInfo=this._boundingInfo,i.transformation=t.transformation||this.transformation,i}getMutableAttribute(t){let i=this._attributes.get(t);return i&&!i.exclusive&&(i={...i,exclusive:!0,data:lo(i.data)},this._attributes.set(t,i)),i}setAttributeData(t,i){const r=this._attributes.get(t);r?this._attributes.set(t,{...r,exclusive:!0,data:i}):ni()&&console.warn(`Setting undefined attribute ${t} data`)}get positionAttribute(){var t;return this.attributes.get("position")??((t=this.baseGeometry)==null?void 0:t.attributes.get("position"))}get indexCount(){var t,i;return((i=(t=this._attributes.values().next().value)==null?void 0:t.indices)==null?void 0:i.length)??0}get faceCount(){return this.indexCount/3}get boundingInfo(){return this._boundingInfo??(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(t){return!!(this.type===0?this._computeAttachmentOriginTriangles(t):this.type===2?this._computeAttachmentOriginLines(t):this._computeAttachmentOriginPoints(t))&&(this._transformation!=null&&ge(t,t,this._transformation),!0)}_computeAttachmentOriginTriangles(t){const i=this.positionAttribute;return ho(i,t)}_computeAttachmentOriginLines(t){const i=this.positionAttribute;return po(i,vo(this.material.parameters,i),t)}_computeAttachmentOriginPoints(t){const i=this.positionAttribute;return fo(i,t)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const t=this.positionAttribute;if(!t||t.indices.length===0)return null;const i=this.type===0?3:1;B(t.indices.length%i===0,"Indexing error: "+t.indices.length+" not divisible by "+i);const r=Ys(t.indices.length/i);return new co(r,i,t)}get transformation(){return this._transformation??Ai}set transformation(t){this._transformation=t&&t!==Ai?Is(t):null}get highlights(){return this._highlights||go}get hasHighlights(){var t;return(((t=this._highlightOptionsCounts)==null?void 0:t.size)??0)>0}foreachHighlightOptions(t){var i;(i=this._highlightOptionsCounts)==null||i.forEach((r,s)=>t(s))}allocateIdAndHighlight(t){const i=new mo(t);return this.addHighlight(i)}addHighlight(t){var s;this._ensureHighlights().add(t);const{highlightName:i}=t,r=(((s=this._highlightOptionsCounts)==null?void 0:s.get(i))??0)+1;return this._ensureHighlightOptionsCounts().set(i,r),t}_ensureHighlights(){let t=this._highlights;return t||(t=new Set,this._highlights=t),t}_ensureHighlightOptionsCounts(){let t=this._highlightOptionsCounts;return t||(t=new Map,this._highlightOptionsCounts=t),t}removeHighlight(t){var i,r,s;if((i=this._highlights)!=null&&i.delete(t)){const{highlightName:n}=t,o=((r=this._highlightOptionsCounts)==null?void 0:r.get(n))??0;o<=1?(s=this._highlightOptionsCounts)==null||s.delete(n):this._ensureHighlightOptionsCounts().set(n,o-1)}}};function vo(e,t){return!(!("isClosed"in e)||!e.isClosed)&&t.indices.length>2}const go=new Set;function _o(e){return e===4||e===5||e===6||e===7||e===8}function Rc(e){return xo(e)||e===3}function Rr(e){return e===9||e===10}function Lc(e){return Lr(e)||Rr(e)}function Lr(e){return e===0}function st(e){return Lr(e)||xi(e)}function Vc(e){return st(e)||e===10}function yo(e){return st(e)||Rr(e)}function xo(e){return yo(e)||Vr(e)}function Vr(e){return e===2}function xi(e){return e===1}function wo(e){return Vr(e)||_o(e)}let bo=class{constructor(e){this._material=e.material,this._techniques=e.techniques,this._output=e.output}dispose(){}get _stippleTextures(){var e;return(e=this._techniques.context)==null?void 0:e.stippleTextures}get _markerTextures(){var e;return(e=this._techniques.context)==null?void 0:e.markerTextures}getTechnique(e,t){return this._techniques.get(e,this._material.getConfiguration(this._output,t))}ensureResources(e){return 2}},So=class{};const Lt=So;let $c=class extends bo{constructor(e){super(e),this._numLoading=0,this._disposed=!1,this._textures=e.textures,this.updateTexture(e.textureId),this._acquire(e.normalTextureId,t=>this._textureNormal=t),this._acquire(e.emissiveTextureId,t=>this._textureEmissive=t),this._acquire(e.occlusionTextureId,t=>this._textureOcclusion=t),this._acquire(e.metallicRoughnessTextureId,t=>this._textureMetallicRoughness=t)}dispose(){super.dispose(),this._texture=Ae(this._texture),this._textureNormal=Ae(this._textureNormal),this._textureEmissive=Ae(this._textureEmissive),this._textureOcclusion=Ae(this._textureOcclusion),this._textureMetallicRoughness=Ae(this._textureMetallicRoughness),this._disposed=!0}ensureResources(e){return this._numLoading===0?2:1}get textureBindParameters(){var e,t,i,r,s;return new To(((e=this._texture)==null?void 0:e.glTexture)??null,((t=this._textureNormal)==null?void 0:t.glTexture)??null,((i=this._textureEmissive)==null?void 0:i.glTexture)??null,((r=this._textureOcclusion)==null?void 0:r.glTexture)??null,((s=this._textureMetallicRoughness)==null?void 0:s.glTexture)??null)}updateTexture(e){this._texture!=null&&e===this._texture.id||(this._texture=Ae(this._texture),this._acquire(e,t=>this._texture=t))}_acquire(e,t){if(e==null)return void t(null);const i=this._textures.acquire(e);if(ys(i))return++this._numLoading,void i.then(r=>{if(this._disposed)return Ae(r),void t(null);t(r)}).finally(()=>--this._numLoading);t(i)}},Mo=class extends Lt{constructor(e=null){super(),this.textureEmissive=e}},To=class extends Mo{constructor(e,t,i,r,s,n,o){super(i),this.texture=e,this.textureNormal=t,this.textureOcclusion=r,this.textureMetallicRoughness=s,this.scale=n,this.normalTextureTransformMatrix=o}},Co=class{constructor(e){this._bits=[...e]}equals(e){return Ms(this._bits,e.bits)}get code(){return this._code??(this._code=String.fromCharCode(...this._bits)),this._code}get bits(){return this._bits}},Po=class extends Lt{constructor(){var e;super(),this._parameterBits=((e=this._parameterBits)==null?void 0:e.map(()=>0))??[],this._parameterNames??(this._parameterNames=[])}get key(){return this._key??(this._key=new Co(this._parameterBits)),this._key}decode(e=this.key){const t=this._parameterBits;this._parameterBits=[...e.bits];const i=this._parameterNames.map(r=>`    ${r}: ${this[r]}`).join(`
`);return this._parameterBits=t,i}};function ht(e={}){return(t,i)=>{var h,c;t.hasOwnProperty("_parameterNames")||Object.defineProperty(t,"_parameterNames",{value:((h=t._parameterNames)==null?void 0:h.slice())??[],configurable:!0,writable:!0}),t.hasOwnProperty("_parameterBits")||Object.defineProperty(t,"_parameterBits",{value:((c=t._parameterBits)==null?void 0:c.slice())??[0],configurable:!0,writable:!0}),t._parameterNames.push(i);const r=e.count||2,s=Math.ceil(Math.log2(r)),n=t._parameterBits;let o=0;for(;n[o]+s>16;)o++,o>=n.length&&n.push(0);const a=n[o],l=(1<<s)-1<<a;n[o]+=s,e.count?Object.defineProperty(t,i,{get(){return(this._parameterBits[o]&l)>>a},set(u){if(this[i]!==u){if(this._key=null,this._parameterBits[o]=this._parameterBits[o]&~l|+u<<a&l,typeof u!="number")throw new wt("internal:invalid-shader-configuration",`Configuration value for ${i} must be a number, got ${typeof u}`);if(e.count==null)throw new wt("internal:invalid-shader-configuration",`Configuration value for ${i} must provide a count option`)}}}):Object.defineProperty(t,i,{get(){return!!((this._parameterBits[o]&l)>>a)},set(u){if(this[i]!==u&&(this._key=null,this._parameterBits[o]=this._parameterBits[o]&~l|+u<<a&l,typeof u!="boolean"))throw new wt("internal:invalid-shader-configuration",`Configuration value for ${i} must be boolean, got ${typeof u}`)}})}}let zo=class extends Po{constructor(){super(...arguments),this.instancedDoublePrecision=!1,this.hasModelTransformation=!1}},et=class extends zo{constructor(){super(...arguments),this.output=0,this.oitPass=0,this.hasSlicePlane=!1,this.hasHighlightMixTexture=!1,this.bindType=1,this.instanced=!1,this.writeDepth=!0}};d([ht({count:11})],et.prototype,"output",void 0),d([ht({count:3})],et.prototype,"oitPass",void 0),d([ht()],et.prototype,"hasSlicePlane",void 0),d([ht()],et.prototype,"hasHighlightMixTexture",void 0);let li=class{constructor(){this._scale=0,this._angleFactor=0,this._minScale=0}update(e,t,i,r){i?(this._scale=Math.min(i.divisor/(t-i.offset),1),this._angleFactor=Oo(e),this._minScale=r!=null?Math.min(i.minPixelSize/r,1):0):(this._scale=1,this._minScale=1,this._angleFactor=1)}apply(e){const{_scale:t,_angleFactor:i,_minScale:r}=this;return e*nt(te(t,1,i),r,1)}applyVec2(e,t){e[0]=this.apply(t[0]),e[1]=this.apply(t[1])}},Nc=class{constructor(){this.evaluator=new li,this.alignmentEvaluator=new li}update(e,t,i,r,s,n){this.evaluator.update(e,t,i,r),this.alignmentEvaluator.update(e,t,s??i,(s?n:null)??r)}};function Oo(e){return Math.abs(e)**3}function kc(e){return!!e&&!0}function Bc(e,t,i,r,s,n){let o=i.screenLength*e.pixelRatio;s!=null&&(Xi.update(r,t,s,n),o=Xi.apply(o));const a=o*Math.tan(.5*e.fovY)/(.5*e.fullHeight);return nt(a*t,i.minWorldLength,i.maxWorldLength)}const Eo=_s();function Gi(e,t){let i=!1;for(const r in t){const s=t[r];s!==void 0&&(Array.isArray(s)?Array.isArray(e[r])&&Eo(s,e[r])||(e[r]=s.slice(),i=!0):e[r]!==s&&(i=!0,e[r]=s))}return i}const Hc={multiply:1,ignore:2,replace:3,tint:4},Xi=new li;let Uc=class{constructor(e,t){this.id=fi(),this.supportsEdges=!1,this._renderPriority=0,this._parameters=new t,Gi(this._parameters,e),this.validateParameters(this._parameters)}get parameters(){return this._parameters}update(e){return!1}setParameters(e,t=!0){Gi(this._parameters,e)&&(this.validateParameters(this._parameters),t&&this._parametersChanged())}validateParameters(e){}shouldRender(e){return this.visible&&this.isVisibleForOutput(e.output)&&(!this.parameters.isDecoration||e.bind.decorations)&&(this.parameters.renderOccluded&e.renderOccludedMask)!==0}isVisibleForOutput(e){return!0}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this._parametersChanged())}_parametersChanged(){var e;(e=this.repository)==null||e.materialChanged(this)}get renderOccludedFlags(){return this.visible?this.parameters.renderOccluded:0}get hasEmissions(){return!1}getConfiguration(e,t,i=new et){return i.output=e,i.hasHighlightMixTexture=e===9&&t.highlightMixTexture!=null,i}},jc=class extends Lt{constructor(){super(...arguments),this.renderOccluded=1,this.isDecoration=!1}};const Ao=an(1,0,1,771);function qc(e,t=!1){switch(e){case 0:return t?yr:ln;case 1:return Ao;case 2:case 3:return null}}function Wc(e){if(e.draped)return null;switch(e.oitPass){case 0:case 2:return e.writeDepth?nn:null;case 1:case 3:return null}}const Gc=5e5,Io={factor:-1,units:-2};function Xc({oitPass:e,enableOffset:t}){return t&&e===1?Io:null}function Yc(e,t=513){return e===0||e===2?t:515}function Kc(e,t){const i=xi(t);return e===1?i?{buffers:[kt,Bt,qs]}:{buffers:[kt,Bt]}:i?{buffers:[kt,Bt]}:null}let Fo=class{constructor(e=0,t=!1,i=!0){this.tolerance=e,this.isVerticalRay=t,this.normalRequired=i}};const ft=bs();function Jc(e,t,i,r,s,n){if(!e.visible)return;const o=ve(Hr,r,i),a=(c,u,p)=>n(c,p,u),{tolerance:l}=t,h=new Fo(l,!1,t.options.normalRequired);if(e.boundingInfo)B(e.type===0),$r(e.boundingInfo,i,o,l,s,h,a);else{const c=e.positionAttribute,u=c.indices;Nr(i,o,0,u.length/3,u,c.data,c.stride,s,h,a)}}const Do=_();function $r(e,t,i,r,s,n,o){if(e==null)return;const a=Ho(i,Do);if(ws(ft,e.bbMin),Ss(ft,e.bbMax),s==null||s.applyToAabb(ft),Uo(ft,t,a,r)){const{primitiveIndices:l,position:h}=e,c=l?l.length:h.indices.length/3;if(c>qo){const u=e.getChildren();if(u!==void 0){for(const p of u)$r(p,t,i,r,s,n,o);return}}Vo(t,i,0,c,h.indices,h.data,h.stride,l,s,n,o)}}const qe=_();function Zc(e,t,i,r,s,n,o,a,l){const{data:h,stride:c}=n;Nr(e,ve(Hr,t,e),i,r,s,h,c,o,a,l)}function Qc(e,t,i,r){if(!i.visible)return;const s=(l,h,c)=>r(l,c,h),{boundingInfo:n}=i;if(n){const{bbMin:l,bbMax:h}=n;if(e<l[0]||e>h[0]||t<l[1]||t>h[1])return}const o=i.positionAttribute,a=o.indices;Ro(e,t,0,a.length/3,a,o,s)}function Ro(e,t,i,r,s,n,o){const{data:a,stride:l}=n;for(let h=i;h<r;++h){const c=3*h,u=l*s[c],p=l*s[c+1],y=l*s[c+2],f=a[u+0]-e,b=a[u+1]-t,w=a[p+0]-e,z=a[p+1]-t,O=a[y+0]-e,C=a[y+1]-t,E=O*z-C*w,D=f*C-b*O,L=w*b-z*f;(E<0||D<0||L<0)&&(E>0||D>0||L>0)||o(0,h,null)}}function Lo(e,t,i,r,s,n,o,a){const l=e[0],h=e[1],c=e[2],u=t[0],p=t[1],y=t[2];for(let f=i;f<r;++f){const b=3*f,w=b+1,z=b+2,O=n*b,C=s[O],E=s[O+1],D=s[O+2],L=n*w,T=n*z,S=s[L]-C,x=s[L+1]-E,A=s[L+2]-D,g=s[T]-C,I=s[T+1]-E,M=s[T+2]-D,R=p*M-I*y,V=y*g-M*u,k=u*I-g*p,N=S*R+x*V+A*k;if(Math.abs(N)<=Br)continue;const J=l-C,ie=h-E,le=c-D,Q=J*R+ie*V+le*k;if(N>0){if(Q<0||Q>N)continue}else if(Q>0||Q<N)continue;const re=ie*A-x*le,de=le*S-A*J,pe=J*x-S*ie,ce=u*re+p*de+y*pe;if(N>0){if(ce<0||Q+ce>N)continue}else if(ce>0||Q+ce<N)continue;const ee=(g*re+I*de+M*pe)/N;ee>=0&&a(ee,f,o?kr(S,x,A,g,I,M,qe):null)}}function Vo(e,t,i,r,s,n,o,a,l,h,c){const u=e[0],p=e[1],y=e[2],f=t[0],b=t[1],w=t[2],{normalRequired:z}=h;for(let O=i;O<r;++O){const C=a[O],E=3*C,D=o*s[E];let L=n[D],T=n[D+1],S=n[D+2];const x=o*s[E+1];let A=n[x],g=n[x+1],I=n[x+2];const M=o*s[E+2];let R=n[M],V=n[M+1],k=n[M+2];l!=null&&([L,T,S]=l.applyToVertex(L,T,S,O),[A,g,I]=l.applyToVertex(A,g,I,O),[R,V,k]=l.applyToVertex(R,V,k,O));const N=A-L,J=g-T,ie=I-S,le=R-L,Q=V-T,re=k-S,de=b*re-Q*w,pe=w*le-re*f,ce=f*Q-le*b,ee=N*de+J*pe+ie*ce;if(Math.abs(ee)<=Br)continue;const $e=u-L,$t=p-T,Nt=y-S,Ne=$e*de+$t*pe+Nt*ce;if(ee>0){if(Ne<0||Ne>ee)continue}else if(Ne>0||Ne<ee)continue;const Mi=$t*ie-J*Nt,Ti=Nt*N-ie*$e,Ci=$e*J-N*$t,ot=f*Mi+b*Ti+w*Ci;if(ee>0){if(ot<0||Ne+ot>ee)continue}else if(ot>0||Ne+ot<ee)continue;const Pi=(le*Mi+Q*Ti+re*Ci)/ee;Pi>=0&&c(Pi,C,z?kr(N,J,ie,le,Q,re,qe):null)}}function Nr(e,t,i,r,s,n,o,a,l,h){const c=t,u=Wo,p=Math.abs(c[0]),y=Math.abs(c[1]),f=Math.abs(c[2]),b=p>=y?p>=f?0:2:y>=f?1:2,w=b,z=c[w]<0?2:1,O=(b+z)%3,C=(b+(3-z))%3,E=c[O]/c[w],D=c[C]/c[w],L=1/c[w],T=$o,S=No,x=ko,{normalRequired:A}=l;for(let g=i;g<r;++g){const I=3*g,M=o*s[I];$(u[0],n[M+0],n[M+1],n[M+2]);const R=o*s[I+1];$(u[1],n[R+0],n[R+1],n[R+2]);const V=o*s[I+2];$(u[2],n[V+0],n[V+1],n[V+2]),a&&(j(u[0],a.applyToVertex(u[0][0],u[0][1],u[0][2],g)),j(u[1],a.applyToVertex(u[1][0],u[1][1],u[1][2],g)),j(u[2],a.applyToVertex(u[2][0],u[2][1],u[2][2],g))),ve(T,u[0],e),ve(S,u[1],e),ve(x,u[2],e);const k=T[O]-E*T[w],N=T[C]-D*T[w],J=S[O]-E*S[w],ie=S[C]-D*S[w],le=x[O]-E*x[w],Q=x[C]-D*x[w],re=le*ie-Q*J,de=k*Q-N*le,pe=J*N-ie*k;if((re<0||de<0||pe<0)&&(re>0||de>0||pe>0))continue;const ce=re+de+pe;if(ce===0)continue;const ee=re*(L*T[w])+de*(L*S[w])+pe*(L*x[w]);if(ee*Math.sign(ce)<0)continue;const $e=ee/ce;$e>=0&&h($e,g,A?Bo(u):null)}}const $o=_(),No=_(),ko=_();function kr(e,t,i,r,s,n,o){return $(Et,e,t,i),$(At,r,s,n),fe(o,Et,At),Pe(o,o),o}function Bo(e){return ve(Et,e[1],e[0]),ve(At,e[2],e[0]),fe(qe,Et,At),Pe(qe,qe),qe}const Et=_(),At=_();function Ho(e,t){return $(t,1/e[0],1/e[1],1/e[2])}function Uo(e,t,i,r){return jo(e,t,i,r,1/0)}function jo(e,t,i,r,s){const n=(e[0]-r-t[0])*i[0],o=(e[3]+r-t[0])*i[0];let a=Math.min(n,o),l=Math.max(n,o);const h=(e[1]-r-t[1])*i[1],c=(e[4]+r-t[1])*i[1];if(l=Math.min(l,Math.max(h,c)),l<0||(a=Math.max(a,Math.min(h,c)),a>l))return!1;const u=(e[2]-r-t[2])*i[2],p=(e[5]+r-t[2])*i[2];return l=Math.min(l,Math.max(u,p)),!(l<0)&&(a=Math.max(a,Math.min(u,p)),!(a>l)&&a<s)}const qo=1e3,Br=1e-7,Hr=_(),Wo=[_(),_(),_()];let eu=class{constructor(){this._transform=X(),this._transformInverse=new dt({value:this._transform},St,X),this._transformInverseTranspose=new dt(this._transformInverse,ai,X),this._transformTranspose=new dt({value:this._transform},ai,X),this._transformInverseRotation=new dt({value:this._transform},Rs,ur)}_invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(e){Ge(this._transform,e)}multiplyTransform(e){zt(this._transform,this._transform,e)}set(e){Ge(this._transform,e),this._invalidateLazyTransforms()}setAndInvalidateLazyTransforms(e,t){this.setTransformMatrix(e),this.multiplyTransform(t),this._invalidateLazyTransforms()}},dt=class{constructor(e,t,i){this._original=e,this._update=t,this._dirty=!0,this._transform=i()}invalidate(){this._dirty=!0}get value(){return this._dirty&&(this._update(this._transform,this._original.value),this._dirty=!1),this._transform}},Go=class{constructor(e=0){this.componentLocalOriginLength=0,this._totalOffset=0,this._offset=0,this._tmpVertex=_(),this._tmpMbs=Rt(),this._tmpObb=new Fn,this._resetOffset(e)}_resetOffset(e){this._offset=e,this._totalOffset=e}set offset(e){this._resetOffset(e)}get offset(){return this._offset}set componentOffset(e){this._totalOffset=this._offset+e}set localOrigin(e){this.componentLocalOriginLength=Y(e)}applyToVertex(e,t,i){const r=$(Ur,e,t,i),s=$(Yo,e,t,i+this.componentLocalOriginLength),n=this._totalOffset/Y(s);return Se(this._tmpVertex,r,s,n),this._tmpVertex}applyToAabb(e){const t=this.componentLocalOriginLength,i=e[0],r=e[1],s=e[2]+t,n=e[3],o=e[4],a=e[5]+t,l=Math.abs(i),h=Math.abs(r),c=Math.abs(s),u=Math.abs(n),p=Math.abs(o),y=Math.abs(a),f=.5*(1+Math.sign(i*n))*Math.min(l,u),b=.5*(1+Math.sign(r*o))*Math.min(h,p),w=.5*(1+Math.sign(s*a))*Math.min(c,y),z=Math.max(l,u),O=Math.max(h,p),C=Math.max(c,y),E=Math.sqrt(f*f+b*b+w*w),D=Math.sign(l+i),L=Math.sign(h+r),T=Math.sign(c+s),S=Math.sign(u+n),x=Math.sign(p+o),A=Math.sign(y+a),g=this._totalOffset;if(E<g)return e[0]-=(1-D)*g,e[1]-=(1-L)*g,e[2]-=(1-T)*g,e[3]+=S*g,e[4]+=x*g,e[5]+=A*g,e;const I=g/Math.sqrt(z*z+O*O+C*C),M=g/E,R=M-I,V=-R;return e[0]+=i*(D*V+M),e[1]+=r*(L*V+M),e[2]+=s*(T*V+M),e[3]+=n*(S*R+I),e[4]+=o*(x*R+I),e[5]+=a*(A*R+I),e}applyToMbs(e){const t=Cr(e),i=Y(t),r=this._totalOffset/i,s=Se(jr,t,t,r),n=e[3]+e[3]*this._totalOffset/i;return Pr(this._tmpMbs,s,n),this._tmpMbs}applyToObb(e){return Dn(e,this._totalOffset,this._totalOffset,1,this._tmpObb),this._tmpObb}},Xo=class{constructor(e=0){this.offset=e,this.sphere=Rt(),this.tmpVertex=_()}applyToVertex(e,t,i){const r=this.objectTransform.transform,s=$(Ur,e,t,i),n=ge(s,s,r),o=this.offset/Y(n);Se(n,n,n,o);const a=this.objectTransform.inverse;return ge(this.tmpVertex,n,a),this.tmpVertex}applyToMinMax(e,t){const i=this.offset/Y(e);Se(e,e,e,i);const r=this.offset/Y(t);Se(t,t,t,r)}applyToAabb(e){const t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;const i=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*i,e[4]+=e[4]*i,e[5]+=e[5]*i,e}applyToBoundingSphere(e){const t=Cr(e),i=Y(t),r=this.offset/i,s=Se(jr,t,t,r),n=e[3]+e[3]*this.offset/i;return Pr(this.sphere,s,n),this.sphere}};const Yi=new Xo;function tu(e){return e!=null?(Yi.offset=e,Yi):null}new Go;const Ur=_(),Yo=_(),jr=_();function iu(e,t,i,r=1){const{data:s,indices:n}=e,o=t.typedBuffer,a=t.typedBufferStride,l=n.length;if(i*=a,r===1)for(let h=0;h<l;++h)o[i]=s[n[h]],i+=a;else for(let h=0;h<l;++h){const c=s[n[h]];for(let u=0;u<r;u++)o[i]=c,i+=a}}function jt(e,t,i){const{data:r,indices:s}=e,n=t.typedBuffer,o=t.typedBufferStride,a=s.length;i*=o;for(let l=0;l<a;++l){const h=2*s[l];n[i]=r[h],n[i+1]=r[h+1],i+=o}}function wi(e,t,i,r=1){const{data:s,indices:n}=e,o=t.typedBuffer,a=t.typedBufferStride,l=n.length;if(i*=a,r===1)for(let h=0;h<l;++h){const c=3*n[h];o[i]=s[c],o[i+1]=s[c+1],o[i+2]=s[c+2],i+=a}else for(let h=0;h<l;++h){const c=3*n[h];for(let u=0;u<r;++u)o[i]=s[c],o[i+1]=s[c+1],o[i+2]=s[c+2],i+=a}}function qr(e,t,i,r=1){const{data:s,indices:n}=e,o=t.typedBuffer,a=t.typedBufferStride,l=n.length;if(i*=a,r===1)for(let h=0;h<l;++h){const c=4*n[h];o[i]=s[c],o[i+1]=s[c+1],o[i+2]=s[c+2],o[i+3]=s[c+3],i+=a}else for(let h=0;h<l;++h){const c=4*n[h];for(let u=0;u<r;++u)o[i]=s[c],o[i+1]=s[c+1],o[i+2]=s[c+2],o[i+3]=s[c+3],i+=a}}function ru(e,t,i){const r=e.typedBuffer,s=e.typedBufferStride;t*=s;for(let n=0;n<i;++n)r[t]=0,r[t+1]=0,r[t+2]=0,r[t+3]=0,t+=s}function Ko(e,t,i,r,s=1){if(!t)return void wi(e,i,r,s);const{data:n,indices:o}=e,a=i.typedBuffer,l=i.typedBufferStride,h=o.length,c=t[0],u=t[1],p=t[2],y=t[4],f=t[5],b=t[6],w=t[8],z=t[9],O=t[10],C=t[12],E=t[13],D=t[14];r*=l;let L=0,T=0,S=0;const x=xr(t)?A=>{L=n[A]+C,T=n[A+1]+E,S=n[A+2]+D}:A=>{const g=n[A],I=n[A+1],M=n[A+2];L=c*g+y*I+w*M+C,T=u*g+f*I+z*M+E,S=p*g+b*I+O*M+D};if(s===1)for(let A=0;A<h;++A)x(3*o[A]),a[r]=L,a[r+1]=T,a[r+2]=S,r+=l;else for(let A=0;A<h;++A){x(3*o[A]);for(let g=0;g<s;++g)a[r]=L,a[r+1]=T,a[r+2]=S,r+=l}}function Jo(e,t,i,r,s=1){if(!t)return void wi(e,i,r,s);const{data:n,indices:o}=e,a=t,l=i.typedBuffer,h=i.typedBufferStride,c=o.length,u=a[0],p=a[1],y=a[2],f=a[4],b=a[5],w=a[6],z=a[8],O=a[9],C=a[10],E=!wr(a),D=1e-6,L=1-D;r*=h;let T=0,S=0,x=0;const A=xr(a)?g=>{T=n[g],S=n[g+1],x=n[g+2]}:g=>{const I=n[g],M=n[g+1],R=n[g+2];T=u*I+f*M+z*R,S=p*I+b*M+O*R,x=y*I+w*M+C*R};if(s===1)if(E)for(let g=0;g<c;++g){A(3*o[g]);const I=T*T+S*S+x*x;if(I<L&&I>D){const M=1/Math.sqrt(I);l[r]=T*M,l[r+1]=S*M,l[r+2]=x*M}else l[r]=T,l[r+1]=S,l[r+2]=x;r+=h}else for(let g=0;g<c;++g)A(3*o[g]),l[r]=T,l[r+1]=S,l[r+2]=x,r+=h;else for(let g=0;g<c;++g){if(A(3*o[g]),E){const I=T*T+S*S+x*x;if(I<L&&I>D){const M=1/Math.sqrt(I);T*=M,S*=M,x*=M}}for(let I=0;I<s;++I)l[r]=T,l[r+1]=S,l[r+2]=x,r+=h}}function Zo(e,t,i,r,s=1){if(!t)return void qr(e,i,r,s);const{data:n,indices:o}=e,a=t,l=i.typedBuffer,h=i.typedBufferStride,c=o.length,u=a[0],p=a[1],y=a[2],f=a[4],b=a[5],w=a[6],z=a[8],O=a[9],C=a[10],E=!wr(a),D=1e-6,L=1-D;if(r*=h,s===1)for(let T=0;T<c;++T){const S=4*o[T],x=n[S],A=n[S+1],g=n[S+2],I=n[S+3];let M=u*x+f*A+z*g,R=p*x+b*A+O*g,V=y*x+w*A+C*g;if(E){const k=M*M+R*R+V*V;if(k<L&&k>D){const N=1/Math.sqrt(k);M*=N,R*=N,V*=N}}l[r]=M,l[r+1]=R,l[r+2]=V,l[r+3]=I,r+=h}else for(let T=0;T<c;++T){const S=4*o[T],x=n[S],A=n[S+1],g=n[S+2],I=n[S+3];let M=u*x+f*A+z*g,R=p*x+b*A+O*g,V=y*x+w*A+C*g;if(E){const k=M*M+R*R+V*V;if(k<L&&k>D){const N=1/Math.sqrt(k);M*=N,R*=N,V*=N}}for(let k=0;k<s;++k)l[r]=M,l[r+1]=R,l[r+2]=V,l[r+3]=I,r+=h}}function Qo(e,t,i,r,s=1){const{data:n,indices:o}=e,a=i.typedBuffer,l=i.typedBufferStride,h=o.length;if(r*=l,t===n.length&&t===4){a[r]=n[0],a[r+1]=n[1],a[r+2]=n[2],a[r+3]=n[3];const c=new Uint32Array(i.typedBuffer.buffer,i.start),u=l/4,p=c[r/=4];r+=u;const y=h*s;for(let f=1;f<y;++f)c[r]=p,r+=u;return}if(s!==1)if(t!==4)for(let c=0;c<h;++c){const u=3*o[c];for(let p=0;p<s;++p)a[r]=n[u],a[r+1]=n[u+1],a[r+2]=n[u+2],a[r+3]=255,r+=l}else for(let c=0;c<h;++c){const u=4*o[c];for(let p=0;p<s;++p)a[r]=n[u],a[r+1]=n[u+1],a[r+2]=n[u+2],a[r+3]=n[u+3],r+=l}else{if(t===4){for(let c=0;c<h;++c){const u=4*o[c];a[r]=n[u],a[r+1]=n[u+1],a[r+2]=n[u+2],a[r+3]=n[u+3],r+=l}return}for(let c=0;c<h;++c){const u=3*o[c];a[r]=n[u],a[r+1]=n[u+1],a[r+2]=n[u+2],a[r+3]=255,r+=l}}}function ea(e,t,i){const{data:r,indices:s}=e,n=t.typedBuffer,o=t.typedBufferStride,a=s.length,l=r[0];i*=o;for(let h=0;h<a;++h)n[i]=l,i+=o}function su(e,t,i,r){Te(De,e,t);const s=Math.max(Math.sqrt(Y(De)),1e-4);W(De,De,1/s),i[r++]=De[0],i[r++]=De[1],i[r++]=De[2],i[r++]=s}const De=_();function ta(e,t,i,r,s=1){const n=t.typedBuffer,o=t.typedBufferStride;if(r*=o,s===1)for(let a=0;a<i;++a)n[r]=e[0],n[r+1]=e[1],n[r+2]=e[2],n[r+3]=e[3],r+=o;else for(let a=0;a<i;++a)for(let l=0;l<s;++l)n[r]=e[0],n[r+1]=e[1],n[r+2]=e[2],n[r+3]=e[3],r+=o}function ia(e,t,i,r,s,n,o){var l;let a={numItems:0,numVerticesPerItem:0};for(const h of i.fields.keys()){const c=e.get(h),u=c==null?void 0:c.indices;if(c&&u)h==="position"&&(a={numItems:1,numVerticesPerItem:u.length}),ra(h,c,r,s,n,o);else if(h==="olidColor"&&t!=null){const p=(l=e.get("position"))==null?void 0:l.indices;if(p){const y=p.length;ta(t,n.getField(h,_r),y,o)}}}return a}function ra(e,t,i,r,s,n){switch(e){case"position":{B(t.size===3);const o=s.getField(e,bt);B(!!o,`No buffer view for ${e}`),Ko(t,i,o,n);break}case"normal":{B(t.size===3);const o=s.getField(e,bt);B(!!o,`No buffer view for ${e}`),Jo(t,r,o,n);break}case"normalCompressed":case"profileRight":case"profileUp":{B(t.size===2);const o=s.getField(e,Ri);B(!!o,`No buffer view for ${e}`),jt(t,o,n);break}case"uv0":{B(t.size===2);const o=s.getField(e,Qs)??s.getField(e,en);B(!!o,`No buffer view for ${e}`),jt(t,o,n);break}case"uvi":{B(t.size===2);const o=s.getField(e,Ri);B(!!o,`No buffer view for ${e}`),jt(t,o,n);break}case"color":case"symbolColor":{const o=s.getField(e,_r);B(!!o,`No buffer view for ${e}`),B(t.size===3||t.size===4),Qo(t,t.size,o,n);break}case"colorFeatureAttribute":case"opacityFeatureAttribute":case"sizeFeatureAttribute":{const o=s.getField(e,Di)??s.getField(e,Di);B(!!o,`No buffer view for ${e}`),B(t.size===1),ea(t,o,n);break}case"tangent":{B(t.size===4);const o=s.getField(e,Fi);B(!!o,`No buffer view for ${e}`),Zo(t,i,o,n);break}case"profileVertexAndNormal":{B(t.size===4);const o=s.getField(e,Zs)??s.getField(e,Fi);B(!!o,`No buffer view for ${e}`),qr(t,o,n);break}case"profileAuxData":{B(t.size===3);const o=s.getField(e,Js)??s.getField(e,bt);B(!!o,`No buffer view for ${e}`),wi(t,o,n);break}}}let nu=class{constructor(e){this.layout=e}elementCount(e){return e.get("position").indices.length}write(e,t,i,r,s,n){return ia(i,r,this.layout,e,t,s,n)}intersect(e,t,i,r,s,n,o){const a=this.layout.createView(e).getField("position",bt);if(a==null)return;const l=ve(sa,n,s),h=0,c=a.count/3,u=r.options.normalRequired,p=(y,f,b)=>o(y,b,f);Lo(s,l,h,c,a.typedBuffer,a.typedBufferStride,u,p)}};const sa=_();let U=class{constructor(e,t,i,r,s=null){if(this.name=e,this.type=t,this.arraySize=s,this.bind={0:null,1:null,2:null},r)switch(i){case void 0:break;case 0:this.bind[0]=r;break;case 1:this.bind[1]=r;break;case 2:this.bind[2]=r}}equals(e){return this.type===e.type&&this.name===e.name&&this.arraySize===e.arraySize}},na=class extends U{constructor(e,t,i){super(e,"float",0,(r,s)=>r.setUniform1f(e,t(s),i))}},Ce=class extends U{constructor(e,t,i){super(e,"vec3",2,(r,s,n,o)=>r.setUniform3fv(e,t(s,n,o),i))}},xe=class extends U{constructor(e,t,i){super(e,"vec3",1,(r,s,n)=>r.setUniform3fv(e,t(s,n),i))}},oa=class extends U{constructor(e,t,i){super(e,"mat3",1,(r,s,n)=>r.setUniformMatrix3fv(e,t(s,n),i))}},ou=class extends U{constructor(e,t,i){super(e,"mat4",1,(r,s,n)=>r.setUniformMatrix4fv(e,t(s,n),i))}},au=class{constructor(e,t){this._module=e,this._load=t}get(){return this._module}async reload(){return this._module=await this._load(),this._module}},Ki=class{constructor(e,t,i){this._context=e,this.locations=i,this._textures=new Map,this.source=ni()?t:null,t.attributeNames.forEach(r=>{i.has(r)||console.error(`Missing VertexAttributeLocation for ${r} used in shader`)}),this._glProgram=e.programCache.acquire(t.generate("vertex",!0),t.generate("fragment",!0),i),this._glProgram.stop=()=>{throw new Error("Wrapped _glProgram used directly")},this.bind=t.generateBind(this),this.bindPass=t.generateBindPass(this),this.bindDraw=t.generateBindDraw(this)}dispose(){this._glProgram.dispose()}get glName(){return this._glProgram.glName}get hasTransformFeedbackVaryings(){return this._glProgram.hasTransformFeedbackVaryings}get compiled(){return this._glProgram.compiled}setUniform1b(e,t){this._glProgram.setUniform1i(e,t?1:0)}setUniform1i(e,t){this._glProgram.setUniform1i(e,t)}setUniform1f(e,t,i){this._glProgram.setUniform1f(e,t,i)}setUniform2fv(e,t,i){this._glProgram.setUniform2fv(e,t,i)}setUniform3fv(e,t,i){this._glProgram.setUniform3fv(e,t,i)}setUniform4fv(e,t,i){this._glProgram.setUniform4fv(e,t,i)}setUniformMatrix3fv(e,t,i){this._glProgram.setUniformMatrix3fv(e,t,!1,i)}setUniformMatrix4fv(e,t,i){this._glProgram.setUniformMatrix4fv(e,t,!1,i)}setUniformMatrices4fv(e,t,i){this._glProgram.setUniformMatrices4fv(e,t,!1,i)}setUniform1fv(e,t,i){this._glProgram.setUniform1fv(e,t,i)}setUniform1iv(e,t){this._glProgram.setUniform1iv(e,t)}setUniform2iv(e,t){this._glProgram.setUniform2iv(e,t)}setUniform3iv(e,t){this._glProgram.setUniform3iv(e,t)}setUniform4iv(e,t){this._glProgram.setUniform4iv(e,t)}assertCompatibleVertexAttributeLocations(e,t){let i=e.locations;if(t){const r=new Map(i);t.forEach((s,n)=>r.set(n,i.size+s)),i=r}i.size!==this.locations.size&&console.error(`VertexAttributeLocations are incompatible: ${i}, ${this.locations}`),this.locations.forEach((r,s)=>{i.get(s)!==r&&console.error(`VertexAttributeLocations are incompatible: Program has ${s} at position ${r}, VAO has it at position ${i.get(s)}.`)})}stop(){this._textures.clear()}bindTexture(e,t){t!=null&&t.glName||(ni()&&console.error(`Texture sampler ${e} has no given Texture in ${new Error().stack} `),t=this._context.emptyTexture);const i=this._ensureTextureUnit(e,t);this._context.useProgram(this),this.setUniform1i(e,i.unit),this._context.bindTexture(t,i.unit)}_ensureTextureUnit(e,t){let i=this._textures.get(e);return i==null?(i={texture:t,unit:this._textures.size},this._textures.set(e,i)):i.texture=t,i}};const aa=()=>pi.getLogger("esri.views.3d.webgl.ShaderTechnique");let lu=class{constructor(e,t,i,r){this.primitiveType=Us.TRIANGLES,this.key=t.key,this._program=new Ki(e.rctx,i.get().build(t),r),this._pipeline=this.initializePipeline(t),this.reload=async s=>{s&&await i.reload(),this.key.equals(t.key)||aa().warn("Configuration was changed after construction, cannot reload shader.",i),zi(this._program),this._program=new Ki(e.rctx,i.get().build(t),r),this._pipeline=this.initializePipeline(t)}}destroy(){this._program=zi(this._program),this._pipeline=null}get program(){return this._program}get compiled(){return this.program.compiled}ensureAttributeLocations(e){this.program.assertCompatibleVertexAttributeLocations(e)}getPipeline(e,t){return this._pipeline}initializePipeline(e){return sn({blending:yr,colorWrite:on})}};function cu(e,t){return wo(e)?{buffers:[js]}:t??null}function la(){return!!xs("enable-feature:objectAndLayerId-rendering")}const uu={func:513},hu={func:519},fu={mask:255},du={mask:0},pu={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},mu={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},vu={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},gu={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}};function _u(e,t){ua(e,t,new Ce("slicePlaneOrigin",(i,r)=>Kr(t,i,r)),new Ce("slicePlaneBasis1",(i,r)=>{var s;return It(t,i,r,(s=r.slicePlane)==null?void 0:s.basis1)}),new Ce("slicePlaneBasis2",(i,r)=>{var s;return It(t,i,r,(s=r.slicePlane)==null?void 0:s.basis2)}))}function yu(e,t){Wr(e,t,new Ce("slicePlaneOrigin",(i,r)=>Kr(t,i,r)),new Ce("slicePlaneBasis1",(i,r)=>{var s;return It(t,i,r,(s=r.slicePlane)==null?void 0:s.basis1)}),new Ce("slicePlaneBasis2",(i,r)=>{var s;return It(t,i,r,(s=r.slicePlane)==null?void 0:s.basis2)}))}const ca=v`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
bool rejectBySlice(vec3 pos) {
return sliceByPlane(pos);
}`;function Wr(e,t,...i){t.hasSlicePlane?(e.uniforms.add(...i),e.code.add(ca)):e.code.add("bool rejectBySlice(vec3 pos) { return false; }")}function ua(e,t,...i){Wr(e,t,...i),t.hasSlicePlane?e.code.add(`
    void discardBySlice(vec3 pos) {
      if (sliceByPlane(pos)) {
        discard;
      }
    }

    vec4 applySliceOutline(vec4 color, vec3 pos) {
      SliceFactors factors = calculateSliceFactors(pos);

      factors.front /= 2.0 * fwidth(factors.front);
      factors.side0 /= 2.0 * fwidth(factors.side0);
      factors.side1 /= 2.0 * fwidth(factors.side1);
      factors.side2 /= 2.0 * fwidth(factors.side2);
      factors.side3 /= 2.0 * fwidth(factors.side3);

      // return after calling fwidth, to avoid aliasing caused by discontinuities in the input to fwidth
      if (sliceByFactors(factors)) {
        return color;
      }

      float outlineFactor = (1.0 - step(0.5, factors.front))
        * (1.0 - step(0.5, factors.side0))
        * (1.0 - step(0.5, factors.side1))
        * (1.0 - step(0.5, factors.side2))
        * (1.0 - step(0.5, factors.side3));

      return mix(color, vec4(vec3(0.0), color.a), outlineFactor * 0.3);
    }

    vec4 applySlice(vec4 color, vec3 pos) {
      return sliceEnabled() ? applySliceOutline(color, pos) : color;
    }
  `):e.code.add(v`void discardBySlice(vec3 pos) { }
vec4 applySlice(vec4 color, vec3 pos) { return color; }`)}function Gr(e,t,i){return e.instancedDoublePrecision?$(ha,i.camera.viewInverseTransposeMatrix[3],i.camera.viewInverseTransposeMatrix[7],i.camera.viewInverseTransposeMatrix[11]):t.slicePlaneLocalOrigin}function Xr(e,t){return e!=null?Te(Ft,t.origin,e):t.origin}function Yr(e,t,i){return e.hasSliceTranslatedView?t!=null?Pt(fa,i.camera.viewMatrix,t):i.camera.viewMatrix:null}function Kr(e,t,i){if(i.slicePlane==null)return it;const r=Gr(e,t,i),s=Xr(r,i.slicePlane),n=Yr(e,r,i);return n!=null?ge(Ft,s,n):s}function It(e,t,i,r){if(r==null||i.slicePlane==null)return it;const s=Gr(e,t,i),n=Xr(s,i.slicePlane),o=Yr(e,s,i);return o!=null?(oe(Ye,r,n),ge(Ft,n,o),ge(Ye,Ye,o),Te(Ye,Ye,Ft)):r}const ha=_(),Ft=_(),Ye=_(),fa=X();let bi=class extends U{constructor(e,t,i){super(e,"vec2",0,(r,s)=>r.setUniform2fv(e,t(s),i))}};function xu(e){e.vertex.uniforms.add(new bi("nearFar",t=>t.camera.nearFar))}function da(e){e.vertex.code.add(v`float calculateLinearDepth(vec2 nearFar,float z) {
return (-z - nearFar[0]) / (nearFar[1] - nearFar[0]);
}`)}function wu(e){da(e),e.vertex.code.add(v`vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * vec4(pos, 1.0);
depth = calculateLinearDepth(nearFar,eye.z);
return proj * eye;
}`),e.vertex.code.add(v`vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
return proj * (view * vec4(pos, 1.0));
}`)}function Vt(e){e.code.add(v`struct MaskedColor {
vec4 color;
bvec4 mask;
};`)}function bu(e){e.include(Vt),e.code.add(v`
    MaskedColor createMaskedFromUInt8NaNColor(vec4 color) {
      return MaskedColor(color * ${v.float(1/254)}, equal(color, vec4(255)));
    }
  `)}function pa(e){e.include(Vt),e.code.add(v`vec4 maskedColorSelectOrOne(MaskedColor color) {
return vec4(
color.mask.r ? 1.0 : color.color.r,
color.mask.g ? 1.0 : color.color.g,
color.mask.b ? 1.0 : color.color.b,
color.mask.a ? 1.0 : color.color.a
);
}
MaskedColor multiplyMaskedColors(MaskedColor color1, MaskedColor color2) {
vec4 masked1 = maskedColorSelectOrOne(color1);
vec4 masked2 = maskedColorSelectOrOne(color2);
return MaskedColor(masked1 * masked2, bvec4(ivec4(color1.mask) & ivec4(color2.mask)));
}`)}function ma(e){e.include(Vt),e.code.add(v`MaskedColor createMaskedFromNaNColor(vec4 color) {
return MaskedColor(color, isnan(color));
}`)}let va=class extends U{constructor(e,t,i){super(e,"vec3",0,(r,s)=>r.setUniform3fv(e,t(s),i))}},Mt=class extends U{constructor(e,t,i){super(e,"mat4",0,(r,s)=>r.setUniformMatrix4fv(e,t(s),i))}},ga=class extends U{constructor(e,t,i){super(e,"mat4",2,(r,s,n)=>r.setUniformMatrix4fv(e,t(s,n),i))}};function _a(e,t){t.instancedDoublePrecision?e.constants.add("cameraPosition","vec3",it):e.uniforms.add(new Ce("cameraPosition",(i,r)=>$(Jr,r.camera.viewInverseTransposeMatrix[3]-i.origin[0],r.camera.viewInverseTransposeMatrix[7]-i.origin[1],r.camera.viewInverseTransposeMatrix[11]-i.origin[2])))}function Su(e,t){if(!t.instancedDoublePrecision)return void e.uniforms.add(new Mt("proj",r=>r.camera.projectionMatrix),new ga("view",(r,s)=>Pt(Ji,s.camera.viewMatrix,r.origin)),new Ce("localOrigin",r=>r.origin));const i=({camera:r})=>$(Jr,r.viewInverseTransposeMatrix[3],r.viewInverseTransposeMatrix[7],r.viewInverseTransposeMatrix[11]);e.uniforms.add(new Mt("proj",r=>r.camera.projectionMatrix),new Mt("view",r=>Pt(Ji,r.camera.viewMatrix,i(r))),new va("localOrigin",r=>i(r)))}const Ji=X(),Jr=_();function Mu(e){e.uniforms.add(new Mt("viewNormal",t=>t.camera.viewInverseTransposeMatrix))}function Tu(e){e.uniforms.add(new na("pixelRatio",t=>t.camera.pixelRatio/t.overlayStretch))}function Cu(e,t,i){for(let r=0;r<i;++r)t[2*r]=e[r],t[2*r+1]=e[r]-t[2*r]}function Pu(e,t){const i=e.length;for(let r=0;r<i;++r)We[0]=e[r],t[r]=We[0];return t}function zu(e,t){const i=e.length;for(let r=0;r<i;++r)We[0]=e[r],We[1]=e[r]-We[0],t[r]=We[1];return t}const We=new Float32Array(2);let Ou=class extends U{constructor(e,t){super(e,"int",1,(i,r,s)=>i.setUniform1i(e,t(r,s)))}};function ya(e,t){switch(t.textureCoordinateType){case 1:return e.attributes.add("uv0","vec2"),e.varyings.add("vuv0","vec2"),void e.vertex.code.add(v`void forwardTextureCoordinates() { vuv0 = uv0; }`);case 2:return e.attributes.add("uv0","vec2"),e.attributes.add("uvRegion","vec4"),e.varyings.add("vuv0","vec2"),e.varyings.add("vuvRegion","vec4"),void e.vertex.code.add(v`void forwardTextureCoordinates() {
vuv0 = uv0;
vuvRegion = uvRegion;
}`);default:Ts(t.textureCoordinateType);case 0:return void e.vertex.code.add(v`void forwardTextureCoordinates() {}`);case 3:return}}function Eu(e,t){t.hasVertexColors?(e.attributes.add("color","vec4"),e.varyings.add("vColor","vec4"),e.vertex.code.add(v`void forwardVertexColor() { vColor = color; }`),e.vertex.code.add(v`
      void forwardNormalizedVertexColor() { vColor = color * ${v.float(1/255)}; }
    `)):e.vertex.code.add(v`void forwardVertexColor() {}
void forwardNormalizedVertexColor() {}`)}function xa(e){e.vertex.code.add(v`float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {
return absCosAngle * absCosAngle * absCosAngle;
}`),e.vertex.code.add(v`vec3 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec3 params) {
return vec3(
min(params.x / (distanceToCamera - params.y), 1.0),
screenSizePerspectiveViewAngleDependentFactor(absCosAngle),
params.z
);
}`),e.vertex.code.add(v`float applyScreenSizePerspectiveScaleFactorFloat(float size, vec3 factor) {
return size * clamp(mix(factor.x, 1.0, factor.y), factor.z, 1.0);
}`),e.vertex.code.add(v`float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec3 params) {
return applyScreenSizePerspectiveScaleFactorFloat(
size,
screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)
);
}`),e.vertex.code.add(v`vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec3 factor) {
return size * clamp(mix(factor.x, 1.0, factor.y), factor.z, 1.0);
}`),e.vertex.code.add(v`vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec3 params) {
return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));
}`)}function Au(e){e.uniforms.add(new xe("screenSizePerspective",t=>Zr(t.screenSizePerspective,t.screenSizePerspectiveMinPixelReferenceSize)))}function wa(e){e.uniforms.add(new xe("screenSizePerspectiveAlignment",t=>Zr(t.screenSizePerspectiveAlignment||t.screenSizePerspective,t.screenSizePerspectiveAlignment?null:t.screenSizePerspectiveMinPixelReferenceSize)))}function Zr(e,t){const i=t!=null&&e!=null?Math.min(e.minPixelSize/t,1):0;return e?$(Zi,e.divisor,e.offset,i):$(Zi,0,0,0)}const Zi=_();let Qr=class extends U{constructor(e,t,i){super(e,"vec4",1,(r,s,n)=>r.setUniform4fv(e,t(s,n),i))}},Iu=class{constructor(e){this.screenLength=Ls(e.screenLength),this.minWorldLength=e.minWorldLength??0,this.maxWorldLength=e.maxWorldLength??1/0}};function Fu(e,t){const i=e.vertex;t.hasVerticalOffset?(Sa(i),t.hasScreenSizePerspective&&(e.include(xa),wa(i),_a(e.vertex,t)),i.code.add(v`
      vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {
        float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);
        ${t.spherical?v`vec3 worldNormal = normalize(worldPos + localOrigin);`:v`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}
        ${t.hasScreenSizePerspective?v`
            float cosAngle = dot(worldNormal, normalize(worldPos - cameraPosition));
            float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:v`
            float verticalOffsetScreenHeight = verticalOffset.x;`}
        // Screen sized offset in world space, used for example for line callouts
        float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);
        return worldNormal * worldOffset;
      }

      vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {
        return worldPos + calculateVerticalOffset(worldPos, localOrigin);
      }
    `)):i.code.add(v`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`)}const ba=Re();function Sa(e){e.uniforms.add(new Qr("verticalOffset",(t,i)=>{const{minWorldLength:r,maxWorldLength:s,screenLength:n}=t.verticalOffset,o=Math.tan(.5*i.camera.fovY)/(.5*i.camera.fullViewport[3]),a=i.camera.pixelRatio||1;return Ot(ba,n*a,o,r,s)}))}function Du(e,t){if(t.output!==10)return e.vertex.code.add(v`void forwardObjectAndLayerIdColor() {}`),void e.fragment.code.add(v`void outputObjectAndLayerIdColor() {}`);const i=t.instanced;e.varyings.add("objectAndLayerIdColorVarying","vec4");const r=i?"instanceOlidColor":"olidColor";e.attributes.add(r,"vec4"),e.vertex.code.add(v`
    void forwardObjectAndLayerIdColor() {
      objectAndLayerIdColorVarying = ${r} * 0.003921568627451;
    }`),e.fragment.code.add(v`void outputObjectAndLayerIdColor() {
fragColor = objectAndLayerIdColorVarying;
}`)}function Ma(e){const{fragment:t}=e;t.code.add(v`uint readChannelBits(uint channel, int highlightLevel) {
int llc = (highlightLevel & 3) << 1;
return (channel >> llc) & 3u;
}
uint readChannel(uvec2 texel, int highlightLevel) {
int lic = (highlightLevel >> 2) & 1;
return texel[lic];
}
uint readLevelBits(uvec2 texel, int highlightLevel) {
return readChannelBits(readChannel(texel, highlightLevel), highlightLevel);
}`)}let Ta=class extends U{constructor(e,t){super(e,"ivec2",0,(i,r)=>i.setUniform2iv(e,t(r)))}},Ca=class extends U{constructor(e,t){super(e,"int",0,(i,r)=>i.setUniform1i(e,t(r)))}},es=class extends U{constructor(e,t){super(e,"sampler2D",0,(i,r)=>i.bindTexture(e,t(r)))}},Pa=class extends U{constructor(e,t){super(e,"usampler2D",0,(i,r)=>i.bindTexture(e,t(r)))}};function za(e,t){const{fragment:i}=e,{output:r,draped:s,hasHighlightMixTexture:n}=t;r===9?(i.uniforms.add(new Ca("highlightLevel",o=>o.highlightLevel??0),new Ta("highlightMixOrigin",o=>o.highlightMixOrigin)),e.outputs.add("fragHighlight","uvec2",0),e.include(Ma),n?i.uniforms.add(new Pa("highlightMixTexture",o=>o.highlightMixTexture)).code.add(v`uvec2 getAccumulatedHighlight() {
return texelFetch(highlightMixTexture, ivec2(gl_FragCoord.xy) - highlightMixOrigin, 0).rg;
}
void outputHighlight(bool occluded) {
if (highlightLevel == 0) {
uint bits = occluded ? 3u : 1u;
fragHighlight = uvec2(bits, 0);
} else {
int ll = (highlightLevel & 3) << 1;
int li = (highlightLevel >> 2) & 3;
uint bits;
if (occluded) {
bits = 3u << ll;
} else {
bits = 1u << ll;
}
uvec2 combinedHighlight = getAccumulatedHighlight();
combinedHighlight[li] |= bits;
fragHighlight = combinedHighlight;
}
}`):i.code.add(v`void outputHighlight(bool occluded) {
uint bits = occluded ? 3u : 1u;
fragHighlight = uvec2(bits, 0);
}`),s?i.code.add(v`bool isHighlightOccluded() {
return false;
}`):i.uniforms.add(new es("depthTexture",o=>o.mainDepth)).code.add(v`bool isHighlightOccluded() {
float sceneDepth = texelFetch(depthTexture, ivec2(gl_FragCoord.xy), 0).x;
return gl_FragCoord.z > sceneDepth + 5e-7;
}`),i.code.add(v`void calculateOcclusionAndOutputHighlight() {
outputHighlight(isHighlightOccluded());
}`)):i.code.add(v`void calculateOcclusionAndOutputHighlight() {}`)}let Oa=class extends U{constructor(e,t,i,r){super(e,"vec4",1,(s,n,o)=>s.setUniform4fv(e,t(n,o),r),i)}},Ea=class extends U{constructor(e,t,i,r){super(e,"float",1,(s,n,o)=>s.setUniform1fv(e,t(n,o),r),i)}},Si=class{constructor(e){this.field=e}},Aa=class extends Si{constructor(e){super(e),this.minSize=[0,0,0],this.maxSize=[0,0,0],this.offset=[0,0,0],this.factor=[0,0,0],this.type=[0,0,0],this.fallback=[0,0,0]}},Qi=class extends Si{constructor(e){super(e),this.colors=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.values=[0,0,0,0,0,0,0,0],this.fallback=[0,0,0,0]}};class Ia extends Si{constructor(t,i=0){super(t),this.fallback=i,this.values=[0,0,0,0,0,0,0,0],this.opacityValues=[0,0,0,0,0,0,0,0]}}class Fa{}function Ke(e){return e!=null}function Da(e,t,i,r=X()){const s=e||0,n=t||0,o=i||0;return s!==0&&mn(r,r,-s/180*Math.PI),n!==0&&br(r,r,n/180*Math.PI),o!==0&&vn(r,r,o/180*Math.PI),r}function ze(e,t,i,r,s){var a;const n=e.minSize,o=e.maxSize;if(e.useSymbolValue){const l=r.symbolSize[i];return t.minSize[i]=l,t.maxSize[i]=l,t.offset[i]=t.minSize[i],t.factor[i]=0,t.type[i]=1,!0}if(Ke(e.field))return Ke(e.stops)?e.stops.length===2&&ke(e.stops[0].size)&&ke(e.stops[1].size)?(er(e.stops[0].size,e.stops[1].size,e.stops[0].value,e.stops[1].value,t,i),t.type[i]=1,!0):!1:ke(n)&&ke(o)&&Ke(e.minDataValue)&&Ke(e.maxDataValue)?(er(n,o,e.minDataValue,e.maxDataValue,t,i),t.type[i]=1,!0):e.valueUnit==="unknown"?!1:ki[e.valueUnit]!=null?(t.minSize[i]=-1/0,t.maxSize[i]=1/0,t.offset[i]=0,t.factor[i]=1/ki[e.valueUnit],t.type[i]=1,!0):!1;if(!Ke(e.field)){if((a=e.stops)!=null&&a[0]&&ke(e.stops[0].size))return t.minSize[i]=e.stops[0].size,t.maxSize[i]=e.stops[0].size,t.offset[i]=t.minSize[i],t.factor[i]=0,t.type[i]=1,!0;if(ke(n))return t.minSize[i]=n,t.maxSize[i]=n,t.offset[i]=n,t.factor[i]=0,t.type[i]=1,!0}return!1}function er(e,t,i,r,s,n){const o=Math.abs(r-i)>0?(t-e)/(r-i):0;s.minSize[n]=o>0?e:t,s.maxSize[n]=o>0?t:e,s.offset[n]=e-i*o,s.factor[n]=o}function Ra(e,t,i,r){if(e.normalizationField||e.valueRepresentation||!$s(e.field))return null;if(t.size){if(e.field)if(t.size.field){if(e.field!==t.size.field)return null}else t.size.field=e.field}else t.size=new Aa(e.field),j(t.size.fallback,i.fallbackSize);let s;switch(e.axis){case"width":return s=ze(e,t.size,0,i),s?t:null;case"height":return s=ze(e,t.size,2,i),s?t:null;case"depth":return s=ze(e,t.size,1,i),s?t:null;case"width-and-depth":return s=ze(e,t.size,0,i),s&&ze(e,t.size,1,i),s?t:null;case null:case void 0:case"all":return s=ze(e,t.size,0,i),s=s&&ze(e,t.size,1,i),s=s&&ze(e,t.size,2,i),s?t:null;default:return`${e.axis}`,null}}function La(e,t,i){for(let s=0;s<3;++s){let n=t.unitInMeters;e.type[s]===1&&(n*=t.modelSize[s],e.type[s]=2),e.minSize[s]=e.minSize[s]/n,e.maxSize[s]=e.maxSize[s]/n,e.offset[s]=e.offset[s]/n,e.factor[s]=e.factor[s]/n}let r;if(e.type[0]!==0)r=0;else if(e.type[1]!==0)r=1;else{if(e.type[2]===0)return!1;r=2}for(let s=0;s<3;++s)e.type[s]===0&&(e.minSize[s]=e.minSize[r],e.maxSize[s]=e.maxSize[r],e.offset[s]=e.offset[r],e.factor[s]=e.factor[r],e.type[s]=e.type[r]);return!0}function tr(e,t,i){e[4*t]=i.r/255,e[4*t+1]=i.g/255,e[4*t+2]=i.b/255,e[4*t+3]=i.a}function Va(e,t,i,r){if(e.normalizationField)return null;if(vi(e.field)){if(!e.stops)return null;{if(e.stops.length>8)return null;t.color=new Qi(e.field);const s=e.stops;for(let n=0;n<8;++n){const o=s[Math.min(n,s.length-1)];t.color.values[n]=o.value,tr(t.color.colors,n,o.color)}je(t.color.fallback,i.fallbackColor)}}else{if(!(e.stops&&e.stops.length>=0))return null;{const s=e.stops&&e.stops.length>=0&&e.stops[0].color;t.color=new Qi(null);for(let n=0;n<8;n++)t.color.values[n]=1/0,tr(t.color.colors,n,s);je(t.color.fallback,i.fallbackColor)}}return t}function $a(e,t,i,r){if(e.normalizationField)return null;if(vi(e.field)){if(!e.stops)return null;{if(e.stops.length>8)return null;t.opacity=new Ia(e.field,i.fallbackColor[3]);const s=e.stops;for(let n=0;n<8;++n){const o=s[Math.min(n,s.length-1)];t.opacity.values[n]=o.value,t.opacity.opacityValues[n]=o.opacity}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const s=e.stops&&e.stops.length>=0?e.stops[0].opacity:0;t.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0],fallback:i.fallbackColor[3]};for(let n=0;n<8;n++)t.opacity.values[n]=1/0,t.opacity.opacityValues[n]=s}}return t}function qt(e,t,i){const r=i===2&&e.rotationType==="arithmetic";t.offset[i]=r?90:0,t.factor[i]=r?-1:1,t.type[i]=1}function Na(e,t,i){if(!vi(e.field))return null;if(t.rotation){if(e.field)if(t.rotation.field){if(e.field!==t.rotation.field)return null}else t.rotation.field=e.field}else t.rotation={field:e.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(e.axis){case"tilt":return qt(e,t.rotation,0),t;case"roll":return qt(e,t.rotation,1),t;case null:case void 0:case"heading":return qt(e,t.rotation,2),t;default:return`${e.axis}`,null}}class Ru{constructor({supports:t,modelSize:i,symbolSize:r,unitInMeters:s,anchor:n,scale:o,rotation:a,fallbackColor:l,fallbackSize:h}){this.supports=t,this.modelSize=i??at(),this.symbolSize=r??at(),this.unitInMeters=s??1,this.anchor=n??rt(),this.scale=o??at(),this.rotation=a??rt(),this.fallbackColor=l??wn(),this.fallbackSize=h??at()}}function ts(e,t,i){if(!e)return null;const r=e.reduce((s,n)=>{if(!s)return s;if(n.valueExpression)return null;switch(n.type){case"size":return t.supports.size?Ra(n,s,t):s;case"color":return t.supports.color?Va(n,s,t):s;case"opacity":return t.supports.opacity?$a(n,s,t):null;case"rotation":return t.supports.rotation?Na(n,s):s;default:return null}},new Fa);return!(e.length>0&&r)||r.size||r.color||r.opacity||r.rotation?r!=null&&r.size&&!La(r.size,t)?null:r:null}class ka{constructor(t,i,r){this.visualVariables=t,this.materialParameters=i,this.requiresShaderTransformation=r}}function Lu(e,t){if(!e||la()||jn.TESTS_DISABLE_FAST_UPDATES)return null;const i=ts(e.visualVariables,t);return i?new ka(i,rs(i,t),!!i.size):null}function Vu(e,t,i){if(!t||!e)return!1;const r=e.visualVariables,s=ts(t.visualVariables,i);return!!s&&!!(pt(r.size,s.size,"size")&&pt(r.color,s.color,"color")&&pt(r.rotation,s.rotation,"rotation")&&pt(r.opacity,s.opacity,"opacity"))&&(e.visualVariables=s,e.materialParameters=rs(s,i),e.requiresShaderTransformation=!!s.size,!0)}function pt(e,t,i){if(!!e!=!!t||e&&e.field!==(t==null?void 0:t.field))return!1;if(e&&i==="rotation"){const r=e,s=t;for(let n=0;n<3;n++)if(r.type[n]!==s.type[n]||r.offset[n]!==s.offset[n]||r.factor[n]!==s.factor[n])return!1}return!0}class is extends Lt{constructor(t){super(),this.vvSize=(t==null?void 0:t.size)??null,this.vvColor=(t==null?void 0:t.color)??null,this.vvOpacity=(t==null?void 0:t.opacity)??null}get hasVVSize(){return!!this.vvSize}get hasVVColor(){return!!this.vvColor}get hasVVOpacity(){return!!this.vvOpacity}}function rs(e,t){const i=new is(e);return i.vvSize&&(i.vvSymbolAnchor=t.anchor,pn(tt),Da(t.rotation[2],t.rotation[0],t.rotation[1],tt),i.vvSymbolRotationMatrix=i.vvSymbolRotationMatrix||ur(),Vs(i.vvSymbolRotationMatrix,tt)),i}function $u(e,t,i){if(!e.vvSize)return i;Ge(Oe,i);const r=e.vvSymbolRotationMatrix;return fn(tt,r[0],r[1],r[2],0,r[3],r[4],r[5],0,r[6],r[7],r[8],0,0,0,0,1),zt(Oe,Oe,tt),Ba(ir,e,t),dn(Oe,Oe,ir),Pt(Oe,Oe,e.vvSymbolAnchor),Oe}function Ba(e,t,i){if(!t.vvSize)return $(e,1,1,1),e;if(Number.isNaN(i[0]))return j(e,t.vvSize.fallback);for(let r=0;r<3;++r){const s=t.vvSize.offset[r]+i[0]*t.vvSize.factor[r];e[r]=nt(s,t.vvSize.minSize[r],t.vvSize.maxSize[r])}return e}function Nu(e,t){const i=e==null?0:t.attributes[e];return typeof i=="number"&&isFinite(i)?i:NaN}const Oe=X(),ir=_(),tt=X();let ku=class extends is{constructor(){super(...arguments),this.renderOccluded=1,this.isDecoration=!1}};const Wt=8;function Bu(e,t){const{vertex:i,attributes:r}=e;t.hasVVInstancing&&(t.hasVVSize||t.hasVVColor)&&r.add("instanceFeatureAttribute","vec4"),t.hasVVSize?(i.uniforms.add(new xe("vvSizeMinSize",s=>s.vvSize.minSize)),i.uniforms.add(new xe("vvSizeMaxSize",s=>s.vvSize.maxSize)),i.uniforms.add(new xe("vvSizeOffset",s=>s.vvSize.offset)),i.uniforms.add(new xe("vvSizeFactor",s=>s.vvSize.factor)),i.uniforms.add(new xe("vvSizeFallback",s=>s.vvSize.fallback)),i.uniforms.add(new oa("vvSymbolRotationMatrix",s=>s.vvSymbolRotationMatrix)),i.uniforms.add(new xe("vvSymbolAnchor",s=>s.vvSymbolAnchor)),i.code.add(v`vec3 vvScale(vec4 _featureAttribute) {
if (isnan(_featureAttribute.x)) {
return vvSizeFallback;
}
return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
}
vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
}`),i.code.add(v`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 scale = max(vvScale(_featureAttribute), eps);
        return vec4(vvSymbolRotationMatrix * _normal / scale, 1.0);
      }

      ${t.hasVVInstancing?v`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):i.code.add(v`vec4 localPosition() { return vec4(position, 1.0); }
vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),e.vertex.include(Vt),t.hasVVColor?(i.constants.add("vvColorNumber","int",Wt),i.uniforms.add(new Ea("vvColorValues",s=>s.vvColor.values,Wt),new Oa("vvColorColors",s=>s.vvColor.colors,Wt),new Qr("vvColorFallback",s=>s.vvColor.fallback,{supportsNaN:!0})),t.hasVVInstancing&&(e.vertex.include(pa),e.vertex.include(ma)),i.code.add(v`
      vec4 interpolateVVColor(float value) {
        if (isnan(value)) {
          return vvColorFallback;
        }

        if (value <= vvColorValues[0]) {
          return vvColorColors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (vvColorValues[i] >= value) {
            float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);
            return mix(vvColorColors[i-1], vvColorColors[i], f);
          }
        }
        return vvColorColors[vvColorNumber - 1];
      }

      vec4 vvGetColor(vec4 featureAttribute) {
        return interpolateVVColor(featureAttribute.y);
      }

      ${t.hasVVInstancing?v`
            vec4 vvColor() {
              return vvGetColor(instanceFeatureAttribute);
            }

            MaskedColor applyVVColor(MaskedColor color) {
              return multiplyMaskedColors(color, createMaskedFromNaNColor(vvColor()));
            }
            `:v`
            vec4 vvColor() {
              return vec4(1.0);
            }

            MaskedColor applyVVColor(MaskedColor color) {
              return color;
            }
            `}
    `)):i.code.add(v`vec4 vvColor() {
return vec4(1.0);
}
MaskedColor applyVVColor(MaskedColor color) {
return color;
}`)}let Ha=class extends U{constructor(e,t,i){super(e,"float",2,(r,s,n)=>r.setUniform1f(e,t(s,n),i))}},Ua=class extends U{constructor(e,t,i){super(e,"float",1,(r,s,n)=>r.setUniform1f(e,t(s,n),i))}};const ja=1/255.5;let qa=class extends U{constructor(e,t){super(e,"sampler2D",1,(i,r,s)=>i.bindTexture(e,t(r,s)))}};function Wa(e){e.fragment.code.add(v`vec4 textureAtlasLookup(sampler2D tex, vec2 textureCoordinates, vec4 atlasRegion) {
vec2 atlasScale = atlasRegion.zw - atlasRegion.xy;
vec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;
float maxdUV = 0.125;
vec2 dUVdx = clamp(dFdx(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
vec2 dUVdy = clamp(dFdy(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
return textureGrad(tex, uvAtlas, dUVdx, dUVdy);
}`)}function Ga(e,t){const{textureCoordinateType:i}=t;if(i===0||i===3)return;e.include(ya,t);const r=i===2;r&&e.include(Wa),e.fragment.code.add(v`
    vec4 textureLookup(sampler2D tex, vec2 uv) {
      return ${r?"textureAtlasLookup(tex, uv, vuvRegion)":"texture(tex, uv)"};
    }
  `)}let Hu=class extends U{constructor(e,t,i){super(e,"vec2",1,(r,s,n)=>r.setUniform2fv(e,t(s,n),i))}},Xa=class extends U{constructor(e,t){super(e,"sampler2D",2,(i,r,s)=>i.bindTexture(e,t(r,s)))}};function Ya(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/t)}function Ka(e,t,i){return 2*Math.atan(Math.sqrt(t*t+i*i)*Math.tan(.5*e)/i)}function Ja(e,t,i){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+i*i))}function Za(e,t,i){return 2*Math.atan(i*Math.tan(.5*e)/Math.sqrt(t*t+i*i))}var ci;let P=ci=class extends di{constructor(e){super(e),this._ray=zr(),this._viewport=Ni(0,0,1,1),this._padding=Ni(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=Sr(1,1e3),this._viewDirty=!0,this._viewMatrix=X(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=X(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=X(),this._frustumDirty=!0,this._frustum=Mr(),this._fullViewport=Re(),this._pixelRatio=1,this.row=0,this.column=0,this._rows=1,this._columns=1,this._center=_(),this._up=_(),this.relativeElevation=0}get pixelRatio(){return this._pixelRatio}set pixelRatio(e){this._pixelRatio=e>0?e:1}get rows(){return this._rows}set rows(e){this._rows=Math.max(1,e)}get columns(){return this._columns}set columns(e){this._columns=Math.max(1,e)}get eye(){return this._ray.origin}set eye(e){this._compareAndSetView(e,this._ray.origin)}get center(){return this._center}set center(e){this._compareAndSetView(e,this._center,"_center")}get ray(){return Te(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(e){this._compareAndSetView(e,this._up,"_up")}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(e){Ge(this._viewMatrix,e),this.notifyChange("_viewMatrix"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),$(_(),-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10])}get viewUp(){return this._ensureViewClean(),$(_(),this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9])}get viewRight(){return this._ensureViewClean(),$(_(),this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8])}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_nearFar"))}get far(){return this._nearFar[1]}set far(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_nearFar"))}get viewport(){return this._viewport}set viewport(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]}get screenViewport(){if(this.pixelRatio===1)return this._viewport;const e=Li(Re(),this._viewport,1/this.pixelRatio),t=this._get("screenViewport");return t&&Vi(e,t)?t:e}get screenPadding(){if(this.pixelRatio===1)return this._padding;const e=Li(Re(),this._padding,1/this.pixelRatio),t=this._get("screenPadding");return t&&Vi(e,t)?t:e}get x(){return this._viewport[0]}set x(e){e+=this._padding[3],this._viewport[0]!==e&&(this._viewport[0]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get y(){return this._viewport[1]}set y(e){e+=this._padding[2],this._viewport[1]!==e&&(this._viewport[1]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get width(){return this._viewport[2]}set width(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get height(){return this._viewport[3]}set height(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get fullWidth(){return this._viewport[2]+this._padding[1]+this._padding[3]}set fullWidth(e){this.width=e-(this._padding[1]+this._padding[3])}get fullHeight(){return this._viewport[3]+this._padding[0]+this._padding[2]}set fullHeight(e){this.height=e-(this._padding[0]+this._padding[2])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get _aspect(){return this.width/this.height}get padding(){return this._padding}set padding(e){Ut(this._padding,e)||(this._viewport[0]+=e[3]-this._padding[3],this._viewport[1]+=e[2]-this._padding[2],this._viewport[2]-=e[1]+e[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=e[0]+e[2]-(this._padding[0]+this._padding[2]),je(this._padding,e),this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_padding"),this.notifyChange("_viewport"))}get viewProjectionMatrix(){return this._viewProjectionDirty&&(zt(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){return this._projectionMatrixInternal}get inverseProjectionMatrix(){return St(X(),this.projectionMatrix)||this._get("inverseProjectionMatrix")||X()}get fov(){return this._fov}set fov(e){this._fov=e,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return Ja(this._fov,this.width,this.height)}set fovX(e){this._fov=Ya(e,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return Za(this._fov,this.width,this.height)}set fovY(e){this._fov=Ka(e,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return mr(this.center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(St(this._viewInverseTransposeMatrix,this.viewMatrix),ai(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(e){const{near:t,far:i}=this;return 2*t*i/(i+t-e*(i-t))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this.pixelRatio}get aboveGround(){return this.relativeElevation!=null&&this.relativeElevation>=0}get _projectionMatrixInternal(){const e=this.width,t=this.height,i=this.near*Math.tan(this.fovY/2)*2,r=i*this._aspect,s=i/this.rows,n=r/this.columns,o=-r/2+this.column*n,a=o+n,l=-i/2+this.row*s,h=l+s,c=cn(X(),o*(1+2*this._padding[3]/e),a*(1+2*this._padding[1]/e),l*(1+2*this._padding[2]/t),h*(1+2*this._padding[0]/t),this.near,this.far),u=this._get("projectionMatrix");return u&&un(u,c)?u:c}copyFrom(e){j(this._ray.origin,e.eye),this.center=e.center,this.up=e.up,je(this._viewport,e.viewport),this.notifyChange("_viewport"),je(this._padding,e.padding),this.notifyChange("_padding"),zs(this._nearFar,e.nearFar),this.notifyChange("_nearFar"),this._fov=e.fov,this.row=e.row,this.column=e.column,this.rows=e.rows,this.columns=e.columns,this.relativeElevation=e.relativeElevation;const t=e;return this._viewDirty=t._viewDirty,this._viewDirty||(Ge(this._viewMatrix,e.viewMatrix),this.notifyChange("_viewMatrix")),this._viewProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||(bn(this._frustum,e.frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(Ge(this._viewInverseTransposeMatrix,e.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),je(this._fullViewport,e.fullViewport),this.pixelRatio=e.pixelRatio,this}copyViewFrom(e){this.eye=e.eye,this.center=e.center,this.up=e.up,this.fov=e.fov}clone(){return new ci().copyFrom(this)}equals(e){return Ie(this.eye,e.eye)&&Ie(this.center,e.center)&&Ie(this.up,e.up)&&Ut(this._viewport,e.viewport)&&Ut(this._padding,e.padding)&&Os(this.nearFar,e.nearFar)&&this._fov===e.fov&&this.pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation&&this.row===e.row&&this.column===e.column&&this.rows===e.rows&&this.columns===e.columns}almostEquals(e){const t=Math.max(1,1/this.pixelRatio,1/e.pixelRatio);if(Math.abs(e.fov-this._fov)>=.001||$i(e.screenPadding,this.screenPadding)>=t||$i(this.screenViewport,e.screenViewport)>=t||this.row!==e.row||this.column!==e.column||this.rows!==e.rows||this.columns!==e.columns)return!1;ve(q,e.eye,e.center),ve(me,this.eye,this.center);const i=ue(q,me),r=Ii(q),s=Ii(me),n=5e-4;return i*i>=(1-1e-10)*r*s&&oi(e.eye,this.eye)<Math.max(r,s)*n*n}computeRenderPixelSizeAt(e){return this.computeRenderPixelSizeAtDist(this._viewDirectionDistance(e))}computeRenderPixelSizeAtDist(e){return e*this.perRenderPixelRatio}computeScreenPixelSizeAt(e){return this.computeScreenPixelSizeAtDist(this._viewDirectionDistance(e))}_viewDirectionDistance(e){return Math.abs(In(this.viewForward,Te(q,e,this.eye)))}computeScreenPixelSizeAtDist(e){return e*this.perScreenPixelRatio}computeDistanceFromRadius(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))}getScreenCenter(e=Es()){return e[0]=(this.padding[3]+this.width/2)/this.pixelRatio,e[1]=(this.padding[0]+this.height/2)/this.pixelRatio,e}getRenderCenter(e,t=.5,i=.5){return e[0]=this.padding[3]+this.width*t,e[1]=this.padding[2]+this.height*i,e[2]=.5,e}setGLViewport(e){const t=this.viewport,i=this.padding;e.setViewport(t[0]-i[3],t[1]-i[2],t[2]+i[1]+i[3],t[3]+i[0]+i[2])}applyProjection(e,t){e!==F&&j(F,e),F[3]=1,lt(F,F,this.projectionMatrix);const i=Math.abs(F[3]);W(F,F,1/i);const r=this.fullViewport;t[0]=te(0,r[0]+r[2],.5+.5*F[0]),t[1]=te(0,r[1]+r[3],.5+.5*F[1]),t[2]=.5*(F[2]+1),t[3]=i}unapplyProjection(e,t){const i=this.fullViewport;F[0]=(e[0]/(i[0]+i[2])*2-1)*e[3],F[1]=(e[1]/(i[1]+i[3])*2-1)*e[3],F[2]=(2*e[2]-1)*e[3],F[3]=e[3],this.inverseProjectionMatrix!=null&&(lt(F,F,this.inverseProjectionMatrix),t[0]=F[0],t[1]=F[1],t[2]=F[2])}projectToScreen(e,t){return this.projectToRenderScreen(e,Gt),this.renderToScreen(Gt,t),t}projectToRenderScreen(e,t){if(F[0]=e[0],F[1]=e[1],F[2]=e[2],F[3]=1,lt(F,F,this.viewProjectionMatrix),F[3]===0)return null;const i=F;W(i,i,1/Math.abs(F[3]));const r=this.fullViewport,s=te(0,r[0]+r[2],.5+.5*i[0]),n=te(0,r[1]+r[3],.5+.5*i[1]);return"x"in t?(t.x=s,t.y=n):(t[0]=s,t[1]=n,t.length>2&&(t[2]=.5*(i[2]+1))),t}unprojectFromScreen(e,t){return this.unprojectFromRenderScreen(this.screenToRender(e,Gt),t)}unprojectFromRenderScreen(e,t){if(zt(mt,this.projectionMatrix,this.viewMatrix),!St(mt,mt))return null;const i=this.fullViewport;return F[0]=2*(e[0]-i[0])/i[2]-1,F[1]=2*(e[1]-i[1])/i[3]-1,F[2]=2*e[2]-1,F[3]=1,lt(F,F,mt),F[3]===0?null:(t[0]=F[0]/F[3],t[1]=F[1]/F[3],t[2]=F[2]/F[3],t)}constrainWindowSize(e,t,i,r){const s=e*this.pixelRatio,n=t*this.pixelRatio,o=Math.max(s-i/2,0),a=Math.max(this.fullHeight-n-r/2,0),l=-Math.min(s-i/2,0),h=-Math.min(this.fullHeight-n-r/2,0),c=i-l- -Math.min(this.fullWidth-s-i/2,0),u=r-h- -Math.min(n-r/2,0);return[Math.round(o),Math.round(a),Math.round(c),Math.round(u)]}computeUp(e){e===1?this._computeUpGlobal():this._computeUpLocal()}screenToRender(e,t){const i=e[0]*this.pixelRatio,r=this.fullHeight-e[1]*this.pixelRatio;return t[0]=i,t[1]=r,t}renderToScreen(e,t){const i=e[0]/this.pixelRatio,r=(this.fullHeight-e[1])/this.pixelRatio;t[0]=i,t[1]=r}_computeUpGlobal(){Te(q,this.center,this.eye);const e=Y(this.center);e<1?Ie(this._up,Ei)&&(j(this._up,Ei),this._markViewDirty(),this.notifyChange("_up")):Math.abs(ue(q,this.center))>.9999*Y(q)*e||(fe(me,q,this.center),fe(me,me,q),Pe(me,me),Ie(this._up,me)||(j(this._up,me),this.notifyChange("_up"),this._markViewDirty()))}_computeUpLocal(){vr(q,this.eye,this.center),Math.abs(q[2])<=.9999&&(W(q,q,q[2]),$(q,-q[0],-q[1],1-q[2]),Pe(q,q),Ie(this._up,q)||(j(this._up,q),this.notifyChange("_up"),this._markViewDirty()))}_compareAndSetView(e,t,i=""){typeof e[0]=="number"&&isFinite(e[0])&&typeof e[1]=="number"&&isFinite(e[1])&&typeof e[2]=="number"&&isFinite(e[2])?Ie(e,t)||(j(t,e),this._markViewDirty(),i.length&&this.notifyChange(i)):pi.getLogger("esri.views.3d.webgl-engine.lib.RenderCamera").warn("RenderCamera vector contains invalid number, ignoring value")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&(Tr(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&(hn(this._viewMatrix,this.eye,this.center,this.up),this.notifyChange("_viewMatrix"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}};d([m()],P.prototype,"_viewport",void 0),d([m()],P.prototype,"_padding",void 0),d([m()],P.prototype,"_fov",void 0),d([m()],P.prototype,"_nearFar",void 0),d([m()],P.prototype,"_viewDirty",void 0),d([m()],P.prototype,"_viewMatrix",void 0),d([m()],P.prototype,"_pixelRatio",void 0),d([m()],P.prototype,"pixelRatio",null),d([m()],P.prototype,"row",void 0),d([m()],P.prototype,"column",void 0),d([m()],P.prototype,"_rows",void 0),d([m()],P.prototype,"rows",null),d([m()],P.prototype,"_columns",void 0),d([m()],P.prototype,"columns",null),d([m()],P.prototype,"eye",null),d([m()],P.prototype,"center",null),d([m()],P.prototype,"_center",void 0),d([m()],P.prototype,"up",null),d([m()],P.prototype,"_up",void 0),d([m()],P.prototype,"viewMatrix",null),d([m({readOnly:!0})],P.prototype,"viewForward",null),d([m({readOnly:!0})],P.prototype,"viewUp",null),d([m({readOnly:!0})],P.prototype,"viewRight",null),d([m({readOnly:!0})],P.prototype,"nearFar",null),d([m()],P.prototype,"near",null),d([m()],P.prototype,"far",null),d([m()],P.prototype,"viewport",null),d([m({readOnly:!0})],P.prototype,"screenViewport",null),d([m({readOnly:!0})],P.prototype,"screenPadding",null),d([m()],P.prototype,"x",null),d([m()],P.prototype,"y",null),d([m()],P.prototype,"width",null),d([m()],P.prototype,"height",null),d([m()],P.prototype,"fullWidth",null),d([m()],P.prototype,"fullHeight",null),d([m({readOnly:!0})],P.prototype,"_aspect",null),d([m()],P.prototype,"padding",null),d([m({readOnly:!0})],P.prototype,"projectionMatrix",null),d([m({readOnly:!0})],P.prototype,"inverseProjectionMatrix",null),d([m()],P.prototype,"fov",null),d([m()],P.prototype,"fovX",null),d([m()],P.prototype,"fovY",null),d([m()],P.prototype,"viewInverseTransposeMatrix",null),d([m({readOnly:!0})],P.prototype,"_projectionMatrixInternal",null),d([m()],P.prototype,"relativeElevation",void 0),P=ci=d([gi("esri.views.3d.webgl.RenderCamera")],P);const Uu=P,F=Re(),mt=X(),q=_(),me=_(),Gt=As();var Me;let ju=(Me=class{constructor(t=1/0,i=-1/0){this.near=t,this.far=i}set(t,i){this.near=t,this.far=i}union(t){t!=null&&(this.near=Math.min(this.near,t.near),this.far=Math.max(this.far,t.far))}within(t){return this.near<=t&&t<=this.far}equals(t){return this.near===t.near&&this.far===t.far}},Me.Zero=new Me(0,0),Me.Infinite=new Me,Me);function Qa(e,t){const i=[],r=[];return vt(i,e,t,0),vt(r,i,t,1),vt(i,r,t,2),vt(r,i,t,3),r}function vt(e,t,i,r){const s=el(i,r);if(e.length=0,t.length){s(gt,t[0],t[0])===1&&Je(e,t[0]);for(let n=0;n<t.length;n++){const o=t[n===t.length-1?0:n+1];switch(s(gt,t[n],o)){case 1:Je(e,o);break;case 3:Je(e,Hi(gt));break;case 2:Je(e,Hi(gt)),Je(e,o)}}}}function Je(e,t){e.length!==0&&Hs(e.at(-1),t)||e.push(t)}function el(e,t){const i=t===0||t===2?0:1,r=e[t],s=t===0||t===1?1:-1,n=i===0?1:0;return(o,a,l)=>{if(a[i]<r&&l[i]<r)return s===1?0:1;if(a[i]>r&&l[i]>r)return s===1?1:0;const h=(l[n]-a[n])/(l[i]-a[i]),c=a[n]+h*(r-a[i]);return o[i]=r,o[n]=c,(a[i]<r?1:-1)*s>0?2:3}}const gt=_i(),tl=_(),_t=_();function ss(){return{direction:_(),up:_()}}function ns(e,t,i,r,s){let n=Pe(tl,e),o=ue(n,r);const a=o>0;o=Math.abs(o),o>.99&&(o=Math.abs(ue(t,r)),o<.99?(j(n,t),a&&W(n,n,-1)):n=null);let l=0;if(n){W(_t,r,ue(r,n)),Te(n,n,_t);const c=ue(n,s)/(Y(n)*Y(s));fe(_t,n,s),l=(ue(_t,r)>0?1:-1)*Ve(si(c))}const h=Ve(si(-ue(r,e)/Y(e)));return i?(i.heading=l,i.tilt=h,i):{heading:l,tilt:h}}function os(e,t,i,r){Te(rr,i,t),Nn(r,Ln(t,rr),e)||e===i||j(e,i)}const rr=_(),as=K(0,1,0),ls=K(0,0,1),Ze=X(),_e=_(),ye=_();function cs(e,t,i,r=ss()){const{direction:s,up:n}=r;return gn(Ze,-ae(t)),br(Ze,Ze,ae(i)),ge(s,ls,Ze),W(s,s,-1),ge(n,as,Ze),r}function il(e,t,i,r){return ns(t,i,r,ls,as)}function rl(e,t,i,r){const s=cs(e,i,r),n=_();return W(n,s.direction,-t),oe(n,n,e),{up:s.up,eye:n,heading:i,tilt:r}}function sl(e){return Ve(e)}function nl(e){return ae(e)}function ol(e,t,i,r,s){const n=e.renderSpatialReference,o=e.spatialReference??t.spatialReference;return Ui(t,_e,n),Ui(t,ye,n),_e[0]-=i/2,ye[0]+=i/2,_e[1]-=r/2,ye[1]+=r/2,Bi(_e,n,_e,o),Bi(ye,n,ye,o),s?(s.xmin=_e[0],s.ymin=_e[1],s.xmax=ye[0],s.ymax=ye[1],s.spatialReference=o):s=new hr(_e[0],_e[1],ye[0],ye[1],o),s}function al(e,t){const i=e.frustum,{renderCoordsHelper:r}=e,s=r.getAltitude(t),n=e.spatialReference,o=e.state.camera.eye,a=[],l=i.planes[5];for(let h=0;h<4;h++){const c=i.lines[h];r.intersectInfiniteManifold(Or(c.origin,c.direction),s,he)||ll(he,i,r,c.endpoint,s),os(he,o,he,l),a.push(Sr(he[0],he[1]))}return cl(Qa(a,r.extent),r,n)}function ll(e,t,i,r,s){const n=t.lines[11].direction,o=(s-i.getAltitude(r))/n[2];Se(e,r,n,o)}function cl(e,t,i){const r=e.map(s=>($(he,s[0],s[1],0),t.fromRenderCoords(he,he,i),[he[0],he[1]]));return r.length<=2?new ri({spatialReference:i}):(r.push(r[0].slice()),fr(r)||r.reverse(),new ri({rings:[r],spatialReference:i}))}const he=_();Object.freeze(Object.defineProperty({__proto__:null,directionToHeadingTilt:il,eyeForCenterWithHeadingTilt:rl,eyeTiltToLookAtTilt:nl,headingTiltToDirectionUp:cs,lookAtTiltToEyeTilt:sl,toArea:al,toExtent:ol},Symbol.toStringTag,{value:"Module"}));var Le;let ul=(Le=class{get planes(){return this.frustum}get points(){return this._points}get mutablePoints(){return this._points}get direction(){return this._direction}get origin(){return this._origin}constructor(t){this.renderCoordsHelper=t,this.frustum=Mr(),this._points=Sn(),this.lines=new Array(12),this._origin=_(),this._direction=_(),this._altitude=null;for(let i=0;i<12;i++)this.lines[i]={origin:null,direction:_(),endpoint:null}}update(t){Tr(t.viewMatrix,t.projectionMatrix,this.frustum,this._points),j(this._origin,t.eye),j(this._direction,t.viewForward),this._altitude=this.renderCoordsHelper.getAltitude(this._origin),this._updateLines()}updatePoints(t){for(let i=0;i<this._points.length;i++)j(this._points[i],t[i]);Mn(this.frustum,this._points),this._updateLines()}get altitude(){return this._altitude}intersectsSphere(t){return Tn(this.frustum,t)}intersectsRay(t){return Cn(this.frustum,t)}intersectsLineSegment(t,i){return Pn(this.frustum,t,i)}intersectsPoint(t){return zn(this.frustum,t)}_updateLines(){const t=this._points;for(let i=0;i<4;i++){const r=i+4;Xt(this.lines[i],t[i],t[r]),Xt(this.lines[i+4],t[i],i===3?t[0]:t[i+1]),Xt(this.lines[i+8],t[r],i===3?t[4]:t[r+1])}}},Le.planePointIndices=On,Le.nearFarLineIndices=[[0,4],[1,5],[2,6],[3,7]],Le);function Xt(e,t,i){e.origin=t,e.endpoint=i,vr(e.direction,t,i)}const Yt=K(parseFloat(5802e-9.toFixed(6)),parseFloat(13558e-9.toFixed(6)),parseFloat(331e-7.toFixed(6))),Kt=3,Jt=K(Kt*parseFloat(65e-8.toFixed(6)),Kt*parseFloat(1881e-9.toFixed(6)),Kt*parseFloat(85e-9.toFixed(6)));K(parseFloat(Number(Yt[0]+Jt[0]).toFixed(6)),parseFloat(Number(Yt[1]+Jt[1]).toFixed(6)),parseFloat(Number(Yt[2]+Jt[2]).toFixed(6)));const hl=2;Rt(),zr();function fl(e,t,i){e.worldUpAtPosition(t,sr),Te(Zt,i,t);const r=Y(Zt);return r===0?0:si(ue(Zt,sr)/r)}const sr=_(),Zt=_();function dl(e,t,i){const r=t/i,s=ae(e),n=Math.sin(r/2),o=Math.cos(s),a=2*Dt(Math.sqrt(n*n/(o*o)));return Ve(a)}const us=K(0,0,1),hs=Pe(_(),K(1,1,1)),Qe=X(),Ee=_(),Be=_();function fs(e,t,i,r=ss()){fe(Ee,e,us),ue(Ee,Ee)===0&&fe(Ee,e,hs),_n(Qe,-ae(t),e),yn(Qe,Qe,-ae(i),Ee);const{up:s,direction:n}=r;return fe(s,Ee,e),Pe(s,s),ge(s,s,Qe),Pe(n,e),gr(n,n),ge(n,n,Qe),r}function pl(e,t,i,r){const s=Ee,n=Be;return Pe(s,e),fe(Be,s,us),ue(Be,Be)===0&&fe(Be,s,hs),fe(n,Be,s),ns(t,i,r,s,n)}function ml(e,t,i,r){const s={eye:_(),up:null,tilt:r,heading:i},n=Ee;n[0]=e[0],n[1]=e[2],n[2]=-e[1];const o=t,a=ae(i),l=ae(r),h=Math.sin(a),c=Math.cos(a),u=Math.sin(l),p=Math.cos(l),y=Y(n);let f;if(Math.abs(l)<1e-8)f=o+y;else{const k=y/u,N=Dt(o/k),J=Math.PI-l-N;f=k*Math.sin(J)}const b=p*o,w=o*o*(u*u),z=c*c*w,O=f-b,C=O*O,E=z*(z+C-n[1]*n[1]);if(E<0)return W(s.eye,n,f/y),s.tilt=0,yt(s,e);const D=Math.sqrt(E),L=n[1]*O,T=z+C;let S;if(S=c>0?-D+L:D+L,Math.abs(T)<1e-8)return y<1e-8?(s.eye[0]=0,s.eye[1]=0,s.eye[2]=o):W(s.eye,n,f/y),s.tilt=0,Qt(s.eye),yt(s,e);s.eye[1]=S/T;const x=h*h*w,A=u*o,g=c*A*s.eye[1],I=s.eye[1]*s.eye[1],M=1-I,R=Math.sqrt(M),V=z*I+x-2*g*R*O+M*C;return Math.abs(V)<1e-8?(W(s.eye,n,f/y),s.tilt=0,Qt(s.eye),yt(s,e)):(s.eye[0]=(M*(f*n[0]-b*n[0])-A*R*(n[0]*s.eye[1]*c+n[2]*h))/V,s.eye[2]=(M*(f*n[2]-b*n[2])-A*R*(n[2]*s.eye[1]*c-n[0]*h))/V,W(s.eye,s.eye,f),Qt(s.eye),yt(s,e))}function Qt(e){const t=e[1];e[1]=-e[2],e[2]=t}function yt(e,t){const i=fs(t,e.heading,e.tilt);return e.up=i.up,e}function vl(e,t,i){const r=Y(t),s=Math.sqrt(i*i+r*r-2*i*r*Math.cos(Math.PI-e)),n=Dt(i/(s/Math.sin(e)));return Ve(e-n)}function gl(e,t,i){const r=ae(e),s=Y(t);return Dt(i/(s/Math.sin(r)))+r}function _l(e,t,i,r,s){let n,o,a,l;const h=t.latitude,c=Ns(e.spatialReference).radius,u=t.longitude,p=dl(h,i,c)/2;n=u-p,o=u+p;const y=ae(h),f=(1+Math.sin(y))/(1-Math.sin(y)),b=(f+1)*Math.tan(r/c/2),w=b*b;function z(C){const E=Math.PI/2;return(C=Hn.normalize(C,-E))>E&&(C=Math.PI-C),C}if(a=1.5*Math.PI-2*Math.atan(.5*(b+Math.sqrt(4*f+w))),l=a+r/c,a=z(a),l=z(l),l<a){const C=l;l=a,a=C}if(a=Math.max(Ve(a),-90),l=Math.min(Ve(l),90),o=Un.monotonic(n,o),o-n>180){const C=(o-n-180)/2;n+=C,o-=C}const O=e.spatialReference&&e.spatialReference.isGeographic?e.spatialReference:ks.WGS84;return s?(s.xmin=n,s.ymin=a,s.xmax=o,s.ymax=l,s.spatialReference=O):s=new hr(n,a,o,l,O),e.spatialReference&&e.spatialReference.isWebMercator&&Bs(s,!1,s),s}function yl(e,t){const{renderCoordsHelper:i}=e,r=e.state.camera.clone(),s=new ul(i);r.near=hl,s.update(r);const n=i.getAltitude(t),o=e.spatialReference,a=i.referenceEllipsoid.radius,l=r.eye,h=1+mr(l,t)/(a+n),c=Math.sqrt(h*h-1),{minCurvature:u,maxCurvature:p,minSamples:y,maxSamples:f}=Sl,b=bl(e),w=nt((c-u)/(p-u),0,1),z=Math.round(te(y,f,w)),O=r.aboveGround,C=s.planes[5],E=[],D=ji(it,Ml,qi()),L=ji(it,Tl,qi());Ot(ei,0,0,0,0);const T=x=>{};for(let x=0;x<4;x++){const A=x===1&&!O||x===3&&O?1-b:0,g=x===1&&O||x===3&&!O?b:1,I=s.lines[x],M=s.lines[x===3?0:x+1];for(let R=0;R<z;R++){const V=R/z,k=R===0?0:te(A,g,x===1?1-(1-V)**2:x===3?V**2:V),N=Ct(Pl,I.origin,M.origin,k),J=$n(I.direction,M.direction,k,Cl);i.intersectManifoldClosestSilhouette(Or(N,J),n,Z),os(Z,l,Z,C),E.push(cr(Z)),E.length!==0&&T(oi(E.at(-1),Z));const ie=(Wi(D,Z)?1:0)|(Wi(L,Z)?2:0);ei[ie]=1}}E.length>2&&T(oi(E[0],E.at(-1)));const S=xl(xn(ei)>1?wl(ds(E,D),L):[E],i,o);return new ri({rings:S,spatialReference:o})}function xl(e,t,i){const r=2*dr();return e.map(s=>{const n=[];let o=!1;for(const a of s)t.fromRenderCoords(a,Z,i),Math.abs(a[0])<r&&Math.abs(a[1])<r?(n.push([null,Z[1]]),n.push([null,Z[1]]),o=!0):n.push([Z[0],Z[1]]);if(o)for(let a=0;a<n.length;a++){const l=n[a];if(l[0]!=null)continue;const h=n[a+1],c=n.at(a===0?-1:a-1);l[0]=c[0],a++;const u=n.at(a===n.length-1?0:a+1);h[0]=u[0]}return n.push(n[0]),fr(n)||n.reverse(),n})}function wl(e,t){const i=[];for(const r of e)i.push(...ds(r,t));return i}function ds(e,t){const i=[],r=[],s=dr();for(let o=0;o<e.length;o++){const a=e[o],l=o===e.length-1?e[0]:e[o+1],h=Vn(a,l,zl),c=kn(t,h.origin,h.vector,0,Z);switch(c){case 2:i.push(a);break;case 3:r.push(a);break;case 0:case 1:{const[u,p,y]=c===0?[1,i,r]:[-1,r,i],f=Bn(t),b=Se(_(),Z,f,u*s),w=Se(_(),Z,f,u*-s);p.push(a),p.push(b),y.push(w)}}}const n=[];return i.length&&n.push(i),r.length&&n.push(r),n}function bl(e){const{renderCoordsHelper:t,state:{camera:i}}=e,{center:r,eye:s}=i,n=Math.abs(t.getAltitude(r)),o=Math.abs(Math.PI/2-fl(t,r,s));return An(nr,t.referenceEllipsoid.radius+n),En(nr,o,i.distance,i.fovY)}const Sl={minCurvature:ae(5),maxCurvature:ae(50),minSamples:1,maxSamples:6},Ml=K(1,0,0),Tl=K(0,1,0),Cl=_(),Pl=_(),Z=_(),nr=Rt(),zl=Rn(),ei=Re();Object.freeze(Object.defineProperty({__proto__:null,directionToHeadingTilt:pl,eyeForCenterWithHeadingTilt:ml,eyeTiltToLookAtTilt:gl,headingTiltToDirectionUp:fs,lookAtTiltToEyeTilt:vl,toArea:yl,toExtent:_l},Symbol.toStringTag,{value:"Module"}));const Ol={COMPOSITE:"composite-color"},qu={SSAO:"ssao",LASERLINES:"laserline-color",HIGHLIGHTS:"highlight-color"};let He=class extends di{constructor(e){super(e),this.view=null,this.consumes={required:[]},this.produces=Ol.COMPOSITE,this.requireGeometryDepth=!1,this._dirty=!0}initialize(){this.addHandles([Fs(()=>this.view.ready,e=>{var t;e&&((t=this.view.stage)==null||t.renderer.addRenderNode(this))},Ds)])}destroy(){var e,t;(t=(e=this.view.stage)==null?void 0:e.renderer)==null||t.removeRenderNode(this)}precompile(){}render(){throw new wt("RenderNode:render-function-not-implemented","render() is not implemented.")}get camera(){return this.view.state.camera.clone()}get sunLight(){return this.bindParameters.lighting.legacy}get gl(){return this.view.stage.renderView.renderingContext.gl}get techniques(){return this.view.stage.renderView.techniques}acquireOutputFramebuffer(){var i,r,s;const e=(r=(i=this._frameBuffer)==null?void 0:i.getTexture())==null?void 0:r.descriptor,t=this.view.stage.renderer.fboCache.acquire((e==null?void 0:e.width)??640,(e==null?void 0:e.height)??480,this.produces);return(s=t.fbo)==null||s.initializeAndBind(),t}bindRenderTarget(){var e,t;return(t=(e=this._frameBuffer)==null?void 0:e.fbo)==null||t.initializeAndBind(),this._frameBuffer}requestRender(e){var t;switch(e){case 2:this.view.state.fading=!0;case 1:(t=this.view.stage)==null||t.renderView.requestRender(e);case 0:case void 0:this._dirty=!0}}resetWebGLState(){var e;this.renderingContext.resetState(),this.renderingContext.bindFramebuffer((e=this._frameBuffer)==null?void 0:e.fbo)}get fboCache(){return this.view.stage.renderer.fboCache}get bindParameters(){return this.renderContext.bind}get renderingContext(){return this.view.stage.renderView.renderingContext}get renderContext(){var e;return(e=this.view.stage)==null?void 0:e.renderer.renderContext}updateAnimation(e){return!!this._dirty&&(this._dirty=!1,!0)}doRender(e){this._frameBuffer=e.find(({name:t})=>t===this.produces);try{return this.render(e)}finally{this._frameBuffer=null}}};d([m({constructOnly:!0})],He.prototype,"view",void 0),d([m({constructOnly:!0})],He.prototype,"consumes",void 0),d([m()],He.prototype,"produces",void 0),d([m({readOnly:!0})],He.prototype,"techniques",null),He=d([gi("esri.views.3d.webgl.RenderNode")],He);const Wu=[],El=[new Ar("position",3,pr.FLOAT,0,12)],Al=[new Ar("position",2,pr.FLOAT,0,8)],Gu=Er(Al);Er(El);function Xu(e,t=!0){e.attributes.add("position","vec2"),t&&e.varyings.add("uv","vec2"),e.vertex.main.add(v`
      gl_Position = vec4(position, 0.0, 1.0);
      ${t?v`uv = position * 0.5 + vec2(0.5);`:""}
  `)}function Il(e){e.uniforms.add(new bi("zProjectionMap",t=>Fl(t.camera))),e.code.add(v`float linearizeDepth(float depth) {
float depthNdc = depth * 2.0 - 1.0;
float c1 = zProjectionMap[0];
float c2 = zProjectionMap[1];
return -(c1 / (depthNdc + c2 + 1e-7));
}`),e.code.add(v`float delinearizeDepth(float linearDepth) {
float c1 = zProjectionMap[0];
float c2 = zProjectionMap[1];
float depthNdc = (-c1/linearDepth) - c2 - 1e-7;
float depthNonlinear01 = (depthNdc + 1.0 ) / 2.0;
return depthNonlinear01;
}`),e.code.add(v`float depthFromTexture(sampler2D depthTexture, vec2 uv) {
ivec2 iuv = ivec2(uv * vec2(textureSize(depthTexture, 0)));
float depth = texelFetch(depthTexture, iuv, 0).r;
return depth;
}`),e.code.add(v`float linearDepthFromTexture(sampler2D depthTexture, vec2 uv) {
return linearizeDepth(depthFromTexture(depthTexture, uv));
}`)}function Fl(e){const t=e.projectionMatrix;return ii(Dl,t[14],t[10])}const Dl=_i();let Yu=class extends U{constructor(e,t,i){super(e,"vec2",2,(r,s,n,o)=>r.setUniform2fv(e,t(s,n,o),i))}},Rl=class extends U{constructor(e,t,i){super(e,"vec4",0,(r,s)=>r.setUniform4fv(e,t(s),i))}};function Ku(e){e.fragment.uniforms.add(new Rl("projInfo",t=>Ll(t.camera))),e.fragment.uniforms.add(new bi("zScale",t=>Vl(t.camera))),e.fragment.code.add(v`vec3 reconstructPosition(vec2 fragCoord, float depth) {
return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);
}`)}function Ll(e){const t=e.projectionMatrix;return t[11]===0?Ot(or,2/(e.fullWidth*t[0]),2/(e.fullHeight*t[5]),(1+t[12])/t[0],(1+t[13])/t[5]):Ot(or,-2/(e.fullWidth*t[0]),-2/(e.fullHeight*t[5]),(1-t[8])/t[0],(1-t[9])/t[5])}const or=Re();function Vl(e){return e.projectionMatrix[11]===0?ii(ar,0,1):ii(ar,1,0)}const ar=_i();function Ju(e){const t=3.141592653589793,i=.3183098861837907;e.constants.add("PI","float",t),e.constants.add("LIGHT_NORMALIZATION","float",i),e.constants.add("INV_PI","float",i),e.constants.add("HALF_PI","float",1.570796326794897),e.constants.add("TWO_PI","float",6.28318530717958)}let Zu=class extends U{constructor(e,t){super(e,"bool",0,(i,r)=>i.setUniform1b(e,t(r)))}},$l=class{constructor(e=rt()){this.intensity=e}};class Nl{constructor(t=rt(),i=K(.57735,.57735,.57735)){this.intensity=t,this.direction=i}}class ui{constructor(t=rt(),i=K(.57735,.57735,.57735),r=!0,s=1,n=1){this.intensity=t,this.direction=i,this.castShadows=r,this.specularStrength=s,this.environmentStrength=n}}let ps=class{constructor(){this.r=[0],this.g=[0],this.b=[0]}};function kl(e,t,i){(i=i||e).length=e.length;for(let r=0;r<e.length;r++)i[r]=e[r]*t[r];return i}function ti(e,t,i){(i=i||e).length=e.length;for(let r=0;r<e.length;r++)i[r]=e[r]*t;return i}function Xe(e,t,i){(i=i||e).length=e.length;for(let r=0;r<e.length;r++)i[r]=e[r]+t[r];return i}function ms(e){return(e+1)*(e+1)}function Bl(e){return nt(Math.floor(Math.sqrt(e)-1),0,2)}function vs(e,t,i){const r=e[0],s=e[1],n=e[2],o=i||[];return o.length=ms(t),t>=0&&(o[0]=.28209479177),t>=1&&(o[1]=.4886025119*r,o[2]=.4886025119*n,o[3]=.4886025119*s),t>=2&&(o[4]=1.09254843059*r*s,o[5]=1.09254843059*s*n,o[6]=.31539156525*(3*n*n-1),o[7]=1.09254843059*r*n,o[8]=.54627421529*(r*r-s*s)),o}function Hl(e,t){const i=ms(e),r=t||{r:[],g:[],b:[]};r.r.length=r.g.length=r.b.length=i;for(let s=0;s<i;s++)r.r[s]=r.g[s]=r.b[s]=0;return r}function Ul(e,t){const i=Bl(t.r.length);for(const r of e)gr(hi,r.direction),vs(hi,i,be),kl(be,Tt),ti(be,r.intensity[0],Ue),Xe(t.r,Ue),ti(be,r.intensity[1],Ue),Xe(t.g,Ue),ti(be,r.intensity[2],Ue),Xe(t.b,Ue);return t}function jl(e,t){vs(hi,0,be);for(const i of e)t.r[0]+=be[0]*Tt[0]*i.intensity[0]*4*Math.PI,t.g[0]+=be[0]*Tt[0]*i.intensity[1]*4*Math.PI,t.b[0]+=be[0]*Tt[0]*i.intensity[2]*4*Math.PI;return t}function ql(e,t,i,r){Hl(t,r),$(i.intensity,0,0,0);let s=!1;const n=Wl,o=Gl,a=Xl;n.length=0,o.length=0,a.length=0;for(const l of e)l instanceof ui&&!s?(j(i.direction,l.direction),j(i.intensity,l.intensity),i.specularStrength=l.specularStrength,i.environmentStrength=l.environmentStrength,i.castShadows=l.castShadows,s=!0):l instanceof ui||l instanceof Nl?n.push(l):l instanceof $l?o.push(l):l instanceof ps&&a.push(l);Ul(n,r),jl(o,r);for(const l of a)Xe(r.r,l.r),Xe(r.g,l.g),Xe(r.b,l.b)}const Wl=[],Gl=[],Xl=[],be=[0],Ue=[0],hi=_(),Tt=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398];class lr{constructor(){this.color=_(),this.intensity=1}}class Yl{constructor(){this.direction=_(),this.ambient=new lr,this.diffuse=new lr}}const Kl=.4;class Qu{constructor(){this._shOrder=2,this._legacy=new Yl,this.globalFactor=.5,this.noonFactor=.5,this._sphericalHarmonics=new ps,this._mainLight=new ui(_(),K(1,0,0),!1)}get legacy(){return this._legacy}get sh(){return this._sphericalHarmonics}get mainLight(){return this._mainLight}set(t){ql(t,this._shOrder,this._mainLight,this._sphericalHarmonics),this.updateLegacy()}updateLegacy(){j(this._legacy.direction,this._mainLight.direction);const t=1/Math.PI;this._legacy.ambient.color[0]=.282095*this._sphericalHarmonics.r[0]*t,this._legacy.ambient.color[1]=.282095*this._sphericalHarmonics.g[0]*t,this._legacy.ambient.color[2]=.282095*this._sphericalHarmonics.b[0]*t,W(this._legacy.diffuse.color,this._mainLight.intensity,t),j(xt,this._legacy.diffuse.color),W(xt,xt,Kl*this.globalFactor),oe(this._legacy.ambient.color,this._legacy.ambient.color,xt)}copyFrom(t){this._sphericalHarmonics.r=Array.from(t.sh.r),this._sphericalHarmonics.g=Array.from(t.sh.g),this._sphericalHarmonics.b=Array.from(t.sh.b),j(this._mainLight.direction,t.mainLight.direction),j(this._mainLight.intensity,t.mainLight.intensity),this._mainLight.castShadows=t.mainLight.castShadows,this._mainLight.specularStrength=t.mainLight.specularStrength,this._mainLight.environmentStrength=t.mainLight.environmentStrength,this.globalFactor=t.globalFactor,this.noonFactor=t.noonFactor}lerpLighting(t,i,r){if(Ct(this._mainLight.intensity,t.mainLight.intensity,i.mainLight.intensity,r),this._mainLight.environmentStrength=te(t.mainLight.environmentStrength,i.mainLight.environmentStrength,r),this._mainLight.specularStrength=te(t.mainLight.specularStrength,i.mainLight.specularStrength,r),j(this._mainLight.direction,i.mainLight.direction),this._mainLight.castShadows=i.mainLight.castShadows,this.globalFactor=te(t.globalFactor,i.globalFactor,r),this.noonFactor=te(t.noonFactor,i.noonFactor,r),t.sh.r.length===i.sh.r.length)for(let s=0;s<i.sh.r.length;s++)this._sphericalHarmonics.r[s]=te(t.sh.r[s],i.sh.r[s],r),this._sphericalHarmonics.g[s]=te(t.sh.g[s],i.sh.g[s],r),this._sphericalHarmonics.b[s]=te(t.sh.b[s],i.sh.b[s],r);else for(let s=0;s<i.sh.r.length;s++)this._sphericalHarmonics.r[s]=i.sh.r[s],this._sphericalHarmonics.g[s]=i.sh.g[s],this._sphericalHarmonics.b[s]=i.sh.b[s];this.updateLegacy()}}const xt=_();function eh(e,{occlusionPass:t,terrainDepthTest:i,cullAboveTerrain:r}){const{vertex:s,fragment:n,varyings:o}=e;if(!i)return s.code.add("void forwardViewPosDepth(vec3 pos) {}"),void n.code.add(`${t?"bool":"void"} discardByTerrainDepth() { ${se(t,"return false;")}}`);o.add("viewPosDepth","float",{invariant:!0}),s.code.add(`void forwardViewPosDepth(vec3 pos) {
    viewPosDepth = pos.z;
  }`),n.include(Il),n.uniforms.add(new es("terrainDepthTexture",a=>{var l;return(l=a.terrainDepth)==null?void 0:l.attachment})).code.add(v`
    ${t?"bool":"void"} discardByTerrainDepth() {
      float depth = texelFetch(terrainDepthTexture, ivec2(gl_FragCoord.xy), 0).r;
      float linearDepth = linearizeDepth(depth);
      ${t?"return viewPosDepth < linearDepth && depth < 1.0;":`if(viewPosDepth ${r?">":"<="} linearDepth) discard;`}
    }`)}function Jl(e){e.code.add(v`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)}function Zl(e){e.code.add(v`
    const float GAMMA = ${v.float(Oi)};
    const float INV_GAMMA = ${v.float(1/Oi)};

    vec4 delinearizeGamma(vec4 color) {
      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.a);
    }

    vec3 linearizeGamma(vec3 color) {
      return pow(color, vec3(GAMMA));
    }
  `)}const Ql=1;function ec(e,t){if(!st(t.output))return;e.fragment.include(Zl);const{emissionSource:i,hasEmissiveTextureTransform:r,bindType:s}=t,n=i===3||i===4||i===5;n&&(e.include(Ga,t),e.fragment.uniforms.add(s===1?new qa("texEmission",u=>u.textureEmissive):new Xa("texEmission",u=>u.textureEmissive)));const o=i===2||n;o&&e.fragment.uniforms.add(s===1?new xe("emissiveBaseColor",u=>u.emissiveBaseColor):new Ce("emissiveBaseColor",u=>u.emissiveBaseColor));const a=i!==0;a&&!(i===7||i===6||i===4||i===5)&&e.fragment.uniforms.add(s===1?new Ua("emissiveStrength",u=>u.emissiveStrength):new Ha("emissiveStrength",u=>u.emissiveStrength));const l=i===7,h=i===5,c=i===1||i===6||l;e.fragment.code.add(v`
    vec4 getEmissions(vec3 symbolColor) {
      vec4 emissions = ${o?h?"emissiveSource == 0 ? vec4(emissiveBaseColor, 1.0): vec4(linearizeGamma(symbolColor), 1.0)":"vec4(emissiveBaseColor, 1.0)":c?l?"emissiveSource == 0 ? vec4(0.0): vec4(linearizeGamma(symbolColor), 1.0)":"vec4(linearizeGamma(symbolColor), 1.0)":"vec4(0.0)"};
      ${se(n,`${se(h,`if(emissiveSource == 0) {
              vec4 emissiveFromTex = textureLookup(texEmission, ${r?"emissiveUV":"vuv0"});
              emissions *= vec4(linearizeGamma(emissiveFromTex.rgb), emissiveFromTex.a);
           }`,`vec4 emissiveFromTex = textureLookup(texEmission, ${r?"emissiveUV":"vuv0"});
           emissions *= vec4(linearizeGamma(emissiveFromTex.rgb), emissiveFromTex.a);`)}
        emissions.w = emissions.rgb == vec3(0.0) ? 0.0: emissions.w;`)}
      ${se(a,`emissions.rgb *= emissiveStrength * ${v.float(Ql)};`)}
      return emissions;
    }
  `)}function th(e,t){e.include(za,t),e.include(ec,t),e.fragment.include(Jl);const{output:i,oitPass:r,discardInvisibleFragments:s,snowCover:n}=t,o=i===10,a=xi(i),l=st(i)&&r===1,h=st(i)&&r!==1;let c=0;(h||a||l)&&e.outputs.add("fragColor","vec4",c++),a&&e.outputs.add("fragEmission","vec4",c++),l&&e.outputs.add("fragAlpha","float",c++),e.fragment.code.add(v`
    void outputColorHighlightOID(vec4 finalColor, const in vec3 vWorldPosition, vec3 emissiveSymbolColor ${se(n,", float snow")}) {
      ${se(o,"finalColor.a = 1.0;")}

      ${se(s,`if (finalColor.a < ${v.float(ja)}) { discard; }`)}

      finalColor = applySlice(finalColor, vWorldPosition);
      ${se(l,v`fragColor = premultiplyAlpha(finalColor);
             fragAlpha = finalColor.a;`)}
      ${se(h,"fragColor = finalColor;")}
      ${se(a,`fragEmission = ${se(n,"mix(finalColor.a * getEmissions(emissiveSymbolColor), vec4(0.0), snow);","finalColor.a * getEmissions(emissiveSymbolColor);")}`)}
      calculateOcclusionAndOutputHighlight();
      ${se(o,"outputObjectAndLayerIdColor();")}
    }
  `)}export{Ec as $,eh as A,U as B,jt as C,ja as D,Ba as E,qa as F,Jo as G,Au as H,To as I,Zu as J,Oc as K,Dc as L,co as M,uo as N,yo as O,Kc as P,Rl as Q,Ua as R,lo as S,Bc as T,st as U,qc as V,Ko as W,Qo as X,ta as Y,ht as Z,$c as _,Nc as a,xo as a$,Rc as a0,_o as a1,Gc as a2,Jc as a3,tu as a4,nu as a5,Xc as a6,Wc as a7,mu as a8,pu as a9,Ou as aA,bu as aB,pa as aC,Ju as aD,Kl as aE,Ga as aF,Ce as aG,Ca as aH,He as aI,qu as aJ,Gu as aK,Ic as aL,Uu as aM,Vc as aN,Gi as aO,Rr as aP,Lr as aQ,jc as aR,bo as aS,ia as aT,Po as aU,ra as aV,Io as aW,Mt as aX,Fc as aY,mo as aZ,Vr as a_,fu as aa,cu as ab,Yc as ac,Lt as ad,Fu as ae,wu as af,ya as ag,Eu as ah,Vt as ai,ma as aj,Hc as ak,_u as al,th as am,xe as an,Xu as ao,Il as ap,Xa as aq,Yu as ar,Ku as as,bi as at,ou as au,oa as av,va as aw,Pu as ax,zu as ay,xu as az,yu as b,Lc as b0,ku as b1,su as b2,gu as b3,hu as b4,vu as b5,du as b6,uu as b7,ga as b8,Ea as b9,Cu as ba,Ma as bb,Qc as bc,Wu as bd,$l as be,Qu as bf,Nu as bg,kc as bh,eu as bi,Ac as bj,Lu as bk,Vu as bl,Ru as bm,Iu as bn,$u as bo,Fo as bp,Uo as bq,Zc as br,ju as bs,Zl as bt,Wt as bu,Oa as bv,Hu as c,qr as d,la as e,lu as f,Qr as g,au as h,Tu as i,et as j,na as k,Jl as l,xa as m,za as n,Su as o,es as p,Du as q,iu as r,ru as s,_a as t,Bu as u,wa as v,jn as w,Mu as x,Sa as y,Uc as z};
