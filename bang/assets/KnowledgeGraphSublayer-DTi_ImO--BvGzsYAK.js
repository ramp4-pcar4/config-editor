const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./lclayout-uHKPd4rG-CAnOmEKh.js","./_commonjsHelpers-BITg13Vk-KnjfkSck.js"])))=>i.map(i=>d[i]);
import{ck as de,ch as Et,be as we,F as Te,l as K,fj as _t,cu as ie,C as ct,H as Nt,B as vt,aj as yt,P as ht,x as J,V as St,fK as Oe,bm as Lt,_ as Mt,bX as kt,m as h,E as m,n as Ne,fk as Dt,fl as Ct,h$ as ye,bp as $e,fZ as xt,i7 as je,c$ as Rt,v as mt,ml as pe,d$ as qe,Q as Ft,q as z,c5 as At,bP as Ot}from"./index-BeTPrQ6f.js";import{c as $t}from"./OptimizedGeometry-BYxlP_oK-DvAqrgO1.js";import{V as jt,a as ae,l as qt,n as xe,i as Re,r as Gt}from"./knowledgeGraphService-CuOTexj3-DwZahOQ0.js";import{N as Ie,W as he}from"./projectionUtils-CsX1UTBu-DsZaU4xz.js";import{_ as G,o as ke,E as me,S as Fe,I as Ee,t as _e}from"./constants-DVYXs0Da-SxxbBSOD.js";import{U as Pt}from"./featureConversionUtils-CZmIxyv5-DHwRSztU.js";import{F as Ge}from"./OptimizedFeature-C33SioFK-sn7DeAq-.js";import"./GraphicsLayer-DPoztXf7-DWF8RDJT.js";import{s as se,n as Pe,a as Ue}from"./Relationship-CxaLXN7a-hGAJ5x7P.js";import{b as oe}from"./Query-DKLDaFaA-I4zhlfzt.js";import{M as Ut}from"./MultiOriginJSONSupport-DNNJhlNT-Bm4fcG4m.js";import{p as Ht}from"./workers-CixlqDQM-CMoJ1YZN.js";import{a as ft,s as gt}from"./GraphicOrigin-BZpgptRb-BMZxic91.js";import{I as Qt}from"./FeatureStore-yiKuYgT--KW5N9_wn.js";import{i as Wt}from"./QueryEngine-CHUxUulR-BQNjp4Dj.js";import{d as He}from"./clientSideDefaults-BTftx6ta-Bkc3-ooB.js";import{f as zt}from"./fieldProperties-B4tOVJmv-DQSPMAAi.js";import{u as Vt,x as Bt}from"./FormTemplate-VNQ04sPR-DwlQPeuM.js";import{Y as Jt}from"./normalizeUtils-DK5542Ty-DtqBcgc2.js";import{s as Zt,t as Yt}from"./QueryEngineCapabilities-DPRPXYxY-DJC_YILC.js";import{e as Kt}from"./FeatureTemplate-DN-lMS1p-caqKKpFl.js";import{u as le,m as fe,i as Xt}from"./labelingInfo-jIy5P_vY-D8rEl7NY.js";import{c as ei,i as ti,n as ii}from"./BlendLayer-D8oJmNCO-A0sTzbOF.js";import{I as ri,v as si,b as ni}from"./DisplayFilteredLayer-Ce0lf91Z-D_UnOF-a.js";import{c as ai,s as oi}from"./FeatureEffectLayer-Bw8pqFtl-COIpRlV8.js";import{h as li,X as pi}from"./FeatureReductionLayer-fRVzjp_G-BAykrsM3.js";import{p as di,u as ui}from"./OrderedLayer-BpzV2gVo-B7bag0TS.js";import{k as ci}from"./RefreshableLayer-BEBm0YMm-CEdeDwog.js";import{r as yi}from"./ScaleRangeLayer-DkZwCH6_-C95kTMqN.js";import{v as hi,m as mi}from"./TemporalLayer-D43PzGI2-BVfMl_Wx.js";import{n as fi,c as gi,d as bi,h as wi,t as Ti}from"./OperationalLayer-Ds0FQSCg-DEUbTcjK.js";import{m as be}from"./Field-Dn1Bgq7n-CJCGLoNR.js";import{i as Ii}from"./TimeInfo-BoebCPJB-ubr6IA4W.js";import{t as Ei}from"./SimpleRenderer-DSyBXxyY-CGNZcXII.js";import{fromJSON as Qe}from"./jsonUtils-5anAqpiW-BnpEYfRl.js";import{_ as _i}from"./typeUtils-BTAsL08--B1VjqkPN.js";import{c as Ni}from"./FeatureSet-BIUKCqNW-D9YRl-VE.js";import{y as vi}from"./popupUtils-D0h6TFFF-Bch8GtRu.js";import{_ as We}from"./utils-DvP1Tc7W-CK5sH9q2.js";let Si=class{constructor(){this.version="",this.queryResult=new Li}},Li=class{constructor(){this.featureResult=new Mi}},Mi=class{constructor(){this.objectIdFieldName="",this.uniqueIdField=new ki,this.globalIdFieldName="",this.geohashFieldName="",this.geometryProperties=new Di,this.geometryType=null,this.spatialReference=new we,this.exceededTransferLimit=!1,this.hasZ=!1,this.hasM=!1,this.transform=new bt,this.fields=[],this.fieldNameToAttributeIndexMap={},this.values=[],this.features=[],this.geometryFields=[]}},ki=class{constructor(){this.name="",this.isSystemMaintained=!1}},Di=class{constructor(){this.shapeAreaFieldName="",this.shapeLengthFieldName="",this.units=""}},bt=class{constructor(){this.quantizeOriginPosition="upperLeft",this.scale=new Ci,this.translate=new xi}},Ci=class{constructor(){this.xScale=0,this.yScale=0,this.mScale=0,this.zScale=0}},xi=class{constructor(){this.xTranslate=0,this.yTranslate=0,this.mTranslate=0,this.zTranslate=0}},Ri=class{constructor(){this.name="",this.fieldType="esriFieldTypeString",this.alias="",this.sqlType="sqlTypeVarchar",this.domain="",this.defaultValue=""}},Fi=class{constructor(){this.attributes=[],this.compressedGeometry=new De,this.centroid=new De,this.aggregateGeometries=[]}},De=class{constructor(){this.geometryType=null,this.lengths=[],this.coords=[]}};const Ai=["ELEMENTUID","TYPENAME"],Oi={upperLeft:0,lowerLeft:1},$i={sqlTypeBigInt:0,sqlTypeBinary:1,sqlTypeBit:2,sqlTypeChar:3,sqlTypeDate:4,sqlTypeDecimal:5,sqlTypeDouble:6,sqlTypeFloat:7,sqlTypeGeometry:8,sqlTypeGUID:9,sqlTypeInteger:10,sqlTypeLongNVarchar:11,sqlTypeLongVarbinary:12,sqlTypeLongVarchar:13,sqlTypeNChar:14,sqlTypeNVarChar:15,sqlTypeOther:16,sqlTypeReal:17,sqlTypeSmallInt:18,sqlTypeSqlXml:19,sqlTypeTime:20,sqlTypeTimestamp:21,sqlTypeTimestamp2:22,sqlTypeTinyInt:23,sqlTypeVarbinary:24,sqlTypeVarchar:25};function ji(e){const t=new Si;t.version=e.version;const r=e.get_query_result();if(r.results_type.value!==0)throw new Error("Got a non-feature collection type");const i=r.get_feature_result(),s=t.queryResult.featureResult;s.objectIdFieldName=i.objectid_field_name,s.exceededTransferLimit=i.exceeded_transfer_limit,s.hasM=i.has_m,s.hasZ=i.has_z,s.geometryType=pe(Re,i.geometry_type.value),s.globalIdFieldName=i.globalid_field_name,s.geohashFieldName=i.geohash_field_name;const n=s.uniqueIdField,a=i.unique_id_field;n.name=a.name,n.isSystemMaintained=a.isSystemMaintained;const l=s.geometryProperties,d=i.geometry_properties;l.shapeAreaFieldName=d.shapeAreaFieldName,l.shapeLengthFieldName=d.shapeLengthFieldName,l.units=d.units;const u=s.spatialReference,y=i.spatial_reference;u.wkid=y.wkid,u.latestWkid=y.latestWkid,u.vcsWkid=y.vcsWkid,u.latestVcsWkid=y.latestVcsWkid,u.wkt=y.wkt,s.transform=Gi(i.transform);const o=s.fields,p=s.fieldNameToAttributeIndexMap,c=i.fields,w=c.size();for(let E=0;E<w;E++){const L=c.get(E),v=wt(L);o.push(v),p[v.name]=E,L.delete()}c.delete();const S=s.values,F=i.values_count();for(let E=0;E<F;E++)S.push(i.get_value_at(E));const f=s.features,_=i.features,x=_.size();if(x>0){for(const E of Ai)if(p[E]===void 0)throw new Error(`Feature collection missing required attribute: ${E}`)}for(let E=0;E<x;E++){const L=new Fi,v=_.get(E),A=L.attributes,q=v.attributes_count();for(let N=0;N<q;N++)A.push(v.get_attribute_at(N));const P=v.get_compressed_geometry();P&&(L.compressedGeometry=Se(P),L.centroid=Se(v.get_centroid()));const U=L.aggregateGeometries,$=v.aggregate_geometries,X=$.size();for(let N=0;N<X;N++){const b=$.get(N),D=Se(b);U.push(D),b.delete()}$.delete(),f.push(L),v.delete()}_.delete();const j=s.geometryFields,O=i.geometry_fields,k=O.size();for(let E=0;E<k;E++){const L=O.get(E),v=qi(L);j.push(v),L.delete()}return O.delete(),t}function Se(e){const t=new De;t.geometryType=pe(Re,e.geometry_type.value);const r=[],i=[];for(let s=0;s<e.lengths.length;s++)r.push(e.lengths[s]);for(let s=0;s<e.coords.length;s++)i.push(e.coords[s]);return t.lengths=r,t.coords=i,t}function wt(e){const t=new Ri;return t.name=e.name,t.alias=e.alias,t.fieldType=pe(Gt,e.field_type.value),t.sqlType=pe($i,e.sql_type.value),t.domain=e.domain,t.defaultValue=e.default_value,t}function qi(e){const t=wt(e);return t.geometryType=pe(Re,e.geometry_type.value),t}function Gi(e){const t=new bt;t.quantizeOriginPosition=pe(Oi,e.quantizeOriginPosition.value);const r=t.scale,i=e.scale;r.xScale=i.xScale,r.yScale=i.yScale,r.mScale=i.mScale,r.zScale=i.zScale;const s=t.translate,n=e.translate;return s.xTranslate=n.xTranslate,s.yTranslate=n.yTranslate,s.mTranslate=n.mTranslate,s.zTranslate=n.zTranslate,t}async function Pi(e){const t=[],r={generateAllSublayers:!1,namedTypeDefinitions:new Map};return e.entitiesUrl&&t.push(ze(e.entitiesUrl).then(i=>{Ve(i,r)})),e.relationshipsUrl&&t.push(ze(e.relationshipsUrl).then(i=>{Ve(i,r)})),await Promise.all(t),r}async function ss(e,t){t??(t=!1);const r={generateAllSublayers:t,namedTypeDefinitions:new Map};return await Qi(e).then(i=>{zi(i,r)}),r}async function ns(e){const t=await xe(),r=new t.MapOfObjectIdentifierSets;Ui(r,t,e);const i=new t.MapOfObjectIdentifierSetsEncoder;try{i.set_map_of_identifier_sets(r),i.encode();const s=i.get_encoding_result();if(s.error.error_code!==0)throw new K("knowledge-graph:layer-support-utils",s.error.error_message);const n=structuredClone(s.get_byte_buffer());return i.delete(),n}finally{r.delete()}}function Ui(e,t,r){for(const[i,s]of r.namedTypeDefinitions){if(!s.members||s.useAllData)continue;const n=s.members.keys();let a=!1,l=!0;const d=new t.ObjectIdArray,u=new t.StringArray,y=new t.GlobalIdArray,o=new t.IdentifierArray,p=new t.ObjectIdentifierSet;for(const c of n)l&&(a=!isNaN(Number(c)),l=!1),a?d.add_objectid(Number(c)):(u.add_string(c),y.add_globalid(c)),o.add_identifier(c);p.set_oid_array(d),p.set_string_array(u),p.set_globalid_array(y),p.set_identifier_array(o),d.delete(),u.delete(),y.delete(),o.delete(),e.put_identifier_set(i,p),p.delete()}return e}async function ze(e){const t=await mt(e,{responseType:"array-buffer"});return Hi(await t.data)}async function Hi(e){const t=new(await xe()).FeatureCollectionDecoder,r=t.decode(new Uint8Array(e));if(r.error_code!==0)throw new K("knowledge-graph:layer-support-utils",r.error_message);const i=t.get_feature_collection(),s=ji(i);return t.delete(),s}async function Qi(e){const t=await mt(e,{responseType:"array-buffer"}),r=await t.data;return Wi(new Uint8Array(r))}async function Wi(e){const t=new(await xe()).MapOfObjectIdentifierSetsDecoder,r=t.decode(new Uint8Array(e)),i=new Map;if(r.error_code!==0)throw new K("knowledge-graph:layer-support-utils",r.error_message);const s=t.get_map_of_identifier_sets(),n=s.keys,a=n.size();for(let l=0;l<a;l++){const d=n.get(l),u=s.query_identifier_set(d),y=[];if(u.id_array_type.value===1){const o=u.get_globalid_array(),p=o.count();for(let c=0;c<p;c++)y.push(o.get_globalid_at(c))}else if(u.id_array_type.value===3){const o=u.get_identifier_array(),p=o.count();for(let c=0;c<p;c++)y.push(o.get_identifier_at(c).toString())}else if(u.id_array_type.value===2){const o=u.get_string_array(),p=o.count();for(let c=0;c<p;c++)y.push(o.get_string_at(c))}else{if(u.id_array_type.value!==0)throw new K("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const o=u.get_oid_array(),p=o.count();for(let c=0;c<p;c++)y.push(o.get_objectid_at(c).toString())}}i.set(d,y)}return t.delete(),i}function Ve(e,t){var i,s,n;if(!((i=e==null?void 0:e.queryResult)!=null&&i.featureResult))return t;const r=e.queryResult.featureResult.fieldNameToAttributeIndexMap;for(const a of e.queryResult.featureResult.features){const l=a.attributes[r.TYPENAME],d=J(t.namedTypeDefinitions,l,()=>({useAllData:!1,members:new Map})),u=a.attributes[r.ELEMENTUID];if(((n=(s=a.compressedGeometry)==null?void 0:s.coords)==null?void 0:n.length)>0){let y=a.compressedGeometry.lengths;a.compressedGeometry.geometryType==="esriGeometryPoint"&&(y=[]),d.members.set(u,{id:u,linkChartLocation:new $t(y,a.compressedGeometry.coords)})}else d.members.set(u,{id:u})}return t}function zi(e,t){for(const[r,i]of e){const s=J(t.namedTypeDefinitions,r,()=>({useAllData:!1,members:new Map}));for(const n of i)s.members.has(n)||s.members.set(n,{id:n})}return t}const as={fetchAndConvertSerializedLinkChart:e=>Pi(e)},Ce=(e,t)=>{if(e.type==="column-reference")return e.column===t.systemOidFieldName?"ID(n)":`n.${e.column}`;if(e.type==="string")return`'${e.value}'`;if(e.type==="number")return`${e.value}`;if(e.type==="binary-expression"&&t.supportedSqlTypes.has(e.left.type)&&t.supportedSqlTypes.has(e.right.type)&&t.supportedSqlOperators.has(e.operator))return`${Ce(e.left,t)} ${e.operator} ${Ce(e.right,t)}`;if(e.type==="binary-expression"&&e.operator==="LIKE"){let r="";if(e.left.type==="function"&&e.left.args.value[0].type==="column-reference")r+=`lower(n.${e.left.args.value[0].column})`;else{if(e.left.type!=="column-reference")return t.unsupportedOperationFound=!0,"";r+=`lower(n.${e.left.column})`}if(r+=" CONTAINS (",e.right.type!=="string")return t.unsupportedOperationFound=!0,"";{let i=e.right.value;i.startsWith("%")&&(i=i.slice(1)),i.endsWith("%")&&(i=i.slice(0,-1)),r+=`'${i.toLowerCase()}')`}return r}return t.unsupportedOperationFound=!0,""};let Le=class ne{constructor(){this._featureLookup=new Map}static getInstance(){return ne.instance||(ne.instance=new ne),ne.instance}static resetInstance(){ne.instance&&(ne.instance=null)}deleteFromStore(t){t.forEach(r=>{this._featureLookup.delete(r)})}readFromStoreByList(t){const r=[];return t.forEach(i=>{const s=this.readFromStoreById(i);s&&r.push(s)}),r}readFromStoreById(t){return this._featureLookup.get(t)??null}writeToStore(t,r,i){const s=[];return t.forEach(n=>{if(!(n!=null&&n.id))return;n.properties||(n.properties=[]);let a,l=null;if(i&&n.properties[i]&&(l=Pt(n.properties[i])),"originId"in n&&"destinationId"in n&&(n.properties[Ee]=n.originId,n.properties[_e]=n.destinationId),n.properties[r]=n.id,n.id&&this._featureLookup.has(n.id)&&this._featureLookup.get(n.id).attributes){const d=this._featureLookup.get(n.id),u=JSON.parse(JSON.stringify(Object.assign(d.attributes,n.properties)));i&&n.properties[i]&&(u[i]=Lt(n.properties[i])),a=new Ge(l?JSON.parse(JSON.stringify(l)):d!=null&&d.geometry?JSON.parse(JSON.stringify(d.geometry)):null,u,null,n.properties[r])}else a=new Ge(l?JSON.parse(JSON.stringify(l)):null,n.properties,null,n.properties[r]);this._featureLookup.set(`${n.typeName?`${n.typeName}__${n.id}`:n.id}`,a),s.push(a)}),s}},Me,I=null;function os(){return Me||(Me=Mt(()=>import("./lclayout-uHKPd4rG-CAnOmEKh.js"),__vite__mapDeps([0,1]),import.meta.url).then(e=>e.l).then(({default:e})=>e({locateFile:t=>kt(`esri/libs/linkchartlayout/${t}`)})).then(e=>{Vi(e)}),Me)}function Vi(e){I=e}const Be={right:0,left:1,top:2,bottom:3},Je={none:0,"start-only":1,"start-and-end":2};function Bi(e){const t={timeDirection:"right",timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:"start-and-end",showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0,...e==null?void 0:e.toJSON(),eventsTicksVisualization:(e==null?void 0:e.eventsTicksVisualization)??"start-and-end"};return{...t,timeDirection:{value:Be[t.timeDirection]??Be.right},eventsTicksVisualization:{value:Je[t.eventsTicksVisualization]??Je["start-and-end"]}}}function re(e,t,r,i,s,n){const a=r.length,l=s.length,d=Float64Array.BYTES_PER_ELEMENT,u=Uint32Array.BYTES_PER_ELEMENT,y=Uint8Array.BYTES_PER_ELEMENT,o=16,p=o+a*(y+2*d)+l*(2*u),c=I._malloc(p);try{const w=c+o-c%o,S=w+a*d,F=S+a*d,f=F+l*u,_=f+l*u,x=()=>[I.HEAPF64.subarray(w>>3,(w>>3)+a),I.HEAPF64.subarray(S>>3,(S>>3)+a),I.HEAPU32.subarray(F>>2,(F>>2)+l),I.HEAPU32.subarray(f>>2,(f>>2)+l),I.HEAPU8.subarray(_,_+a)],[j,O,k,E,L]=x();j.set(r),O.set(i),k.set(s),E.set(n),L.set(t);const v=e(a,_,w,S,l,F,f);let A=null,q=null;if(v.value===0){const b=I.getLayoutLinksTypes(),D=I.getLayoutLinksVerticesEndIndices(),R=I.getLayoutLinksVertices(),C=I.countLayoutLinksVertices();!l||b&&D?C&&!R?v.value=1:(A={types:new Uint8Array(I.HEAPU8.subarray(b,b+l)),vertexEndIndex:new Uint32Array(I.HEAPU32.subarray(D>>2,(D>>2)+l)),vertices:new Float64Array(I.HEAPF64.subarray(R>>3,(R>>3)+2*C))},q=I.getAuxiliaryGraphicElements()):v.value=1}const[P,U,$,X,N]=x();return r.set(P),i.set(U),s.set($),n.set(X),t.set(N),{status:v.value,links:A,graphics:q}}finally{I._free(c),I.cleanupLayout()}}const Ze=2,Ye=1,Ke=-1;var Xe,et,tt,it,rt,st,nt;(function(e){function t(){return I.getMinIdealEdgeLength()}function r(i,s,n,a,l,d,u=Ze,y=Ye,o=Ke){return re((p,c,w,S,F,f,_)=>I.applyForceDirectedLayout(i,p,c,w,S,F,f,_,u,y,o),s,n,a,l,d)}e.getMinIdealEdgeLength=t,e.apply=r})(Xe||(Xe={})),function(e){function t(r,i,s,n,a,l,d=Ze,u=Ye,y=Ke){return re((o,p,c,w,S,F,f)=>I.applyCommunityLayout(r,o,p,c,w,S,F,f,d,u,y),i,s,n,a,l)}e.apply=t}(et||(et={})),function(e){function t(r,i,s,n,a,l){return re((d,u,y,o,p,c,w)=>I.applySimpleLayout(r,d,u,y,o,p,c,w),i,s,n,a,l)}e.apply=t}(tt||(tt={})),function(e){function t(r,i,s,n,a,l){return re((d,u,y,o,p,c,w)=>I.applyHierarchicalLayout(r,d,u,y,o,p,c,w),i,s,n,a,l)}e.apply=t}(it||(it={})),function(e){function t(r,i,s,n,a,l){return re((d,u,y,o,p,c,w)=>I.applyRadialTreeLayout(r,d,u,y,o,p,c,w),i,s,n,a,l)}e.apply=t}(rt||(rt={})),function(e){function t(r,i,s,n,a,l){return re((d,u,y,o,p,c,w)=>I.applySmartTreeLayout(r,d,u,y,o,p,c,w),i,s,n,a,l)}e.apply=t}(st||(st={})),function(e){function t(r,i,s,n,a,l,d,u,y,o,p,c){return re((w,S,F,f,_,x,j)=>{if(a.length!==w)return{value:1};if(l.length!==w)return{value:1};if(y.length!==_)return{value:1};if(o.length!==_)return{value:1};const O=Float64Array.BYTES_PER_ELEMENT,k=16,E=I._malloc(k+w*O),L=I._malloc(k+w*O),v=I._malloc(k+_*O),A=I._malloc(k+_*O),q=E+k-E%k,P=L+k-L%k,U=v+k-v%k,$=A+k-A%k;try{return I.HEAPF64.subarray(q>>3,(q>>3)+w).set(a),I.HEAPF64.subarray(P>>3,(P>>3)+w).set(l),I.HEAPF64.subarray(U>>3,(U>>3)+_).set(y),I.HEAPF64.subarray($>>3,($>>3)+_).set(o),I.applyChronologicalLayout(r,w,S,F,f,q,P,_,x,j,U,$,p,Bi(c))}finally{I._free(E),I._free(L),I._free(v),I._free(A)}},i,s,n,d,u)}e.apply=t}(nt||(nt={})),qe()({none:"none",startAndEnd:"start-and-end",startOnly:"start-only"}),qe()({absoluteValue:"absolute-value",multiplier:"multiplier"});const Ji=new Map([["basic-grid","basic-grid"],["geographic-organic-standard","geographic-organic-standard"],["hierarchical-bottom-to-top","hierarchical-bottom-to-top"],["hierarchical-top-to-bottom","hierarchical-bottom-to-top"],["organic-community","organic-community"],["organic-fusiform","organic-standard"],["organic-leaf-circle","organic-standard"],["organic-standard","organic-standard"],["radial-node-centric","radial-root-centric"],["radial-root-centric","radial-root-centric"],["tree-bottom-to-top","tree-left-to-right"],["tree-left-to-right","tree-left-to-right"],["tree-right-to-left","tree-left-to-right"],["tree-top-to-bottom","tree-left-to-right"],["chronological-mono-timeline","chronological-mono-timeline"],["chronological-multi-timeline","chronological-multi-timeline"]]);function Zi(e,t){var i,s;const r=new Map;if((i=t.dataModel)!=null&&i.relationshipTypes)for(const n of t.dataModel.relationshipTypes)n.name&&r.set(n.name,[]);for(const n of e)r.has(n.typeName)&&((s=r.get(n.typeName))==null||s.push(n.id));return r}async function ls(e,t,r){const i=[],s=Zi(e,t),n={},a=[];for(const[y,o]of s){if(o.length<1)continue;const p=`${y}_ids`;n[p]=o,a.push(`MATCH (n)-[r:${y}]->(m) WHERE id(r) in $${p} RETURN id(n), labels(n)[0], id(m), labels(m)[0]`)}if(a.length===0)return[];const l=a.join(" UNION "),d=new se({openCypherQuery:l,bindParameters:n}),u=(await ae(t,d,r==null?void 0:r.requestOptions)).resultRowsStream.getReader();for(;;){const{done:y,value:o}=await u.read();if(y)break;for(const p of o)i.push({id:p[0],typeName:p[1]}),i.push({id:p[2],typeName:p[3]})}return i}const ps=e=>Ji.get(e)??"radial-root-centric";function Yi(e){if(!e.spatialReference.isWGS84)throw new K("knowledge-graph:layer-support-utils","The utilsExtentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map(t=>[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]])}let B=class extends yt{constructor(e){var r,i,s;super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const t=new Map;(r=e.knowledgeGraph.dataModel.entityTypes)==null||r.forEach(n=>{var a,l;n.name&&(t.set(n.name,"entity"),this._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!((a=e.inclusionModeDefinition)!=null&&a.generateAllSublayers)||this.entityTypeNames.add(n.name),(l=n.properties)==null||l.forEach(d=>{d.geometryType&&d.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(n.name,{name:d.name??"",geometryType:d.geometryType})}))}),(i=e.knowledgeGraph.dataModel.relationshipTypes)==null||i.forEach(n=>{var a,l;n.name&&(t.set(n.name,"relationship"),this._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!((a=e.inclusionModeDefinition)!=null&&a.generateAllSublayers)||this.relationshipTypeNames.add(n.name),(l=n.properties)==null||l.forEach(d=>{d.geometryType&&d.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(n.name,{name:d.name??"",geometryType:d.geometryType})}))}),(s=e.inclusionModeDefinition)==null||s.namedTypeDefinitions.forEach((n,a)=>{var d,u;if(t.get(a)==="entity")this.entityTypeNames.add(a);else{if(t.get(a)!=="relationship")return ht.getLogger(this).warn(`A named type, ${a}, was in the inclusion list that wasn't in the data model and will be removed`),void((d=e.inclusionModeDefinition)==null?void 0:d.namedTypeDefinitions.delete(a));this.relationshipTypeNames.add(a)}const l=new Map;(u=n.members)==null||u.forEach(y=>{J(this.memberIdTypeLookup,y.id,()=>new Set).add(a)}),this.sublayerCaches.set(a,l)})}addToLayer(e){e.forEach(({typeName:t,id:r})=>{if(!this.inclusionModeDefinition)throw new K("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){const i=this.inclusionModeDefinition.namedTypeDefinitions.get(t);i.members||(i.members=new Map),i.members.set(r,{id:r}),J(this.memberIdTypeLookup,r,()=>new Set).add(t)}}else{const i=new Map;i.set(r,{id:r}),this.inclusionModeDefinition.namedTypeDefinitions.set(t,{useAllData:!1,members:i}),J(this.memberIdTypeLookup,r,()=>new Set).add(t)}})}getById(e){return Le.getInstance().readFromStoreById(e)}async getData(e,t,r){var s,n;if(t.objectType.name&&((s=this.inclusionModeDefinition)!=null&&s.namedTypeDefinitions)&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let i;if(i=e||new oe({where:"1=1",outFields:["*"]}),t.parentCompositeLayer.type==="link-chart"){const a=t.parentCompositeLayer,l=this._processingCacheUpdatesLookup.get(t.objectType.name??""),d=i.outFields;d&&d.length===1&&d[0]===G&&i.where==="1=1"||await Promise.all(l??[]);const u=this.sublayerCaches.has(t.objectType.name??"")?Array.from((n=this.sublayerCaches.get(t.objectType.name))==null?void 0:n.values()):[],y=[];return u.forEach(o=>{if(this.relationshipTypeNames.has(t.objectType.name)){o.geometry=a.relationshipLinkChartDiagramLookup.get(o.attributes[t.objectIdField]);const p=this.memberIdTypeLookup.get(o.attributes[Ee]),c=this.memberIdTypeLookup.get(o.attributes[_e]),w=this._isEndEntitySpatial(p,o,Ee),S=this._isEndEntitySpatial(c,o,_e);o.attributes[me]=Number(w&&S)}else{o.geometry=a.entityLinkChartDiagramLookup.get(o.attributes[t.objectIdField]);const p=this.geographicLookup.get(t.objectType.name);p&&o.attributes[p.name]?o.attributes[me]=1:o.attributes[me]=0}o.attributes[Fe]=o.geometry,y.push(o)}),y}return this.retrieveDataFromService(i,t,r)}async getConnectedRecordIds(e,t,r){const i=[];let s="";const n=this._getNamedTypeIdMapFromNodeIds(e);if(t&&(t==null?void 0:t.length)!==0){for(const y of t)s=s+y+"|";s=s.slice(0,-1)}const a={},l=[];for(const[y,o]of n){const p=`${y}_ids`;a[p]=o,t&&(t==null?void 0:t.length)!==0?l.push(`MATCH (n:${y}) WHERE id(n) IN $${p} WITH n MATCH (n)-[r:${s}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`):l.push(`MATCH (n:${y}) WHERE id(n) IN $${p} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`)}if(!l.length)return i;const d=l.join(" UNION "),u=(await ae(this.knowledgeGraph,new se({openCypherQuery:d,bindParameters:a}),{signal:r==null?void 0:r.signal})).resultRowsStream.getReader();for(;;){const{done:y,value:o}=await u.read();if(y)break;for(let p=0;p<o.length;p++){const c=o[p];i.push({id:c[0],typeName:c[1]}),i.push({id:c[2],typeName:c[3]})}}return i}async getRelationshipsBetweenNodes(e,t,r){const i=this._getNamedTypeIdMapFromNodeIds(e);if(i.size===0)return[];const s={relationshipExclusionIds:t,possibleConnectionEntityIds:e},n=[];for(const[u,y]of i.entries()){const o=`${u}_ids`;s[o]=y,n.push(`MATCH (n:${u}) WHERE id(n) IN $${o} WITH n MATCH (n)-[r]->(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`)}const a=n.join(" UNION "),l=[],d=(await ae(this.knowledgeGraph,new se({openCypherQuery:a,bindParameters:s}),{signal:r==null?void 0:r.signal})).resultRowsStream.getReader();for(;;){const{done:u,value:y}=await d.read();if(u)break;for(let o=0;o<y.length;o++){const p=y[o];l.push({id:p[0],typeName:p[1]})}}return l}async getRelationshipsFromNodes(e,t,r,i){const s=this._getNamedTypeIdMapFromNodeIds(e);if(s.size===0||t.length===0)return[];const n={relationshipExclusionIds:r,possibleConnectionEntityIds:t},a=[];for(const[o,p]of s.entries()){const c=`${o}_ids`;n[c]=p,a.push(`MATCH (n:${o}) WHERE id(n) IN $${c} WITH n MATCH (n)-[r]-(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`)}const l=a.join(" UNION "),d=new Map,u=(await ae(this.knowledgeGraph,new se({openCypherQuery:l,bindParameters:n}),{signal:i==null?void 0:i.signal})).resultRowsStream.getReader();for(;;){const{done:o,value:p}=await u.read();if(o)break;for(let c=0;c<p.length;c++){const w=p[c];let S=d.get(w[1]);S||(S=new Set,d.set(w[1],S)),S.add(w[0])}}const y=[];for(const[o,p]of d)for(const c of p)y.push({id:c,typeName:o});return y}async refreshCacheContent(e,t,r,i=!0,s){var u,y,o,p,c,w,S,F;const n=Le.getInstance(),a=[],l=new Map,d=new Map;(u=this.knowledgeGraph.dataModel.entityTypes)==null||u.forEach(f=>{f.name&&d.set(f.name,f)}),(y=this.knowledgeGraph.dataModel.relationshipTypes)==null||y.forEach(f=>{f.name&&d.set(f.name,f)}),e||this.inclusionModeDefinition?e?e.forEach(f=>{var _;if(this.memberIdTypeLookup.has(f))for(const x of this.memberIdTypeLookup.get(f))l.has(x)?(_=l.get(x))==null||_.push(f):l.set(x,[f])}):(p=(o=this.inclusionModeDefinition)==null?void 0:o.namedTypeDefinitions)==null||p.forEach((f,_)=>{f.useAllData?l.set(_,null):f.members&&f.members.forEach(x=>{var j;l.has(_)&&l.get(_)!==null?(j=l.get(_))==null||j.push(x.id):l.set(_,[x.id])})}):((c=this.knowledgeGraph.dataModel.entityTypes)==null||c.forEach(f=>{f.name&&l.set(f.name,null)}),(w=this.knowledgeGraph.dataModel.entityTypes)==null||w.forEach(f=>{f.name&&l.set(f.name,null)}));for(const[f,_]of l){const x=new Set(_),j=new Promise((O,k)=>{(async()=>{var $,X,N,b,D,R,C,M,H;const E=new Set,L=[];let v,A="",q=!1;if(t||((X=($=d.get(f))==null?void 0:$.properties)==null||X.forEach(T=>{T.name&&E.add(T.name)})),r&&this.geographicLookup.has(f)){const T=(N=this.geographicLookup.get(f))==null?void 0:N.name;T&&E.add(T)}if(this.entityTypeNames.has(f))A=`MATCH (n:${f}) ${_?"WHERE id(n) IN $ids ":""}return ID(n)`,E.forEach(T=>{A+=`, n.${T}`,L.push(T)});else{if(!this.relationshipTypeNames.has(f))throw new K("knowledge-graph:layer-data-manager",`The graph type of ${f} could not be determined. Was this type set in the KG data model and inclusion definition?`);q=!0,A=`MATCH ()-[n:${f}]->() ${_?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,E.forEach(T=>{A+=`, n.${T}`,L.push(T)})}v=new se(_?{openCypherQuery:A,bindParameters:{ids:_}}:{openCypherQuery:A});const P=(await ae(this.knowledgeGraph,v,{signal:s==null?void 0:s.signal})).resultRowsStream.getReader();for(;;){const{done:T,value:ee}=await P.read();if(T)break;const Ae=[];for(let Z=0;Z<ee.length;Z++){const te=ee[Z];let Q=0,ge=0;const W={properties:{}};for(W.id=te[Q],Q++,ge++,q&&(W.originId=te[Q],Q++,ge++,W.destinationId=te[Q],Q++,ge++,J(this.nodeConnectionsLookup,W.originId,()=>new Set).add(W.id),J(this.nodeConnectionsLookup,W.destinationId,()=>new Set).add(W.id),J(this.relationshipConnectionsLookup,W.id,()=>[W.originId,W.destinationId]));Q<te.length;Q++)W.properties[L[Q-ge]]=te[Q];x.delete(W.id),Ae.push(W)}const It=n.writeToStore(Ae,G,(b=this.geographicLookup.get(f))==null?void 0:b.name);this.sublayerCaches.has(f)||this.sublayerCaches.set(f,new Map),i&&!((D=this.inclusionModeDefinition)!=null&&D.namedTypeDefinitions.has(f))&&((R=this.inclusionModeDefinition)==null||R.namedTypeDefinitions.set(f,{useAllData:!1,members:new Map})),i&&!((C=this.inclusionModeDefinition)!=null&&C.namedTypeDefinitions.get(f).members)&&(this.inclusionModeDefinition.namedTypeDefinitions.get(f).members=new Map);const ve=this.sublayerCaches.get(f);It.forEach(Z=>{var te,Q;ve==null||ve.set(Z.attributes[G],Z),i&&!((te=this.inclusionModeDefinition)!=null&&te.namedTypeDefinitions.get(f).members.has(Z.attributes[G]))&&((Q=this.inclusionModeDefinition)==null||Q.namedTypeDefinitions.get(f).members.set(Z.attributes[G],{id:Z.attributes[G]}),J(this.memberIdTypeLookup,Z.attributes[G],()=>new Set).add(f))})}const U=(M=this.inclusionModeDefinition)==null?void 0:M.namedTypeDefinitions.get(f);if(U)for(const T of x)(H=U.members)==null||H.delete(T)})().then(()=>{O(null)}).catch(E=>{E.name==="AbortError"?O(null):k(E)})});a.push(j),(S=this._processingCacheUpdatesLookup.get(f))==null||S.push(j)}if(await Promise.all(a),(F=s==null?void 0:s.signal)==null?void 0:F.aborted)throw St()}removeFromLayer(e){var i,s,n;const t=new Set,r=new Set(e.map(a=>a.id));for(const a of e)t.add(a.typeName),((i=this.memberIdTypeLookup.get(a.id))==null?void 0:i.size)===1?this.memberIdTypeLookup.delete(a.id):(s=this.memberIdTypeLookup.get(a.id))==null||s.delete(a.typeName),(n=this.inclusionModeDefinition)==null||n.namedTypeDefinitions.forEach((l,d)=>{var u;d===a.typeName&&((u=l.members)!=null&&u.has(a.id))&&l.members.delete(a.id)});t.forEach(a=>{var l;(l=this.sublayerCaches.get(a))==null||l.forEach((d,u)=>{var y;r.has(u)&&((y=this.sublayerCaches.get(a))==null||y.delete(u))})})}async retrieveDataFromService(e,t,r){var w,S,F,f,_,x,j,O,k,E,L,v,A,q,P,U,$,X;const i=Le.getInstance(),s=new Set,n=[];let a,l="",d=[];const u=t.graphType==="relationship",y=(F=(S=(w=this.inclusionModeDefinition)==null?void 0:w.namedTypeDefinitions)==null?void 0:S.get(t.objectType.name))==null?void 0:F.useAllData,o=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let p=!y&&o?Array.from(o).sort():null;if((x=(_=(f=this.inclusionModeDefinition)==null?void 0:f.namedTypeDefinitions)==null?void 0:_.get(t.objectType.name))!=null&&x.useAllData)(k=(O=(j=this.inclusionModeDefinition)==null?void 0:j.namedTypeDefinitions)==null?void 0:O.get(t.objectType.name))!=null&&k.useAllData&&e.objectIds!=null&&(p=e.objectIds);else if(e.objectIds!=null&&p&&p.length>0){const N=e.objectIds;e.objectIds=p.filter(b=>N.includes(b))}else if(e.objectIds!=null)p=e.objectIds;else{if((E=this.inclusionModeDefinition)!=null&&E.namedTypeDefinitions.has(t.objectType.name)&&(!((L=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))!=null&&L.members)||((A=(v=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))==null?void 0:v.members)==null?void 0:A.size)<1))return e.objectIds=[],[];e.objectIds=p}if(e.outFields!=null){const N=e.outFields;N.includes("*")?t.fields.forEach(b=>{s.add(b.name)}):N.forEach(b=>{b!==G&&b!==t.geometryFieldName&&s.add(b)})}if(e.geometry!=null){const N=e.geometry;let b;const D=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,R=D==null?void 0:D.spatialReference,C=(q=D==null?void 0:D.serviceCapabilities)==null?void 0:q.geometryCapabilities;let M=C==null?void 0:C.geometryMaxBoundingRectangleSizeX,H=C==null?void 0:C.geometryMaxBoundingRectangleSizeY;if(N.type==="point"){let T=N;(P=T.spatialReference)!=null&&P.isWGS84||(await Ie(T.spatialReference,ie),T=he(T,ie)),b=new Te({spatialReference:ie,xmin:T.x-1e-4,ymin:T.y-1e-4,xmax:T.x+1e-4,ymax:T.y+1e-4})}else(U=N==null?void 0:N.extent)!=null&&U.spatialReference&&!(($=N.spatialReference)!=null&&$.isWGS84)?(await Ie(N.extent.spatialReference,ie),b=he(N.extent,ie)):b=N.extent;if(M&&H&&R){if(R.wkid!==4326){const T=new Te({spatialReference:R,xmax:M,ymax:H}),ee=he(T,ie);M=ee.xmax,H=ee.ymax}if(b.xmax-b.xmin>M)throw new K("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${M}° latitude, limit exceeded`);if(b.ymax-b.ymin>H)throw new K("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${H}° longitude, limit exceeded`)}if(e.where!=null&&e.where!=="1=1"){const T=await Oe(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach(ee=>{T.fieldNames.includes(ee.name)&&s.add(ee.name)})}l=u?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&s.add(t.geometryFieldName),s.forEach(T=>{l+=`, n.${T}`,n.push(T)}),a=new se({openCypherQuery:l,bindParameters:{param_filter_geom:new ct({rings:Yi(b)})}})}else{let N="";if(e.where!=null&&e.where!=="1=1"){const R=await Oe(e.where,t.fieldsIndex);t.fields.forEach(M=>{R.fieldNames.includes(M.name)&&s.add(M.name)});const C={systemOidFieldName:G,supportedSqlTypes:new Set(["column-reference","string","number","binary-expression"]),supportedSqlOperators:new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]),unsupportedOperationFound:!1};N=Ce(R.parseTree,C),C.unsupportedOperationFound&&(N="")}let b="";b=u?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let D=!1;p&&(D=!0,b+=" WHERE ID(n) IN $ids"),N&&(b+=D?" AND":" WHERE",b+=` ${N}`),b+=" return ID(n)",u&&(b+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&s.add(t.geometryFieldName),s.forEach(R=>{b+=`, n.${R}`,n.push(R)}),a=new se(p?{openCypherQuery:b,bindParameters:{ids:p}}:{openCypherQuery:b})}const c=(await ae(t.parentCompositeLayer.dataManager.knowledgeGraph,a,r)).resultRowsStream.getReader();for(;;){const{done:N,value:b}=await c.read();if(N)break;const D=[];for(let R=0;R<b.length;R++){const C=b[R];let M=0,H=0;const T={properties:{}};for(T.id=C[M],M++,H++,u&&(T.originId=C[M],M++,H++,T.destinationId=C[M],M++,H++);M<C.length;M++)T.properties[n[M-H]]=C[M];D.push(T)}d=d.concat(i.writeToStore(D,G,(X=t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name))==null?void 0:X.name))}return d}_isEndEntitySpatial(e,t,r){var i;for(const s of e??[])if(this.entityTypeNames.has(s)){const n=this.geographicLookup.get(s),a=n&&((i=this.sublayerCaches.get(s))==null?void 0:i.get(t.attributes[r]));if(n&&(a!=null&&a.attributes[n.name]))return!0}return!1}_getNamedTypeIdMapFromNodeIds(e){const t=new Map;return e.forEach(r=>{var i;if(this.memberIdTypeLookup.has(r))for(const s of this.memberIdTypeLookup.get(r)){if(!this.entityTypeNames.has(s))return;t.has(s)?(i=t.get(s))==null||i.push(r):t.set(s,[r])}}),t}};h([m()],B.prototype,"knowledgeGraph",void 0),h([m()],B.prototype,"inclusionModeDefinition",void 0),h([m()],B.prototype,"entityTypeNames",void 0),h([m()],B.prototype,"relationshipTypeNames",void 0),h([m()],B.prototype,"geographicLookup",void 0),h([m()],B.prototype,"sublayerCaches",void 0),h([m()],B.prototype,"nodeConnectionsLookup",void 0),h([m()],B.prototype,"relationshipConnectionsLookup",void 0),h([m()],B.prototype,"memberIdTypeLookup",void 0),B=h([Ne("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],B);const Ki=Symbol("isKnowledgeGraphGraphicOriginSymbol");var at;class Xi extends ft{get[(at=Ki,Dt)](){return this.sublayer}get[Ct](){return this.sublayer}get[gt](){return this.sublayer}constructor(t,r){super(),this[at]=!0,this.type="knowledge-graph",this.layer=t,this.sublayer=r}get id(){return this.layer.id}}const er=Symbol("isLinkChartGraphicOriginSymbol");var ot;class tr extends ft{get[(ot=er,gt)](){return this.layer}constructor(t,r){super(),this[ot]=!0,this.type="link-chart",this.layer=t,this.sublayer=r}get id(){return`${this.layer.id}:__${this.sublayer.id}__`}}const lt=zt(),ir=e=>{const t=e;let r=class extends t{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return h([m(lt.fields)],r.prototype,"fields",void 0),h([m(lt.fieldsIndex)],r.prototype,"fieldsIndex",void 0),r=h([Ne("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],r),r},rr=Vt;let Y=class extends yt{constructor(e){super(e),this.entityAdds=void 0,this.entityUpdates=void 0,this.entityDeletes=void 0,this.relationshipAdds=void 0,this.relationshipUpdates=void 0,this.relationshipDeletes=void 0,this.options=void 0}};h([m()],Y.prototype,"entityAdds",void 0),h([m()],Y.prototype,"entityUpdates",void 0),h([m()],Y.prototype,"entityDeletes",void 0),h([m()],Y.prototype,"relationshipAdds",void 0),h([m()],Y.prototype,"relationshipUpdates",void 0),h([m()],Y.prototype,"relationshipDeletes",void 0),h([m()],Y.prototype,"options",void 0),Y=h([Ne("esri.rest.knowledgeGraph.GraphApplyEdits")],Y);const sr={initializeLayersFromClientData:async(e,t,r)=>{if(t||(t=[...e.layers,...e.tables].map(n=>n.graphTypeName)),(t==null?void 0:t.length)===0)return;const i=new Map;for(const n of t)i.set(n,pt(e,n));const s=await qt(e.dataManager.knowledgeGraph,Array.from(i.values()),{requestOptions:{signal:r==null?void 0:r.signal}});for(const n of[...e.layers,...e.tables]){const a=n.objectType.name;if(a==null)continue;const l=s.get(pt(e,a));if(l){const d=JSON.parse(l);d===null||typeof d!="object"||d.hasOwnProperty("showLabels")||(d.showLabels=!1),n.read(d,{origin:"service"})}}}},pt=(e,t)=>e.type==="knowledge-graph"?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;async function ds(e,t,r){return sr.initializeLayersFromClientData(e,t,r)}const dt=["#4a0932","#b31515","#18382e","#a64f1b","#102432","#8c213f","#ed9310","#2c6954","#144d59","#ffc730","#75351e","#454f4b","#78b1c2","#191921","#8f8f82","#9be0c0","#dbb658","#87b051","#11495c","#c43541","#9c5596","#44498b","#ad9d63","#86afb3","#5c98ca","#b0bfa2","#73241f","#b86b53","#d9d78c","#3e756d","#f260a1","#a0d17d","#c27c30","#eb82eb","#ffdf3c","#ffb259","#ab52b3","#3cccb4","#0095ba","#d92b30"],nr="#8f8f82";function ar(e){return e<0||e>=dt.length?new $e(nr):new $e(dt[e])}function or(e){const t=e.toArray();return new xt({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,style:"solid",width:.75,color:t},{type:"CIMVectorMarker",enable:!0,size:6,markerPlacement:{type:"CIMMarkerPlacementOnLine",angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-10,ymin:-5,xmax:0,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[-12,-3.47],[-12,3.6],[1.96,-.03],[-12,-3.47]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:t}]}}]}]}}})}function lr(e){let t="ESRI__ID",r=4;for(const i of e)if(i.name){if(i.name.toLowerCase()==="name"){t=i.name;break}i.name.toLowerCase().includes("name")?(t=i.name,r=2):i.fieldType==="esriFieldTypeString"&&r>3&&(t=i.name,r=3)}return t}function pr(e,t,r){const i={color:[80,80,80],haloColor:[255,255,255],haloSize:.7,font:{size:10,weight:"normal"}},s=new le({labelExpressionInfo:new fe({expression:r==="ESRI__ID"?`${t}`:`$feature.${r}`}),labelPlacement:"above-center",symbol:new ye(i)}),n=new le({labelExpressionInfo:new fe({expression:`'${t}' + IIf($feature.ESRI__AggregationCount>1, ' (' + $feature.ESRI__AggregationCount + ')', '')`}),labelPlacement:"center-along",labelPosition:"parallel",repeatLabel:!1,symbol:new ye({...i,yoffset:"12px"})});return e==="entity"?[s]:[n]}function dr(e,t,r){const i={color:[255,255,255],haloColor:[0,0,0],haloSize:.7,font:{size:10,weight:"bold"}},s=r==="ESRI__ID"?`${e}`:`$feature.${r}`;return t==="point"?[new le({labelExpressionInfo:new fe({expression:s}),labelPlacement:"above-center",symbol:new ye(i)})]:t==="polyline"?[new le({labelExpressionInfo:new fe({expression:s}),labelPlacement:"center-along",repeatLabel:!0,symbol:new ye(i)})]:t==="polygon"?[new le({labelExpressionInfo:new fe({expression:s}),labelPlacement:"always-horizontal",symbol:new ye(i)})]:null}const ur={capabilities:[],allowGeometryUpdates:!1,serviceCapabilities:{geometryCapabilities:{supportsZValues:!1,supportsMValues:!1}}};function cr(e){const{capabilities:t,allowGeometryUpdates:r,serviceCapabilities:{geometryCapabilities:{supportsZValues:i,supportsMValues:s}}}=(e==null?void 0:e.serviceDefinition)||ur,n=e!=null&&e.dataModel.arcgisManaged?t:t.filter(l=>l==="Query"),a=new Set(n);return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:s,supportsZ:i},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:a.has("Create"),supportsDelete:a.has("Delete"),supportsEditing:a.has("Editing"),supportsChangeTracking:!1,supportsQuery:a.has("Query"),supportsQueryBins:!1,supportsQueryPivot:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:a.has("Update"),supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},query:Yt,queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:Zt,editing:{supportsGeometryUpdate:!!(e!=null&&e.dataModel.arcgisManaged)&&r,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:a.has("Delete"),supportsUpdateByAnonymous:!1,supportsUpdateByOthers:a.has("Update"),supportsAsyncApplyEdits:!1,zDefault:void 0}}}async function yr(e,t){var y;const r=new Y,i=t.graphTypeName,s=t.graphType,n=t.parentCompositeLayer.type==="knowledge-graph"?t.geometryFieldName:null,a=!!((y=t.fieldsIndex.get(n))!=null&&y.editable),l=o=>{const p={...o};for(const c of t.fields)c.editable||delete p[c.name];for(const c of Object.keys(o))c.includes("ESRI__")&&delete p[c];return p},d=async o=>{await Ie(o.spatialReference,we.WGS84);const p=he(o,we.WGS84);return p.type==="point"?p.normalize():(await Jt(p))[0]};for(const o of e.addFeatures??[]){const p=l(o.attributes);je(o.sourceLayer)&&o.sourceLayer.graphTypeName===i&&(s==="entity"?(r.entityAdds||(r.entityAdds=[]),n&&o.geometry&&(p[n]=await d(o.geometry)),r.entityAdds.push(new Pe({properties:p,typeName:i}))):(r.relationshipAdds||(r.relationshipAdds=[]),r.relationshipAdds.push(new Ue({properties:p,typeName:i}))))}for(const o of e.updateFeatures??[]){const p=o.attributes[G],c=l(o.attributes);je(o.sourceLayer)&&o.sourceLayer.graphTypeName===i&&(s==="entity"?(r.entityUpdates||(r.entityUpdates=[]),n&&a&&o.geometry&&(c[n]=await d(o.geometry)),r.entityUpdates.push(new Pe({id:p,properties:c,typeName:i}))):(r.relationshipUpdates||(r.relationshipUpdates=[]),r.relationshipUpdates.push(new Ue({id:p,properties:c,typeName:i}))))}const u=new Map;for(const o of e.deleteFeatures??[])if(Rt(o)){const p=o,c=J(u,p.sourceLayer.graphTypeName,()=>({typeName:p.sourceLayer.graphTypeName,ids:[]}));p.sourceLayer.graphTypeName===i&&c.ids.push(p.attributes[G])}else o.objectId&&typeof o.objectId=="string"&&J(u,i,()=>({typeName:i,ids:[]})).ids.push(o.objectId);for(const o of u.values())o.ids.length>0&&(s==="entity"?(r.entityDeletes||(r.entityDeletes=[]),r.entityDeletes.push({typeName:o.typeName,ids:o.ids})):(r.relationshipDeletes||(r.relationshipDeletes=[]),r.relationshipDeletes.push({typeName:o.typeName,ids:o.ids})));return r}function hr(e,t){const r={addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]};for(const i of e.editResults)if(i.typeName===t){for(const s of i.adds)r.addFeatureResults.push({objectId:s.id,globalId:s.id});for(const s of i.updates)r.updateFeatureResults.push({objectId:s.id,globalId:s.id});for(const s of i.deletes)r.deleteFeatureResults.push({objectId:s.id,globalId:s.id})}return r}function mr(e){if(!e.objectType)return null;const t=[];for(const r of e.fields)!r.name.includes("ESRI__")&&r.editable&&r.type!=="geometry"&&t.push(new rr({fieldName:r.name}));return new Bt({elements:t})}function fr(e){if(!e.objectType)return null;let t=null;switch(e.geometryType){case"point":case"multipoint":t="point";break;case"polyline":t="line";break;case"polygon":t="polygon";break;default:t=null}return[new Kt({name:e.graphTypeName,drawingTool:t,prototype:{}})]}function V(e){if(!e.json)return e;e.json.write=ut(e.json.write);const t=e.json.origins;if(!t)return e;let r;for(r in t){const i=t[r];i&&(i.write=ut(i.write))}return e}function ut(e){return typeof e=="object"&&e?(e.enabled!==!1&&(e.overridePolicy=gr(e)),e):e===!0?ue():e}function gr(e){const{target:t,writer:r,overridePolicy:i,...s}=e;return function(n,a){const l=Tt.call(this,n,a);return l.enabled?{...s,...l}:l}}function ue(){return{overridePolicy:Tt}}function Tt(e,t){const r=!!this.geometryType;let i={enabled:r};return r&&(i={...i,...ce.call(this,e,t)}),i}function ce(e,t){return{ignoreOrigin:this.originIdOf(t)>0}}let g=class extends ir(ri(li(ai(ei(di(hi(yi(ci(Ut(Ft)))))))))){constructor(e){super(e),this.blendMode="normal",this.charts=null,this.definitionExpression=null,this.displayFilterEnabled=!0,this.displayFilterInfo=null,this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=G,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then(()=>{const t=new MessageChannel;return new Ht(t.port1,{channel:t,client:{queryFeatures:(r,i={})=>{const s=oe.fromJSON(r);return this.queryFeaturesJSON(s,i)}}}),[t.port2]})},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get capabilities(){return this.parent?this.parent.sublayerCapabilities:cr(null)}get userHasUpdateItemPrivileges(){var e;return!!((e=this.parent)!=null&&e.userHasUpdateItemPrivileges)}get editingEnabled(){return this._isOverridden("editingEnabled")?this._get("editingEnabled"):this.capabilities.operations.supportsEditing}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}get isTable(){return this.parentCompositeLayer.type!=="link-chart"&&this.geometryFieldName==null}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){var t,r;const e=[];return(r=(t=this.objectType)==null?void 0:t.properties)==null||r.forEach(i=>{const s=i.fieldType==="esriFieldTypeOID"?"esriFieldTypeInteger":i.fieldType;e.push(be.fromJSON({name:i.name,type:s,alias:i.alias,defaultValue:i.defaultValue,editable:i.editable,nullable:i.nullable}))}),e.push(be.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),be.fromJSON({name:ke,type:"esriFieldTypeInteger",alias:ke,editable:!1}),be.fromJSON({name:me,type:"esriFieldTypeInteger",alias:me,editable:!1})),e}get formTemplate(){return this._isOverridden("formTemplate")?this._get("formTemplate"):mr(this)}set formTemplate(e){this._overrideIfSome("formTemplate",e)}get geometryType(){var r,i,s;if(((r=this.parentCompositeLayer)==null?void 0:r.type)==="link-chart")return this.graphType==="relationship"?"polyline":"point";const e=(s=this.parentCompositeLayer)==null?void 0:s.dataManager.geographicLookup.get((i=this.objectType)==null?void 0:i.name),t=e==null?void 0:e.geometryType;return t&&t!=="esriGeometryNull"?de.fromJSON(t):null}get geometryFieldName(){var e,t,r,i;return((e=this.parentCompositeLayer)==null?void 0:e.type)==="link-chart"?Fe:((i=(r=this.parentCompositeLayer)==null?void 0:r.dataManager.geographicLookup.get((t=this.objectType)==null?void 0:t.name))==null?void 0:i.name)??null}get graphicOrigin(){if(!this.parent)return null;switch(this.parent.type){case"knowledge-graph":return new Xi(this.parent,this);case"link-chart":return new tr(this.parent,this)}}get graphTypeName(){var e;return(e=this.objectType)==null?void 0:e.name}set graphTypeName(e){this._set("graphTypeName",e)}get hasM(){var r,i,s,n,a;const e=(i=this.parentCompositeLayer)==null?void 0:i.dataManager.geographicLookup.get((r=this.objectType)==null?void 0:r.name),t=e==null?void 0:e.name;return((a=t?(n=(s=this.objectType)==null?void 0:s.properties)==null?void 0:n[t]:null)==null?void 0:a.hasM)??!1}get hasZ(){var r,i,s,n,a;const e=(i=this.parentCompositeLayer)==null?void 0:i.dataManager.geographicLookup.get((r=this.objectType)==null?void 0:r.name),t=e==null?void 0:e.name;return((a=t?(n=(s=this.objectType)==null?void 0:s.properties)==null?void 0:n[t]:null)==null?void 0:a.hasZ)??!1}set labelingInfo(e){this._set("labelingInfo",e)}get labelingInfo(){if(this._isOverridden("labelingInfo"))return this._get("labelingInfo");if(!this.objectType||!this.parentCompositeLayer||!this.graphTypeName)return null;const e=this.objectType.properties?lr(this.objectType.properties):"ESRI__ID";return this.parentCompositeLayer.type==="link-chart"?pr(this.graphType,this.graphTypeName,e):dr(this.graphTypeName,this.geometryType,e)}set renderer(e){Et(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){var s,n,a,l;if(this._isOverridden("renderer"))return this._get("renderer");const e=(a=(n=(s=this.parentCompositeLayer)==null?void 0:s.dataManager)==null?void 0:n.knowledgeGraph)==null?void 0:a.dataModel,t=[...(e==null?void 0:e.entityTypes)??[],...(e==null?void 0:e.relationshipTypes)??[]].map(d=>d.name).indexOf(this.graphTypeName),r=ar(t);if(((l=this.parentCompositeLayer)==null?void 0:l.type)==="link-chart"){if(this.graphType==="relationship")return new Ei({type:"simple",symbol:or(r)});const d=Qe(He(de.toJSON("point")).renderer);return We(d.symbol,r),d}const i=Qe(He(de.toJSON(this.geometryType)).renderer);return We(i.symbol,r),i}get spatialReference(){var e,t,r,i;return((i=(r=(t=(e=this.parentCompositeLayer)==null?void 0:e.dataManager)==null?void 0:t.knowledgeGraph)==null?void 0:r.dataModel)==null?void 0:i.spatialReference)??we.WGS84}get templates(){return this._isOverridden("templates")?this._get("templates"):fr(this)}set templates(e){this._overrideIfSome("templates",e)}set timeInfo(e){this._set("timeInfo",e)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(e){this._set("title",e)}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return vi(this,e)}createQuery(){return new oe({where:"1=1",outFields:["*"]})}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){return null}async queryFeatures(e,t){await this.load();const{resolvedQuery:r,queryEngine:i}=await this._setupQueryObjects(e),s=this.graphicOrigin,n=Ni.fromJSON(await i.executeQuery(r.toJSON(),t==null?void 0:t.signal));return n.features.forEach(a=>{a.sourceLayer=this,a.origin=s}),n}async queryFeaturesJSON(e,t){await this.load();const{resolvedQuery:r,queryEngine:i}=await this._setupQueryObjects(e);return await i.executeQuery(r.toJSON(),t==null?void 0:t.signal)}async queryFeatureCount(e,t){await this.load();const{resolvedQuery:r,queryEngine:i}=await this._setupQueryObjects(e);return i.executeQueryForCount(r.toJSON(),t==null?void 0:t.signal)}async queryExtent(e={},t){var l,d,u,y;await this.load();const r={...e,returnGeometry:!0},{resolvedQuery:i,queryEngine:s}=await this._setupQueryObjects(r),n=await s.executeQueryForExtent(i.toJSON(),t==null?void 0:t.signal);let a;return a=((l=n.extent)==null?void 0:l.xmin)!=null&&((d=n.extent)==null?void 0:d.xmax)!=null&&((u=n.extent)==null?void 0:u.ymin)!=null&&((y=n.extent)==null?void 0:y.ymax)!=null?new Te(n.extent):new Te,{count:n.count,extent:a}}async queryObjectIds(e,t){await this.load();const r=oe.from(e);let i;if(this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)i=this._cachedQueryEngine;else{const s=await this.parentCompositeLayer.dataManager.getData(r,this,t);i=this.loadQueryEngine(s)}return await i.executeQueryForIds(r.toJSON(),t==null?void 0:t.signal)}async applyEdits(e){var n;if(!this.parentCompositeLayer.dataManager.knowledgeGraph)throw new K("knowledge-graph-sublayer:no-knowledge-graph","ApplyEdits cannot be executed because the parent does not have a Knowledge Graph model.  This is usually caused by the layer not yet being loaded");const t=await yr(e,this);t.options={cascadeDelete:!0,cascadeProvenanceDelete:!!((n=this.parent)!=null&&n.knowledgeGraph.serviceDefinition.supportsProvenance)||void 0};const r=await jt(this.parentCompositeLayer.dataManager.knowledgeGraph,t),i=hr(r,this.graphTypeName),s={addedFeatures:i.addFeatureResults,updatedFeatures:i.updateFeatureResults,deletedFeatures:i.deleteFeatureResults,addedAttachments:i.addAttachmentResults,deletedAttachments:i.deleteAttachmentResults,updatedAttachments:i.updateAttachmentResults,exceededTransferLimit:!1,historicMoment:new Date,edits:void 0};return this.emit("edits",s),this.emit("apply-edits",{result:Promise.resolve(s)}),this.parentCompositeLayer.type==="link-chart"&&await this.parentCompositeLayer.refreshLinkChartCache([...s.addedFeatures.map(a=>a.globalId),...s.updatedFeatures.map(a=>a.globalId),...s.deletedFeatures.map(a=>a.globalId)]),i}loadQueryEngine(e){var i;const t=new Qt({geometryType:de.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),r=new Wt({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:de.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,featureIdInfo:{type:"object-id",fieldName:this.objectIdField},spatialReference:this.spatialReference.toJSON(),timeInfo:(i=this.timeInfo)==null?void 0:i.toJSON(),featureStore:t});return r.featureStore.addMany(e),r}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new oe({where:"1=1",outFields:[G]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}load(e){return this.addResolvingPromise(this.parent.load(e).then(()=>_t(this.timeInfo,this.fieldsIndex))),Promise.resolve(this)}async _setupQueryObjects(e,t){var n;const r=oe.from(e),i=r.geometry;if(i&&!((n=i.spatialReference)!=null&&n.isWGS84)&&(await Ie(i.spatialReference,ie),r.geometry=he(i instanceof ct||i instanceof Nt||i instanceof vt?i:i.extent,ie)),this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)return{resolvedQuery:r,queryEngine:this._cachedQueryEngine};const s=await this.parentCompositeLayer.dataManager.getData(r,this,t);return{resolvedQuery:r,queryEngine:this.loadQueryEngine(s)}}};function br(e,t,r){var s,n;const i=[["ESRI__AGGREGATION_COUNT",ke],["ESRI__ORIGIN_ID",Ee],["ESRI__DESTINATION_ID",_e],["ESRI__LAYOUT_GEOMETRY",Fe]];try{for(const a of e)for(const[l,d]of i)a.labelExpression=(s=a.labelExpression)==null?void 0:s.replaceAll(l,d),(n=a.labelExpressionInfo)!=null&&n.expression&&(a.labelExpressionInfo.expression=a.labelExpressionInfo.expression.replaceAll(l,d))}catch(a){ht.getLogger(this).warn("Error updating labelingInfo",a)}return Xt(e,t,r)}h([m(V(z(ti)))],g.prototype,"blendMode",void 0),h([m({readOnly:!0})],g.prototype,"capabilities",null),h([m({readOnly:!0})],g.prototype,"userHasUpdateItemPrivileges",null),h([m({type:Boolean})],g.prototype,"editingEnabled",null),h([m()],g.prototype,"isTable",null),h([m({json:{origins:{"web-scene":{write:!1}},write:ue()}})],g.prototype,"charts",void 0),h([m({readOnly:!0})],g.prototype,"defaultPopupTemplate",null),h([m({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],g.prototype,"definitionExpression",void 0),h([m(V(z(si)))],g.prototype,"displayFilterEnabled",void 0),h([m(V(z(ni)))],g.prototype,"displayFilterInfo",void 0),h([m(V(z(ii)))],g.prototype,"effect",void 0),h([m()],g.prototype,"elevationInfo",void 0),h([m(V(z(oi)))],g.prototype,"featureEffect",void 0),h([m(V(z(pi)))],g.prototype,"featureReduction",null),h([m()],g.prototype,"fields",null),h([m()],g.prototype,"formTemplate",null),h([m()],g.prototype,"geometryType",null),h([m()],g.prototype,"geometryFieldName",null),h([m({readOnly:!0})],g.prototype,"graphicOrigin",null),h([m({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],g.prototype,"graphType",void 0),h([m({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],g.prototype,"graphTypeName",null),h([m()],g.prototype,"hasM",null),h([m()],g.prototype,"hasZ",null),h([m({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],g.prototype,"id",void 0),h([m({type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",default:!1,write:{overridePolicy(){return{enabled:!!this.geometryType,alwaysWriteDefaults:!0,ignoreOrigin:!0}}}}})],g.prototype,"labelsVisible",void 0),h([m({type:[le],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:br,write:ue()}})],g.prototype,"labelingInfo",null),h([m({readOnly:!0,json:{read:!1,write:{writer(e,t){var r;switch((r=this.parentCompositeLayer)==null?void 0:r.type){case"link-chart":t.layerType="LinkChartSubLayer";break;case"knowledge-graph":t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],g.prototype,"layerType",void 0),h([m(V(z(fi)))],g.prototype,"legendEnabled",void 0),h([m(V(z(gi)))],g.prototype,"maxScale",void 0),h([m(V(z(bi)))],g.prototype,"minScale",void 0),h([m()],g.prototype,"objectIdField",void 0),h([m()],g.prototype,"objectType",void 0),h([m(V(z(wi)))],g.prototype,"opacity",void 0),h([m(V(z(ui)))],g.prototype,"orderBy",void 0),h([m({clonable:!1})],g.prototype,"parent",void 0),h([m()],g.prototype,"parentCompositeLayer",void 0),h([m(V(z(Ti)))],g.prototype,"popupEnabled",void 0),h([m({type:At,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],g.prototype,"popupTemplate",void 0),h([m({type:Number,json:{write:{overridePolicy:ce}}})],g.prototype,"refreshInterval",void 0),h([m({types:_i,json:{name:"layerDefinition.drawingInfo.renderer",write:ue()}})],g.prototype,"renderer",null),h([m()],g.prototype,"source",void 0),h([m()],g.prototype,"spatialReference",null),h([m()],g.prototype,"templates",null),h([m({type:Ii,json:{name:"layerDefinition.timeInfo",write:{overridePolicy:ce},origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:{overridePolicy:ce}},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:{overridePolicy:ce}}}}})],g.prototype,"timeInfo",null),h([m({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],g.prototype,"title",null),h([Ot("title")],g.prototype,"writeTitle",null),h([m({json:{read:!1}})],g.prototype,"type",void 0),h([m(V(z(mi)))],g.prototype,"useViewTime",void 0),h([m({type:Boolean,json:{name:"visibility",write:ue()}})],g.prototype,"visible",void 0),g=h([Ne("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],g);export{B as $,ns as C,ss as D,ls as H,it as L,rt as M,Xe as N,ps as Q,tt as S,ds as X,nt as a,g as b,os as c,Le as h,as as j,st as k,cr as l,et as v};
