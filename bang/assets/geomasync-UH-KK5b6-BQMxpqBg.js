const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./unitConversion-Dsm_H0Dm-eZfwiAJA.js","./enum-D3e-PyKo-Bl5V5br5.js","./index-BeTPrQ6f.js","./index-BlWAJbpo.css"])))=>i.map(i=>d[i]);
import{b5 as w,bm as h,r as g,F as b,H as D,_ as Y,B as F,C as R,D as G,d4 as $,bW as H,G as nn,v as M}from"./index-BeTPrQ6f.js";import{e as O,D as x,h as en,z as an,O as tn,I as rn,R as on,k as sn,t as V}from"./arcade-WEshytE2-CynglP9_.js";import{T as d,l as k,v as m,j as W,m as B,_ as X,w as v,N as C,U as L,a0 as q,L as E,a1 as Z,a2 as z,e as P,s as un,D as j,A as T,X as U}from"./Dictionary-B0UU8VOj-BnHchtFP.js";import{c as i}from"./enum-D3e-PyKo-Bl5V5br5.js";import{H as J}from"./TimeOnly-BFfVS_ja-C4MPGwCM.js";import{n as K}from"./portalUtils-BQqUZtd_-DC5noOca.js";import{n as f}from"./operatorsWorkerConnection-BI0u3kJm-CDhqefZJ.js";import"./arcadeEnvironment-CGtXgdl9-Db3WjmFu.js";import"./Feature-DEFbFbhW-MI6BQTTC.js";import"./featureConversionUtils-CZmIxyv5-DHwRSztU.js";import"./OptimizedFeature-C33SioFK-sn7DeAq-.js";import"./memoryEstimations-C_GUL8g_-JniNFd5l.js";import"./OptimizedGeometry-BYxlP_oK-DvAqrgO1.js";import"./OptimizedFeatureSet-Dz5hF8Qm-CgsRgxJh.js";import"./FieldsIndex-Ds4D9xP7-BiTuE5Z3.js";import"./UnknownTimeZone-DzO8gKMe-d6rtFXqm.js";import"./timeZoneUtils-CdK7eU4Y-fyhJ3EFx.js";import"./ImmutableArray-CiJxhY8_-Kqx7aWRu.js";import"./shared-DXZ65waB-BM-XH3jC.js";import"./Field-Dn1Bgq7n-CJCGLoNR.js";import"./fieldType-DvW5hpfa-DYUbIy_X.js";import"./number-BsNxu9Ry-D0lLRJTw.js";import"./aiServices-BhAKf1Iw-D6L8gru6.js";import"./commonProperties-D1Pjvz5u-DHiB1uzW.js";import"./utils-CRANtbnc-C6zyufvL.js";import"./WhereClause-DrmAQ3eI-CwdMrUuP.js";import"./streamLayerUtils-CcwO9-27-DFlbJ4P1.js";import"./unitConversion-Dsm_H0Dm-eZfwiAJA.js";import"./uuid-CFz2qBzH-cIdlpVG-.js";import"./workers-CixlqDQM-CMoJ1YZN.js";import"./Queue-CK6TduSr-C-T211SM.js";import"./intl-DRhjUnwt-Dihhq8dq.js";import"./messages-DQ10DjvF-6kk0dzjG.js";async function Q(r,e,a){var n,t;if(!((n=nn)!=null&&n.findCredential(r.restUrl)))return null;if(r.loadStatus==="loaded"&&e===""&&((t=r.user)!=null&&t.sourceJSON)&&a===!1)return r.user.sourceJSON;const u={responseType:"json",query:{f:"json"}};if(a&&(u.query.returnUserLicenseTypeExtensions=!0),e===""){const o=await M(r.restUrl+"/community/self",u);if(o.data){const s=o.data;if(s!=null&&s.username)return s}return null}const l=await M(r.restUrl+"/community/users/"+e,u);if(l.data){const o=l.data;return o.error?null:o}return null}function p(r){if(r==null)return r;switch(typeof r){case"string":case"number":return r;default:throw new i(null,"InvalidParameter",null)}}function Gn(r){r.mode==="async"&&(r.functions.disjoint=function(e,a){return r.standardFunctionAsync(e,a,(u,l,n)=>(n=d(n),O(n,e,a),n[0]===null||n[1]===null||f("disjoint",[n[0].toJSON(),n[1].toJSON()])))},r.functions.intersects=function(e,a){return r.standardFunctionAsync(e,a,(u,l,n)=>(n=d(n),O(n,e,a),n[0]!==null&&n[1]!==null&&f("intersects",[n[0].toJSON(),n[1].toJSON()])))},r.functions.touches=function(e,a){return r.standardFunctionAsync(e,a,(u,l,n)=>(n=d(n),O(n,e,a),n[0]!==null&&n[1]!==null&&f("touches",[n[0].toJSON(),n[1].toJSON()])))},r.functions.crosses=function(e,a){return r.standardFunctionAsync(e,a,(u,l,n)=>(n=d(n),O(n,e,a),n[0]!==null&&n[1]!==null&&f("crosses",[n[0].toJSON(),n[1].toJSON()])))},r.functions.within=function(e,a){return r.standardFunctionAsync(e,a,(u,l,n)=>(n=d(n),O(n,e,a),n[0]!==null&&n[1]!==null&&f("within",[n[0].toJSON(),n[1].toJSON()])))},r.functions.contains=function(e,a){return r.standardFunctionAsync(e,a,(u,l,n)=>(n=d(n),O(n,e,a),n[0]!==null&&n[1]!==null&&f("contains",[n[0].toJSON(),n[1].toJSON()])))},r.functions.overlaps=function(e,a){return r.standardFunctionAsync(e,a,(u,l,n)=>(n=d(n),O(n,e,a),n[0]!==null&&n[1]!==null&&f("overlaps",[n[0].toJSON(),n[1].toJSON()])))},r.functions.equals=function(e,a){return r.standardFunctionAsync(e,a,(u,l,n)=>(m(n,2,2,e,a),n[0]===n[1]||(n[0]instanceof w&&n[1]instanceof w?f("equals",[n[0].toJSON(),n[1].toJSON()]):(k(n[0])&&k(n[1])||!!(W(n[0])&&W(n[1])||B(n[0])&&B(n[1])))&&n[0].equals(n[1]))))},r.functions.relate=function(e,a){return r.standardFunctionAsync(e,a,(u,l,n)=>{if(n=d(n),m(n,3,3,e,a),n[0]instanceof w&&n[1]instanceof w)return f("relate",[n[0].toJSON(),n[1].toJSON(),X(n[2])]);if(n[0]instanceof w&&n[1]===null||n[1]instanceof w&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new i(e,"InvalidParameter",a)})},r.functions.intersection=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>(n=d(n),O(n,e,a),n[0]===null||n[1]===null?null:h(await f("intersection",[n[0].toJSON(),n[1].toJSON()]))))},r.functions.union=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if((n=d(n)).length===0)throw new i(e,"WrongNumberOfParameters",a);const t=[];if(n.length===1)if(g(n[0])){for(const o of d(n[0]))if(o!==null){if(!(o instanceof w))throw new i(e,"InvalidParameter",a);t.push(o.toJSON())}}else{if(!v(n[0])){if(n[0]instanceof w)return C(J(n[0]),e.spatialReference);if(n[0]===null)return null;throw new i(e,"InvalidParameter",a)}for(const o of d(n[0].toArray()))if(o!==null){if(!(o instanceof w))throw new i(e,"InvalidParameter",a);t.push(o.toJSON())}}else for(const o of n)if(o!==null){if(!(o instanceof w))throw new i(e,"InvalidParameter",a);t.push(o.toJSON())}return t.length===0?null:h(await f("union",[t]))})},r.functions.difference=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>(n=d(n),O(n,e,a),n[0]===null?null:n[1]===null?J(n[0]):h(await f("difference",[n[0].toJSON(),n[1].toJSON()]))))},r.functions.symmetricdifference=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>(n=d(n),O(n,e,a),n[0]===null&&n[1]===null?null:n[0]===null?J(n[1]):n[1]===null?J(n[0]):h(await f("symmetricDifference",[n[0].toJSON(),n[1].toJSON()]))))},r.functions.clip=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,2,2,e,a),!(n[1]instanceof b)&&n[1]!==null)throw new i(e,"InvalidParameter",a);if(n[0]===null)return null;if(!(n[0]instanceof w))throw new i(e,"InvalidParameter",a);return n[1]===null?null:h(await f("clip",[n[0].toJSON(),n[1].toJSON()]))})},r.functions.cut=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,2,2,e,a),!(n[1]instanceof D)&&n[1]!==null)throw new i(e,"InvalidParameter",a);if(n[0]===null)return[];if(!(n[0]instanceof w))throw new i(e,"InvalidParameter",a);return n[1]===null?[J(n[0])]:(await f("cut",[n[0].toJSON(),n[1].toJSON()])).map(t=>h(t))})},r.functions.area=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(m(n,1,2,e,a),n=d(n),L(n[0])){const o=await n[0].sumArea(p(n[1]),null,e.abortSignal);if(e.abortSignal.aborted)throw new i(e,"Cancelled",a);return o}let t=n[0];if((g(t)||v(t))&&(t=q(n[0],e.spatialReference)),t===null)return 0;if(!(t instanceof w))throw new i(e,"InvalidParameter",a);return f("area",[t.toJSON(),p(n[1])])})},r.functions.areageodetic=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{m(n,1,3,e,a);let t=(n=d(n))[0];(g(t)||v(t))&&(t=q(t,e.spatialReference));const o=p(n[1]),s=x(n[2]);if(L(t)){const c=await t.sumArea(o,s,e.abortSignal);if(e.abortSignal.aborted)throw new i(e,"Cancelled",a);return c}if(t==null)return 0;if(!E(t))throw new i(e,"InvalidParameter",a);return f("geodeticArea",[t.toJSON(),o,s])})},r.functions.length=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(m(n,1,2,e,a),n=d(n),L(n[0])){const o=await n[0].sumLength(p(n[1]),null,e.abortSignal);if(e.abortSignal.aborted)throw new i(e,"Cancelled",a);return o}let t=n[0];if((g(n[0])||v(n[0]))&&(t=Z(n[0],e.spatialReference)),t===null)return 0;if(!(t instanceof w))throw new i(e,"InvalidParameter",a);return f("length",[t.toJSON(),p(n[1])])})},r.functions.length3d=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(m(n,1,2,e,a),(n=d(n))[0]===null)return 0;let t=n[0];if((g(n[0])||v(n[0]))&&(t=Z(n[0],e.spatialReference)),t===null)return 0;if(!(t instanceof w))throw new i(e,"InvalidParameter",a);if(t.hasZ===!0){const{convertFromSpatialReferenceUnit:o,toLengthUnit:s}=await Y(()=>import("./unitConversion-Dsm_H0Dm-eZfwiAJA.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),c=en(t);return o(t.spatialReference,s(n[1]),c)}return f("length",[t.toJSON(),p(n[1])])})},r.functions.lengthgeodetic=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{m(n,1,3,e,a);let t=(n=d(n))[0];(g(n[0])||v(n[0]))&&(t=Z(n[0],e.spatialReference));const o=p(n[1]),s=x(n[2]);if(L(t)){const c=await t.sumLength(o,s,e.abortSignal);if(e.abortSignal.aborted)throw new i(e,"Cancelled",a);return c}if(t===null)return 0;if(!E(t))throw new i(e,"InvalidParameter",a);return f("geodeticLength",[t.toJSON(),o,s])})},r.functions.distance=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{n=d(n),m(n,2,3,e,a);let t=n[0];if((g(n[0])||v(n[0]))&&(t=z(n[0],e.spatialReference)),!(t instanceof w))throw new i(e,"InvalidParameter",a);let o=n[1];if((g(n[1])||v(n[1]))&&(o=z(n[1],e.spatialReference)),!(o instanceof w))throw new i(e,"InvalidParameter",a);return f("distance",[t.toJSON(),o.toJSON(),p(n[2])])})},r.functions.distancegeodetic=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{n=d(n),m(n,2,4,e,a);const t=n[0];if(!(t instanceof F))throw new i(e,"InvalidParameter",a);const o=n[1];if(!(o instanceof F))throw new i(e,"InvalidParameter",a);const s=new D({paths:[],spatialReference:t.spatialReference});return s.addPath([t,o]),f("geodeticLength",[s.toJSON(),p(n[2]),x(n[3])])})},r.functions.densify=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,2,3,e,a),n[0]===null)return null;if(!(n[0]instanceof w))throw new i(e,"InvalidParameter",a);const t=P(n[1]);if(isNaN(t))throw new i(e,"InvalidParameter",a);if(t<=0)throw new i(e,"InvalidParameter",a);switch(n[0].type){case"polygon":case"polyline":case"extent":return h(await f("densify",[n[0].toJSON(),t,p(n[2])]));default:return n[0]}})},r.functions.densifygeodetic=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{n=d(n),m(n,2,4,e,a);const t=n[0];if(t==null)return null;if(!E(t))throw new i(e,"InvalidParameter",a);const o=P(n[1]);if(isNaN(o))throw new i(e,"InvalidParameter",a);if(o<=0)throw new i(e,"InvalidParameter",a);const s=p(n[2]),c=x(n[3]);switch(t.type){case"polygon":case"polyline":case"extent":return h(await f("geodeticDensify",[t.toJSON(),o,s,c]));default:return t}})},r.functions.generalize=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,2,4,e,a),n[0]===null)return null;if(!(n[0]instanceof w))throw new i(e,"InvalidParameter",a);const t=P(n[1]);if(isNaN(t))throw new i(e,"InvalidParameter",a);const o=un(j(n[2],!0));return h(await f("generalize",[n[0].toJSON(),t,p(n[3]),{removeDegenerateParts:o}]))})},r.functions.buffer=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,2,3,e,a),n[0]===null)return null;if(!(n[0]instanceof w))throw new i(e,"InvalidParameter",a);const t=P(n[1]);if(isNaN(t))throw new i(e,"InvalidParameter",a);return t===0?J(n[0]):h(await f("buffer",[n[0].toJSON(),t,p(n[2])]))})},r.functions.buffergeodetic=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{n=d(n),m(n,2,4,e,a);const t=n[0];if(t==null)return null;if(!E(t))throw new i(e,"InvalidParameter",a);const o=P(n[1]);if(isNaN(o))throw new i(e,"InvalidParameter",a);if(o===0)return J(t);const s=p(n[2]),c=x(n[3]);return h(await f("geodesicBuffer",[t.toJSON(),o,s,c]))})},r.functions.offset=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{n=d(n),m(n,2,6,e,a);const t=n[0];if(t===null)return null;if(!(t instanceof R||t instanceof D))throw new i(e,"InvalidParameter",a);const o=P(n[1]);if(isNaN(o))throw new i(e,"InvalidParameter",a);const s=n[2],c=an(n[3]),y=P(j(n[4],10));if(isNaN(y))throw new i(e,"InvalidParameter",a);const S=P(j(n[5],0));if(isNaN(S))throw new i(e,"InvalidParameter",a);return h(await f("offset",[t.toJSON(),o,p(s),c,y,S]))})},r.functions.rotate=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{var c;if(n=d(n),m(n,2,3,e,a),n[0]===null)return null;if(!(n[0]instanceof w))throw new i(e,"InvalidParameter",a);const t=n[0]instanceof b?R.fromExtent(n[0]):n[0],o=P(n[1]);if(isNaN(o))throw new i(e,"InvalidParameter",a);const s=j(n[2],null);if(s===null){const y=t.type==="point"?t:(c=t.extent)==null?void 0:c.center;return h(await f("rotate",[t.toJSON(),o,y==null?void 0:y.x,y==null?void 0:y.y]))}if(s instanceof F)return h(await f("rotate",[t.toJSON(),o,s.x,s.y]));throw new i(e,"InvalidParameter",a)})},r.functions.centroid=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,1,2,e,a),n[0]===null)return null;const t=tn(n[1]);let o=n[0];if((g(n[0])||v(n[0]))&&(o=t==="geometric"?z(n[0],e.spatialReference):q(n[0],e.spatialReference),o===null))return null;if(!(o instanceof w))throw new i(e,"InvalidParameter",a);return h(t==="geometric"?await f("centroid",[o.toJSON()]):await f("labelPoint",[o.toJSON()]))})},r.functions.measuretocoordinate=function(e,a){return r.standardFunctionAsync(e,a,rn)},r.functions.pointtocoordinate=function(e,a){return r.standardFunctionAsync(e,a,on)},r.functions.distancetocoordinate=function(e,a){return r.standardFunctionAsync(e,a,sn)},r.functions.multiparttosinglepart=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,1,1,e,a),n[0]===null)return null;if(!(n[0]instanceof w))throw new i(e,"InvalidParameter",a);if(n[0]instanceof F)return[C(J(n[0]),e.spatialReference)];if(n[0]instanceof b)return[C(J(n[0]),e.spatialReference)];const t=h(await f("simplify",[n[0].toJSON()]));if(t instanceof R){const o=[],s=[];for(let c=0;c<t.rings.length;c++)if(t.isClockwise(t.rings[c])){const y=h({rings:[t.rings[c]],hasZ:t.hasZ===!0,hasM:t.hasM===!0,spatialReference:t.spatialReference.toJSON()});o.push(y)}else s.push({ring:t.rings[c],pt:t.getPoint(c,0)});for(let c=0;c<s.length;c++)for(let y=0;y<o.length;y++)if(o[y].contains(s[c].pt)){o[y].addRing(s[c].ring);break}return o}if(t instanceof D){const o=[];for(let s=0;s<t.paths.length;s++){const c=h({paths:[t.paths[s]],hasZ:t.hasZ===!0,hasM:t.hasM===!0,spatialReference:t.spatialReference.toJSON()});o.push(c)}return o}if(n[0]instanceof G){const o=[],s=C(J(n[0]),e.spatialReference);for(let c=0;c<s.points.length;c++)o.push(s.getPoint(c));return o}return null})},r.functions.isselfintersecting=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{m(n,1,1,u,l);let t=(n=d(n))[0];if((g(n[0])||v(n[0]))&&(t=Z(n[0],u.spatialReference)),t instanceof G){const o=t.points;for(let s=0;s<o.length;s++)for(let c=s+1;c<o.length;c++)if($(o[s],o[c]))return!0;return!1}return(t instanceof D||t instanceof R)&&await f("isSelfIntersecting",[t.toJSON()])})},r.functions.issimple=function(e,a){return r.standardFunctionAsync(e,a,(u,l,n)=>{if(n=d(n),m(n,1,1,e,a),n[0]===null)return!0;if(!(n[0]instanceof w))throw new i(e,"InvalidParameter",a);return f("isSimple",[n[0].toJSON()])})},r.functions.simplify=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,1,1,e,a),n[0]===null)return null;if(!(n[0]instanceof w))throw new i(e,"InvalidParameter",a);return h(await f("simplify",[n[0].toJSON()]))})},r.functions.convexhull=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,1,1,e,a),n[0]===null)return null;if(!(n[0]instanceof w))throw new i(e,"InvalidParameter",a);return h(await f("convexHull",[n[0].toJSON()]))})},r.functions.getuser=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{var c,y;m(n,0,2,e,a);let t=j(n[1],""),o=t===!0;if(t=t===!0||t===!1?"":X(t),n.length===0||n[0]instanceof V){let S;S=(c=e.services)!=null&&c.portal?e.services.portal:H.getDefault(),n.length>0&&(S=K(n[0],S));const I=await Q(S,t,o);if(I){const A=JSON.parse(JSON.stringify(I));for(const N of["lastLogin","created","modified"])A[N]!==void 0&&A[N]!==null&&(A[N]=new Date(A[N]));return T.convertObjectToArcadeDictionary(A,U(e))}return null}let s=null;if(L(n[0])&&(s=n[0]),s){if(o=!1,t)return null;await s.load();const S=await s.getOwningSystemUrl();if(!S){if(!t){const N=await s.getIdentityUser();return N?T.convertObjectToArcadeDictionary({username:N},U(e)):null}return null}let I;I=(y=e.services)!=null&&y.portal?e.services.portal:H.getDefault(),I=K(new V(S),I);const A=await Q(I,t,o);if(A){const N=JSON.parse(JSON.stringify(A));for(const _ of["lastLogin","created","modified"])N[_]!==void 0&&N[_]!==null&&(N[_]=new Date(N[_]));return T.convertObjectToArcadeDictionary(N,U(e))}return null}throw new i(e,"InvalidParameter",a)})},r.functions.nearestcoordinate=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,2,2,e,a),!(n[0]instanceof w||n[0]===null))throw new i(e,"InvalidParameter",a);if(!(n[1]instanceof F||n[1]===null))throw new i(e,"InvalidParameter",a);if(n[0]===null||n[1]===null)return null;const t=n[0]instanceof b?R.fromExtent(n[0]):n[0],o=await f("getNearestCoordinate",[t.toJSON(),n[1].toJSON(),{calculateLeftRightSide:!0}]);return o===null?null:T.convertObjectToArcadeDictionary({coordinate:h(o.coordinate),distance:o.distance,sideOfLine:o.distance===0?"straddle":o.isRightSide?"right":"left"},U(e),!1,!0)})},r.functions.nearestvertex=function(e,a){return r.standardFunctionAsync(e,a,async(u,l,n)=>{if(n=d(n),m(n,2,2,e,a),!(n[0]instanceof w||n[0]===null))throw new i(e,"InvalidParameter",a);if(!(n[1]instanceof F||n[1]===null))throw new i(e,"InvalidParameter",a);if(n[0]===null||n[1]===null)return null;const t=n[0]instanceof b?R.fromExtent(n[0]):n[0],o=await f("getNearestVertex",[t.toJSON(),n[1].toJSON()]);return o===null?null:T.convertObjectToArcadeDictionary({coordinate:h(o.coordinate),distance:o.distance,sideOfLine:o.distance===0?"straddle":o.isRightSide?"right":"left"},U(e),!1,!0)})})}export{Gn as registerFunctions};
