import{P as sr,l as L,dx as lr,dy as ur,dz as cr,dA as ir,dB as ar,dC as fr,dD as hr,ao as dr,dE as F}from"./index-BeTPrQ6f.js";import{F as k}from"./OptimizedFeature-C33SioFK-sn7DeAq-.js";import{s as gr}from"./OptimizedFeatureSet-Dz5hF8Qm-CgsRgxJh.js";import{c as P}from"./OptimizedGeometry-BYxlP_oK-DvAqrgO1.js";function w(r,n){return r?n?4:3:n?3:2}const U=()=>sr.getLogger("esri.layers.graphics.featureConversionUtils"),_={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},mr=(r,n,t,o,l,e)=>{r[t]=l,r[t+1]=e},B=(r,n,t,o,l,e)=>{r[t]=l,r[t+1]=e,r[t+2]=n[o+2]},yr=(r,n,t,o,l,e)=>{r[t]=l,r[t+1]=e,r[t+2]=n[o+3]},pr=(r,n,t,o,l,e)=>{r[t]=l,r[t+1]=e,r[t+2]=n[o+2],r[t+3]=n[o+3]};function O(r,n,t,o){if(r){if(t)return n&&o?pr:B;if(n&&o)return yr}else if(n&&o)return B;return mr}function z({scale:r,translate:n},t){return Math.round((t-n[0])/r[0])}function R({scale:r,translate:n},t){return Math.round((n[1]-t)/r[1])}function q({scale:r,translate:n},t){return Math.round((t-n[0])/r[0])}function C({scale:r,translate:n},t){return Math.round((t-n[1])/r[1])}function S({scale:r,translate:n},t,o){return t*r[o]+n[o]}function _r(r,n,t){return r?n?t?D(r):V(r):t?A(r):v(r):null}function v(r){const n=r.coords;return{x:n[0],y:n[1]}}function X(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r}function V(r){const n=r.coords;return{x:n[0],y:n[1],z:n[2]}}function wr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.z,r}function A(r){const n=r.coords;return{x:n[0],y:n[1],m:n[2]}}function Mr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.m,r}function D(r){const n=r.coords;return{x:n[0],y:n[1],z:n[2],m:n[3]}}function Gr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.z,r.coords[3]=n.m,r}function br(r,n,t,o){let l=v;t&&o?l=D:t?l=V:o&&(l=A);for(const e of n){const{geometry:s,attributes:u}=e,i=s!=null?l(s):null;r.push({attributes:u,geometry:i})}return r}function j(r,n){return r&&n?Gr:r?wr:n?Mr:X}function Pr(r,n,t,o,l){const e=j(t,o);for(const s of n){const u=s.geometry!=null?e(new P,s.geometry):null;r.push(new k(u,s.attributes,null,F(s,l)))}return r}function xr(r,n,t=j(n.z!=null,n.m!=null)){return t(r,n)}function Tr(r,n,t,o){for(const{geometry:l,attributes:e}of n)r.push({attributes:e,geometry:l!=null?H(l,t,o):null});return r}function H(r,n,t){if(r==null)return null;const o=w(n,t),l=[];for(let e=0;e<r.coords.length;e+=o){const s=[];for(let u=0;u<o;u++)s.push(r.coords[e+u]);l.push(s)}return n?t?{points:l,hasZ:n,hasM:t}:{points:l,hasZ:n}:t?{points:l,hasM:t}:{points:l}}function Ir(r,n,t,o,l){const e=w(t,o);for(const s of n){const u=s.geometry!=null?J(new P,s.geometry,e):null;r.push(new k(u,s.attributes,null,F(s,l)))}return r}function J(r,n,t=w(n.hasZ,n.hasM)){r.lengths[0]=n.points.length;const o=r.coords;let l=0;for(const e of n.points)for(let s=0;s<t;s++)o[l++]=e[s];return r}function Zr(r,n,t,o){for(const{geometry:l,attributes:e}of n)r.push({attributes:e,geometry:l!=null?K(l,t,o):null});return r}function K(r,n,t){if(!r)return null;const o=w(n,t),{coords:l,lengths:e}=r,s=[];let u=0;for(const i of e){const c=[];for(let a=0;a<i;a++){const f=[];for(let h=0;h<o;h++)f.push(l[u++]);c.push(f)}s.push(c)}return n?t?{paths:s,hasZ:n,hasM:t}:{paths:s,hasZ:n}:t?{paths:s,hasM:t}:{paths:s}}function Nr(r,n,t,o,l){const e=w(t,o);for(const s of n){const u=s.geometry!=null?rr(new P,s.geometry,e):null,i=s.centroid!=null?xr(new P,s.centroid):null;r.push(new k(u,s.attributes,i,F(s,l)))}return r}function rr(r,n,t=w(n.hasZ,n.hasM)){const{lengths:o,coords:l}=r;let e=0;for(const s of n.paths){for(const u of s)for(let i=0;i<t;i++)l[e++]=u[i];o.push(s.length)}return r}function $r(r,n,t,o){for(const{geometry:l,attributes:e,centroid:s}of n){const u=l!=null?nr(l,t,o):null;if(s!=null){const i=v(s);r.push({attributes:e,centroid:i,geometry:u})}else r.push({attributes:e,geometry:u})}return r}function nr(r,n,t){if(!r)return null;const o=w(n,t),{coords:l,lengths:e}=r,s=[];let u=0;for(const i of e){const c=[];for(let a=0;a<i;a++){const f=[];for(let h=0;h<o;h++)f.push(l[u++]);c.push(f)}s.push(c)}return n?t?{rings:s,hasZ:n,hasM:t}:{rings:s,hasZ:n}:t?{rings:s,hasM:t}:{rings:s}}function kr(r,n,t,o,l){for(const e of n){const s=e.geometry!=null?tr(new P,e.geometry,t,o):null,u=F(e,l);e.centroid!=null?r.push(new k(s,e.attributes,X(new P,e.centroid),u)):r.push(new k(s,e.attributes,null,u))}return r}function tr(r,n,t=n.hasZ,o=n.hasM){return Er(r,n.rings,t,o)}function Er(r,n,t,o){const l=w(t,o),{lengths:e,coords:s}=r;let u=0;I(r);for(const i of n){for(const c of i)for(let a=0;a<l;a++)s[u++]=c[a];e.push(i.length)}return r}const $=[],E=[];function Or(r,n,t,o,l){$[0]=r;const[e]=or(E,$,n,t,o,l);return x($),x(E),e}function or(r,n,t,o,l,e){if(x(r),!t){for(const s of n){const u=F(s,e);r.push(new k(null,s.attributes,null,u))}return r}switch(t){case"esriGeometryPoint":return Pr(r,n,o,l,e);case"esriGeometryMultipoint":return Ir(r,n,o,l,e);case"esriGeometryPolyline":return Nr(r,n,o,l,e);case"esriGeometryPolygon":case"esriGeometryMultiPatch":return kr(r,n,o,l,e);default:U().error("convertToFeatureSet:unknown-geometry",new L("internal:geometry",`Unable to parse unknown geometry type '${t}'`)),x(r)}return r}function Vr(r,n,t,o){E[0]=r,er($,E,n,t,o);const l=$[0];return x($),x(E),l}function Ar(r,n,t){if(r==null)return null;const o=new P;return"hasZ"in r&&n==null&&(n=r.hasZ),"hasM"in r&&t==null&&(t=r.hasM),lr(r)?j(n??r.z!=null,t??r.m!=null)(o,r):ur(r)?tr(o,r,n,t):cr(r)?rr(o,r,w(n,t)):ir(r)?J(o,r,w(n,t)):void U().error("convertFromGeometry:unknown-geometry",new L("internal:geometry",`Unable to parse unknown geometry type '${r}'`))}function Fr(r,n,t,o){const l=r&&("coords"in r?r:r.geometry);if(l==null)return null;switch(n){case"esriGeometryPoint":{let e=v;return t&&o?e=D:t?e=V:o&&(e=A),e(l)}case"esriGeometryMultipoint":return H(l,t,o);case"esriGeometryPolyline":return K(l,t,o);case"esriGeometryPolygon":return nr(l,t,o);default:return U().error("convertToGeometry:unknown-geometry",new L("internal:geometry",`Unable to parse unknown geometry type '${n}'`)),null}}function Lr(r,n){for(const t of n)r.push({attributes:t.attributes});return r}function er(r,n,t,o,l){if(x(r),t==null)return Lr(r,n);switch(t){case"esriGeometryPoint":return br(r,n,o,l);case"esriGeometryMultipoint":return Tr(r,n,o,l);case"esriGeometryPolyline":return Zr(r,n,o,l);case"esriGeometryPolygon":return $r(r,n,o,l);default:U().error("convertToFeatureSet:unknown-geometry",new L("internal:geometry",`Unable to parse unknown geometry type '${t}'`))}return r}function Dr(r){const{spatialReference:n,transform:t,fields:o,hasM:l,hasZ:e,features:s,geometryType:u,exceededTransferLimit:i,queryGeometry:c,queryGeometryType:a}=r,f={features:er([],s,u,e,l),fields:o,geometryType:u,spatialReference:n,queryGeometry:Fr(c,a,!1,!1)};return t&&(f.transform=t),i&&(f.exceededTransferLimit=i),l&&(f.hasM=l),e&&(f.hasZ=e),f}function jr(r,n){const t=new gr,{hasM:o,hasZ:l,features:e,spatialReference:s,geometryType:u,exceededTransferLimit:i,transform:c,fields:a}=r;return a&&(t.fields=a),t.geometryType=u??null,t.spatialReference=s??null,e&&or(t.features,e,u,l,o,n),i&&(t.exceededTransferLimit=i),o&&(t.hasM=o),l&&(t.hasZ=l),c&&(t.transform=c),t}function Br(r){const{transform:n,features:t,hasM:o,hasZ:l}=r;if(!n)return r;for(const e of t)e.geometry!=null&&W(e.geometry,e.geometry,o,l,n),e.centroid!=null&&W(e.centroid,e.centroid,o,l,n);return r.transform=null,r}function Qr(r,n){const{geometryType:t,features:o,hasM:l,hasZ:e}=n;if(!r)return n;for(let s=0;s<o.length;s++){const u=o[s],i=u.weakClone();i.geometry=new P,Q(i.geometry,u.geometry,l,e,t,r),u.centroid&&(i.centroid=new P,Q(i.centroid,u.centroid,l,e,"esriGeometryPoint",r)),o[s]=i}return n.transform=r,n}function Q(r,n,t,o,l,e,s=t,u=o){if(I(r),!(n!=null&&n.coords.length))return null;const i=_[l],{coords:c,lengths:a}=n,f=w(t,o),h=w(t&&s,o&&u),g=O(t,o,s,u);if(!a.length)return g(r.coords,c,0,0,z(e,c[0]),R(e,c[1])),I(r,f,0),r;let d,y,M,b,p=0,m=0,G=m;for(const Z of a){if(Z<i)continue;let T=0;m=G,M=d=z(e,c[p]),b=y=R(e,c[p+1]),g(r.coords,c,m,p,M,b),T++,p+=f,m+=h;for(let N=1;N<Z;N++,p+=f)M=z(e,c[p]),b=R(e,c[p+1]),M===d&&b===y||(g(r.coords,c,m,p,M-d,b-y),m+=h,T++,d=M,y=b);T>=i&&(r.lengths.push(T),G=m)}return x(r.coords,G),r.coords.length?r:null}function Wr(r,n,t,o,l,e,s=t,u=o){if(I(r),!(n!=null&&n.coords.length))return null;const i=_[l],{coords:c,lengths:a}=n,f=w(t,o),h=w(t&&s,o&&u),g=O(t,o,s,u);if(!a.length)return g(r.coords,c,0,0,c[0],c[1]),I(r,f,0),r;let d=0;const y=e*e;for(const M of a){if(M<i){d+=M*f;continue}const b=r.coords.length/h,p=d,m=d+(M-1)*f;g(r.coords,c,r.coords.length,p,c[p],c[p+1]),Y(r.coords,c,f,y,g,p,m),g(r.coords,c,r.coords.length,m,c[m],c[m+1]);const G=r.coords.length/h-b;G>=i?r.lengths.push(G):x(r.coords,b*h),d+=M*f}return r.coords.length?r:null}function Ur(r,n,t,o){const l=r[n],e=r[n+1],s=r[t],u=r[t+1],i=r[o],c=r[o+1];let a=s,f=u,h=i-a,g=c-f;if(h!==0||g!==0){const d=((l-a)*h+(e-f)*g)/(h*h+g*g);d>1?(a=i,f=c):d>0&&(a+=h*d,f+=g*d)}return h=l-a,g=e-f,h*h+g*g}function Y(r,n,t,o,l,e,s){let u,i=o,c=0;for(let a=e+t;a<s;a+=t)u=Ur(n,a,e,s),u>i&&(c=a,i=u);i>o&&(c-e>t&&Y(r,n,t,o,l,e,c),l(r,n,r.length,c,n[c],n[c+1]),s-c>t&&Y(r,n,t,o,l,c,s))}function Xr(r,n,t,o){var c;if(!((c=n==null?void 0:n.coords)!=null&&c.length))return null;const l=w(t,o);let e=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(n&&n.coords){const a=n.coords;for(let f=0;f<a.length;f+=l){const h=a[f],g=a[f+1];e=Math.min(e,h),u=Math.max(u,h),s=Math.min(s,g),i=Math.max(i,g)}}return ar(r)?fr(r,e,s,u,i):hr(e,s,u,i,r),r}function W(r,n,t,o,l){const{coords:e,lengths:s}=n,u=w(t,o);if(!e.length)return r!==n&&I(r),r;dr(l);const{originPosition:i,scale:c,translate:a}=l,f=Rr;f.originPosition=i;const h=f.scale;h[0]=c[0]??1,h[1]=-(c[1]??1),h[2]=c[2]??1,h[3]=c[3]??1;const g=f.translate;if(g[0]=a[0]??0,g[1]=a[1]??0,g[2]=a[2]??0,g[3]=a[3]??0,!s.length){for(let y=0;y<u;++y)r.coords[y]=S(f,e[y],y);return r!==n&&I(r,u,0),r}let d=0;for(let y=0;y<s.length;y++){const M=s[y];r.lengths[y]=M;for(let m=0;m<u;++m)r.coords[d+m]=S(f,e[d+m],m);let b=r.coords[d],p=r.coords[d+1];d+=u;for(let m=1;m<M;m++,d+=u){b+=e[d]*h[0],p+=e[d+1]*h[1],r.coords[d]=b,r.coords[d+1]=p;for(let G=2;G<u;++G)r.coords[d+G]=S(f,e[d+G],G)}}return r!==n&&I(r,e.length,s.length),r}function Hr(r,n,t,o,l,e){if(I(r),r.lengths.push(...n.lengths),t===l&&o===e)for(let s=0;s<n.coords.length;s++)r.coords.push(n.coords[s]);else{const s=w(t,o),u=O(t,o,l,e),i=n.coords;for(let c=0;c<i.length;c+=s)u(r.coords,i,r.coords.length,c,i[c],i[c+1])}return r}function vr(r,n,t,o){let l=0,e=r[o*n],s=r[o*(n+1)];for(let u=1;u<t;u++){const i=e+r[o*(n+u)],c=s+r[o*(n+u)+1],a=(i-e)*(c+s);e=i,s=c,l+=a}return .5*l}function Jr(r,n){const{coords:t,lengths:o}=r;let l=0,e=0;for(let s=0;s<o.length;s++){const u=o[s];e+=vr(t,l,u,n),l+=u}return Math.abs(e)}function zr(r,n,t,o){return r*o-t*n===0&&r*t+n*o>0}function Kr(r,n,t,o,l){const e=w(o,l);if(!r.lengths.length){if(r.coords.length<2)return null;const[f,h]=r.coords,g=q(n,f),d=C(n,h);return new P([],[g,d])}const s=new P([],[0,0]),u=_[t],i=t==="esriGeometryPolygon"||t==="esriGeometryPolyline";let c=0,a=0;for(let f=0;f<r.lengths.length;f++){const h=r.lengths[f],g=a;let d=q(n,r.coords[e*c]),y=C(n,r.coords[e*c+1]);s.coords[a++]=d,s.coords[a++]=y;let M=0,b=0,p=1;for(let m=1;m<h;m++){const G=q(n,r.coords[e*(m+c)]),Z=C(n,r.coords[e*(m+c)+1]);if(G!==d||Z!==y){const T=G-d,N=Z-y;i&&zr(M,b,T,N)?(s.coords[a-2]+=T,s.coords[a-1]+=N,d+=T,y+=N):(s.coords[a++]=G,s.coords[a++]=Z,d=G,y=Z,M=T,b=N,p+=1)}}p<u?a=g:s.lengths.push(p),c+=h}return s.lengths.length===0?null:s}function I(r,n=0,t=0){x(r.lengths,t),x(r.coords,n)}function x(r,n=0){r.length!==n&&(r.length=n)}const Rr={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{Vr as $,or as B,Xr as C,H as D,Q as H,W as K,Or as L,Hr as O,K as Q,jr as R,Qr as S,Ar as U,nr as W,Dr as Y,Br as _,Kr as a,_r as b,Jr as c,z as d,R as e,tr as j,xr as o,Wr as q,Er as r,Fr as u};
