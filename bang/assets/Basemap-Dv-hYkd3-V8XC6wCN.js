const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./layersCreator-DpzdZQia-DcCdwOC_.js","./index-BeTPrQ6f.js","./index-BlWAJbpo.css","./loadUtils-DwBPBIZy-BQIH1t1r.js","./fetchService-CbI45rct-DlraP8Gs.js","./associatedFeatureServiceUtils-CYDBc3zT-CVYBBSKA.js","./PortalItem-BrQqKoE_-zs2bKsCH.js","./lazyLayerLoader-BJiXfIQc-BZp5YqgY.js","./portalLayers-CgoWRTMY-2drJoJ7R.js","./portalItemUtils-C12I5owR-Iiaf4oEu.js","./projectionUtils-CsX1UTBu-DsZaU4xz.js","./projectBuffer-CMNsPBq1-CMpE7Jo3.js","./zscale-PLuFqpaL-BIEnWBsg.js","./styleUtils-BQqoMgIA-U43o5V_5.js","./asyncUtils-Cu__bxqs-ecCTUaGV.js"])))=>i.map(i=>d[i]);
import{bI as R,a7 as v,P as w,ar as W,br as I,bU as T,q as V,bV as U,N as j,_ as P,t as O,bW as _,b as $,v as k,bX as d,m as n,E as y,n as D,bK as x,be as E,bP as F,aj as N,bf as C}from"./index-BeTPrQ6f.js";import{y as J}from"./loadAll-B16dgL0--5EDWWWLE.js";import H from"./PortalItem-BrQqKoE_-zs2bKsCH.js";import{j as K,B as q}from"./messages-DQ10DjvF-6kk0dzjG.js";import"./intl-DRhjUnwt-Dihhq8dq.js";import{e as z}from"./isBasemap-CJN7v_Jq-Dgi2bMj-.js";import{b as M}from"./writeUtils-DKeM2R6Z-BUUAIn2U.js";import"./asyncUtils-Cu__bxqs-ecCTUaGV.js";async function X(l){if(!l)return;const e=l.includes("-vector")?l.slice(0,l.indexOf("-vector")):l.includes("-3d")?l.slice(0,l.indexOf("-3d")):l,r=await K("esri/t9n/basemaps");return r[l]||r[e]}const Y={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-hillshade",url:"https://services.arcgisonline.com/ArcGIS/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1},{id:"terrain-base",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/33064a20de0c48d2bb61efa8faca93a8/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Terrain Base"},{id:"terrain-reference",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/14fbc125ccc9488888b014db09f35f67/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Reference Reference",isReference:!0}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/94329802cbfa44a18f423e6f1a0b875c/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return d("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return d("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return d("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return d("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return d("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Buildings_v1/SceneServer",itemId:"cd33b09dde0a419c986ca1a78a5fc06d",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return d("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]}};let b=class extends N{constructor(l){super(l),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const l=this.language;let e=l==="local"||l==="global"?l:q(l??C())??"global";return e=e==="no"?"nb":e,e}};n([y()],b.prototype,"apiKey",void 0),n([y()],b.prototype,"id",void 0),n([y()],b.prototype,"language",void 0),n([y()],b.prototype,"places",void 0),n([y()],b.prototype,"serviceUrl",void 0),n([y()],b.prototype,"worldview",void 0),b=n([D("esri.support.BasemapStyle")],b);const Z=b;var A,h,u;let p=(u=class extends R(x){constructor(e){super(e),this[A]=!0,this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.type="Basemap",this.id=Date.now().toString(16)+"-basemap-"+h.idCounter++,this.baseLayers=new v,this.referenceLayers=new v,this.groundLayers=new v;const r=t=>{var g;const{parent:o}=t;o&&o!==this&&"remove"in o&&((g=o.remove)==null||g.call(o,t)),t.parent=this,t.type!=="elevation"&&t.type!=="integrated-mesh-3dtiles"||w.getLogger(this).error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a basemap layer and will therefore be ignored.`)},s=t=>{var g;const{parent:o}=t;o&&o!==this&&"remove"in o&&((g=o.remove)==null||g.call(o,t)),t.parent=this},i=t=>{const o=t.item;return o.parent===this?(w.getLogger(this).error(`Layer '${o.title}, id:${o.id}' of type '${o.type}' already a ground layer, second add will be ignored.`),void t.preventDefault()):o.type!=="integrated-mesh-3dtiles"&&o.type!=="integrated-mesh"?(w.getLogger(this).error(`Layer '${o.title}, id:${o.id}' of type '${o.type}' is not supported as a ground layer and will therefore be ignored.`),void t.preventDefault()):void 0},a=t=>{t.parent=null},c=t=>{t.parent===this&&(t.parent=null)};this.addHandles([this.baseLayers.on("after-add",t=>r(t.item)),this.baseLayers.on("after-remove",t=>a(t.item)),this.referenceLayers.on("after-add",t=>r(t.item)),this.referenceLayers.on("after-remove",t=>a(t.item)),this.groundLayers.on("before-add",i),this.groundLayers.on("after-add",t=>s(t.item)),this.groundLayers.on("after-remove",t=>c(t.item))])}initialize(){this.when().catch(e=>{w.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const i of e)i.destroyed||i.destroy();const r=this.groundLayers.toArray();for(const i of r)i.destroyed||i.destroy();const s=this.referenceLayers.toArray();for(const i of s)i.destroyed||i.destroy();this.baseLayers.destroy(),this.groundLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=W(this.portalItem)}removeChildLayer(e){for(const r of[this.baseLayers,this.referenceLayers,this.groundLayers])r.remove(e)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",I(e,this._get("baseLayers")))}_writeBaseLayers(e,r,s){const i=[];e&&(s={...s,layerContainerType:"basemap-base-layers"},this.baseLayers.forEach(a=>{const c=M(a,s.webmap?s.webmap.getLayerJSONFromResourceInfo(a):null,s);c!=null&&i.push(c)}),this.referenceLayers.forEach(a=>{const c=M(a,s.webmap?s.webmap.getLayerJSONFromResourceInfo(a):null,s);c!=null&&(a.type!=="scene"&&(c.isReference=!0),i.push(c))})),r.baseMapLayers=i}set groundLayers(e){this._set("groundLayers",I(e,this._get("groundLayers")))}_writeGroundLayers(e,r,s){const i=[];e&&(s={...s,layerContainerType:"basemap-ground-layers"},this.groundLayers.forEach(a=>{const c=M(a,s.webmap?s.webmap.getLayerJSONFromResourceInfo(a):null,s);c!=null&&i.push(c)}),i.length>0&&(r.groundLayers=i))}get loaded(){return super.loaded}set referenceLayers(e){this._set("referenceLayers",I(e,this._get("referenceLayers")))}writeTitle(e,r){r.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return J(this,e=>{e(this.baseLayers,this.groundLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(r=>T(r)?r.clone():r),groundLayers:this.groundLayers.map(r=>T(r)?r.clone():r),referenceLayers:this.referenceLayers.map(r=>T(r)?r.clone():r)};return this.loaded&&(e.loadStatus="loaded"),new h({resourceInfo:this.resourceInfo}).set(e)}read(e,r){this.resourceInfo||this._set("resourceInfo",{data:e,context:r}),super.read(e,r)}write(e,r){var s;return e=e||{},r!=null&&r.origin||(r={origin:"web-map",...r}),super.write(e,r),!this.loaded&&((s=this.resourceInfo)!=null&&s.data.baseMapLayers)&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(i=>{const a=V(i);return a.url&&U(a.url)&&(a.url=`https:${a.url}`),a.templateUrl&&U(a.templateUrl)&&(a.templateUrl=`https:${a.templateUrl}`),a})),e}async _loadFromSource(e){const{resourceInfo:r,portalItem:s,style:i}=this;j(e);const a=[];if(r){const c=r.context?r.context.url:null;if(a.push(this._loadLayersFromJSON(r.data,c,e)),r.data.id&&!r.data.title){const t=r.data.id;a.push(X(t).then(o=>{o&&this.read({title:o},r.context)}))}}else s?a.push(this._loadFromItem(s,e)):i&&a.push(this._loadFromStylesService(i,e));await Promise.all(a)}async _loadLayersFromJSON(e,r,s){var g,f;const i=(g=this.resourceInfo)==null?void 0:g.context,a=((f=this.portalItem)==null?void 0:f.portal)||(i==null?void 0:i.portal)||null,c=ee[(i==null?void 0:i.origin)||""]??"web-map",{populateOperationalLayers:t}=await P(async()=>{const{populateOperationalLayers:m}=await import("./layersCreator-DpzdZQia-DcCdwOC_.js");return{populateOperationalLayers:m}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url),o=[];if(j(s),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const m={context:{...i,origin:c,url:r,portal:a,layerContainerType:"basemap-base-layers"},defaultLayerType:"DefaultTileLayer"},L=S=>c==="web-scene"&&S.layerType==="ArcGISSceneServiceLayer"||S.isReference,G=t(this.baseLayers,e.baseMapLayers.filter(S=>!L(S)),m);o.push(G);const B=t(this.referenceLayers,e.baseMapLayers.filter(L),m);o.push(B)}if(e.groundLayers&&Array.isArray(e.groundLayers)){const m={context:{...i,origin:c,url:r,portal:a,layerContainerType:"basemap-ground-layers"},defaultLayerType:"IntegratedMesh3DTilesLayer"},L=t(this.groundLayers,e.groundLayers,m);o.push(L)}await Promise.allSettled(o)}async _loadFromItem(e,r){const s=await e.load(r),i=await s.fetchData("json",r),a=O(e.itemUrl??"");return this._set("resourceInfo",{data:i.baseMap??{},context:{origin:Q[e.type||""]??"web-map",portal:e.portal||_.getDefault(),url:a}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:i.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||_.getDefault(),url:a}),this._loadLayersFromJSON(this.resourceInfo.data,a,r)}async _loadFromStylesService(e,r){const s=e.serviceUrl.endsWith("/webmaps")?e.serviceUrl.slice(0,-8):e.serviceUrl,i=`${s}/styles/${e.id}/self`,a=`${s}/webmaps/${e.id}`,c=e.apiKey??$.apiKeys.basemapStyles,[t,o]=await Promise.all([(await k(i,{query:{token:c},signal:r==null?void 0:r.signal})).data,(await k(a,{query:{language:e.languageParameter,places:e.places,worldview:e.worldview,token:c},signal:r==null?void 0:r.signal})).data]);this.thumbnailUrl??(this.thumbnailUrl=t.thumbnailUrl);const g=O(a);if(this._set("resourceInfo",{data:o.baseMap??{},context:{origin:"web-map",url:g}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:o.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,g,r),c)for(const f of[...this.baseLayers,...this.groundLayers,...this.referenceLayers])"apiKey"in f&&(f.apiKey=c)}static fromId(e){const r=Y[e];return r?r.itemId?new h({portalItem:{id:r.itemId,portal:{url:"https://www.arcgis.com"}}}):h.fromJSON(r,r.is3d?{origin:"web-scene",portal:new _({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}},A=z,h=u,u.idCounter=0,u);n([y({json:{read:!1,write:{ignoreOrigin:!0,target:"baseMapLayers",writer(l,e,r,s){this._writeBaseLayers(l,e,s)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:v}},writer(l,e,r,s){this._writeBaseLayers(l,e,s)}}}}}})],p.prototype,"baseLayers",null),n([y({json:{read:!1,write:{ignoreOrigin:!0,target:"groundLayers",writer(l,e,r,s){this._writeGroundLayers(l,e,s)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{groundLayers:{type:v}},writer(l,e,r,s){this._writeGroundLayers(l,e,s)}}}}}})],p.prototype,"groundLayers",null),n([y({type:String,json:{origins:{"web-scene":{write:!0}}}})],p.prototype,"id",void 0),n([y({type:H})],p.prototype,"portalItem",void 0),n([y()],p.prototype,"referenceLayers",null),n([y({readOnly:!0})],p.prototype,"resourceInfo",void 0),n([y({type:E})],p.prototype,"spatialReference",void 0),n([y({type:Z})],p.prototype,"style",void 0),n([y()],p.prototype,"thumbnailUrl",void 0),n([y({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],p.prototype,"title",void 0),n([F("title")],p.prototype,"writeTitle",null),p=h=n([D("esri.Basemap")],p);const Q={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},ee={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},re=p,de=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{de as B,re as F,Y as a};
