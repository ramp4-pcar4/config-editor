import{m as p}from"./Field-Dn1Bgq7n-CJCGLoNR.js";const V="Raster.",u="Raster.Dim.",$=".Max",m={servicePixelValue:"Raster.ServicePixelValue",rawServicePixelValue:"Raster.ServicePixelValue.Raw",itemPixelValue:"Raster.ItemPixelValue",magnitude:"Raster.Magnitude",direction:"Raster.Direction",variable:"Raster.Variable"},w=new Map([["quarters","Quarter"],["months","Month"],["weeks","Week of the year"],["days","Day of the year"]]);function f(n,e){return new p({name:n,alias:e,domain:null,editable:!1,length:50,type:"string"})}function d(n,e){return new p({name:n,alias:e,domain:null,editable:!1,type:"double"})}function b(n,e){return new p({name:n,alias:e,domain:null,editable:!1,type:"date"})}function P(n){return f(m.servicePixelValue,n??"Service Pixel Value")}function S(n){return f(m.rawServicePixelValue,n??"Raw Service Pixel Value")}function R(){return f(m.itemPixelValue,"Item Pixel Value")}function M(n){return f(`${m.servicePixelValue}.${n}`,n)}function I(n){return d(`${m.magnitude}`,"Magnitude"+(n?` (${n})`:""))}function D(){return d(`${m.direction}`,"Direction (Â°)")}function E(n){return n.fields.filter(e=>e.type!=="oid"&&e.name.toLowerCase()!=="value").map(e=>{const t=e.clone();return t.name=`${V}${e.name}`,t})}function N(n){const e=new Set,t=new Set,i=new Map;return n.variables.forEach(({dimensions:a})=>{a.forEach(r=>{var c,o,s;if(r.recurring)i.set(r.name,r.unit);else{const l=((c=r.unit)==null?void 0:c.trim())==="ISO8601"||((s=(o=r.name)==null?void 0:o.trim())==null?void 0:s.toLowerCase())==="stdtime"?e:t;l.add(r.name),r.hasRanges&&l.add(`${r.name}${$}`)}})}),[f(m.variable,"Variable"),...[...e].map(a=>b(`${u}${a}`,h(a))),...[...t].map(a=>d(`${u}${a}`,h(a))),...[...i].map(([a,r])=>d(`${u}${a}`,g(a,r)))]}function g(n,e){return e=e==null?void 0:e.toLowerCase(),e&&w.has(e)?w.get(e):h(n)}function h(n){const e=n.endsWith($),t=e?n.slice(0,-4):n,i=t==="StdTime"?"Standard Time":t==="StdZ"?"Standard Z":t;return e?`${i} Max`:i}function x(n,e){return e?new Date(n):n}function W(n,e,t){t!=null&&t.length&&(e[m.variable]=t[0].variableName,t.forEach(({dimensionName:i,values:a})=>{if(i&&(a!=null&&a.length)){const r=`${u}${i}`,c=n.find(({name:l})=>l===r);if(!c)return;const o=c.type==="date",s=a[0];if(Array.isArray(s)){if(e[`${u}${i}`]=x(s[0],o),s[1]!=null){const l=`${u}${i}${$}`;if(n.some(({name:v})=>v===l)){const v=x(s[1],o);e[l]=v}}}else e[`${u}${i}`]=x(s,o)}}))}function C(n,e){if(e.pixelType.startsWith("f")&&n.forEach(({format:t,fieldName:i})=>{t&&i&&/^raster\.(item|service)pixelvalue/i.test(i)&&(t.places=2)}),e.multidimensionalInfo){const t=e.multidimensionalInfo.variables.flatMap(({dimensions:i})=>i);n.forEach(({format:i,fieldName:a})=>{var r,c;if(i&&(a!=null&&a.startsWith(u))){const o=a.slice(u.length),s=`${o}${$}`;(c=(r=t.find(({name:l})=>l===o||l===s))==null?void 0:r.values)!=null&&c.every(l=>Number.isInteger(l))&&(i.places=0)}})}}export{N as D,E as I,D as M,W as N,S as P,I as R,R as S,C as W,P as g,m as l,u as s,V as w,M as y};
