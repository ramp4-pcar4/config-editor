import{eq as f,am as Q}from"./index-BeTPrQ6f.js";import{z as h,j as H,E as p,R as B,q as b,l as E,Q as F,_ as d,b as I,S as T}from"./vec32-CI1xtKog-DFVYRcgb.js";import"./vec42-DHp-FUwt-Br7hmYJs.js";import{b as U,Y as o,B as D}from"./vectorStacks-B2ngxq6F-myhPBoPk.js";function et(r){const t=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],e=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],n=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(t,e,n))}function nt(r,t){const e=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),n=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),c=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return d(r,e,n,c),r}function V(r,t,e){Math.abs(r[0])>Math.abs(r[1])?d(t,0,1,0):d(t,1,0,0),F(e,r,t),F(t,e,r),E(e,e),E(t,t)}function ct(r,t,e,n=f()){const c=I(r),i=I(t),s=h(r,t)/(c*i);if(s<.9999999999999999){const u=Math.acos(s),M=((1-e)*c+e*i)/Math.sin(u),a=M/c*Math.sin((1-e)*u),g=M/i*Math.sin(e*u);return p(J,r,a),p(L,t,g),H(n,J,L)}return T(n,r,t,e)}const J=f(),L=f();function N(r=$){return[r[0],r[1],r[2],r[3]]}function ut(r=$[0],t=$[1],e=$[2],n=$[3]){return O(r,t,e,n,U.get())}function W(r,t){return O(t[0],t[1],t[2],t[3],r)}function st(r){return r}function O(r,t,e,n,c=N()){return c[0]=r,c[1]=t,c[2]=e,c[3]=n,c}function X(r,t,e){const n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],c=Math.abs(n-1)>1e-5&&n>1e-12?1/Math.sqrt(n):1;return e[0]=t[0]*c,e[1]=t[1]*c,e[2]=t[2]*c,e[3]=-(e[0]*r[0]+e[1]*r[1]+e[2]*r[2]),e}function Z(r,t,e,n=N()){const c=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],u=r[0]-t[0],M=r[1]-t[1],a=r[2]-t[2],g=i*a-s*M,Y=s*u-c*a,j=c*M-i*u,v=g*g+Y*Y+j*j,k=Math.abs(v-1)>1e-5&&v>1e-12?1/Math.sqrt(v):1;return n[0]=g*k,n[1]=Y*k,n[2]=j*k,n[3]=-(n[0]*r[0]+n[1]*r[1]+n[2]*r[2]),n}function P(r,t,e,n=0,c=Math.floor(e*(1/3)),i=Math.floor(e*(2/3))){if(e<3)return!1;t(q,n);let s=c,u=!1;for(;s<e-1&&!u;)t(m,s),s++,u=!B(q,m);if(!u)return!1;for(s=Math.max(s,i),u=!1;s<e&&!u;)t(l,s),s++,b(y,q,m),E(y,y),b(z,m,l),E(z,z),u=!B(q,l)&&!B(m,l)&&Math.abs(h(y,z))<_;return u?(Z(q,m,l,r),!0):(n!==0||c!==1||i!==2)&&P(r,t,e,0,1,2)}function it(r,t,e=!0){const n=t.length/3;return P(r,(c,i)=>d(c,t[3*i+0],t[3*i+1],t[3*i+2]),e?n-1:n)}const _=.99619469809,q=f(),m=f(),l=f(),y=f(),z=f();function ot(r,t,e){return t!==r&&W(r,t),r[3]=-h(r,e),r}function ft(r,t){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t}function ht(r,t,e,n){return F(l,t,r),X(e,l,n)}function Mt(r,t,e,n){return R(S(r,t,b(o.get(),e,t),A,n))}function gt(r,t,e){return t!=null&&R(S(r,t.origin,t.direction,C,e))}function lt(r,t,e){return R(S(r,t.origin,t.vector,0,e))}function at(r,t,e){return R(S(r,t.origin,t.vector,1,e))}function mt(r,t){return x(r,t)>=0}function bt(r,t){const e=h(r,t.ray.direction),n=-x(r,t.ray.origin);if(n<0&&e>=0)return!1;if(e>-1e-6&&e<1e-6)return n>0;if((n<0||e<0)&&!(n<0&&e<0))return!0;const c=n/e;return e>0?c<t.c1&&(t.c1=c):c>t.c0&&(t.c0=c),t.c0<=t.c1}function qt(r,t){const e=h(r,t.ray.direction),n=-x(r,t.ray.origin);if(e>-1e-6&&e<1e-6)return n>0;const c=n/e;return e>0?c<t.c1&&(t.c1=c):c>t.c0&&(t.c0=c),t.c0<=t.c1}function $t(r,t,e){const n=p(o.get(),r,-r[3]),c=w(r,b(o.get(),t,n),o.get());return H(e,c,n),e}function pt(r,t,e,n){const c=r,i=o.get(),s=o.get();V(c,i,s);const u=b(o.get(),e,t),M=D(i,u),a=D(s,u),g=D(c,u);return d(n,M,a,g)}function w(r,t,e){const n=p(o.get(),r,h(r,t));return b(e,t,n),e}function dt(r,t){return Math.abs(x(r,t))}function x(r,t){return h(r,t)+r[3]}function R(r){return r===0||r===1}function S(r,t,e,n,c){const i=h(r,e),s=x(r,t);if(i===0)return s>=0?2:3;let u=-s/i;return 1&n&&(u=Q(u,0,1)),!(4&n)&&u<0||!(8&n)&&u>1?s>=0?2:3:(H(c,t,p(c,e,u)),s>=0?0:1)}const $=[0,0,1,0],A=12,C=8;export{et as D,nt as E,ct as F,N as L,$t as M,O as N,P as O,V as R,W as U,ut as V,X as W,Z as X,it as Y,st as Z,ot as a,dt as b,gt as c,lt as e,bt as f,pt as g,qt as h,ft as o,x as q,mt as r,Mt as s,ht as t,at as u,S as x};
