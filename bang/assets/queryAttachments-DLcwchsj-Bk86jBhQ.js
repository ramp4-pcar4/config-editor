import{bO as u,ld as h,N as i}from"./index-JysQxb7m.js";import{f}from"./query-COAsogFA-B_7NHWKZ.js";import{t as l}from"./AttachmentInfo-zWxchQNl-8VmURCUB.js";import"./normalizeUtils-u00NGW3M-DJIcJS3H.js";import"./normalizeUtilsCommon-ClagynAA-DgLRsjpR.js";import"./utils-BO8hgPs3-ESkgk50Y.js";import"./utils-DpLVEUvg-Cr3RAbYo.js";import"./pbfQueryUtils-aBcHX3TJ-XGWHC9a8.js";import"./pbf-hoLeQyp2-Bcnds-5q.js";import"./memoryEstimations-DeWfxwaV-BnbU1TaS.js";import"./OptimizedGeometry-pzfNw1AT--wT_d_bU.js";import"./OptimizedFeature-mIz_HhJg-lEv_dFEg.js";import"./OptimizedFeatureSet-Dz5hF8Qm-B1brSkRC.js";import"./queryZScale-CwrUzBjP-D1J1AAas.js";import"./projectionUtils-B-CplN3q-DYZZu_-u.js";function y(s){const t=s.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t.orderByFields&&(t.orderByFields=t.orderByFields.join(",")),t}function $(s,t){const o={};for(const r of t){const{parentObjectId:e,parentGlobalId:a,attachmentInfos:c}=r;for(const n of c){const{id:p}=n,d=u(h(`${s.path}/${e}/attachments/${p}`)),m=l.fromJSON(n);m.set({url:d,parentObjectId:e,parentGlobalId:a}),o[e]?o[e].push(m):o[e]=[m]}}return o}function x(s,t,o){let r={query:f({...s.query,f:"json",...y(t)})};return o&&(r={...o,...r,query:{...o.query,...r.query}}),i(s.path+"/queryAttachments",r).then(e=>e.data.attachmentGroups)}async function J(s,t,o){const{objectIds:r}=t,e=[];for(const a of r)e.push(i(s.path+"/"+a+"/attachments",o));return Promise.all(e).then(a=>r.map((c,n)=>({parentObjectId:c,attachmentInfos:a[n].data.attachmentInfos})))}export{x as executeAttachmentQuery,J as fetchAttachments,$ as processAttachmentQueryResult};
