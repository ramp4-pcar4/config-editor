const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SelfSnappingEngine-cGmuW4MT-B2xgg0h1.js","./index-CBMEoBe1.js","./index-CpSsk29H.css","./globalCss-CFN4F315-DTUnIrUK.js","./Queue-B8H6jIv7-BwVqvcRw.js","./signal-DxzURL18--wkbw797.js","./Version-BTMwSXf1-WL_C32o5.js","./quantityUtils-RaoZoCNH-DaTB8IoM.js","./vec2-BnynUbeJ-CKtGJQAy.js","./common-CYWrYyJl-E8-sukrT.js","./geodesicLengthMeasurementUtils-X1SKKkBz-DkXEqCb3.js","./index-CVKk0WAC-CsKJFDLO.js","./draw-store-C1_quxsr-Bq7x0OZh.js","./GraphicsLayer-GkJJfSu5-CwfpgeJp.js","./GraphicsCollection-rAFZo1AJ-BlVwPPV6.js","./Layer-B8q-l4yV-BrrRSYHJ.js","./TimeExtent-gZaEUVeW-BagTZBwO.js","./ScaleRangeLayer-DIxukUBC-pEcRqXGO.js","./layerContainerType-ChWdCT09-G5sdAsSy.js","./jsonUtils-DzmXEA9_-CT2AJZAo.js","./parser-hXQyB-Qx-B10CaQwE.js","./mat4f32-CiZjBg9k-CUm34GoR.js","./mat4-BFStKTjU-ZAg-cSs8.js","./ElevationInfo-DkWlof50-iMvbcrJj.js","./lengthUtils-wU9RRIqK-BT1jjFni.js","./intl-DLmy-Li5-I_ERwC12.js","./jsxFactory-C5LxVioS-DaJXHcMA.js","./uuid-Dj9mdEVg-BaKSCiyT.js","./layerViewUtils-Bk5QNiAa-CUQJdYme.js","./widget-BgluoE6k-Bicfan8e.js","./diffUtils-BSe9IE26-DZZbiUYW.js","./UpdatingHandles-DBzjq66S-BoM1VXsj.js","./ViewingMode-CyR_b1T8-_s7_Gbsk.js","./vec2f64-CEUyUoff-BBc0aQ6D.js","./vec32-BuqRmYBM-CtdUGvNP.js","./vec42-D8CJyqHG-DnfLTeQH.js","./vec4f64-CjUMzAyX-DPYbdAom.js","./projection-m8vi7Cxv-D46rH7Dd.js","./meshVertexSpaceUtils-BwEbYR8F-DIwJWbt0.js","./MeshLocalVertexSpace-DFCiKNRA-B7OAtOKV.js","./hydratedFeatures-BDT5zTGB-CsFRCZ70.js","./projectVectorToVector-D0K_S4MR-DnEkUtMb.js","./projectPointToVector-CG1hALQu-BrP1TkuY.js","./plane-B_adY3_o-cU7zwxlO.js","./mat3f64-Dh9_zhFu-BIT-k8Dm.js","./mat4f64-BaJwL7tQ-k0uMm8LY.js","./quatf64-C16JxGFv-BKWK1F8U.js","./geodesicUtils-DV-lFWtb-kScndeqx.js","./Scheduler-Br-2v2ys-Zqm4sr82.js","./geometryEngineBase-DueYg7ux-B6e4gAE3.js","./_commonjsHelpers-BITg13Vk-KnjfkSck.js","./hydrated-Bae3cp-4-YBSnke5T.js","./mat2d-BQA-1WB--Pnyy0dhf.js","./quat-D8L_R4I0-C0Txg3DZ.js","./drapedUtils-7RfmdK5D-BKf582sQ.js","./utils-C0LvbFCo-RMQaTNpt.js","./substitute-TfjvVaWd-DGs88jVt.js","./Query-CxQYWcUQ-DzmF5hbn.js","./Field-Cj6Pz3TI-EfqjxSA5.js","./fieldType-VTpxE-EM-5T3eEEAO.js","./sphere-Cj20syUS-oRTzH7yL.js","./mat3-DOnW3DjW-C3hbW9XY.js","./GridSnappingEngine-DCXaqXz2-BVH_N7rN.js","./normalizeUtils-b-vZURob-BXBFV5sp.js","./utils-DuaeuwP5-BGN9Vqpk.js","./utils-Jw-4AGsF-C8WQA2bI.js","./scaleUtils-DtnDbXa5-CyhsWLE6.js","./gridUtils-D2du44-d-B52HXCl4.js","./FeatureSnappingEngine-aDZtmISS-BcRW78MV.js","./FeatureFilter-C7FajlY_-sOmM1wSK.js","./floorFilterUtils-4r-vVdzs-u-jw2p7F.js","./editingTools-KBOXuhog-BLoXiaY2.js","./SnappingVisualizer2D-DR-yrbjS-DOjWOTua.js","./enums-f9UUstHQ-hLTu4V1l.js","./automaticAreaMeasurementUtils-Bz1iefP0-DRrJ0iO8.js","./PointSnappingHint-ClwQ1VNw-a0NGzMM_.js","./automaticLengthMeasurementUtils-BcfJmFU0-DldX8Bnl.js","./MeshTransform-CvTryVbE-DpyG9UnZ.js","./axisAngleDegrees-nTnQhoaG-CHg6jH80.js","./themeUtils-RB4IoNvm-uO-dsvgO.js","./a11yUtils-C2ydunC--DK56cGoy.js","./unitFormatUtils-zTNxheG9-CDo67MBk.js","./ByteSizeUnit-DL8UhsB0-B2-AmVRx.js","./spatialReferenceEllipsoidUtils-DlQOpWof-DK8_viMF.js","./earcut-XDcq3zAf-BcwyrT7l.js","./triangle-BePBrXJ8-BK6Lu7UL.js","./lineSegment-BJNfNZM5-C8vxhVFa.js","./editPlaneUtils-CYBM1uSC-gjb4XOSK.js","./boundedPlane-B6TkXVHT-C1ETcjfX.js","./cimSymbolUtils-BuFg2oLA-uVIbsC26.js","./utils-BYqzY6_X-FI4tArPo.js","./defaultCIMValues-gWpu7WSC-cjxb95kj.js","./GraphicManipulator-DXPP3gDs-KZRAdPP2.js","./colorUtils-DxUhbS7D-CUyszBhS.js","./drawUtils-BUIg7AUj-gWIVVJLj.js","./editingTools-CWx0-1A2-eo-2amF1.js","./glsl-o28TenZV-B0eZUNn3.js","./BindType-CKbZk6AG-Bqvzo9NX.js","./interfaces-D_DB_-WL-Ch45RYtt.js","./VerticalOffset.glsl-BtVaDxLq-BD5qaa54.js","./Indices-DkAzsiH--DbKxrb4u.js","./InterleavedLayout-DcHoXu73-Bq_Dycff.js","./BufferView-BBCzkcZS-BavgBQdX.js","./renderState-DlSSrLcZ-Du_EmLq6.js","./enums-DBi1-Mm2-CUS1pvQe.js","./VertexAttribute-DFC3a3eR-BhmQtMsu.js","./ShaderOutput-C_OqLoo1-jp3zUBgm.js","./requestImageUtils-rT_rMd2F-p1rOxwcs.js","./TextureFormat-Cl0ugX3E-DD0Aw8RG.js","./Texture-DXSFJsEu-Wtgszlex.js","./getDataTypeBytes-HSdrWtlL-ClHsCcSN.js","./orientedBoundingBox-CTsjUkMw-DLwUSXU_.js","./computeTranslationToOriginAndRotation-DwwrTl3S-BmUnPkDW.js","./ShaderBuilder-BkQM64Qp-U1V-HHrk.js","./triangulationUtils-KRNFVU70-B4sr1F0f.js","./deduplicate-DZCyc4JG-CRK39qw4.js","./RibbonLine.glsl-B9kKeq0l-VQTK7ccl.js","./HUDVisibility.glsl-Bl7zdrV0-D_9wcpSO.js","./doublePrecisionUtils-BJbYwoii-kIP-tL_t.js","./vec3f32-BS0cezmI-B_madU1n.js","./Octree-Kk-G5P_T-NqeW4v79.js","./floatRGBA-YJlz5IlR-gYDsBJ3K.js","./HUDMaterial.glsl-DUfp5PMk-CiZX0aS_.js","./VertexArrayObject-DTkLCIKs-CODNg3X_.js","./memoryEstimations-iHVpvWPf-muIwwhYq.js","./HighlightDefaults-Cg50f_1y-BdtvBSDI.js","./VertexElementDescriptor-BAy1DPb3-BOhpDZGx.js","./NestedMap-Ddo7BfvO-C19CMXI3.js","./TextOverlayItem-pAuO460X-qBVCNFs4.js","./glUtil-n1JOrdV3-BO0hK77I.js","./SelectedVertexTooltipInfo-C6fS9jtg-_2zIbHyZ.js","./TranslateTooltipInfo-BmeZ3crn-CLYd8qUY.js","./utils-C_9ghOVk-BkZ3kRku.js","./LRUCache-BLmkvs7b-BlMtOAfW.js","./MemCache-BCippCv6-5mCsZm8w.js","./IViewEvents-BE10MM98-CvMfjolG.js","./MD5-CHHr-oed-SuyrCYQ0.js","./multiOriginJSONSupportUtils-DGETddQl-BrWaY9_8.js","./ExtentScaleTooltipInfo-DGVFaJSb-Bi3GYqPi.js","./LineCallout.glsl-B1CPwb2z-BHHqsrct.js","./heightModelInfoUtils-CI93rfC7-C6QvJAY5.js","./HeightModelInfo-BkDck4B0-CnWGm1rQ.js","./visualVariableUtils-BO-_wo28-DP_j124F.js","./dehydratedFeatures-CekTKTy7-DrNFsMSE.js","./UniqueValueRenderer-BmoLL_Ee-CaiEJ32d.js","./commonProperties-BLIn8DYU-B7s3aXGw.js","./colorRamps-KMmVdCPJ-DBm2pvhR.js","./ColorStop-DoHCvOqO-BLRHtXAS.js","./RendererLegendOptions-f5mIImtQ-th5j7YDf.js","./styleUtils-DxAOZq5S-Dn6r5GA8.js","./rendererConversion-D-HBj0jy-DaTKBh1m.js","./RealisticTree.glsl-De7nH4tm-BPBtm_aR.js","./DefaultMaterial-DGGIMylx-BfpN1LVI.js","./NormalAttribute.glsl-C9zbIKka-BETdA4ez.js","./edgeUtils-CjV7X0G9-YQb8PwGZ.js","./OptimizedFeatureSet-D6mgsKNr-D237deNR.js","./OptimizedGeometry-1qDYm3YK-DaEUjOqr.js","./optimizedFeatureQueryEngineAdapter-Bx4OOJmK-DCT5KGuK.js","./vec2f32-CVhmN3Me-DxoqVD7C.js","./featureConversionUtils-DRaHTjrY-DYsv25kR.js","./webStyleAcceptedFormats-DsfCZOwz-CG7ZQ6BV.js","./PooledRBush-J5-OtqBl-H9JqPZwm.js","./quickselect-DHTstthl-Ds_Aj0x5.js","./popupUtils-sIuvqRgn-B2GkNpcx.js","./geometryServiceUtils-7fDBrM6E-lFnSVXwU.js","./project-CdmvlsYz-Cyy5-6FD.js","./LayerView-D3XoMhlx-BkWuvG9g.js","./GraphicMover-CiNX1V2i-PBqRfaCj.js","./featureUtils-CZUu1SmW-Cv4a66rk.js","./utils-BG7WTOnW-DP9MEjZl.js","./timeZoneUtils-z3WjfjXQ-C6Gurq5H.js","./Box-CcaqKOvu-CnIdYwkh.js","./settings-zzKkZJrb-BhojPf20.js","./Reshape-BUYuf7aU-B14kvgSI.js"])))=>i.map(i=>d[i]);
import{v as c,df as v,f_ as me,dK as Cn,I as h,aa as we,a as qt,bM as re,ai as be,_ as N,H as Pt,K as Dn,fs as Nn,eO as di,fd as Hn,fc as Un,gE as Vn,gF as Fn,dF as ui,bd as Be,bf as $n,dP as Rt,bp as yi,cV as Ui,gG as jn,gg as zn,gH as Q,gI as gi,a8 as Vi,c as qn,dM as fi,dX as Yn,gh as nt,t as C,Y as Fi,dz as ot,eY as Zn,fY as Bn,ac as Wn,gJ as Kn,bh as Ue,dT as Xn,f$ as Jn,dN as Qn,aj as eo,e3 as vi,eE as Ce,gn as to,c$ as ft,ah as io,b3 as no,cN as oo,b6 as so,dn as ro,dI as ao,gK as po}from"./index-CBMEoBe1.js";import{i as lo}from"./UpdatingHandles-DBzjq66S-BoM1VXsj.js";import{O as Dt,Q as co,L as ho,k as uo,K as yo,i as go}from"./projection-m8vi7Cxv-D46rH7Dd.js";import fo from"./GraphicsLayer-GkJJfSu5-CwfpgeJp.js";import{b as vo}from"./ElevationInfo-DkWlof50-iMvbcrJj.js";import{g as G,A as mi,k as mo,a as _o,W as Eo,m as bo}from"./globalCss-CFN4F315-DTUnIrUK.js";import{t as Fe,g as Yt}from"./quantityUtils-RaoZoCNH-DaTB8IoM.js";import{i as H,y as ne,l as Se,P as xe,f as wo,b as To,h as $i,M as ji,D as So,v as Oo,k as Po,A as Ro,m as zi,E as _i}from"./vec2-BnynUbeJ-CKtGJQAy.js";import{o as z,y as Go,t as Qe,l as Mo}from"./vec2f64-CEUyUoff-BBc0aQ6D.js";import{O as k,T as O,p as Nt,C as F,v as Ao,y as V,X as st,l as xo,r as vt,P as Lo,Y as ko,_ as mt,g as qi,A as oe,W as Io,V as Ht}from"./vec32-BuqRmYBM-CtdUGvNP.js";import{s as je,p as Yi,f as rt}from"./projectVectorToVector-D0K_S4MR-DnEkUtMb.js";import{u as Ut,D as Zt,W as at,C as Bt}from"./geodesicUtils-DV-lFWtb-kScndeqx.js";import{O as Co}from"./TimeExtent-gZaEUVeW-BagTZBwO.js";import{b as Do}from"./Query-CxQYWcUQ-DzmF5hbn.js";import{y as No,w as Ho}from"./vec42-D8CJyqHG-DnfLTeQH.js";import{o as Uo}from"./vec4f64-CjUMzAyX-DPYbdAom.js";import{Q as q,m as Zi,O as Vo,U as Bi,P as Fo,B as _t,$ as Wi,a as Vt,E as Ki,K as $o}from"./plane-B_adY3_o-cU7zwxlO.js";import{G as jo,F as zo,B as qo,w as Yo,U as Zo}from"./sphere-Cj20syUS-oRTzH7yL.js";import{n as $e}from"./common-CYWrYyJl-E8-sukrT.js";function Xi(e){return e?Oe:os}function Bo(e,t){return t!=null&&t.mode?t.mode:Xi(e).mode}function Wo(e,t){return t??Xi(e)}function Ji(e,t){return Bo(e==null||(e.hasZ??!1),t)}function Yr(e,t){return Wo(e==null||(e.hasZ??!1),t)}function Ko(e){const t=Qi(e);return Ji(e.geometry,t)}function Xo(e){const t=Qi(e),i=Ji(e.geometry,t),n=t!=null&&i!=="on-the-ground"?ns(t):0,o=t==null?void 0:t.featureExpressionInfo;return{mode:i,offset:n,featureExpressionInfo:o}}function Jo(e){return Et(Xo(e))}function Zr(e){return Et(e)||Qo(e)}function Qo(e){var t;return((t=e==null?void 0:e.featureExpressionInfo)==null?void 0:t.expression)==="0"}function Et(e){if(!e||e.mode==="on-the-ground")return!1;const t=e!=null&&e.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!t||t==="0")}function Qi(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function Wt(e,t){if(!(e!=null&&e.offset))return 0;const{offset:i,unit:n}=e;if(n==="decimal-degrees")return 0;const o=n!=="unknown"&&n?n:"meters",s=to(t);return s?ft(i,o,s):0}function Br(e,t,i){if(!(i!=null&&i.mode))return;const n=e.hasZ?e.z:0,o=Wt(i,e.spatialReference);switch(i.mode){case"absolute-height":return n-o;case"on-the-ground":return 0;case"relative-to-ground":return n-((t.elevationProvider.getElevation(e.x,e.y,n,e.spatialReference,"ground")??0)+o);case"relative-to-scene":return n-((t.elevationProvider.getElevation(e.x,e.y,n,e.spatialReference,"scene")??0)+o)}}function es(e,t,i,n=null){return Kt(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,i,n)}function en(e,t,i,n,o=null){return Kt(e,t[0],t[1],t.length>2?t[2]:0,i,n,o)}function Kt(e,t,i,n,o,s,a=null){if(s==null)return;const r=a!=null?a.mode:"absolute-height";if(r==="on-the-ground")return 0;const{absoluteZ:p}=ts(t,i,n,o,e,s);return is(p,t,i,n,o,e,a,r)}function ts(e,t,i,n,o,s){const a=Wt(s,n);switch(s.mode){case"absolute-height":return{absoluteZ:i+a,elevation:0};case"on-the-ground":{const r=o.elevationProvider.getElevation(e,t,0,n,"ground")??0;return{absoluteZ:r,elevation:r}}case"relative-to-ground":{const r=o.elevationProvider.getElevation(e,t,i,n,"ground")??0;return{absoluteZ:i+r+a,elevation:r}}case"relative-to-scene":{const r=o.elevationProvider.getElevation(e,t,i,n,"scene")??0;return{absoluteZ:i+r+a,elevation:r}}}}function is(e,t,i,n,o,s,a,r){const p=Wt(a,o);switch(r){case"absolute-height":return e-p;case"relative-to-ground":return e-((s.elevationProvider.getElevation(t,i,n,o,"ground")??0)+p);case"relative-to-scene":return e-((s.elevationProvider.getElevation(t,i,n,o,"scene")??0)+p)}}function Wr(e,t){if(t==null)return!1;const{mode:i}=t;return i!=null&&(e==="scene"&&i==="relative-to-scene"||e==="ground"&&i!=="absolute-height")}function Kr(e,t,i){return i&&i.mode!==t?`${e} only support ${t} elevation mode`:null}function Xr(e,t,i){return(i==null?void 0:i.mode)===t?`${e} do not support ${t} elevation mode`:null}function Jr(e,t){return(t==null?void 0:t.featureExpressionInfo)!=null&&t.featureExpressionInfo.expression!=="0"?`${e} do not support featureExpressionInfo`:null}function Qr(e,t){t&&e.warn(".elevationInfo=",t)}function ns(e){return((e==null?void 0:e.offset)??0)*vo(e==null?void 0:e.unit)}const Oe={mode:"absolute-height",offset:0},os={mode:"on-the-ground",offset:null};function Gt(e,t){return e[0]*t[1]-e[1]*t[0]}function ss(e,t,i){const n=xe(i,t)/Se(i);return Oo(e,i,n)}function ea(e,t,i,n,o=i){return H(Te,n,i),H(pt,t,o),ss(Me,pt,Te),To(e,o,Me)}function ta(e,t,i,n){H(Te,t,i);const o=n/$i(Te);return ne(e,i,Te,o)}function ia(e,t){const i=e.start,n=e.end,o=t.start,s=t.end,a=H(Te,n,i),r=H(tn,s,o),p=Gt(a,r);if(Math.abs(p)<=as)return[];const l=H(pt,i,o),d=Gt(r,l)/p,u=Gt(a,l)/p;if(d>=0){if(u>=0||t.type===P.LINE)return[ne(Me,i,a,d)]}else if(e.type===P.LINE&&(u>=0||t.type===P.LINE))return[ne(Me,i,a,d)];return[]}function rs(e,t,i){const n=[],o=H(Te,e.end,e.start),s=H(tn,e.start,t),a=Se(o),r=2*xe(o,s),p=r*r-4*a*(Se(s)-i*i);if(p===0){const l=-r/(2*a);(e.type===P.LINE||l>=0)&&n.push(ne(Me,e.start,o,l))}else if(p>0){const l=Math.sqrt(p),d=(-r+l)/(2*a);(e.type===P.LINE||d>=0)&&n.push(ne(Me,e.start,o,d));const u=(-r-l)/(2*a);(e.type===P.LINE||u>=0)&&n.push(ne(pt,e.start,o,u))}return n}var P;(function(e){e[e.RAY=0]="RAY",e[e.LINE=1]="LINE"})(P||(P={}));const as=1e-6,Te=z(),tn=z(),pt=z(),Me=z();function ps(e,t,i,n,o=v()){const s=mt(ls,e);return s[2]=en(n,s,t,i)||0,n.renderCoordsHelper.toRenderCoords(s,t,o),o}const ls=v(),nn="z",on="r",R={redo:on,undo:nn,center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},Ei={toggle:"Control"},na={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},oa={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:mo,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},editSourcePoints:{key:"Alt",continuePropagation:!0},undo:nn,redo:on};let sa=class{constructor(){this._bindings=new Map}add(e,t){return this.addToggle(e,i=>{i.type==="key-down"&&t(i)})}addToggle(e,t){const i=cs.fromDefinition(e,t),n=io(this._bindings,i.key,()=>[]);return n.push(i),no(()=>oo(n,i))}register(e,t=G.WIDGET){return so([e.on("key-down",i=>this.dispatch(e.inputManager,i),t),e.on("key-up",i=>this.dispatch(e.inputManager,i),t)])}dispatch(e,t){const i=t.key,n=this._bindings.get(i);if(n)for(const o of n)o.process(e,t)}},cs=class Ft{constructor(t,i,n,o,s){this.key=t,this.modifiers=i,this.repeats=n,this.continuePropagation=o,this.callback=s}process(t,i){if(!(i.key!==this.key||"repeat"in i&&i.repeat&&!this.repeats)){for(const n of this.modifiers)if(!t.isModifierKeyDown(n))return;this.continuePropagation||i.stopPropagation(),this.callback(i)}}static fromDefinition(t,i){if(typeof t=="string")return new Ft(t,[],!1,!1,i);const{key:n,modifier:o,repeats:s,continuePropagation:a}=t;return new Ft(n,o?Array.isArray(o)?o:[o]:[],!!s,!!a,i)}};var Pe;function sn(e,t,i){return j(e,t,i)}function j(e=0,t=0,i=0){return nt(e,t,i)}function ra(e){return e}function aa(e){return e}function _e(e,t,i){return nt(e,t,i)}function Ae(e){const[t,i,n]=e;return e.length>3?[t,i,n,e[3]]:[t,i,n]}function Mt(e){return e[3]=((e.length>3?e[3]:void 0)??Pe.NONE)|Pe.TARGET,e}function pa(e){return!!(((e.length>3?e[3]:void 0)??Pe.NONE)&Pe.TARGET)}function bi(e,t,{coordinateHelper:i,elevationInfo:n},o){return e?He(i.vectorToDehydratedPoint(e,hs),t,n,o):null}function He(e,t,i,n=j()){return n[0]=e.x,n[1]=e.y,n[2]=e.z??0,t==null||(t.type==="2d"?n[2]=0:n[2]=es(t,e,i,Oe)??0),n}function la(e,t,i){return i?(Yi(i,e[0],e[1],e[2],t),i):je(e[0],e[1],e[2],t)}function wi(e,t,{z:i,m:n},o,s){const{spatialReference:a,elevationInfo:r}=o;let p;i==null&&n==null?p=void 0:t==null||t.type==="2d"?p=i??void 0:p=en(t,e,a,Oe,r)??0;const[l,d]=e;return s?Yi(s,l,d,p,a):s=je(l,d,p,a),n!=null&&(s.m=n,s.hasM=!0),s}function ca(e,t,i,n,o=j()){const[s,a]=e;return o[0]=s,o[1]=a,e.length>3&&(o[3]=e[3]??Pe.NONE),(i==null?void 0:i.type)!=="3d"?(o[2]=t.value,o):(o[2]=Kt(i,s,a,t.value,n,t.elevationInfo,Oe)??0,o)}(function(e){e[e.NONE=0]="NONE",e[e.TARGET=1]="TARGET"})(Pe||(Pe={}));const hs=je(0,0,0,null);let K=class extends Fi{constructor(){super(...arguments),this.enabled=!0}};c([h({type:Boolean})],K.prototype,"enabled",void 0),K=c([C("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],K);let S=class extends Fi{constructor(e){super(e),this.lineSnapper=new K,this.parallelLineSnapper=new K,this.rightAngleSnapper=new K,this.rightAngleTriangleSnapper=new K,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new ot([255,127,0]),this.orangeTransparent=new ot([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};c([h({type:K,constructOnly:!0,nonNullable:!0,json:{write:!0}})],S.prototype,"lineSnapper",void 0),c([h({type:K,constructOnly:!0,nonNullable:!0,json:{write:!0}})],S.prototype,"parallelLineSnapper",void 0),c([h({type:K,constructOnly:!0,nonNullable:!0,json:{write:!0}})],S.prototype,"rightAngleSnapper",void 0),c([h({type:K,constructOnly:!0,nonNullable:!0,json:{write:!0}})],S.prototype,"rightAngleTriangleSnapper",void 0),c([h({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],S.prototype,"shortLineThreshold",void 0),c([h({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],S.prototype,"distance",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],S.prototype,"pointThreshold",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],S.prototype,"intersectionParallelLineThreshold",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],S.prototype,"parallelLineThreshold",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],S.prototype,"verticalLineThresholdMeters",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],S.prototype,"touchSensitivityMultiplier",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],S.prototype,"pointOnLineThreshold",void 0),c([h({type:ot,nonNullable:!0})],S.prototype,"orange",void 0),c([h({type:ot,nonNullable:!0})],S.prototype,"orangeTransparent",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],S.prototype,"lineHintWidthReference",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],S.prototype,"lineHintWidthTarget",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],S.prototype,"lineHintFadedExtensions",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],S.prototype,"parallelLineHintWidth",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],S.prototype,"parallelLineHintLength",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],S.prototype,"parallelLineHintOffset",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],S.prototype,"rightAngleHintSize",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],S.prototype,"rightAngleHintOutlineSize",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],S.prototype,"satisfiesConstraintScreenThreshold",void 0),S=c([C("esri.views.interactive.snapping.Settings.Defaults")],S);const lt=new S;var I;(function(e){e[e.FEATURE=1]="FEATURE",e[e.SELF=2]="SELF",e[e.ALL=3]="ALL"})(I||(I={}));let bt=class{constructor(e,t){this.isDraped=e,this.domain=t}},ds=class rn extends bt{constructor(t,i,n=I.ALL){super(i,n),this.intersectionPoint=t}equals(t){return t instanceof rn&&O(this.intersectionPoint,t.intersectionPoint)}},se=class an extends bt{constructor(t,i,n,o,s=I.ALL,a=!0,r=!0){super(o,s),this.type=t,this.lineStart=i,this.lineEnd=n,this.fadeLeft=a,this.fadeRight=r}equals(t){return t instanceof an&&this.type===t.type&&O(this.lineStart,t.lineStart)&&O(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}get length(){return qi(this.lineStart,this.lineEnd)}},us=class pn extends bt{constructor(t,i,n,o=I.ALL){super(n,o),this.lineStart=t,this.lineEnd=i}equals(t){return t instanceof pn&&O(this.lineStart,t.lineStart)&&O(this.lineEnd,t.lineEnd)}},ln=class cn extends bt{constructor(t,i,n,o,s=I.ALL){super(o,s),this.previousVertex=t,this.centerVertex=i,this.nextVertex=n}equals(t){return t instanceof cn&&O(this.previousVertex,t.previousVertex)&&O(this.centerVertex,t.centerVertex)&&O(this.nextVertex,t.nextVertex)}};function Xt({start:e,end:t,type:i},n,o){const s=[],a=H(ze,t,e),r=H(wt,e,n),p=Se(a),l=2*xe(a,r),d=l*l-4*p*(Se(r)-o*o);if(d===0){const u=-l/(2*p);(i===$.PLANE||u>=0)&&s.push(ne(z(),e,a,u))}else if(d>0){const u=Math.sqrt(d),f=(-l+u)/(2*p);(i===$.PLANE||f>=0)&&s.push(ne(z(),e,a,f));const y=(-l-u)/(2*p);(i===$.PLANE||y>=0)&&s.push(ne(z(),e,a,y))}return s}function hn(e,t){const i=e.start,n=e.end,o=H(ze,n,i),s=oe(St,-o[1],o[0],0),a=t.start,r=t.end,p=F(Qt,r,a),l=V(p,s),d=oe(_n,i[0],i[1],0),u=F(En,d,a),f=V(u,s),y=$e();if(Math.abs(l)<y)return[];const g=k(bn,a,p,f/l);if(t.type===P.RAY){const m=F($t,g,a);if(V(m,p)<-y)return[]}if(e.type===$.HALF_PLANE){const m=Po(wt,g,i);if(xe(m,o)<-y)return[]}return[me(g)]}function ys(e,t){return fs(ct(ei,t[2],e),t)}function dn(e,t){return vn(ct(ei,0,e),ct(Es,0,t)).map(([i,n])=>Qe(i,n))}function un(e,t,i){return gn(e,ct(ei,e[2],t),i)}function yn(e,t,i,n=v()){const o=H(ze,e,t),s=$i(o);return ne(n,t,o,s===0?1:i/s),n[2]=e[2],n}function gn(e,{start:t,end:i,type:n},o=v()){const s=F(Tt,e,t),a=F(St,i,t),r=V(s,a)/V(a,a);return k(o,t,a,n===P.RAY?Math.max(r,0):r)}const gs=(()=>{const e=v(),t=v(),i=v();return({start:n,end:o},{center:s,radius:a,normal:r,slicePlane:p})=>{const l=_t(s,r,_s);if(w(Vt(l,n),0)&&w(Vt(l,o),0)){Wi(r,e,t);const u=(g,m)=>(vt(i,m,s),zi(g,V(i,e),V(i,t)),g),f=rs({start:u(ze,n),end:u(wt,o),type:P.LINE},Mo,a),y=[];for(const[g,m]of f){const T=mt(v(),s);k(T,T,e,g),k(T,T,t,m),p&&!ve(p,T)||y.push(T)}return y}const d=v();return Zi(l,n,o,d)?!w(qi(d,s),a)||p&&!ve(p,d)?[]:[d]:[]}})();function fn({start:e,end:t,type:i},n,o){const s=[],a=vt(Tt,t,e),r=H(wt,e,n),p=Se(a),l=2*xe(a,r),d=l*l-4*p*(Se(r)-o*o);if(d===0){const u=-l/(2*p);(i===P.LINE||u>=0)&&s.push(k(v(),e,a,u))}else if(d>0){const u=Math.sqrt(d),f=(-l+u)/(2*p);(i===P.LINE||f>=0)&&s.push(k(v(),e,a,f));const y=(-l-u)/(2*p);(i===P.LINE||y>=0)&&s.push(k(v(),e,a,y))}return s}function vn(e,t){const i=e.start,n=e.end,o=t.start,s=t.end,a=F(Tt,n,i),r=F(St,s,o),p=F(Qt,o,i),l=st(_n,a,r);if(!w(V(p,l),0))return[];const d=Ht(l);if(w(d,0))return[];const u=st(En,p,r),f=V(u,l)/d,y=k(bn,i,a,f);if(e.type===P.RAY){const g=F($t,y,i);if(V(a,g)<-$e())return[]}if(t.type===P.RAY){const g=F($t,y,o);if(V(r,g)<-$e())return[]}return[me(y)]}function fs({start:e,end:t,type:i},n){const o=F(Tt,n,e),s=F(St,t,e),a=st(Qt,s,o),r=Ht(a)/Ht(s),p=$e();if(r<p)switch(i){case P.LINE:return[me(n)];case P.RAY:return V(s,o)<-p?[]:[me(n)]}return[]}function Jt(e,t,i,n){const[o,s]=e,[a,r]=i,p=a-o,l=r-s,d=p*p+l*l,u=Math.sqrt(d);if(u>t+n)return[];if(u<Math.abs(t-n))return[];if(w(u,0)&&w(t,n))return[];const f=(t*t-n*n+d)/(2*u),y=Math.sqrt(t*t-f*f),g=y*l/u,m=y*p/u,[T,J]=Ro(ze,e,i,f/u);return w(g,m)?[Qe(T,J)]:[Qe(T+g,J-m),Qe(T-g,J+m)]}function ct(e,t,{start:i,end:n,type:o}){return oe(e.start,i[0],i[1],t),oe(e.end,n[0],n[1],t),e.type=ms[o],e}function mn(e,t){return w(e[2],t[2])}function w(e,t){return Zn(Math.abs(e-t),0,$e())}function vs(e,t){return t.filter(i=>ve(e,i))}function ve(e,t){return Fo(e,t)}var $;(function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"})($||($={}));const ms={[$.PLANE]:P.LINE,[$.HALF_PLANE]:P.RAY},ze=z(),wt=z(),Tt=v(),St=v(),Qt=v(),_n=v(),En=v(),bn=v(),$t=v(),_s=q(),ei={start:v(),end:v(),type:P.LINE},Es={start:v(),end:v(),type:P.LINE};class Z{intersect(t){return ae(this,t)}closestPoints(t){return[this.closestTo(t)]}}class Le extends Z{constructor(t){super(),this.point=t}equals(t){return this===t||B(t)&&O(this.point,t.point)}closestTo(){return Ae(this.point)}}class ti extends Z{constructor(t,i,n){super(),this.start=t,this.end=i,this.lineLike={start:t,end:i,type:n}}equals(t){return this===t||ee(t)&&this.lineLike.type===t.lineLike.type&&O(this.start,t.start)&&O(this.end,t.end)}closestTo(t){const i=j();return gn(t,this.lineLike,i),i}}class ii extends ti{constructor(t,i){super(t,i,P.LINE)}}class bs extends ti{constructor(t,i){super(t,i,P.RAY)}}class wn extends Z{constructor(t){super(),this.constraints=t}equals(t){return this===t||jt(t)&&Bn(this.constraints,t.constraints,(i,n)=>i.equals(n))}closestTo(t){let i,n=1/0;for(const o of this.constraints){const s=o.closestTo(t),a=Nt(t,s);a<n&&(n=a,i=s)}return Ae(i??t)}closestPoints(t){return this.constraints.flatMap(i=>i===this?[]:i.closestPoints(t))}}class Tn extends Z{constructor(t,i){super(),this.center=t,this.radius=i}equals(t){return this===t||ie(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){const i=j();return yn(t,this.center,this.radius,i),i}}class ni extends Z{constructor(t,i){super(),this.center=t,this.radius=i}equals(t){return this===t||le(t)&&O(this.center,t.center)&&this.radius===t.radius}closestTo(t){const i=j();return yn(t,this.center,this.radius,i),i[2]=this.center[2],i}asCircle(){return new oi(Ae(this.center),this.radius,_e(0,0,1))}}class oi extends Z{constructor(t,i,n,o=void 0){super(),this.center=t,this.radius=i,this.normal=n,this.slicePlane=o}equals(t){return this===t||ye(t)&&O(this.center,t.center)&&O(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){var l;const{center:i,radius:n}=this;Bi(this.getPlane(ws),t,At);const o=F(At,At,i),s=Ao(o);if(w(s,0))return Ae(t);const a=n/Math.sqrt(s),r=j();k(r,i,o,a);const{slicePlane:p}=this;return p&&!ve(p,r)?((l=ri(p,this))==null?void 0:l.closestTo(t))??Ae(t):r}getPlane(t=q()){return _t(this.center,this.normal,t)}}const At=v(),ws=q();class Ts extends Z{constructor(t){super(),this.z=t}equals(t){return this===t||pe(t)&&this.z===t.z}closestTo(t){return _e(t[0],t[1],this.z)}getPlane(t=q()){return oe(Ti,0,0,this.z),_t(Ti,po,t)}}const Ti=v();class si extends Z{constructor(t,i,n){super(),this.start=t,this.end=i,this.planeLike={start:t,end:i,type:n}}equals(t){return this===t||te(t)&&this.planeLike.type===t.planeLike.type&&O(this.start,t.start)&&O(this.end,t.end)}closestTo(t){const i=j();return un(t,this.planeLike,i),i}closestEndTo(t){const{start:i,end:n}=this.planeLike;return Math.sign(xe(H(Ss,n,i),H(Os,t,i)))>0?this.end:this.start}getPlane(t=q()){const i=mt(Si,this.end);return i[2]+=1,$o(this.start,this.end,i,t)}getSlicePlane(t=q()){const{start:i,end:n,type:o}=this.planeLike;if(o===$.PLANE)return;const s=oe(Si,i[0],i[1],0),a=oe(Oi,n[0],n[1],0),r=vt(Oi,a,s);return _t(s,r,t),t}}const Ss=z(),Os=z(),Si=v(),Oi=v();class ha extends si{constructor(t,i){super(t,i,$.HALF_PLANE)}}class Sn extends si{constructor(t,i){super(t,i,$.PLANE)}}class Ps extends Z{constructor(t,i){super(),this.sphere=zo(t,i)}equals(t){return this===t||ce(t)&&qo(this.sphere,t.sphere)}closestTo(t){const i=j();return Yo(this.sphere,t,i),i}get center(){return Zo(this.sphere)}get radius(){return this.sphere[3]}}class On extends Z{constructor(t,i,n){super(),this.start=t,this.end=i,this.getZ=n,this.planeLike={start:t,end:i,type:$.PLANE}}equals(t){return this===t||ht(t)&&O(this.start,t.start)&&O(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return Ls(this,t)}addIfOnTheGround(t,i){for(const n of i){const o=this.getZ(n[0],n[1])??0;w(n[2],o)&&(n[2]=o,t.push(n))}}}class Rs extends Z{constructor(t,i,n){super(),this._x=t,this._y=i,this._z=n}equals(t){return this===t||Bs(t)&&this._x===t._x&&this._y===t._y&&this._z===t._z}closestTo([t,i,n]){return sn(this._x??t,this._y??i,this._z??n)}}class Gs extends Z{constructor(t,i,n,o,s){super(),this._origin=t,this._spatialReference=i,this._distanceMeters=n,this._z=o,this._directionDegrees=s}equals(t){return this===t||Zs(t)&&_i(this._origin,t._origin)&&this._spatialReference===t._spatialReference&&this._distanceMeters===t._distanceMeters&&this._z===t._z&&this._directionDegrees===t._directionDegrees}closestTo([t,i,n]){return zi(De,t,i),_i(De,this._origin)||this._applyDirectionAndDistance(De),sn(De[0],De[1],this._z??n)}_applyDirectionAndDistance(t){if(this._directionDegrees!=null&&this._distanceMeters!=null)at(t,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)As(t,this._origin,this._directionDegrees,t,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:i}=Zt(Ms,this._origin,t,this._spatialReference);at(t,this._origin,i??0,this._distanceMeters,this._spatialReference)}}}const De=[0,0],Ms=new Bt;function As(e,t,i,n,o){let{azimuth:s,distance:a}=Zt(xs,t,n,o);s??(s=0);let r=a*Math.cos((s-i)*go);r=Math.max(0,r),at(e,t,i,r,o)}const xs=new Bt;function Ls(e,t){const i=j();return un(t,e.planeLike,i),i[2]=e.getZ(i[0],i[1])??Rn,i}function ae(e,t){if(jt(e)){const i=[];for(const n of e.constraints){const o=n.intersect(t);o&&i.push(o)}return ai(i)}if(jt(t))return ae(t,e);if(ht(e))return Pi(e,t);if(ht(t))return Pi(t,e);if(B(e)){const{point:i}=e;if(B(t))return O(i,t.point)?e:void 0;const n=t.closestTo(i);return Io(n,i)?e:void 0}if(ee(e)){if(B(t))return ae(t,e);if(ee(t))return X(vn(e.lineLike,t.lineLike));if(pe(t))return ks(e,t);if(te(t))return X(hn(t.planeLike,e.lineLike));if(ie(t))return X(fn(e.lineLike,t.center,t.radius));if(ye(t))return X(gs(e.lineLike,t));if(le(t))return Is(e,t);if(ce(t))return Cs(e,t)}else if(pe(e)){if(B(t)||ee(t))return ae(t,e);if(pe(t))return Ds(e,t);if(te(t))return Ns(e,t);if(ie(t))return Hs(e,t);if(ye(t))return Vs(e,t);if(le(t))return Us(e,t);if(ce(t))return Fs(e,t)}else if(te(e)){if(B(t)||ee(t)||pe(t))return ae(t,e);if(te(t))return xt(dn(e.planeLike,t.planeLike));if(ie(t))return xt(Xt(e.planeLike,t.center,t.radius));if(ye(t))return js(e,t);if(le(t))return $s(e,t);if(ce(t))return zs(e,t)}else if(ie(e)){if(B(t)||ee(t)||pe(t)||te(t))return ae(t,e);if(ie(t))return xt(Jt(e.center,e.radius,t.center,t.radius));if(ye(t))return;if(le(t))return qs(e,t);if(ce(t))return}else if(ye(e)){if(B(t)||ee(t)||pe(t)||te(t)||ie(t))return ae(t,e);if(ye(t))return;if(le(t))return t.asCircle(),void 0;if(ce(t))return}else if(le(e)){if(B(t)||ee(t)||pe(t)||te(t)||ie(t)||ye(t))return ae(t,e);if(le(t))return Ys(t,e);if(ce(t))return}else if(ce(e)){if(B(t)||ee(t)||pe(t)||te(t)||ie(t)||le(t))return ae(t,e);if(ce(t))return}}const ks=(()=>{const e=q();return(t,i)=>{const{start:n,end:o}=t;if(mn(n,o)&&w(n[2],i.z))return t;const s=j();return Zi(i.getPlane(e),n,o,s)?new Le(s):void 0}})();function Is({lineLike:e},{center:t,radius:i}){const n=t[2];return X(fn(e,t,i).filter(o=>w(o[2],n)))}function Cs({lineLike:e},{sphere:t}){return X(jo(t,e.start,e.end))}const ri=(()=>{const e=Uo(),t=v(),i=v();return(n,o,s)=>{const{normal:a,center:r,radius:p}=o;Wi(a,t,i);const l=Ki(n),d=p*V(l,t),u=p*V(l,i);No(e,r[0],r[1],r[2],1);const f=Ho(n,e),y=Math.hypot(d,u),g=w(y,0);if(w(Vt(n,r),0)){if(g)return o;if(w(p,0))return!s||ve(s,r)?new Le(Ae(r)):void 0;st(t,l,a),xo(t,t);const Ot=new Array,Ye=me(r);k(Ye,Ye,t,p),s&&!ve(s,Ye)||Ot.push(Ye);const Ze=me(r);return k(Ze,Ze,t,-p),s&&!ve(s,Ze)||Ot.push(Ze),X(Ot)}if(g)return;const m=-f/y;if(Math.abs(m)>1||w(m,1))return;const T=Math.atan(d/u),J=ro(m)-T,Ie=Math.PI-J,b=new Array,Ee=v();k(Ee,r,t,p*Math.cos(J)),k(Ee,Ee,i,p*Math.sin(J)),b.push(Ee);const qe=v();return k(qe,r,t,p*Math.cos(Ie)),k(qe,qe,i,p*Math.sin(Ie)),b.push(qe),X(s?vs(s,b):b)}})();function Ds(e,t){return w(e.z,t.z)?e:void 0}function Ns({z:e},{planeLike:t}){const[i,n]=t.start,[o,s]=t.end,a=_e(i,n,e),r=_e(o,s,e);return t.type===$.PLANE?new ii(a,r):new bs(a,r)}function Hs(e,t){const[i,n]=t.center;return new ni(_e(i,n,e.z),t.radius)}function Us(e,t){return w(t.center[2],e.z)?t:void 0}const Vs=(()=>{const e=q();return(t,i)=>ri(t.getPlane(e),i,i.slicePlane)})();function Fs(e,{center:t,radius:i}){const n=Math.abs(t[2]-e.z);if(n>i&&!w(n,i))return;const o=_e(t[0],t[1],e.z),s=Math.sqrt(i**2-n**2);return w(s,0)?void 0:new ni(o,s)}const $s=(()=>{const e=q();return(t,{center:i,radius:n})=>{const o=Xt(t.planeLike,i,n),s=i[2];t.getSlicePlane(e);const a=new Array;for(const[r,p]of o){const l=[r,p,s];ve(e,l)&&a.push(l)}return X(a)}})(),js=(()=>{const e=q(),t=q();return(i,n)=>ri(i.getPlane(e),n,i.getSlicePlane(t))})(),zs=(()=>{const e=q();return(t,{center:i,radius:n})=>{const o=t.getPlane(e),s=Vo(o,i),a=Math.abs(s);if(a>n&&!w(a,n))return;const r=Math.sqrt(n**2-s**2);if(w(r,0)){const d=j();return Bi(o,i,d),new Le(d)}const p=j(),l=me(Ki(o));return k(p,i,l,s),new oi(p,r,l,t.getSlicePlane())}})();function qs(e,t){const i=ji(e.center,t.center);return w(i,0)&&w(e.radius,t.radius)?t:Pn(Jt(e.center,e.radius,t.center,t.radius),t.center[2])}function Ys(e,t){if(!mn(e.center,t.center))return;const i=ji(e.center,t.center);return w(i,0)&&w(e.radius,t.radius)?e:Pn(Jt(e.center,e.radius,t.center,t.radius),e.center[2])}function Pi(e,t){const{planeLike:i,getZ:n}=e,o=new Array;if(B(t))e.addIfOnTheGround(o,ys(i,t.point));else if(ee(t))e.addIfOnTheGround(o,hn(i,t.lineLike));else if(ie(t))for(const[s,a]of Xt(i,t.center,t.radius)){const r=n(s,a);r!=null&&o.push(nt(s,a,r))}else if(te(t)||ht(t))for(const[s,a]of dn(i,t.planeLike)){const r=n(s,a)??Rn;o.push(nt(s,a,r))}return X(o)}function xt(e){return ai(e.map(([t,i])=>{const n=_e(t,i,0),o=_e(t,i,1);return new ii(n,o)}))}function X(e){return ai(e.map(t=>t?new Le(t):void 0))}function Pn(e,t){return X(e.map(([i,n])=>[i,n,t]))}function ai(e){if(e.length!==0)return e.length===1?e[0]??void 0:new wn(e.filter(Cn))}function jt(e){return e instanceof wn}function B(e){return e instanceof Le}function ee(e){return e instanceof ti}function pe(e){return e instanceof Ts}function te(e){return e instanceof si}function ie(e){return e instanceof Tn}function le(e){return e instanceof ni}function ye(e){return e instanceof oi}function ce(e){return e instanceof Ps}function ht(e){return e instanceof On}function Zs(e){return e instanceof Gs}function Bs(e){return e instanceof Rs}const Rn=0;var U;function Ws(e,t){if(e==null||t==null)return;const i=zt(e,t);return i!=null?Fe(i,"radians","geographic"):void 0}(function(e){e.Absolute="absolute",e.Relative="relative",e.RelativeBilateral="relative-bilateral"})(U||(U={}));const zt=(()=>{const e=v(),t=v();return(i,n)=>(oe(e,i.x,i.y,i.z??0),oe(t,n.x,n.y,n.z??0),Ks(e,t,i.spatialReference,n.spatialReference))})(),Ks=(()=>{const e=z(),t=v(),i=v();return(n,o,s,a)=>{if(O(n,o))return;const r=Ut(s),p=Ut(a);if(r&&p&&Ui(r,p)&&rt(n,s,t,r)&&rt(o,a,i,p)){const{azimuth:d}=Zt(Js,t,i,r);return d!=null?ft(d,"degrees","radians"):void 0}e[0]=o[0]-n[0],e[1]=o[1]-n[1];let l=So(Go,e);return e[0]<0&&(l=Qs-l),l}})();function da(e,t,i,n=U.Absolute){if(t&&i)switch(n){case U.Absolute:return Ws(t,i);case U.Relative:return Gi(Ri(e,t,i),U.Relative);case U.RelativeBilateral:return Gi(Ri(e,t,i),U.RelativeBilateral)}}function Ri(e,t,i){if(!e||!t||!i)return;const n=zt(e,t),o=zt(t,i);return n!=null&&o!=null?Fe(o-n,"radians","geographic"):void 0}function Gi(e,t){if(e!=null)switch(t){case U.Absolute:return Xs(e);case U.Relative:{const i=dt(e);let n=Mi.normalize(i,0,!0);return n===-180&&(n=180),Fe(n,"degrees","geographic")}case U.RelativeBilateral:{const i=dt(e),n=Math.abs(Mi.normalize(i,0,!0));return Fe(n,"degrees","geographic")}}}function Xs(e){const t=dt(e),i=er.normalize(t,0,!0);return Fe(i,"degrees","geographic")}const ua=(()=>{const e=v();return(t,i,n,o,s,a="geodesic")=>{mt(e,i);const r=dt(s);if(a==="geodesic"){const y=Ut(n);if(y&&rt(e,n,e,y))return at(t,e,r,o,y),t[2]=i[2],!!rt(t,y,t,n)}const p=Yt(r,"geographic","arithmetic"),l=ft(p,"degrees","radians"),d=i[0]+o*Math.cos(l),u=i[1]+o*Math.sin(l),f=i[2];return oe(t,d,u,f),!0}})();function dt(e){if(e!=null)return Yt(Gn(e),e.rotationType,"geographic")}function ya(e){if(e!=null)return Yt(Gn(e),e.rotationType,"arithmetic")}function Gn(e){return ft(e.value,e.unit,"degrees")}const Js=new Bt,Qs=2*Math.PI,er=Eo,Mi=new bo(-180,180);let et=class extends re{constructor(e){super(e),this.enabled=!1}};c([h({type:Boolean,nonNullable:!0})],et.prototype,"enabled",void 0),et=c([C("esri.views.interactive.sketch.SketchLabelOptions")],et);const pi=et,ga=Symbol("grid-placement-graphic");function Mn(e,t){const i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function fa(e,t){return Math.sqrt(Mn(e,t))}function tr(e,t){t.sort((i,n)=>Nt(i.targetPoint,e)-Nt(n.targetPoint,e))}var Y;function va({point:e,distance:t,returnEdge:i,vertexMode:n,coordinateHelper:{spatialReference:o},filter:s},a,r){return r=r!=null?r.clone():new Do({where:"1=1"}),s&&(r.geometry=s.geometry,r.distance=s.distance,r.spatialRelationship=s.spatialRelationship,r.where=Wn(r.where,s.where),r.timeExtent=Co(r.timeExtent,s.timeExtent),r.objectIds=ir(r.objectIds,s.objectIds)),{point:je(e[0],e[1],e[2],o.toJSON()),mode:a,distance:t,returnEdge:i,vertexMode:n,query:r.toJSON()}}function ir(e,t){return e||t?t?e?Array.from(Kn(new Set(e),new Set(t))):t:e:null}function ma(e,t,i){return{left:bi(e.leftVertex.pos,t,i),right:bi(e.rightVertex.pos,t,i)}}(function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(Y||(Y={}));const Ai=Symbol("snapping-toggle");function nr(e,t=()=>{}){const i=be(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:n,snappingOptions:o})=>{if(e.removeHandles(Ai),!n||!o)return;const s=G.TOOL,a=[n.on("key-down",r=>{r.key!==Ei.toggle||r.repeat||(o.enabledToggled=!0,t())},s),n.on("key-up",r=>{r.key===Ei.toggle&&(o.enabledToggled=!1,t())},s),n.on("pointer-move",r=>{const p=r.native.ctrlKey;o.enabledToggled!==p&&(o.enabledToggled=p,t())},s)];e.addHandles(a,Ai)},Ue);e.addHandles(i)}function _a(e){var t;return _o(e)&&"utilityNetworks"in e&&!!((t=e.utilityNetworks)!=null&&t.length)}let Ve=class extends re{constructor(e){super(e),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};c([h({type:String,nonNullable:!0})],Ve.prototype,"mode",void 0),Ve=c([C("esri.views.interactive.sketch.SketchTooltipElevationOptions")],Ve);let L=class extends re{constructor(e){super(e),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};c([h({type:Boolean,nonNullable:!0})],L.prototype,"area",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"coordinates",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"direction",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"distance",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"elevation",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"header",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"helpMessage",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"orientation",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"radius",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"rotation",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"scale",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"size",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"totalLength",void 0),L=c([C("esri.views.interactive.sketch.SketchTooltipVisibleElements")],L);const An=L;let D=class extends re{constructor(e){super(e),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new Ve,this.placement="auto",this.offset=null,this.visibleElements=new An,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};c([h({type:Boolean,nonNullable:!0})],D.prototype,"enabled",void 0),c([h()],D.prototype,"forceEnabled",void 0),c([h()],D.prototype,"effectiveEnabled",null),c([h()],D.prototype,"helpMessage",void 0),c([h()],D.prototype,"helpMessageIcon",void 0),c([h({type:Boolean,nonNullable:!0})],D.prototype,"inputEnabled",void 0),c([h({type:Ve,nonNullable:!0})],D.prototype,"elevation",void 0),c([h()],D.prototype,"placement",void 0),c([h()],D.prototype,"offset",void 0),c([h({type:An,nonNullable:!0})],D.prototype,"visibleElements",void 0),c([h()],D.prototype,"visualVariables",void 0),c([h()],D.prototype,"xyMode",void 0),D=c([C("esri.views.interactive.sketch.SketchTooltipOptions")],D);const li=D;let Re=class extends re{constructor(e){super(e),this.length=null,this.verticalLength=null,this.area=null}};c([h()],Re.prototype,"length",void 0),c([h()],Re.prototype,"verticalLength",void 0),c([h()],Re.prototype,"area",void 0),Re=c([C("esri.views.interactive.sketch.Units")],Re);const ut=Re;let ge=class extends re{constructor(e){super(e),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?U.RelativeBilateral:U.Relative;case"absolute":return U.Absolute}}get displayUnits(){return this._get("displayUnits")??new ut}set displayUnits(e){this._set("displayUnits",e)}get inputUnits(){return this._get("inputUnits")??new ut}set inputUnits(e){this._set("inputUnits",e)}};c([h({type:String,nonNullable:!0})],ge.prototype,"directionMode",void 0),c([h({type:Boolean,nonNullable:!0})],ge.prototype,"relativeDirectionIsBilateral",void 0),c([h()],ge.prototype,"effectiveDirectionMode",null),c([h({type:ut,nonNullable:!0})],ge.prototype,"displayUnits",null),c([h({type:ut,nonNullable:!0})],ge.prototype,"inputUnits",null),ge=c([C("esri.views.interactive.sketch.SketchValueOptions")],ge);const ci=ge;let fe=class extends re{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new we}};c([h({constructOnly:!0})],fe.prototype,"layer",void 0),c([h()],fe.prototype,"enabled",void 0),c([h()],fe.prototype,"updating",void 0),c([h()],fe.prototype,"availability",void 0),c([h()],fe.prototype,"sublayerSources",void 0),fe=c([C("esri.views.interactive.snapping.FeatureSnappingLayerSource")],fe);const xn=fe;let A=class extends re{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new we,this.distance=lt.distance,this.touchSensitivityMultiplier=lt.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){var r;const e=this.featureSources;e.some(xi)&&Vi.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const t=e.filter(sr),i=((r=this._get("_effectiveFeatureSources"))==null?void 0:r.filter(xi))??new we;for(const p of t){const l=i.find(d=>d.layer===p.layer.parent);if(l)l.sublayerSources.includes(p)||l.sublayerSources.add(p);else if(p.layer.parent){const d=new xn({layer:p.layer.parent});d.sublayerSources.add(p),i.add(d)}}for(const p of i){const l=p.sublayerSources.filter(d=>!t.includes(d));p.sublayerSources.removeMany(l)}i.removeMany(i.filter(p=>p.sublayerSources.length===0));const n=e.filter(or),o=this._get("_effectiveFeatureSources")??new we,{added:s,removed:a}=ao(o.toArray(),[...n,...i]);return o.removeMany(a),o.addMany(s),o}};c([h()],A.prototype,"enabled",void 0),c([h()],A.prototype,"enabledToggled",void 0),c([h()],A.prototype,"forceDisabled",void 0),c([h()],A.prototype,"selfEnabled",void 0),c([h()],A.prototype,"featureEnabled",void 0),c([h()],A.prototype,"gridEnabled",void 0),c([h()],A.prototype,"attributeRulesEnabled",void 0),c([h({type:we.ofType(xn)})],A.prototype,"featureSources",void 0),c([h()],A.prototype,"distance",void 0),c([h()],A.prototype,"touchSensitivityMultiplier",void 0),c([h({readOnly:!0})],A.prototype,"effectiveEnabled",null),c([h({readOnly:!0})],A.prototype,"effectiveGridEnabled",null),c([h({readOnly:!0})],A.prototype,"effectiveSelfEnabled",null),c([h({readOnly:!0})],A.prototype,"effectiveFeatureEnabled",null),c([h({readOnly:!0})],A.prototype,"_effectiveFeatureSources",null),A=c([C("esri.views.interactive.snapping.SnappingOptions")],A);const hi=A;function xi(e){return e.layer.type==="subtype-group"}function or(e){return e.layer.type!=="subtype-group"}function sr(e){return e.layer.type==="subtype-sublayer"}function rr(e){return(e==null?void 0:e.type)==="graphic"}function ar(e){return e.find(rr)??null}class ke{constructor(t,i,n,o){this.targetPoint=t,this.constraint=i,this.isDraped=n,this.domain=o}}let Ln=class extends ke{constructor({targetPoint:e,objectId:t,constraint:i,isDraped:n}){super(e,i,n,I.FEATURE),this.objectId=t}},pr=class extends Ln{constructor(e){super({...e,isDraped:!0,constraint:new On(e.edgeStart,e.edgeEnd,e.getGroundElevation)})}get hints(){return[new se(Y.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},lr=class extends Ln{constructor(e){super({...e,constraint:new ii(e.edgeStart,e.edgeEnd)})}get hints(){return[new se(Y.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},tt=class extends ke{constructor(e,t,i,n){super(e,new Le(e),n,I.ALL),this.first=t,this.second=i}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new ds(this.targetPoint,this.isDraped,this.domain)]}},cr=class extends ke{constructor({lineStart:e,lineEnd:t,targetPoint:i,isDraped:n}){super(i,new Sn(e,t),n,I.SELF),this._referenceLineHint=new se(Y.REFERENCE_EXTENSION,e,t,n,this.domain)}get hints(){return[this._referenceLineHint,new se(Y.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}},hr=class extends ke{constructor({referenceLine:e,lineStart:t,targetPoint:i,isDraped:n}){const o=me(t),{left:s,right:a}=e;vt(o,Lo(o,o,a),s),super(i,new Sn(t,o),n,I.SELF),this._referenceLines=[{edge:e,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new se(Y.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new us(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(e=>new se(Y.REFERENCE,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight))]}addReferenceLine(e){const t={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(i=>{O(e.right,i.edge.left)&&(i.fadeLeft=!1,t.fadeRight=!1),O(e.right,i.edge.right)&&(i.fadeRight=!1,t.fadeRight=!1),O(e.left,i.edge.right)&&(i.fadeRight=!1,t.fadeLeft=!1),O(e.left,i.edge.left)&&(i.fadeLeft=!1,t.fadeLeft=!1)}),this._referenceLines.push(t)}},dr=class extends ke{constructor({targetPoint:e,constraint:t,previousVertex:i,otherVertex:n,otherVertexType:o,isDraped:s,selfSnappingType:a,objectId:r,domain:p}){super(e,t,s,p??I.SELF),this.previousVertex=i,this.otherVertex=n,this.otherVertexType=o,this.selfSnappingType=a??gt.None,this.objectId=r??null}get hints(){const e=this.previousVertex,t=this.otherVertexType===yt.CENTER?this.otherVertex:this.targetPoint,i=this.otherVertexType===yt.CENTER?this.targetPoint:this.otherVertex;return[new se(Y.TARGET,t,i,this.isDraped,this.domain),new se(Y.REFERENCE,e,t,this.isDraped,this.domain),new ln(this.previousVertex,t,i,this.isDraped,this.domain)]}};var yt,gt;(function(e){e[e.NEXT=0]="NEXT",e[e.CENTER=1]="CENTER"})(yt||(yt={})),function(e){e[e.None=0]="None",e[e.LastVertex=1]="LastVertex",e[e.FirstVertex=2]="FirstVertex",e[e.ExistingEdge=3]="ExistingEdge"}(gt||(gt={}));class ur extends ke{constructor({targetPoint:t,point1:i,point2:n,isDraped:o}){super(t,new Tn(ko(v(),i,n,.5),.5*wo(i,n)),o,I.SELF),this._p1=i,this._p2=n}get hints(){return[new se(Y.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new se(Y.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new ln(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}function yr(e,t,i,n){return n.type==="2d"?(We.x=e[0],We.y=e[1],We.spatialReference=t,n.toScreen(We)):(ps(e,t,i,n,Li),n.state.camera.projectToScreen(Li,Lt),Xn(Lt[0],Lt[1]))}const We=je(0,0,0,null),Li=v(),Lt=Jn();let W=class extends qt.EventedMixin(re){constructor(e){super(e),this.options=new hi,this._engineCache=new Map,this._loadTask=null,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=he.MAIN}initialize(){this.addHandles([be(()=>{const{distance:e,touchSensitivityMultiplier:t,effectiveSelfEnabled:i,effectiveFeatureEnabled:n,effectiveGridEnabled:o}=this.options;return{selfEnabled:i,featureEnabled:n,gridEnabled:this.view.type==="2d"&&o,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:e,touchSensitivityMultiplier:t}},(e,t)=>{var i;t&&(this.doneSnapping(),this.emit("changed")),(i=this._loadTask)==null||i.abort(),this._loadTask=Qn(n=>this._updateEngines(e,t,n))},Ue),be(()=>this.options,e=>{for(const t of this._engines)t.options=e},eo)])}destroy(){var e;(e=this._loadTask)==null||e.abort(),this._destroyEngines()}get updating(){var e;return this._engines.some(t=>t.updating)||!((e=this._loadTask)!=null&&e.finished)}_destroyEngines(){this._engineCache.forEach(e=>e.destroy()),this._engineCache.clear(),this._engines=[]}async _updateEngines(e,t,i){var s;if(!e.viewReady)return void this._destroyEngines();(t==null?void 0:t.viewSpatialReference)!==e.viewSpatialReference&&this._destroyEngines();const n=this._engineCache,o=await Promise.allSettled([e.featureEnabled&&!n.has("feature")?this._createFeatureSnappingEngine(i):void 0,e.selfEnabled&&!n.has("self")?this._createSelfSnappingEngine(i):void 0,e.gridEnabled&&!n.has("grid")?this._createGridSnappingEngine(i):void 0]);if(i.aborted)for(const a of o)a.status==="fulfilled"&&((s=a.value)==null||s.engine.destroy());else{for(const a of o)a.status==="fulfilled"&&a.value&&n.set(a.value.type,a.value.engine);this._engines=Array.from(n.values())}}async _createSelfSnappingEngine(e){const{SelfSnappingEngine:t}=await N(()=>import("./SelfSnappingEngine-cGmuW4MT-B2xgg0h1.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61]),import.meta.url);return Pt(e),{type:"self",engine:new t({view:this.view,options:this.options})}}async _createGridSnappingEngine(e){const{view:t}=this;if(t.type!=="2d")return;const{GridSnappingEngine:i}=await N(()=>import("./GridSnappingEngine-DCXaqXz2-BVH_N7rN.js"),__vite__mapDeps([62,1,2,34,9,37,63,64,65,66,67,47,31,13,14,15,16,17,18,19,20,21,22,23,24,3,4,5,6,7,8,33,41,42,57,58,59,35,36,43,44,45,46,60,61]),import.meta.url);return Pt(e),{type:"grid",engine:new i({view:t,options:this.options})}}async _createFeatureSnappingEngine(e){const{FeatureSnappingEngine:t}=await N(()=>import("./FeatureSnappingEngine-aDZtmISS-BcRW78MV.js"),__vite__mapDeps([68,1,2,8,9,34,31,69,57,58,59,16,70,28,37,13,14,15,17,18,19,20,21,22,23,24,3,4,5,6,7,33,41,42,47,35,36,43,44,45,46,60,61]),import.meta.url);Pt(e);const{view:i,options:n}=this,{spatialReference:o}=i;return{type:"feature",engine:new t({view:i,options:n,spatialReference:o})}}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,i=e*t;return i*i}snap(e){return vr(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:t,context:i}=e;this._removeVisualization();const n=this._currentMainCandidate;if(n==null)return t;const o=this._selectUpdateInput(e);if(o==null)return t;const{spatialReference:s}=i,a=Dt(o,s);if(a==null)return t;const{view:r}=this,{elevationInfo:p,visualizer:l}=i,d=[],u=He(a,r,p),f=n.constraint.closestTo(u);if(!this._arePointsWithinScreenThreshold(u,f,i)||!It(n,i.drawConstraints))return this._resetSnappingState(),t;n.targetPoint=Mt(f),d.push(...n.hints);for(const y of this._currentOtherActiveCandidates)It(y,i.drawConstraints)&&(y.targetPoint=Mt(f),d.push(...y.hints));return l!=null&&this.addHandles(l.draw(d,{spatialReference:s,elevationInfo:mr(i),view:r,selfSnappingZ:i.selfSnappingZ}),kt),wi(f,r,t,i)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:t}){switch(this._currentSnappedType){case he.MAIN:return e;case he.SCENE:return t}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=he.MAIN}_removeVisualization(){this.removeHandles(kt)}async _snapSinglePoint({point:e,context:t,signal:i}){const{view:n}=this,{elevationInfo:o}=t,s=He(e,n,o),a=await this._fetchCandidates(s,I.ALL,t,i);return this._createSnapResult(s,he.MAIN,a,n,e,t,i)}async _snapMultiPoint({point:e,scenePoint:t,context:i,signal:n}){const{view:o}=this,{coordinateHelper:s,elevationInfo:a,spatialReference:r}=i;await co(t.spatialReference,r);const p=Dt(t,r),l=He(p,o,a),d=await this._fetchCandidates(l,I.FEATURE,i,n);if(d.length>0){const y=await this._fetchCandidates(l,I.SELF,i,n);return this._createSnapResult(l,he.SCENE,[...d,...y],o,p,i,n)}const u=He(e,o,a),f=await this._fetchCandidates(u,I.SELF,i,n);return this._createSnapResult(u,he.MAIN,f,o,{z:s.hasZ()&&e.hasZ?e.z??0:void 0,m:s.hasM()&&e.hasM?e.m??0:void 0},i,n)}async _fetchCandidates(e,t,i,n){return(await Promise.all(this._engines.map(o=>o.fetchCandidates(e,t,i,n)))).flat()}_createSnapResult(e,t,i,n,o,s,a){return{get valid(){return!Dn(a)},apply:()=>{const{spatialReference:r}=s,{snappedPoint:p,hints:l}=this._processCandidates(e,t,i,s);return this._removeVisualization(),s.visualizer!=null&&this.addHandles(s.visualizer.draw(l,{spatialReference:r,elevationInfo:Oe,view:n,selfSnappingZ:s.selfSnappingZ}),kt),wi(p,n,o,s)}}}_processCandidates(e,t,i,n){if(i.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),tr(e,i);const o=this._currentMainCandidate;if(o!=null){const s=fr(o,i);if(s>=0){if(!(i[s]instanceof tt))return this._intersectWithOtherCandidates(s,i,e,t,n);if(this._arePointsWithinScreenThreshold(e,o.targetPoint,n))return this._updateSnappingCandidate(o,t,i,n)}}return this._intersectWithOtherCandidates(0,i,e,t,n)}_intersectWithOtherCandidates(e,t,i,n,o){const{coordinateHelper:s}=o,a=t[e],r=[];for(let p=0;p<t.length;++p){if(p===e)continue;const l=t[p],d=a.constraint.intersect(l.constraint);if(d)for(const u of d.closestPoints(a.targetPoint))r.push([new tt(Mt(u),a,l,l.isDraped),this._squaredScreenDistance(i,u,s)])}return r.length>0&&(r.sort((p,l)=>p[1]-l[1]),r[0][1]<this._squaredPointProximityThreshold(o.pointer))?this._updateSnappingCandidate(r[0][0],n,t,o):It(a,o.drawConstraints)?this._updateSnappingCandidate(a,n,t,o):{snappedPoint:i,hints:[]}}_updateSnappingCandidate(e,t,i,n){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;const o=this._currentMainCandidate.targetPoint,s=[];s.push(...e.hints);for(const a of i){if(e instanceof tt){if(a.constraint.equals(e.first.constraint)||a.constraint.equals(e.second.constraint))continue}else if(a.constraint.equals(e.constraint))continue;const r=a.constraint.closestTo(o);this._squaredScreenDistance(r,o,n.coordinateHelper)<gr()&&(a.targetPoint=o,this._currentOtherActiveCandidates.push(a),s.push(...a.hints))}return{snappedPoint:o,hints:s}}_squaredPointProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(e,t,i){return this._squaredScreenDistance(e,t,i.coordinateHelper)<this._squaredPointProximityThreshold(i.pointer)}_squaredScreenDistance(e,t,i){return Mn(this._toScreen(e,i),this._toScreen(t,i))}_toScreen(e,t){return yr(e,t.spatialReference,Oe,this.view)}get test(){}};var he;c([h({constructOnly:!0})],W.prototype,"view",void 0),c([h()],W.prototype,"options",void 0),c([h({readOnly:!0})],W.prototype,"updating",null),c([h()],W.prototype,"_loadTask",void 0),c([h()],W.prototype,"_engines",void 0),c([h()],W.prototype,"_squaredMouseProximityThreshold",null),c([h()],W.prototype,"_squaredTouchProximityThreshold",null),W=c([C("esri.views.interactive.snapping.SnappingManager")],W),function(e){e[e.MAIN=0]="MAIN",e[e.SCENE=1]="SCENE"}(he||(he={}));const kt="visualization-handle";function gr(){return lt.satisfiesConstraintScreenThreshold*lt.satisfiesConstraintScreenThreshold}function It(e,t){return!t||t.direction==null&&t.distance==null||!(e instanceof pr||e instanceof lr||e instanceof cr||e instanceof hr||e instanceof ur)&&(!(e instanceof dr)||t.direction==null&&e.selfSnappingType===gt.LastVertex)}function fr(e,t){return e instanceof tt?Ct(t,e.first)>=0&&Ct(t,e.second)>=0?0:-1:Ct(t,e)}function Ct(e,t){let i=-1;for(let n=0;n<e.length;++n)if(t.constraint.equals(e[n].constraint)){i=n;break}return i}function vr(e){return e.scenePoint!=null}function mr({coordinateHelper:e,elevationInfo:t}){return e.hasZ()?Oe:t}let Ge=class extends re{constructor(e){super(e),this.labels=new pi,this.tooltips=new li,this.values=new ci}};c([h({nonNullable:!0,type:pi})],Ge.prototype,"labels",void 0),c([h({nonNullable:!0,type:li})],Ge.prototype,"tooltips",void 0),c([h({nonNullable:!0,type:ci})],Ge.prototype,"values",void 0),Ge=c([C("esri.views.interactive.sketch.SketchOptions")],Ge);const kn=Ge;function ki(e,t,i){if(!t||!(e!=null&&e.map))return;const{map:n}=e,o=n.layers.find(s=>s===t);o||n.add(t,i),o&&i!=null&&n.layers.reorder(o,i)}function Ea(e,t){const i=(t==null?void 0:t.type)==="subtype-sublayer"?t.parent:t;return e.allLayerViews.find(n=>{const o=n.layer;return o===i||"sublayers"in o&&o.sublayers!=null&&o.sublayers.includes(i)})}function _r(e,t){return t==="freehandPolygon"||t==="freehandPolyline"?"freehand":e??(t==="rectangle"||t==="circle"?"hybrid":"click")}function Er(e){switch(e){case"freehandPolygon":return"polygon";case"freehandPolyline":return"polyline";default:return e}}var Ii;(function(e){e[e.ForceCollapse=-1]="ForceCollapse",e[e.Low=0]="Low",e[e.Medium=10]="Medium",e[e.High=100]="High",e[e.Max=1e3]="Max"})(Ii||(Ii={}));function Ci(e){switch(e){case E.SUPPORTED:break;case E.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case E.GEOMETRY_MISSING:return"no geometry";case E.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case E.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case E.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var E;(function(e){e[e.SUPPORTED=0]="SUPPORTED",e[e.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",e[e.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",e[e.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",e[e.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",e[e.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(E||(E={}));function br(e){var n,o;if(e.graphic&&((n=e.graphic.layer)==null?void 0:n.type)!=="graphics")return E.GRAPHICS_LAYER_MISSING;const t=(o=e.operations)==null?void 0:o.data.type;if(!t)return E.GEOMETRY_TYPE_UNSUPPORTED;switch(t){case"polygon":case"point":case"polyline":case"mesh":break;default:return E.GEOMETRY_TYPE_UNSUPPORTED}const i=e.elevationInfo;return Et(i)?E.ELEVATION_MODE_UNSUPPORTED:E.SUPPORTED}function wr(e){return Tr(e).result}function Tr(e){var n;if(e.graphic&&((n=e.graphic.layer)==null?void 0:n.type)!=="graphics")return{result:E.GRAPHICS_LAYER_MISSING};if(!e.operations)return{result:E.GEOMETRY_MISSING};if(Et(e.elevationInfo))return{result:E.ELEVATION_MODE_UNSUPPORTED};const t=e.operations.data.type,i=e.operations.data.geometry;return t==="point"||t==="mesh"||t==="polyline"||t==="polygon"?{result:E.SUPPORTED,geometry:i}:{result:E.GEOMETRY_TYPE_UNSUPPORTED}}function Sr(e){var i;if(((i=e.layer)==null?void 0:i.type)!=="graphics")return E.GRAPHICS_LAYER_MISSING;if(e.geometry==null)return E.GEOMETRY_MISSING;switch(e.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return E.SUPPORTED;default:return E.GEOMETRY_TYPE_UNSUPPORTED}const t=e.symbol!=null&&e.symbol.type==="point-3d"&&e.symbol.symbolLayers;return!t||!t.some(n=>n.type==="object")?E.SYMBOL_TYPE_UNSUPPORTED:Ko(e)!=="on-the-ground"&&Jo(e)?E.ELEVATION_MODE_UNSUPPORTED:E.SUPPORTED}let x=class extends qt.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:Nn(this.activeComponent)}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var e;(e=this.activeComponent)==null||e.reset()}refreshComponent(){const e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};c([h()],x.prototype,"activeComponent",void 0),c([h()],x.prototype,"cancelled",void 0),c([h()],x.prototype,"history",void 0),c([h()],x.prototype,"tool",null),c([h()],x.prototype,"type",void 0),c([h()],x.prototype,"canUndo",null),c([h()],x.prototype,"canRedo",null),c([h()],x.prototype,"onEnd",void 0),c([h()],x.prototype,"undo",null),c([h()],x.prototype,"redo",null),c([h()],x.prototype,"toggleTool",void 0),c([h()],x.prototype,"addToSelection",void 0),c([h()],x.prototype,"removeFromSelection",void 0),x=c([C("esri.widgets.Sketch.support.OperationHandle")],x);let it=class extends x{};c([h()],it.prototype,"activeComponent",void 0),it=c([C("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],it);let de=class extends x{};c([h()],de.prototype,"activeComponent",void 0),de=c([C("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],de);const Di={defaultZ:0},Ne={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let _=class extends qt.EventedAccessor{constructor(e){var t;super(e),this._defaultSnappingManager=null,this._updatingHandles=new lo,this._internalGraphicsLayer=new fo({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new di({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new Hn({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new Un({color:[130,130,130,1],width:2}),this.meshSymbol=new Vn({symbolLayers:new we([new Fn])}),this.updateGraphics=new we,this.updateOnGraphicClick=!0,this.creationMode="single",this.vertexSymbol=new di({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new kn,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._sketchContinuationFlag=!1,this._originalPopupEnabled=null,this.defaultCreateOptions=Di,this.defaultUpdateOptions=Ne,this.snappingOptions=((t=e==null?void 0:e.snappingManager)==null?void 0:t.options)??(e==null?void 0:e.snappingOptions)??new hi}initialize(){this.addHandles([ui(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.layers},"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),ui(()=>{var e;return(e=this.layer)==null?void 0:e.graphics},"change",e=>{if(this._operationHandle!=null)for(const t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())}),be(()=>{var e;return((e=this.layer)==null?void 0:e.elevationInfo)??null},e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},Ue),be(()=>this.view,e=>{this._defaultSnappingManager=Be(this._defaultSnappingManager),e&&(this.snappingManager||(this._defaultSnappingManager=new W({view:e,options:this.snappingOptions})),e.type==="2d"?N(()=>import("./editingTools-KBOXuhog-BLoXiaY2.js"),__vite__mapDeps([71,1,2,72,8,9,33,73,74,75,34,7,76,25,77,22,45,53,44,46,35,78,38,39,79,26,27,80,11,12,13,14,15,16,17,18,19,20,21,23,24,3,4,5,6,28,29,30,31,32,36,37,40,41,42,43,47,48,49,50,51,52,54,55,56,57,58,59,60,61,81,82,83,10,84,85,86,87,88,89,90,91,92,93,94]),import.meta.url):e.type==="3d"&&(N(()=>import("./editingTools-CWx0-1A2-eo-2amF1.js"),__vite__mapDeps([95,8,9,33,96,97,1,2,98,36,37,99,45,34,100,101,102,35,85,60,22,61,44,43,46,86,103,104,105,106,24,88,32,107,108,109,5,110,111,53,83,112,113,114,84,115,116,117,118,119,38,39,41,42,40,120,23,121,122,123,124,78,125,126,127,48,93,25,76,7,77,79,26,27,80,11,12,13,14,15,16,17,18,19,20,21,3,4,6,28,29,30,31,47,49,50,51,52,54,55,56,57,58,59,81,82,10,128,129,74,75,87,130,131,132,89,90,91,73,133,134,135,136,137,138,92]),import.meta.url).then(t=>t.e),N(()=>import("./LineCallout.glsl-B1CPwb2z-BHHqsrct.js"),__vite__mapDeps([139,1,2,140,141,42,37,41,116,34,9,36,111,61,44,45,53,46,35,83,112,22,43,33,32,99,100,101,102,8,85,60,86,103,104,105,106,97,96,24,88,107,108,109,5,110,117,118,119,38,39,40,120,23,121,113,30,31,15,16,142,57,58,59,134,143,124,48,144,145,146,147,148,149,150,21,25,151,152,153,154,155,156,157,158,159,160,161,162,163,3,4,6,28,164,165,64,65,166,125,13,14,17,18,19,20,7,47]),import.meta.url).then(t=>t.G)))},Ue),be(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,t)=>{e&&t&&!e.equals(t)&&this.cancel()})]),nr(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=Be(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this._updatingHandles.destroy(),this.emit("destroy")}get updating(){return this._updatingHandles.updating||this.snappingManager!=null&&this.snappingManager.updating}get activeTool(){var e;return((e=this._operationHandle)==null?void 0:e.tool)??null}get activeCreateToolDrawMode(){var e;return((e=this._operationHandle)==null?void 0:e.type)==="create"&&this._operationHandle.activeComponent&&"mode"in this._operationHandle.activeComponent?this._operationHandle.activeComponent.mode:null}get activeTooltip(){const{activeComponent:e,destroyed:t}=this,i=!t&&e&&"tooltip"in e?e.tooltip:null;return i!=null&&i.visible?i:null}get activeComponent(){var e;return((e=this._operationHandle)==null?void 0:e.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...Di,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...Ne,...e,reshapeOptions:{...Ne.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...Ne.highlightOptions,...e==null?void 0:e.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get snappingOptions(){var e;return((e=this.snappingManager)==null?void 0:e.options)??this._get("snappingOptions")}set snappingOptions(e){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=e),this._set("snappingOptions",e)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(e){if(e)this._isOverridden("snappingManager")||(this._defaultSnappingManager=Be(this._defaultSnappingManager)),this._override("snappingManager",e);else{const{view:t}=this;!this._defaultSnappingManager&&t&&(this._defaultSnappingManager=new W({options:this.snappingOptions,view:t})),this._clearOverride("snappingManager")}}get state(){var i;const e=!(!((i=this.view)!=null&&i.ready)||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:n,map:o}=t;n&&(t.cursor=null),o==null||o.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const i="view-ready";this.removeHandles(i),e&&this.addHandles($n(()=>e.ready,n=>{this.removeHandles(this._viewHandlesKey),n&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)},Ue),i),this._set("view",e)}cancel(){this._moduleLoaderAbortController=Rt(this._moduleLoaderAbortController),this._viewReadyAbortController=Rt(this._viewReadyAbortController),this._sketchContinuationFlag=!0,this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:t}=this;if(e==="active"&&t.length){const{activeTool:i,layer:n}=this,o=t.toArray();n.removeMany(o),this.cancel(),this._emitDeleteEvent({graphics:o,tool:i})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const e=this.updateGraphics.map(t=>t.clone()).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,t){this.cancel(),await this._waitViewReady();const{view:i,layer:n}=this;if(!i||this.state==="disabled")throw n||this._logMissingLayer(),yi();if(i.activeTool!=null&&(i.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");ki(i,this._internalGraphicsLayer);const o=await this._updatingHandles.addPromise(this._setupCreateOperation(e,t));if(o==null||this.destroyed)return void i.map.remove(this._internalGraphicsLayer);const s=()=>{var a;if(o===this._operationHandle){const r=this.createGraphic,p=this._operationHandle.cancelled;if(this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),(a=this.view)!=null&&a.map&&this.view.map.remove(this._internalGraphicsLayer),o.cancelled||r==null||n.add(r),this._sketchContinuationFlag=!1,this.emit("create",{graphic:r,state:p?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"}),p||this._sketchContinuationFlag)return;const{creationMode:l}=this;if(l==="continuous"){if(t!=null&&t.geometryToPlace)return;this._updatingHandles.addPromise(vi(this.create(e,t)))}else l==="update"&&r&&this._updatingHandles.addPromise(vi(this.update([r])))}};o.on("complete",s),this._operationHandle=o,i.ready&&i.focus()}async place(e,t){return this.create("mesh",{mode:"click",hasZ:e.hasZ,geometryToPlace:e,...t})}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:i,view:n,state:o}=this;if(!n||o==="disabled")throw i||this._logMissingLayer(),yi();n.activeTool!=null&&(n.activeTool=null);const s=Array.isArray(e)?e:[e];if(e==null||!(s!=null&&s.length))return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(s.some(r=>r.layer!==i?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):r.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const a=await this._updatingHandles.addPromise(this._setupUpdateOperation(s,t));this.destroyed||a==null||M(a)||(ki(n,this._internalGraphicsLayer),this._setUpdateOperationHandle(a,t),this.emit("update",{graphics:s,state:"start",aborted:!1,tool:a.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const t=this.view;if(t){e=Array.isArray(e)?e:[e];for(const i of e)i.geometry==null||i.geometry.type==="mesh"||Ui(i.geometry.spatialReference,t.spatialReference)||(ho(i.geometry.spatialReference,t.spatialReference)||uo()||await yo(),i.geometry=Dt(i.geometry,t.spatialReference))}else this._logMissingView()}undo(){var e;this.canUndo()&&((e=this._operationHandle)==null||e.undo())}redo(){var e;this.canRedo()&&((e=this._operationHandle)==null||e.redo())}canUndo(){var e;return!!((e=this._operationHandle)!=null&&e.canUndo())}canRedo(){var e;return!!((e=this._operationHandle)!=null&&e.canRedo())}toggleUpdateTool(){var e;(e=this._operationHandle)==null||e.toggleTool()}async _getFirstHit(e){const t=this.view;if(!t)return this._logMissingView(),null;if(t.type==="2d"){const o=[];t.map.allLayers.forEach(a=>{a.type!=="vector-tile"&&a.type!=="imagery"||o.push(a)});const s=await t.hitTest(e,{exclude:o});return ar(s.results)}const i=[t.map.ground];t.map.allLayers.forEach(o=>{jn(o.type)&&i.push(o)});const n=await t.hitTest(e,{exclude:i});if(n.results.length>0){const o=n.results[0];if(o!=null&&o.type==="graphic"&&o.graphic&&(!n.ground.mapPoint||t.map.ground.opacity<1||n.ground.distance-(o.distance??0)>-Math.min(3*n.ground.distance,t.viewingMode==="global"?zn(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return o}return null}_generateViewHandles(e){return[e.on("immediate-click",async t=>{var n;const i=this.state==="active"&&((n=this._operationHandle)==null?void 0:n.type)==="create";this.state!=="disabled"&&!i&&this.updateOnGraphicClick&&await this._updatingHandles.addPromise(this._handleImmediateClick(t))},G.WIDGET)]}async _handleImmediateClick(e){var n;const t=await e.async(()=>this._getFirstHit(mi(e)));let i=null;if(t!=null){const o=t.graphic;this.updateGraphics.includes(o)||o.layer===this.layer?(e.stopPropagation(),i=o):((n=this.view)==null?void 0:n.type)!=="2d"||this._isComponentGraphic(o)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();i==null||this.updateGraphics.includes(i)||await this.update([i],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}})}async _setupCreateOperation(e,t){const i=this.view;if(!i)return this._logMissingView(),null;const n={hasZ:i.type==="3d",...this.defaultCreateOptions,...t},o=await this._setupDrawGraphicTool(e,i,n);return o==null?null:(i.tools.add(o),i.activeTool=o,this._setupCreateOperationHandle(o))}async _setupDrawGraphicTool(e,t,i){var m;if(e==="multipoint"&&t.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!t)return this._logMissingView(),null;const{cursor:n,defaultZ:o,hasZ:s,geometryToPlace:a,graphicProperties:r,mode:p,preserveAspectRatio:l}=i,d=_r(p,e),u=Er(e),f=(m=i==null?void 0:i.optionsPerTool)!=null&&m.has(e)?i.optionsPerTool.get(e):{},y=(f==null?void 0:f.preserveAspectRatio)??l??e!=="rectangle",g={centered:e!=="rectangle"&&!(e==="circle"&&!y),cursor:n,defaultZ:o,forceUniformSize:y,graphicProperties:{...r,attributes:{...r==null?void 0:r.attributes}},geometryToPlace:a,geometryType:u,mode:d,graphicSymbol:this._getGraphicSymbolFromTool(e),hasZ:s,snappingManager:this.snappingManager,snapToScene:!1,view:t,...f};return t.type==="2d"?this._makeDrawGraphicTool2D(g):this._makeDrawGraphicTool3D(g)}async _makeDrawGraphicTool2D(e){const t=await this._requireModule(N(()=>import("./editingTools-KBOXuhog-BLoXiaY2.js"),__vite__mapDeps([71,1,2,72,8,9,33,73,74,75,34,7,76,25,77,22,45,53,44,46,35,78,38,39,79,26,27,80,11,12,13,14,15,16,17,18,19,20,21,23,24,3,4,5,6,28,29,30,31,32,36,37,40,41,42,43,47,48,49,50,51,52,54,55,56,57,58,59,60,61,81,82,83,10,84,85,86,87,88,89,90,91,92,93,94]),import.meta.url));return M(t)||this.destroyed?null:new t.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:Pr(e.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(e){const t=await this._requireModule(N(()=>import("./editingTools-CWx0-1A2-eo-2amF1.js"),__vite__mapDeps([95,8,9,33,96,97,1,2,98,36,37,99,45,34,100,101,102,35,85,60,22,61,44,43,46,86,103,104,105,106,24,88,32,107,108,109,5,110,111,53,83,112,113,114,84,115,116,117,118,119,38,39,41,42,40,120,23,121,122,123,124,78,125,126,127,48,93,25,76,7,77,79,26,27,80,11,12,13,14,15,16,17,18,19,20,21,3,4,6,28,29,30,31,47,49,50,51,52,54,55,56,57,58,59,81,82,10,128,129,74,75,87,130,131,132,89,90,91,73,133,134,135,136,137,138,92]),import.meta.url).then(n=>n.e));if(M(t)||this.destroyed)return null;const{elevationInfo:i}=this.layer;return new t.module.DrawGraphicTool3D({...e,elevationInfo:i,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(e){const t=this.view;if(!t)return this._logMissingView(),null;let i=null;const n=e.forceUniformSize,o=e.centered,s=[t.on("key-down",r=>{if(r.key===R.pan)r.stopPropagation(),r.repeat||(e.enabled=!1);else if(r.key===R.complete)r.stopPropagation(),e.completeCreateOperation();else if(r.key!==R.vertexAdd||r.repeat)r.key===R.undo?(r.stopPropagation(),a.undo()):r.key===R.redo?(r.stopPropagation(),a.redo()):r.key!==R.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||r.repeat?r.key===R.center&&(r.repeat||(e.centered=!o,r.stopPropagation())):(e.forceUniformSize=!n,r.stopPropagation());else{const p=e.drawOperation.geometryType;p!=="polyline"&&p!=="polygon"&&p!=="multipoint"||(r.stopPropagation(),e.drawOperation.commitStagedVertex())}},G.WIDGET),t.on("key-up",r=>{r.key===R.pan?e.enabled=!0:r.key!==R.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?r.key===R.center&&(e.centered=o,r.stopPropagation()):(e.forceUniformSize=n,r.stopPropagation())},G.WIDGET),e.on("vertex-add",r=>{switch(i=i==null?"start":"active",r.operation){case"apply":this.emit("create",{graphic:e.graphic,state:i,tool:this.activeTool,toolEventInfo:r,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",r=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:r.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",r=>{switch(r.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:r,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",r=>{this._set("createGraphic",r.graphic),i="complete",r.aborted?a&&a.cancel():a&&a.complete()}),be(()=>this._getGraphicSymbolFromTool(e.geometryType),r=>{e.graphicSymbol=r})],a=new it({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{var r;Q(s),(r=t.tools)==null||r.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return a}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":case"freehandPolyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":case"freehandPolygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(e,t){var a;const{layer:i,view:n}=this;if(!n)return this._logMissingView(),null;const o={...this.defaultUpdateOptions,...t,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...t==null?void 0:t.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...t==null?void 0:t.highlightOptions}};let s=o.tool??Ne.tool;for(const r of e)i.remove(r),i.add(r);if(n.type==="3d"){if(e.length===0)return null;switch(s){case"move":return this._setupMove3DOperation(e,o,n,s);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(e[0],o,n);case"transform":return this._setupGraphicTransform3DOperation(e,o,n)}}switch(s){case"move":return this._setupMove2DOperation(e,o,n);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(e,s,o,n);case"transform":if(e.length===1){const r=(a=e[0].geometry)==null?void 0:a.type;r!=="point"&&r!=="multipoint"||(s="reshape")}return this._setupTransformOrReshape2DOperation(e,s,o,n)}}async _setupMove3DOperation(e,t,i,n,o=!1){const s=await this._requireModule(N(()=>import("./editingTools-CWx0-1A2-eo-2amF1.js"),__vite__mapDeps([95,8,9,33,96,97,1,2,98,36,37,99,45,34,100,101,102,35,85,60,22,61,44,43,46,86,103,104,105,106,24,88,32,107,108,109,5,110,111,53,83,112,113,114,84,115,116,117,118,119,38,39,41,42,40,120,23,121,122,123,124,78,125,126,127,48,93,25,76,7,77,79,26,27,80,11,12,13,14,15,16,17,18,19,20,21,3,4,6,28,29,30,31,47,49,50,51,52,54,55,56,57,58,59,81,82,10,128,129,74,75,87,130,131,132,89,90,91,73,133,134,135,136,137,138,92]),import.meta.url).then(y=>y.e));if(M(s))return s;const{ManipulatedObject3DGraphic:a,MoveTool3D:r}=s.module,p=new Map,l=()=>{p.forEach(y=>y.destroy()),p.clear()};for(const y of e){const g=new a({view:i,graphic:y}),m=br(g);if(m!==E.SUPPORTED)return l(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${Ci(m)}).`),null;p.set(y,g)}const d=new r({view:i,enableZ:t.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(d),d.objects.addMany(Array.from(p.values())),o||this.updateGraphics.addMany(e);const u=[],f=new de({activeComponent:d,tool:n,type:"update",onEnd:()=>{Q(u),Je(i,d),l()},undo:()=>{Hi(this.view,d),Ke(f,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},redo:()=>{Xe(f,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:y=>{this.updateGraphics.push(y);const g=new a({view:i,graphic:y});p.set(y,g),d.objects.push(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[y],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:y=>{const g=this.updateGraphics.indexOf(y);if(f.history.undo.forEach(T=>T.updates.splice(g,1)),f.history.redo.forEach(T=>T.updates.splice(g,1)),this.updateGraphics.remove(y),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[y],type:"selection-change"},type:"update"}),this.updateGraphics.length===0)return void f.complete();const m=p.get(y);m&&(d.objects.remove(m),m.destroy(),p.delete(y))},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1||n!=="transform")return;const y=this.updateGraphics.at(0),g=await this._setupReshape3DOperation(y,t,i,!0);g&&!M(g)&&(f.onEnd(),f.destroy(),this._setUpdateOperationHandle(g,t))}});return u.push(...this._getHandlesForComponent(f,t),i.on("immediate-click",y=>this._getCommonUpdateOperationClickHandlers(f,y,t),G.WIDGET),i.on("key-down",y=>{this._getCommonUpdateOperationKeyDownHandlers(f,y)},G.WIDGET)),f}_setupGraphicTransform3DOperation(e,t,i,n=!1){if(e.length===1&&Sr(e[0])===E.SUPPORTED){const o=e[0],s=o.geometry;if(s!=null&&(s.type==="point"||s.type==="mesh"))return this._setupPointTransform3DOperation(o,t,i);if(s!=null&&(s.type==="polygon"||s.type==="polyline"))return this._setupPolyTransform3DOperation(o,t,i,n)}return this._setupMove3DOperation(e,t,i,"transform",n)}async _setupPointTransform3DOperation(e,t,i){const n="transform",{enableRotation:o,enableScaling:s,enableZ:a}=t,r=await this._requireModule(N(()=>import("./editingTools-CWx0-1A2-eo-2amF1.js"),__vite__mapDeps([95,8,9,33,96,97,1,2,98,36,37,99,45,34,100,101,102,35,85,60,22,61,44,43,46,86,103,104,105,106,24,88,32,107,108,109,5,110,111,53,83,112,113,114,84,115,116,117,118,119,38,39,41,42,40,120,23,121,122,123,124,78,125,126,127,48,93,25,76,7,77,79,26,27,80,11,12,13,14,15,16,17,18,19,20,21,3,4,6,28,29,30,31,47,49,50,51,52,54,55,56,57,58,59,81,82,10,128,129,74,75,87,130,131,132,89,90,91,73,133,134,135,136,137,138,92]),import.meta.url).then(g=>g.e));if(M(r))return r;const{TransformTool3D:p,ManipulatedObject3DGraphic:l}=r.module,d=new l({graphic:e,view:i}),u=new p({object:d,view:i,enableRotation:o,enableScaling:s,enableZ:a,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(u),this.updateGraphics.add(e);const f=[],y=new de({activeComponent:u,tool:n,type:"update",onEnd:()=>{Q(f),Je(i,u),d.destroy()},undo:()=>{Hi(this.view,u),Ke(y,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},redo:()=>{Xe(y,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:async g=>{this.updateGraphics.add(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"}),y.onEnd(),y.destroy();const m=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);M(m)||this._setUpdateOperationHandle(m,t)},removeFromSelection:g=>{this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),y.complete()},toggleTool:()=>{}});return f.push(...this._getHandlesForComponent(y,t),i.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(y,g,t),G.WIDGET),i.on("key-down",g=>{this._getCommonUpdateOperationKeyDownHandlers(y,g)},G.WIDGET)),y}async _setupPolyTransform3DOperation(e,t,i,n=!1){var J,Ie;const o="transform",{enableRotation:s,enableScaling:a,enableZ:r,preserveAspectRatio:p}=t,l=await this._requireModule(N(()=>import("./editingTools-CWx0-1A2-eo-2amF1.js"),__vite__mapDeps([95,8,9,33,96,97,1,2,98,36,37,99,45,34,100,101,102,35,85,60,22,61,44,43,46,86,103,104,105,106,24,88,32,107,108,109,5,110,111,53,83,112,113,114,84,115,116,117,118,119,38,39,41,42,40,120,23,121,122,123,124,78,125,126,127,48,93,25,76,7,77,79,26,27,80,11,12,13,14,15,16,17,18,19,20,21,3,4,6,28,29,30,31,47,49,50,51,52,54,55,56,57,58,59,81,82,10,128,129,74,75,87,130,131,132,89,90,91,73,133,134,135,136,137,138,92]),import.meta.url).then(b=>b.e));if(M(l))return l;const{ManipulatedObject3DGraphic:d,ExtentTransformTool:u}=l.module,f=(Ie=(J=this.view)==null?void 0:J.inputManager)==null?void 0:Ie.isModifierKeyDown(R.constraint),y=new d({view:i,graphic:e}),g=new u({object:y,view:i,enableRotation:s,enableScaling:a,enableZ:r,preserveAspectRatio:!!p!=!!f,sketchOptions:this.sketchOptions});i.tools.add(g),n||this.updateGraphics.add(e);const m=[],T=new de({activeComponent:g,tool:o,type:"update",onEnd:()=>{Q(m),Je(i,g),y.destroy()},canUndo:()=>!g.destroyed&&g.canUndo,undo:()=>{g.destroyed||(g.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},canRedo:()=>!g.destroyed&&g.canRedo,redo:()=>{g.destroyed||(g.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},addToSelection:async b=>{this.updateGraphics.add(b),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[b],removed:[],type:"selection-change"},type:"update"}),T.onEnd(),T.destroy();const Ee=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);M(Ee)||this._setUpdateOperationHandle(Ee,t)},removeFromSelection:b=>{this.updateGraphics.remove(b),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[b],type:"selection-change"},type:"update"}),T.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1)return;const b=await this._setupReshape3DOperation(e,t,i,!0);b&&!M(b)&&(T.onEnd(),T.destroy(),this._setUpdateOperationHandle(b,t))}});return m.push(...this._getHandlesForComponent(T,t),i.on("immediate-click",b=>this._getCommonUpdateOperationClickHandlers(T,b,t),G.WIDGET),i.on("key-down",b=>this._getCommonUpdateOperationKeyDownHandlers(T,b),G.WIDGET),i.on("key-down",b=>{b.key!==R.constraint||b.repeat||(g.preserveAspectRatio=!g.preserveAspectRatio,b.stopPropagation())},G.WIDGET),i.on("key-up",b=>{b.key===R.constraint&&(g.preserveAspectRatio=!g.preserveAspectRatio,b.stopPropagation())},G.WIDGET)),T}async _setupMove2DOperation(e,t,i){const n="move";this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const o=await this._getGraphicMover(e,t,i);if(M(o))return o;const s=new de({activeComponent:o,tool:n,type:"update",onEnd:()=>{var l;this._displayDefaultCursor(),Q(p),Q(r),o.destroy(),(l=this._internalGraphicsLayer)==null||l.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const l=this.updateGraphics.toArray();Ke(s,l),s.refreshComponent(),this._emitUndoEvent({graphics:l,tool:n})},redo:()=>{const l=this.updateGraphics.toArray();Xe(s,l),s.refreshComponent(),this._emitRedoEvent({graphics:l,tool:n})},addToSelection:async l=>{await this._updatingHandles.addPromise(this._updateSpatialReference(l)),this.updateGraphics.push(l),o.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[l],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:l=>{const d=this.updateGraphics.indexOf(l);s.history.undo.forEach(f=>f.updates.splice(d,1)),s.history.redo.forEach(f=>f.updates.splice(d,1)),this.updateGraphics.remove(l);const u=this.updateGraphics.toArray();this.emit("update",{graphics:u,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[l],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?o.graphics=u:s.complete()}});let a=!1;const r=[i.on("immediate-click",l=>this._getCommonUpdateOperationClickHandlers(s,l,t),G.WIDGET),i.on("key-down",l=>{this._getCommonUpdateOperationKeyDownHandlers(s,l),l.key!==R.constraint||l.repeat||(a=!0,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},G.WIDGET),i.on("key-up",l=>{l.key===R.constraint&&a&&(a=!1,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},G.WIDGET)],p=this._getHandlesForComponent(s,t);return s}async _setupReshape3DOperation(e,t,i,n=!1){const o="reshape",s=await this._requireModule(N(()=>import("./editingTools-CWx0-1A2-eo-2amF1.js"),__vite__mapDeps([95,8,9,33,96,97,1,2,98,36,37,99,45,34,100,101,102,35,85,60,22,61,44,43,46,86,103,104,105,106,24,88,32,107,108,109,5,110,111,53,83,112,113,114,84,115,116,117,118,119,38,39,41,42,40,120,23,121,122,123,124,78,125,126,127,48,93,25,76,7,77,79,26,27,80,11,12,13,14,15,16,17,18,19,20,21,3,4,6,28,29,30,31,47,49,50,51,52,54,55,56,57,58,59,81,82,10,128,129,74,75,87,130,131,132,89,90,91,73,133,134,135,136,137,138,92]),import.meta.url).then(g=>g.e));if(M(s))return s;const{ManipulatedObject3DGraphic:a,ReshapeTool3D:r}=s.module,p=new a({view:i,graphic:e}),l=wr(p);if(l!==E.SUPPORTED)return p.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${Ci(l)}).`),null;const d=t.reshapeOptions,u=new r({view:i,object:p,enableZVertex:t.enableZ&&(d==null?void 0:d.vertexOperation)==="move",enableZShape:t.enableZ&&(d==null?void 0:d.shapeOperation)==="move",enableMoveObject:(d==null?void 0:d.shapeOperation)==="move"||(d==null?void 0:d.shapeOperation)==="move-xy",enableMidpoints:(d==null?void 0:d.edgeOperation)==="split",enableEdgeOffset:(d==null?void 0:d.edgeOperation)==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(u),n||this.updateGraphics.add(p.graphic);const f=[],y=new de({activeComponent:u,tool:o,type:"update",onEnd:()=>{Q(f),Je(i,u),p.destroy()},canUndo:()=>!u.destroyed&&u.canUndo,undo:()=>{u.destroyed||(u.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},canRedo:()=>!u.destroyed&&u.canRedo,redo:()=>{u.destroyed||(u.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},addToSelection:async g=>{this.updateGraphics.add(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"}),y.onEnd(),y.destroy();const m=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);M(m)||this._setUpdateOperationHandle(m,t)},removeFromSelection:g=>{this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),y.complete()},toggleTool:async()=>{if(t.toggleToolOnClick===!1)return;y.onEnd(),y.destroy();const g=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,i,!0);M(g)||this._setUpdateOperationHandle(g,t)}});return f.push(...this._getHandlesForComponent(y,t),i.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(y,g,t),G.WIDGET),i.on("key-down",g=>{this._getCommonUpdateOperationKeyDownHandlers(y,g)},G.WIDGET)),y}async _setupTransformOrReshape2DOperation(e,t,i,n){this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const o=t==="transform"?await this._getBox(e,i,n):await this._getReshape(e,i,n);if(M(o))return o;const s=new de({activeComponent:o,type:"update",onEnd:()=>{Q(r),Q(a),s.activeComponent&&!s.activeComponent.destroyed&&s.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{Ke(s,this.updateGraphics.toArray()),s.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s.tool})},redo:()=>{Xe(s,this.updateGraphics.toArray()),s.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s.tool})},addToSelection:async p=>{let l=s.activeComponent;if((l==null?void 0:l.type)==="reshape"){const d=[...this.updateGraphics,p];this.updateGraphics.removeAll(),s.onEnd(),s.destroy();const u=await this._setupTransformOrReshape2DOperation(d,"transform",i,n);if(M(u))return;this._setUpdateOperationHandle(u,i)}else this.updateGraphics.add(p),l.graphics=this.updateGraphics.toArray(),l.refresh(),s.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[p],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async p=>{const l=this.updateGraphics.indexOf(p);s.history.undo.forEach(u=>u.updates.splice(l,1)),s.history.redo.forEach(u=>u.updates.splice(l,1)),this.updateGraphics.remove(p);const d=this.updateGraphics.toArray();if(d.length===0)s.complete();else{const u=d[0].geometry;d.length!==1||u==null||u.type!=="point"&&u.type!=="multipoint"?s.activeComponent.graphics=d:s.toggleTool()}this.emit("update",{graphics:d,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[p],type:"selection-change"},type:"update"})},toggleTool:async()=>{var u;if(this.updateGraphics.length>1)return;const p=this.updateGraphics.at(0),l=p.geometry;if(l!=null&&(s.tool==="reshape"&&(l.type==="point"||l.type==="multipoint")||s.tool==="transform"&&l.type==="extent"))return;let d=null;s.tool==="transform"?d=await this._getReshape([p],i,n):s.tool==="reshape"&&(d=await this._getBox([p],i,n)),M(d)||((u=s.activeComponent)==null||u.destroy(),s.activeComponent=d,s.activeComponent&&(Q(r),r=this._getHandlesForComponent(s,i)))}}),a=[n.on("immediate-click",p=>this._getCommonUpdateOperationClickHandlers(s,p,i),G.WIDGET),n.on("key-down",p=>{if(this._getCommonUpdateOperationKeyDownHandlers(s,p),p.key===R.constraint&&!p.repeat&&s){const l=s.activeComponent;l&&l.type==="box"&&(l.preserveAspectRatio=!l.preserveAspectRatio)}},G.WIDGET),n.on("key-up",p=>{if(p.key===R.constraint&&s){const l=s.activeComponent;l&&l.type==="box"&&(l.preserveAspectRatio=!l.preserveAspectRatio)}},G.WIDGET)];let r=this._getHandlesForComponent(s,i);return s}async _getGraphicMover(e,t,i){const{enableMoveAllGraphics:n,highlightOptions:o}=t,s=await this._requireModule(N(()=>import("./GraphicMover-CiNX1V2i-PBqRfaCj.js"),__vite__mapDeps([167,1,2,13,14,15,16,17,18,19,20,21,22,9,23,24,94,125,28,168,25,169,170,3,4,5,6,92,8,34,37,42,54,31,7,33,41,47,57,58,59,35,36,43,44,45,46,60,61]),import.meta.url).then(a=>a.G));return M(s)?s:new s.module.default({enableMoveAllGraphics:n,highlightsEnabled:!!(o!=null&&o.enabled),indicatorsEnabled:!1,graphics:e,view:i,callbacks:{onGraphicMoveStart:({dx:a,dy:r,graphic:p})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:r,mover:p,type:"move-start"},type:"update"})},onGraphicMove:({dx:a,dy:r,graphic:p})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:r,mover:p,type:"move"},type:"update"}),onGraphicMoveStop:({dx:a,dy:r,graphic:p})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:r,mover:p,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,t,i){var l,d;const{enableRotation:n,enableScaling:o,highlightOptions:s,preserveAspectRatio:a}=t,r=await this._requireModule(N(()=>import("./Box-CcaqKOvu-CnIdYwkh.js"),__vite__mapDeps([171,1,2,7,94,167,13,14,15,16,17,18,19,20,21,22,9,23,24,125,28,168,25,169,170,3,4,5,6,92,8,34,37,42,54,31,33,41,47,57,58,59,35,36,43,44,45,46,60,61,172,76,77,53,78,38,39,79,26,27,80,11,12,29,30,32,40,48,49,50,51,52,55,56,81,82,83,10,138,131]),import.meta.url));if(M(r))return r;const p=(d=(l=this.view)==null?void 0:l.inputManager)==null?void 0:d.isModifierKeyDown(R.constraint);return new r.module.default({graphics:e,enableRotation:n,enableScaling:o,highlightsEnabled:!!(s!=null&&s.enabled),preserveAspectRatio:!!a!=!!p,layer:this._internalGraphicsLayer,view:i,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:u=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...u},type:"update"}),onMove:u=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...u},type:"update"}),onMoveStop:u=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...u},type:"update"}),onScaleStart:u=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...u},type:"update"}),onScale:u=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...u},type:"update"}),onScaleStop:u=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...u},type:"update"}),onRotateStart:u=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...u},type:"update"}),onRotate:u=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...u},type:"update"}),onRotateStop:u=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...u},type:"update"})}})}async _getReshape(e,t,i){var r,p,l;const n=((r=t.reshapeOptions)==null?void 0:r.edgeOperation)==="split",o=((p=t.reshapeOptions)==null?void 0:p.shapeOperation)==="move",s=!!((l=t.highlightOptions)!=null&&l.enabled),a=await this._requireModule(N(()=>import("./Reshape-BUYuf7aU-B14kvgSI.js"),__vite__mapDeps([173,1,2,13,14,15,16,17,18,19,20,21,22,9,23,24,32,72,8,33,73,74,75,34,7,76,25,77,45,53,44,46,35,78,38,39,79,26,27,80,11,12,3,4,5,6,28,29,30,31,36,37,40,41,42,43,47,48,49,50,51,52,54,55,56,57,58,59,60,61,81,82,83,10,84,85,86,94,167,125,168,169,170,92,130,131,172]),import.meta.url));return M(a)?a:new a.module.default({enableMidpoints:n,enableMovement:o,graphic:e[0],highlightsEnabled:s,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:i,callbacks:{onReshapeStart:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onReshape:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onReshapeStop:({mover:d,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d,type:u},type:"update"}),onMoveStart:({dx:d,dy:u,mover:f,type:y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:u,mover:f,type:y},type:"update"}),onMove:({dx:d,dy:u,mover:f,type:y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:u,mover:f,type:y},type:"update"}),onMoveStop:({dx:d,dy:u,mover:f,type:y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:u,mover:f,type:y},type:"update"}),onVertexAdd:({added:d,type:u,vertices:f})=>{const y=d.map(g=>gi(g.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:y,vertices:f,type:u},type:"update"})},onVertexRemove:({removed:d,type:u,vertices:f})=>{const y=d.map(g=>gi(g.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:y,vertices:f,type:u},type:"update"})}}})}_getHandlesForComponent(e,t){const i=e.activeComponent;if(!i)return[];switch(i.type){case"graphic-mover":return[i.on("graphic-click",({graphic:n,viewEvent:o})=>{var s;(s=o.native)!=null&&s.shiftKey&&(o.stopPropagation(),e.removeFromSelection(n))}),i.on("graphic-move-start",n=>e.addToHistory(ue(n.allGraphics)))];case"box":return[i.on("graphic-click",n=>this._onTransformOrReshape2DGraphicClick(e,t,n)),i.on("move-start",n=>e.addToHistory(ue(n.graphics))),i.on("rotate-start",n=>e.addToHistory(ue(n.graphics))),i.on("scale-start",n=>e.addToHistory(ue(n.graphics)))];case"reshape":return[i.on("graphic-click",n=>this._onTransformOrReshape2DGraphicClick(e,t,n)),i.on("move-start",n=>e.addToHistory(ue([n.mover]))),i.on("reshape-start",n=>e.addToHistory(ue([n.graphic]))),i.on("vertex-add",n=>e.addToHistory(ue([n.oldGraphic]))),i.on("vertex-remove",n=>e.addToHistory(ue([n.oldGraphic])))];case"move-3d":return[i.events.on("record-undo",({updates:n})=>{e.addToHistory({updates:n})}),i.events.on("move-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move-start"},type:"update"})}),i.events.on("move",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:n.dx,dy:n.dy,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move"},type:"update"})}),i.events.on("move-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move-stop"},type:"update"})}),i.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,t):e.toggleTool()})];case"transform-3d":return[i.events.on("record-undo",({updates:n})=>{e.addToHistory({updates:n})}),i.events.on("translate-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move-start"},type:"update"})}),i.events.on("translate-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move-stop"},type:"update"})}),i.events.on("rotate-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate-start"},type:"update"})}),i.events.on("rotate-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate-stop"},type:"update"})}),i.events.on("scale-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale-start"},type:"update"})}),i.events.on("scale-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale-stop"},type:"update"})}),i.events.on("translate",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move"},type:"update"})}),i.events.on("rotate",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate"},type:"update"})}),i.events.on("scale",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale"},type:"update"})}),i.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,t):e.toggleTool()})];case"reshape-3d":return[i.events.on("reshape",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...n,mover:n.object.graphic},type:"update"})}),i.events.on("move",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...n,mover:n.object.graphic},type:"update"})}),i.events.on("vertex-add",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),i.events.on("vertex-remove",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),i.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,t):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,t,i){var s;const{graphic:n,viewEvent:o}=i;return(s=o.native)!=null&&s.shiftKey&&n.layer===this.layer?(o.stopPropagation(),e.removeFromSelection(n)):t.toggleToolOnClick?(o.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){var o;this._operationHandle=e;const i=(o=this.view)==null?void 0:o.map;this._disablePopup(t);const n=()=>{if(e===this._operationHandle){const s=this.updateGraphics.toArray(),a=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),i&&i.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:s,state:"complete",aborted:e.cancelled,tool:a,toolEventInfo:null,type:"update"})}};e.on("complete",n)}async _getCommonUpdateOperationClickHandlers(e,t,i){const n=mi(t),o=await t.async(()=>this._getFirstHit(n));if(o==null)return void e.complete();if(t.native.shiftKey&&this._toggleSelection([o.graphic],e,i))return void t.stopPropagation();this.updateGraphics.includes(o.graphic)?t.stopPropagation():e.complete()}_toggleSelection(e,t,i){const n=!!i.multipleSelectionEnabled;return e.some(o=>o!=null&&!(!n||o.layer!==this.layer)&&(this.updateGraphics.includes(o)?t.removeFromSelection(o):t.addToSelection(o),!0))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const i=t.key;i===R.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):i===R.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):i===R.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&R.delete.includes(i)&&this._onDeleteKey(t)}_onDeleteKey(e){var n;if(!this._operationHandle||this._operationHandle.type!=="update")return;const t=this.activeComponent,i=this.updateGraphics.toArray();t!=null&&(t.type!=="reshape"||i.length===1&&((n=i[0].geometry)==null?void 0:n.type)==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){var e,t;this._internalGraphicsLayer&&((t=(e=this.view)==null?void 0:e.map)==null||t.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=Be(this._internalGraphicsLayer))}_isComponentGraphic(e){var i;const{activeComponent:t}=this;return!(!e||t==null)&&(((i=e.attributes)==null?void 0:i.esriSketchTool)||t.type==="draw-2d"&&t.graphic===e||(t.type==="box"||t.type==="reshape")&&t.isUIGraphic(e))}_displayPointerCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,t,i){Vi.getLogger(this).error(new qn(e,t,i))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const i=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:i}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){}wait(){return fi(()=>!this.updating)}_disablePopupEnabled(e){var t;return((t=this.view)==null?void 0:t.type)!=="3d"||this.updateOnGraphicClick||((e==null?void 0:e.toggleToolOnClick)??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?(Rt(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await Yn(fi(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",Ni("view"))}_logMissingLayer(){this._logError(Or,Ni("layer"))}};c([h()],_.prototype,"_defaultSnappingManager",void 0),c([h()],_.prototype,"updating",null),c([h({readOnly:!0})],_.prototype,"_updatingHandles",void 0),c([h()],_.prototype,"_operationHandle",void 0),c([h({readOnly:!0})],_.prototype,"activeTool",null),c([h({readOnly:!0})],_.prototype,"activeCreateToolDrawMode",null),c([h()],_.prototype,"activeTooltip",null),c([h({types:Ce})],_.prototype,"activeFillSymbol",void 0),c([h()],_.prototype,"activeLineSymbol",void 0),c([h()],_.prototype,"activeVertexSymbol",void 0),c([h()],_.prototype,"allowDeleteKey",void 0),c([h({readOnly:!0})],_.prototype,"createGraphic",null),c([h()],_.prototype,"defaultCreateOptions",null),c([h()],_.prototype,"defaultUpdateOptions",null),c([h({type:pi,nonNullable:!0})],_.prototype,"labelOptions",null),c([h()],_.prototype,"layer",void 0),c([h({types:Ce})],_.prototype,"pointSymbol",void 0),c([h({types:Ce})],_.prototype,"polygonSymbol",void 0),c([h({types:Ce})],_.prototype,"polylineSymbol",void 0),c([h()],_.prototype,"meshSymbol",void 0),c([h({type:hi,nonNullable:!0})],_.prototype,"snappingOptions",null),c([h()],_.prototype,"snappingManager",null),c([h({readOnly:!0})],_.prototype,"state",null),c([h({type:li,nonNullable:!0})],_.prototype,"tooltipOptions",null),c([h({readOnly:!0})],_.prototype,"updateGraphics",void 0),c([h()],_.prototype,"updateOnGraphicClick",void 0),c([h()],_.prototype,"creationMode",void 0),c([h({type:ci,nonNullable:!0})],_.prototype,"valueOptions",null),c([h({types:Ce})],_.prototype,"vertexSymbol",void 0),c([h({value:null})],_.prototype,"view",null),c([h({constructOnly:!0,type:kn})],_.prototype,"sketchOptions",void 0),_=c([C("esri.widgets.Sketch.SketchViewModel")],_);const Or="sketch:missing-property",Ni=e=>`Property '${e}' is missing on SketchViewModel.`;function Pr(e){return e==="polygon"||e==="rectangle"||e==="circle"}function Ke(e,t){In("undo",e.history.undo,e.history.redo,t)}function Xe(e,t){In("redo",e.history.redo,e.history.undo,t)}function In(e,t,i,n){const o=t.pop();if(!o)return;const s=o.updates,a=[];n.forEach((r,p)=>{const l=s[p];l!=null&&("geometry"in l&&l.geometry!=null&&(a.push({geometry:r.geometry}),r.geometry=l.geometry),"symbol"in l&&l.symbol!=null&&(a.push({symbol:r.symbol}),r.symbol=l.symbol),"undo"in l&&(a.push(l),l[e](r)))}),i.push({updates:a})}function Hi(e,t){e!=null&&t.hasGrabbedManipulators&&(e.activeTool=null)}function ue(e){return{updates:e.map(({geometry:t})=>(t==null?void 0:t.type)==="mesh"?{geometry:t.cloneShallow()}:{geometry:t})}}function Je(e,t){var i;(i=e.tools)==null||i.remove(t),t.destroyed||t.destroy()}function M(e){return"requireError"in e&&e.requireError==="aborted"}const ba=_;export{Ko as $,ya as A,Ea as B,se as C,U as D,us as E,nr as F,ln as G,lt as H,ia as I,Xs as J,Wo as K,ga as L,R as M,bt as N,P as O,He as P,I as Q,ua as R,Br as S,kn as T,na as U,sa as V,wi as W,Xo as X,tr as Y,yr as Z,ai as _,j as a,ma as a0,bi as a1,Mt as a2,ra as a3,Mn as a4,cr as a5,Ks as a6,gn as a7,ea as a8,_e as a9,Qo as aA,Yr as aB,ki as aC,Qr as aD,Kr as aE,Jr as aF,Xr as aG,Wr as aH,va as aI,hr as aa,gt as ab,dr as ac,yt as ad,ta as ae,ur as af,sn as ag,tt as ah,Ln as ai,lr as aj,pr as ak,fa as al,_a as am,Bo as an,br as ao,E as ap,Wt as aq,Zr as ar,la as as,os as at,pa as au,ca as av,Y as aw,ps as ax,Ji as ay,en as az,B as b,hi as c,ci as d,es as e,Rs as f,Kt as g,Ii as h,Ts as i,dt as j,Ws as k,Gs as l,Le as m,oa as n,da as o,ts as p,ar as q,ha as r,Tn as s,ba as t,Oe as u,xn as v,pi as w,ds as x,Gi as y,aa as z};
