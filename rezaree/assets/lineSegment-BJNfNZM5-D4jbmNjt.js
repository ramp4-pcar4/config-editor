import{f_ as w,df as d,d4 as B}from"./index-uAe2c5m-.js";import{X as E}from"./sphere-Cj20syUS-Di3MiqPq.js";import{r as l,y as A,N as T,P as M,v as F,_,p as S}from"./vec32-BuqRmYBM-BdfZIctT.js";import{f as g}from"./plane-B_adY3_o-D-rv9d7_.js";function y(t){return t?{origin:w(t.origin),vector:w(t.vector)}:{origin:d(),vector:d()}}function I(t,r){const n=Q.get();return n.origin=t,n.vector=r,n}function j(t,r=y()){return N(t.origin,t.vector,r)}function N(t,r,n=y()){return _(n.origin,t),_(n.vector,r),n}function k(t,r,n=y()){return _(n.origin,t),l(n.vector,r,t),n}function z(t,r){const n=l(g.get(),r,t.origin),u=A(t.vector,n),i=A(t.vector,t.vector),s=B(u/i,0,1),c=l(g.get(),T(g.get(),t.vector,s),n);return A(c,c)}function G(t,r,n){return O(t,r,0,1,n)}function H(t,r,n){return M(n,t.origin,T(n,t.vector,r))}function O(t,r,n,u,i){const{vector:s,origin:c}=t,p=l(g.get(),r,c),f=A(s,p)/F(s);return T(i,s,B(f,n,u)),M(i,i,t.origin)}function J(t,r){if(C(t,I(r.origin,r.direction),!1,x)){const{tA:n,pB:u,distance2:i}=x;if(n>=0&&n<=1)return i;if(n<0)return S(t.origin,u);if(n>1)return S(M(g.get(),t.origin,t.vector),u)}return null}function K(t,r,n){return!!C(t,r,!0,x)&&(_(n,x.pA),!0)}function C(t,r,n,u){const i=t.origin,s=M(g.get(),i,t.vector),c=r.origin,p=M(g.get(),c,r.vector),f=g.get(),o=g.get();if(f[0]=i[0]-c[0],f[1]=i[1]-c[1],f[2]=i[2]-c[2],o[0]=p[0]-c[0],o[1]=p[1]-c[1],o[2]=p[2]-c[2],Math.abs(o[0])<1e-6&&Math.abs(o[1])<1e-6&&Math.abs(o[2])<1e-6)return!1;const e=g.get();if(e[0]=s[0]-i[0],e[1]=s[1]-i[1],e[2]=s[2]-i[2],Math.abs(e[0])<1e-6&&Math.abs(e[1])<1e-6&&Math.abs(e[2])<1e-6)return!1;const U=f[0]*o[0]+f[1]*o[1]+f[2]*o[2],h=o[0]*e[0]+o[1]*e[1]+o[2]*e[2],D=f[0]*e[0]+f[1]*e[1]+f[2]*e[2],P=o[0]*o[0]+o[1]*o[1]+o[2]*o[2],q=(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])*P-h*h;if(Math.abs(q)<1e-6)return!1;let a=(U*h-D*P)/q,v=(U+h*a)/P;n&&(a=B(a,0,1),v=B(v,0,1));const m=g.get(),b=g.get();return m[0]=i[0]+a*e[0],m[1]=i[1]+a*e[1],m[2]=i[2]+a*e[2],b[0]=c[0]+v*o[0],b[1]=c[1]+v*o[1],b[2]=c[2]+v*o[2],u.tA=a,u.tB=v,u.pA=m,u.pB=b,u.distance2=S(m,b),!0}const x={tA:0,tB:0,pA:d(),pB:d(),distance2:0},Q=new E(()=>y());export{N as C,O as D,y as M,j as O,k as Q,z as R,G as S,H as T,J as U,K as V};
