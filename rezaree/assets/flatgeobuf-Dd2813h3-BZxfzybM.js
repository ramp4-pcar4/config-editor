var Xt=Object.defineProperty;var Zt=(r,t,e)=>t in r?Xt(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var w=(r,t,e)=>Zt(r,typeof t!="symbol"?t+"":t,e);const B=new Int32Array(2),Ot=new Float32Array(B.buffer),St=new Float64Array(B.buffer),$=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var dt;(function(r){r[r.UTF8_BYTES=1]="UTF8_BYTES",r[r.UTF16_STRING=2]="UTF16_STRING"})(dt||(dt={}));class V{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new V(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return B[0]=this.readInt32(t),Ot[0]}readFloat64(t){return B[$?0:1]=this.readInt32(t),B[$?1:0]=this.readInt32(t+4),St[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){Ot[0]=e,this.writeInt32(t,B[0])}writeFloat64(t,e){St[0]=e,this.writeInt32(t,B[$?0:1]),this.writeInt32(t+4,B[$?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);t+=4;const s=this.bytes_.subarray(t,t+n);return e===dt.UTF8_BYTES?s:this.text_decoder_.decode(s)}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=4)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createScalarList(t,e){const n=[];for(let s=0;s<e;++s){const i=t(s);i!==null&&n.push(i)}return n}createObjList(t,e){const n=[];for(let s=0;s<e;++s){const i=t(s);i!==null&&n.push(i.unpack())}return n}}class at{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let e;t?e=t:e=1024,this.bb=V.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const n=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<n+t+e;){const s=this.bb.capacity();this.bb=at.growByteBuffer(this.bb),this.space+=this.bb.capacity()-s}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){(this.force_defaults||e!==n)&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,s=V.allocate(n);return s.setPosition(n-e),s.bytes().set(t.bytes(),n-e),s}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);const n=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);const s=2;this.addInt16(t-this.object_start);const i=(n+s)*2;this.addInt16(i);let o=0;const u=this.space;t:for(e=0;e<this.vtables.length;e++){const l=this.bb.capacity()-this.vtables[e];if(i==this.bb.readInt16(l)){for(let a=2;a<i;a+=2)if(this.bb.readInt16(u+a)!=this.bb.readInt16(l+a))continue t;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const s=n?4:0;if(e){const i=e;if(this.prep(this.minalign,8+s),i.length!=4)throw new TypeError("FlatBuffers: file identifier must be length 4");for(let o=3;o>=0;o--)this.writeInt8(i.charCodeAt(o))}this.prep(this.minalign,4+s),this.addOffset(t),s&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,s=n-this.bb.readInt32(n);if(!(e<this.bb.readInt16(s)&&this.bb.readInt16(s+e)!=0))throw new TypeError("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(t==null)return 0;let e;return t instanceof Uint8Array?e=t:e=this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length),this.bb.bytes().set(e,this.space),this.endVector()}createByteVector(t){return t==null?0:(this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length),this.bb.bytes().set(t,this.space),this.endVector())}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n];if(s!==null)e.push(this.createObjectOffset(s));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}}const wt=new Uint8Array(0);function Jt(){return this._source.cancel()}function $t(r,t){if(!r.length)return t;if(!t.length)return r;var e=new Uint8Array(r.length+t.length);return e.set(r),e.set(t,r.length),e}function Yt(){var r=this,t=r._array.subarray(r._index);return r._source.read().then(function(e){return r._array=wt,r._index=0,e.done?t.length>0?{done:!1,value:t}:{done:!0,value:void 0}:{done:!1,value:$t(t,e.value)}})}function Kt(r){if((r|=0)<0)throw new Error("invalid length");var t=this,e=this._array.length-this._index;if(this._index+r<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=r));var n=new Uint8Array(r);return n.set(this._array.subarray(this._index)),function s(){return t._source.read().then(function(i){return i.done?(t._array=wt,t._index=0,e>0?n.subarray(0,e):null):e+i.value.length>=r?(t._array=i.value,t._index=r-e,n.set(i.value.subarray(0,r-e),e),n):(n.set(i.value,e),e+=i.value.length,s())})}()}function Qt(r){return typeof r.slice=="function"?r:new Q(typeof r.read=="function"?r:r.getReader())}function Q(r){this._source=r,this._array=wt,this._index=0}Q.prototype.read=Yt,Q.prototype.slice=Kt,Q.prototype.cancel=Jt;var g,y;(g=y||(y={}))[g.Byte=0]="Byte",g[g.UByte=1]="UByte",g[g.Bool=2]="Bool",g[g.Short=3]="Short",g[g.UShort=4]="UShort",g[g.Int=5]="Int",g[g.UInt=6]="UInt",g[g.Long=7]="Long",g[g.ULong=8]="ULong",g[g.Float=9]="Float",g[g.Double=10]="Double",g[g.String=11]="String",g[g.Json=12]="Json",g[g.DateTime=13]="DateTime",g[g.Binary=14]="Binary";class I{constructor(){w(this,"bb",null);w(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsColumn(t,e){return(e||new I).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsColumn(t,e){return t.setPosition(t.position()+4),(e||new I).__init(t.readInt32(t.position())+t.position(),t)}name(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}type(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):y.Byte}title(t){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}width(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt32(this.bb_pos+t):-1}precision(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt32(this.bb_pos+t):-1}scale(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt32(this.bb_pos+t):-1}nullable(){let t=this.bb.__offset(this.bb_pos,18);return!t||!!this.bb.readInt8(this.bb_pos+t)}unique(){let t=this.bb.__offset(this.bb_pos,20);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}primaryKey(){let t=this.bb.__offset(this.bb_pos,22);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}metadata(t){let e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__string(this.bb_pos+e,t):null}static startColumn(t){t.startObject(11)}static addName(t,e){t.addFieldOffset(0,e,0)}static addType(t,e){t.addFieldInt8(1,e,y.Byte)}static addTitle(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWidth(t,e){t.addFieldInt32(4,e,-1)}static addPrecision(t,e){t.addFieldInt32(5,e,-1)}static addScale(t,e){t.addFieldInt32(6,e,-1)}static addNullable(t,e){t.addFieldInt8(7,+e,1)}static addUnique(t,e){t.addFieldInt8(8,+e,0)}static addPrimaryKey(t,e){t.addFieldInt8(9,+e,0)}static addMetadata(t,e){t.addFieldOffset(10,e,0)}static endColumn(t){let e=t.endObject();return t.requiredField(e,4),e}static createColumn(t,e,n,s,i,o,u,l,a,h,b,c){return I.startColumn(t),I.addName(t,e),I.addType(t,n),I.addTitle(t,s),I.addDescription(t,i),I.addWidth(t,o),I.addPrecision(t,u),I.addScale(t,l),I.addNullable(t,a),I.addUnique(t,h),I.addPrimaryKey(t,b),I.addMetadata(t,c),I.endColumn(t)}}class U{constructor(){w(this,"bb",null);w(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCrs(t,e){return(e||new U).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCrs(t,e){return t.setPosition(t.position()+4),(e||new U).__init(t.readInt32(t.position())+t.position(),t)}org(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}code(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}name(t){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}wkt(t){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__string(this.bb_pos+e,t):null}codeString(t){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__string(this.bb_pos+e,t):null}static startCrs(t){t.startObject(6)}static addOrg(t,e){t.addFieldOffset(0,e,0)}static addCode(t,e){t.addFieldInt32(1,e,0)}static addName(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWkt(t,e){t.addFieldOffset(4,e,0)}static addCodeString(t,e){t.addFieldOffset(5,e,0)}static endCrs(t){return t.endObject()}static createCrs(t,e,n,s,i,o,u){return U.startCrs(t),U.addOrg(t,e),U.addCode(t,n),U.addName(t,s),U.addDescription(t,i),U.addWkt(t,o),U.addCodeString(t,u),U.endCrs(t)}}var _,x;(_=x||(x={}))[_.Unknown=0]="Unknown",_[_.Point=1]="Point",_[_.LineString=2]="LineString",_[_.Polygon=3]="Polygon",_[_.MultiPoint=4]="MultiPoint",_[_.MultiLineString=5]="MultiLineString",_[_.MultiPolygon=6]="MultiPolygon",_[_.GeometryCollection=7]="GeometryCollection",_[_.CircularString=8]="CircularString",_[_.CompoundCurve=9]="CompoundCurve",_[_.CurvePolygon=10]="CurvePolygon",_[_.MultiCurve=11]="MultiCurve",_[_.MultiSurface=12]="MultiSurface",_[_.Curve=13]="Curve",_[_.Surface=14]="Surface",_[_.PolyhedralSurface=15]="PolyhedralSurface",_[_.TIN=16]="TIN",_[_.Triangle=17]="Triangle";class S{constructor(){w(this,"bb",null);w(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsHeader(t,e){return(e||new S).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsHeader(t,e){return t.setPosition(t.position()+4),(e||new S).__init(t.readInt32(t.position())+t.position(),t)}name(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}envelope(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}envelopeLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}envelopeArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}geometryType(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):x.Unknown}hasZ(){let t=this.bb.__offset(this.bb_pos,10);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasM(){let t=this.bb.__offset(this.bb_pos,12);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasT(){let t=this.bb.__offset(this.bb_pos,14);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasTm(){let t=this.bb.__offset(this.bb_pos,16);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}columns(t,e){let n=this.bb.__offset(this.bb_pos,18);return n?(e||new I).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}columnsLength(){let t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}featuresCount(){let t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readUint64(this.bb_pos+t):BigInt("0")}indexNodeSize(){let t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readUint16(this.bb_pos+t):16}crs(t){let e=this.bb.__offset(this.bb_pos,24);return e?(t||new U).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}title(t){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){let e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__string(this.bb_pos+e,t):null}metadata(t){let e=this.bb.__offset(this.bb_pos,30);return e?this.bb.__string(this.bb_pos+e,t):null}static startHeader(t){t.startObject(14)}static addName(t,e){t.addFieldOffset(0,e,0)}static addEnvelope(t,e){t.addFieldOffset(1,e,0)}static createEnvelopeVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startEnvelopeVector(t,e){t.startVector(8,e,8)}static addGeometryType(t,e){t.addFieldInt8(2,e,x.Unknown)}static addHasZ(t,e){t.addFieldInt8(3,+e,0)}static addHasM(t,e){t.addFieldInt8(4,+e,0)}static addHasT(t,e){t.addFieldInt8(5,+e,0)}static addHasTm(t,e){t.addFieldInt8(6,+e,0)}static addColumns(t,e){t.addFieldOffset(7,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static addFeaturesCount(t,e){t.addFieldInt64(8,e,BigInt("0"))}static addIndexNodeSize(t,e){t.addFieldInt16(9,e,16)}static addCrs(t,e){t.addFieldOffset(10,e,0)}static addTitle(t,e){t.addFieldOffset(11,e,0)}static addDescription(t,e){t.addFieldOffset(12,e,0)}static addMetadata(t,e){t.addFieldOffset(13,e,0)}static endHeader(t){return t.endObject()}static finishHeaderBuffer(t,e){t.finish(e)}static finishSizePrefixedHeaderBuffer(t,e){t.finish(e,void 0,!0)}}class m{constructor(){w(this,"bb",null);w(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsGeometry(t,e){return(e||new m).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsGeometry(t,e){return t.setPosition(t.position()+4),(e||new m).__init(t.readInt32(t.position())+t.position(),t)}ends(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+4*t):0}endsLength(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}endsArray(){let t=this.bb.__offset(this.bb_pos,4);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}xy(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}xyLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}xyArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}z(t){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}zLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}zArray(){let t=this.bb.__offset(this.bb_pos,8);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}m(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}mLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}mArray(){let t=this.bb.__offset(this.bb_pos,10);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}t(t){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}tLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}tArray(){let t=this.bb.__offset(this.bb_pos,12);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}tm(t){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint64(this.bb.__vector(this.bb_pos+e)+8*t):BigInt(0)}tmLength(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}type(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readUint8(this.bb_pos+t):x.Unknown}parts(t,e){let n=this.bb.__offset(this.bb_pos,18);return n?(e||new m).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}partsLength(){let t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static startGeometry(t){t.startObject(8)}static addEnds(t,e){t.addFieldOffset(0,e,0)}static createEndsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startEndsVector(t,e){t.startVector(4,e,4)}static addXy(t,e){t.addFieldOffset(1,e,0)}static createXyVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startXyVector(t,e){t.startVector(8,e,8)}static addZ(t,e){t.addFieldOffset(2,e,0)}static createZVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startZVector(t,e){t.startVector(8,e,8)}static addM(t,e){t.addFieldOffset(3,e,0)}static createMVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startMVector(t,e){t.startVector(8,e,8)}static addT(t,e){t.addFieldOffset(4,e,0)}static createTVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startTVector(t,e){t.startVector(8,e,8)}static addTm(t,e){t.addFieldOffset(5,e,0)}static createTmVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startTmVector(t,e){t.startVector(8,e,8)}static addType(t,e){t.addFieldInt8(6,e,x.Unknown)}static addParts(t,e){t.addFieldOffset(7,e,0)}static createPartsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startPartsVector(t,e){t.startVector(4,e,4)}static endGeometry(t){return t.endObject()}static createGeometry(t,e,n,s,i,o,u,l,a){return m.startGeometry(t),m.addEnds(t,e),m.addXy(t,n),m.addZ(t,s),m.addM(t,i),m.addT(t,o),m.addTm(t,u),m.addType(t,l),m.addParts(t,a),m.endGeometry(t)}}class P{constructor(){w(this,"bb",null);w(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFeature(t,e){return(e||new P).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFeature(t,e){return t.setPosition(t.position()+4),(e||new P).__init(t.readInt32(t.position())+t.position(),t)}geometry(t){let e=this.bb.__offset(this.bb_pos,4);return e?(t||new m).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}properties(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}propertiesLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}propertiesArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}columns(t,e){let n=this.bb.__offset(this.bb_pos,8);return n?(e||new I).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}columnsLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFeature(t){t.startObject(3)}static addGeometry(t,e){t.addFieldOffset(0,e,0)}static addProperties(t,e){t.addFieldOffset(1,e,0)}static createPropertiesVector(t,e){t.startVector(1,e.length,1);for(let n=e.length-1;n>=0;n--)t.addInt8(e[n]);return t.endVector()}static startPropertiesVector(t,e){t.startVector(1,e,1)}static addColumns(t,e){t.addFieldOffset(2,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static endFeature(t){return t.endObject()}static finishFeatureBuffer(t,e){t.finish(e)}static finishSizePrefixedFeatureBuffer(t,e){t.finish(e,void 0,!0)}static createFeature(t,e,n,s){return P.startFeature(t),P.addGeometry(t,e),P.addProperties(t,n),P.addColumns(t,s),P.endFeature(t)}}function mt(r){let t=S.getRootAsHeader(r),e=t.featuresCount(),n=t.indexNodeSize(),s=[];for(let u=0;u<t.columnsLength();u++){let l=t.columns(u);if(!l)throw Error("Column unexpectedly missing");if(!l.name())throw Error("Column name unexpectedly missing");s.push({name:l.name(),type:l.type(),title:l.title(),description:l.description(),width:l.width(),precision:l.precision(),scale:l.scale(),nullable:l.nullable(),unique:l.unique(),primary_key:l.primaryKey()})}let i=t.crs(),o=i?{org:i.org(),code:i.code(),name:i.name(),description:i.description(),wkt:i.wkt(),code_string:i.codeString()}:null;return{geometryType:t.geometryType(),columns:s,envelope:null,featuresCount:Number(e),indexNodeSize:n,crs:o,title:t.title(),description:t.description(),metadata:t.metadata()}}function Gt(r,t){let e,n,{xy:s,z:i,ends:o,parts:u,type:l}=t;if(u){let h=u.map(c=>Gt(r,c)),b=m.createPartsVector(r,h);return m.startGeometry(r),m.addParts(r,b),m.addType(r,l),m.endGeometry(r)}let a=m.createXyVector(r,s);return i&&(e=m.createZVector(r,i)),o&&(n=m.createEndsVector(r,o)),m.startGeometry(r),n&&m.addEnds(r,n),m.addXy(r,a),e&&m.addZ(r,e),m.addType(r,l),m.endGeometry(r)}function ft(r,t,e){if(r.length!==0)if(Array.isArray(r[0]))for(let n of r)ft(n,t,e);else r.length===2?t.push(...r):(t.push(r[0],r[1]),e.push(r[2]))}function ht(r,t){let e=[];for(let n=0;n<r.length;n+=2){let s=[r[n],r[n+1]];t&&s.push(t[n>>1]),e.push(s)}return e}function tt(r){return r?x[r]:x.Unknown}let Ct=new TextEncoder,Et=new TextDecoder;function te(r,t,e){let n=e.columns,s=new at,i=0,o=1024,u=new Uint8Array(1024),l=new DataView(u.buffer),a=function(d){if(i+d<o)return;let f=new Uint8Array(o=Math.max(o+d,2*o));f.set(u),l=new DataView((u=f).buffer)};if(n)for(let d=0;d<n.length;d++){let f=n[d],p=t[f.name];if(p!==null)switch(a(2),l.setUint16(i,d,!0),i+=2,f.type){case y.Bool:a(1),l.setUint8(i,p),i+=1;break;case y.Short:a(2),l.setInt16(i,p,!0),i+=2;break;case y.UShort:a(2),l.setUint16(i,p,!0),i+=2;break;case y.Int:a(4),l.setInt32(i,p,!0),i+=4;break;case y.UInt:a(4),l.setUint32(i,p,!0),i+=4;break;case y.Long:a(8),l.setBigInt64(i,BigInt(p),!0),i+=8;break;case y.Float:a(4),l.setFloat32(i,p,!0),i+=4;break;case y.Double:a(8),l.setFloat64(i,p,!0),i+=8;break;case y.DateTime:case y.String:{let v=Ct.encode(p);a(4),l.setUint32(i,v.length,!0),i+=4,a(v.length),u.set(v,i),i+=v.length;break}case y.Json:{let v=Ct.encode(JSON.stringify(p));a(4),l.setUint32(i,v.length,!0),i+=4,a(v.length),u.set(v,i),i+=v.length;break}default:throw Error("Unknown type "+f.type)}}let h=0;i>0&&(h=P.createPropertiesVector(s,u.slice(0,i)));let b=Gt(s,r);P.startFeature(s),P.addGeometry(s,b),h&&P.addProperties(s,h);let c=P.endFeature(s);return s.finishSizePrefixed(c),s.asUint8Array()}function ee(r,t){let e={};if(!t||t.length===0)return e;let n=r.propertiesArray();if(!n)return e;let s=new DataView(n.buffer,n.byteOffset),i=r.propertiesLength(),o=0;for(;o<i;){let u=s.getUint16(o,!0);o+=2;let l=t[u],a=l.name;switch(l.type){case y.Bool:e[a]=!!s.getUint8(o),o+=1;break;case y.Byte:e[a]=s.getInt8(o),o+=1;break;case y.UByte:e[a]=s.getUint8(o),o+=1;break;case y.Short:e[a]=s.getInt16(o,!0),o+=2;break;case y.UShort:e[a]=s.getUint16(o,!0),o+=2;break;case y.Int:e[a]=s.getInt32(o,!0),o+=4;break;case y.UInt:e[a]=s.getUint32(o,!0),o+=4;break;case y.Long:e[a]=Number(s.getBigInt64(o,!0)),o+=8;break;case y.ULong:e[a]=Number(s.getBigUint64(o,!0)),o+=8;break;case y.Float:e[a]=s.getFloat32(o,!0),o+=4;break;case y.Double:e[a]=s.getFloat64(o,!0),o+=8;break;case y.DateTime:case y.String:{let h=s.getUint32(o,!0);o+=4,e[a]=Et.decode(n.subarray(o,o+h)),o+=h;break}case y.Json:{let h=s.getUint32(o,!0);o+=4;let b=Et.decode(n.subarray(o,o+h));e[a]=JSON.parse(b),o+=h;break}default:throw Error("Unknown type "+l.type)}}return e}var pt=function(r,t){return pt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var s in n)n.hasOwnProperty(s)&&(e[s]=n[s])},pt(r,t)};function re(r,t){pt(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function z(r,t,e,n){function s(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function u(h){try{a(n.next(h))}catch(b){o(b)}}function l(h){try{a(n.throw(h))}catch(b){o(b)}}function a(h){h.done?i(h.value):s(h.value).then(u,l)}a((n=n.apply(r,[])).next())})}function A(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(h){return l([a,h])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,s=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(h){a=[6,h],s=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}function D(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function X(r){return this instanceof X?(this.v=r,this):new X(r)}function ne(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(r,t||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(c){n[c]&&(s[c]=function(d){return new Promise(function(f,p){i.push([c,d,f,p])>1||u(c,d)})})}function u(c,d){try{l(n[c](d))}catch(f){b(i[0][3],f)}}function l(c){c.value instanceof X?Promise.resolve(c.value.v).then(a,h):b(i[0][2],c)}function a(c){u("next",c)}function h(c){u("throw",c)}function b(c,d){c(d),i.shift(),i.length&&u(i[0][0],i[0][1])}}var Lt=function(r){re(t,r);function t(e){var n=r.call(this,e)||this;return Object.defineProperty(n,"name",{value:"RepeaterOverflowError",enumerable:!1}),typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(n,n.constructor.prototype):n.__proto__=n.constructor.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(n,n.constructor),n}return t}(Error);(function(){function r(t){if(t<0)throw new RangeError("Capacity may not be less than 0");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return this._q.length>=this._c},enumerable:!1,configurable:!0}),r.prototype.add=function(t){if(this.full)throw new Error("Buffer full");this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r})(),function(){function r(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.add=function(t){for(;this._q.length>=this._c;)this._q.shift();this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r}(),function(){function r(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}return Object.defineProperty(r.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.add=function(t){this._q.length<this._c&&this._q.push(t)},r.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},r}();function _t(r){r!=null&&typeof r.then=="function"&&r.then(nt,nt)}var ct=0,Vt=1,M=2,et=3,yt=4,rt=1024,nt=function(){};function q(r){var t=r.err,e=Promise.resolve(r.execution).then(function(n){if(t!=null)throw t;return n});return r.err=void 0,r.execution=e.then(function(){},function(){}),r.pending===void 0?e:r.pending.then(function(){return e})}function k(r,t){var e=r.state>=et;return Promise.resolve(t).then(function(n){return!e&&r.state>=yt?q(r).then(function(s){return{value:s,done:!0}}):{value:n,done:e}})}function vt(r,t){var e,n;if(!(r.state>=M))if(r.state=M,r.onnext(),r.onstop(),r.err==null&&(r.err=t),r.pushes.length===0&&(typeof r.buffer>"u"||r.buffer.empty))H(r);else try{for(var s=D(r.pushes),i=s.next();!i.done;i=s.next()){var o=i.value;o.resolve()}}catch(u){e={error:u}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}}function H(r){var t,e;if(!(r.state>=et)){r.state<M&&vt(r),r.state=et,r.buffer=void 0;try{for(var n=D(r.nexts),s=n.next();!s.done;s=n.next()){var i=s.value,o=r.pending===void 0?q(r):r.pending.then(function(){return q(r)});i.resolve(k(r,o))}}catch(u){t={error:u}}finally{try{s&&!s.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}r.pushes=[],r.nexts=[]}}function Tt(r){r.state>=yt||(r.state<et&&H(r),r.state=yt)}function ie(r,t){if(_t(t),r.pushes.length>=rt)throw new Lt("No more than "+rt+" pending calls to push are allowed on a single repeater.");if(r.state>=M)return Promise.resolve(void 0);var e=r.pending===void 0?Promise.resolve(t):r.pending.then(function(){return t});e=e.catch(function(l){r.state<M&&(r.err=l),Tt(r)});var n;if(r.nexts.length){var s=r.nexts.shift();s.resolve(k(r,e)),r.nexts.length?n=Promise.resolve(r.nexts[0].value):typeof r.buffer<"u"&&!r.buffer.full?n=Promise.resolve(void 0):n=new Promise(function(l){return r.onnext=l})}else typeof r.buffer<"u"&&!r.buffer.full?(r.buffer.add(e),n=Promise.resolve(void 0)):n=new Promise(function(l){return r.pushes.push({resolve:l,value:e})});var i=!0,o={},u=n.catch(function(l){if(i)throw l});return o.then=function(l,a){return i=!1,Promise.prototype.then.call(n,l,a)},o.catch=function(l){return i=!1,Promise.prototype.catch.call(n,l)},o.finally=n.finally.bind(n),r.pending=e.then(function(){return u}).catch(function(l){r.err=l,Tt(r)}),o}function se(r){var t=vt.bind(null,r),e=new Promise(function(n){return r.onstop=n});return t.then=e.then.bind(e),t.catch=e.catch.bind(e),t.finally=e.finally.bind(e),t}function oe(r){if(!(r.state>=Vt)){r.state=Vt;var t=ie.bind(null,r),e=se(r);r.execution=new Promise(function(n){return n(r.executor(t,e))}),r.execution.catch(function(){return vt(r)})}}var Y=new WeakMap,Z=function(){function r(t,e){Y.set(this,{executor:t,buffer:e,err:void 0,state:ct,pushes:[],nexts:[],pending:void 0,execution:void 0,onnext:nt,onstop:nt})}return r.prototype.next=function(t){_t(t);var e=Y.get(this);if(e===void 0)throw new Error("WeakMap error");if(e.nexts.length>=rt)throw new Lt("No more than "+rt+" pending calls to next are allowed on a single repeater.");if(e.state<=ct&&oe(e),e.onnext(t),typeof e.buffer<"u"&&!e.buffer.empty){var n=k(e,e.buffer.remove());if(e.pushes.length){var s=e.pushes.shift();e.buffer.add(s.value),e.onnext=s.resolve}return n}else if(e.pushes.length){var i=e.pushes.shift();return e.onnext=i.resolve,k(e,i.value)}else if(e.state>=M)return H(e),k(e,q(e));return new Promise(function(o){return e.nexts.push({resolve:o,value:t})})},r.prototype.return=function(t){_t(t);var e=Y.get(this);if(e===void 0)throw new Error("WeakMap error");return H(e),e.execution=Promise.resolve(e.execution).then(function(){return t}),k(e,q(e))},r.prototype.throw=function(t){var e=Y.get(this);if(e===void 0)throw new Error("WeakMap error");return e.state<=ct||e.state>=M||typeof e.buffer<"u"&&!e.buffer.empty?(H(e),e.err==null&&(e.err=t),k(e,q(e))):this.next(Promise.reject(t))},r.prototype[Symbol.asyncIterator]=function(){return this},r.race=ae,r.merge=le,r.zip=ue,r.latest=he,r}();function lt(r,t){var e,n,s=[],i=function(a){a!=null&&typeof a[Symbol.asyncIterator]=="function"?s.push(a[Symbol.asyncIterator]()):a!=null&&typeof a[Symbol.iterator]=="function"?s.push(a[Symbol.iterator]()):s.push(function(){return ne(this,arguments,function(){return A(this,function(h){switch(h.label){case 0:return t.yieldValues?[4,X(a)]:[3,3];case 1:return[4,h.sent()];case 2:h.sent(),h.label=3;case 3:return t.returnValues?[4,X(a)]:[3,5];case 4:return[2,h.sent()];case 5:return[2]}})})}())};try{for(var o=D(r),u=o.next();!u.done;u=o.next()){var l=u.value;i(l)}}catch(a){e={error:a}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return s}function ae(r){var t=this,e=lt(r,{returnValues:!0});return new Z(function(n,s){return z(t,void 0,void 0,function(){var i,o,u,l,a,h;return A(this,function(b){switch(b.label){case 0:if(!e.length)return s(),[2];o=!1,s.then(function(){i(),o=!0}),b.label=1;case 1:b.trys.push([1,,5,7]),l=void 0,a=0,h=function(){var c,d,f,p,v,C;return A(this,function(O){switch(O.label){case 0:c=a;try{for(d=(v=void 0,D(e)),f=d.next();!f.done;f=d.next())p=f.value,Promise.resolve(p.next()).then(function(F){F.done?(s(),u===void 0&&(u=F)):a===c&&(a++,i(F))},function(F){return s(F)})}catch(F){v={error:F}}finally{try{f&&!f.done&&(C=d.return)&&C.call(d)}finally{if(v)throw v.error}}return[4,new Promise(function(F){return i=F})];case 1:return l=O.sent(),l===void 0?[3,3]:[4,n(l.value)];case 2:O.sent(),O.label=3;case 3:return[2]}})},b.label=2;case 2:return o?[3,4]:[5,h()];case 3:return b.sent(),[3,2];case 4:return[2,u&&u.value];case 5:return s(),[4,Promise.race(e.map(function(c){return c.return&&c.return()}))];case 6:return b.sent(),[7];case 7:return[2]}})})})}function le(r){var t=this,e=lt(r,{yieldValues:!0});return new Z(function(n,s){return z(t,void 0,void 0,function(){var i,o,u,l=this;return A(this,function(a){switch(a.label){case 0:if(!e.length)return s(),[2];i=[],o=!1,s.then(function(){var h,b;o=!0;try{for(var c=D(i),d=c.next();!d.done;d=c.next()){var f=d.value;f()}}catch(p){h={error:p}}finally{try{d&&!d.done&&(b=c.return)&&b.call(c)}finally{if(h)throw h.error}}}),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,Promise.all(e.map(function(h,b){return z(l,void 0,void 0,function(){var c,d;return A(this,function(f){switch(f.label){case 0:f.trys.push([0,,6,9]),f.label=1;case 1:return o?[3,5]:(Promise.resolve(h.next()).then(function(p){return i[b](p)},function(p){return s(p)}),[4,new Promise(function(p){i[b]=p})]);case 2:return c=f.sent(),c===void 0?[3,4]:c.done?(u=c,[2]):[4,n(c.value)];case 3:f.sent(),f.label=4;case 4:return[3,1];case 5:return[3,9];case 6:return d=h.return,d?[4,h.return()]:[3,8];case 7:d=f.sent(),f.label=8;case 8:return[7];case 9:return[2]}})})}))];case 2:return a.sent(),[2,u&&u.value];case 3:return s(),[7];case 4:return[2]}})})})}function ue(r){var t=this,e=lt(r,{returnValues:!0});return new Z(function(n,s){return z(t,void 0,void 0,function(){var i,o,u,l;return A(this,function(a){switch(a.label){case 0:if(!e.length)return s(),[2,[]];o=!1,s.then(function(){i(),o=!0}),a.label=1;case 1:a.trys.push([1,,6,8]),a.label=2;case 2:return o?[3,5]:(Promise.all(e.map(function(h){return h.next()})).then(function(h){return i(h)},function(h){return s(h)}),[4,new Promise(function(h){return i=h})]);case 3:return u=a.sent(),u===void 0?[2]:(l=u.map(function(h){return h.value}),u.some(function(h){return h.done})?[2,l]:[4,n(l)]);case 4:return a.sent(),[3,2];case 5:return[3,8];case 6:return s(),[4,Promise.all(e.map(function(h){return h.return&&h.return()}))];case 7:return a.sent(),[7];case 8:return[2]}})})})}function he(r){var t=this,e=lt(r,{yieldValues:!0,returnValues:!0});return new Z(function(n,s){return z(t,void 0,void 0,function(){var i,o,u,l,a,h=this;return A(this,function(b){switch(b.label){case 0:if(!e.length)return s(),[2,[]];o=[],u=!1,s.then(function(){var c,d;i();try{for(var f=D(o),p=f.next();!p.done;p=f.next()){var v=p.value;v()}}catch(C){c={error:C}}finally{try{p&&!p.done&&(d=f.return)&&d.call(f)}finally{if(c)throw c.error}}u=!0}),b.label=1;case 1:return b.trys.push([1,,5,7]),Promise.all(e.map(function(c){return c.next()})).then(function(c){return i(c)},function(c){return s(c)}),[4,new Promise(function(c){return i=c})];case 2:return l=b.sent(),l===void 0?[2]:(a=l.map(function(c){return c.value}),l.every(function(c){return c.done})?[2,a]:[4,n(a.slice())]);case 3:return b.sent(),[4,Promise.all(e.map(function(c,d){return z(h,void 0,void 0,function(){var f;return A(this,function(p){switch(p.label){case 0:if(l[d].done)return[2,l[d].value];p.label=1;case 1:return u?[3,4]:(Promise.resolve(c.next()).then(function(v){return o[d](v)},function(v){return s(v)}),[4,new Promise(function(v){return o[d]=v})]);case 2:return f=p.sent(),f===void 0?[2,l[d].value]:f.done?[2,f.value]:(a[d]=f.value,[4,n(a.slice())]);case 3:return p.sent(),[3,1];case 4:return[2]}})})}))];case 4:return[2,b.sent()];case 5:return s(),[4,Promise.all(e.map(function(c){return c.return&&c.return()}))];case 6:return b.sent(),[7];case 7:return[2]}})})})}const ot=class ot{constructor(){w(this,"_extraRequestThreshold",262144)}extraRequestThreshold(){return this._extraRequestThreshold}setExtraRequestThreshold(t){if(t<0)throw Error("extraRequestThreshold cannot be negative");this._extraRequestThreshold=t}};w(ot,"global",new ot);let it=ot;const ce=40,be=16;function It(r,t){t=Math.min(Math.max(+t,2),65535);let e=r,n=e;do n+=e=Math.ceil(e/t);while(e!==1);return 40*n}function de(r,t){if(t<2)throw Error("Node size must be at least 2");if(r===0)throw Error("Number of items must be greater than 0");let e=r,n=e,s=[e];do n+=e=Math.ceil(e/t),s.push(e);while(e!==1);let i=[];for(let u of(e=n,s))i.push(e-u),e-=u;let o=[];for(let u=0;u<s.length;u++)o.push([i[u],i[u]+s[u]]);return o}async function*fe(r,t,e,n){class s{constructor(d,f){w(this,"_level");w(this,"nodes");this._level=f,this.nodes=d}level(){return this._level}startNodeIdx(){return this.nodes[0]}endNodeIdx(){return this.nodes[1]}extendEndNodeIdx(d){this.nodes[1]=d}toString(){return`[NodeRange level: ${this._level}, nodes: ${this.nodes[0]}-${this.nodes[1]}]`}}let{minX:i,minY:o,maxX:u,maxY:l}=e,a=de(r,t),h=a[0][0],b=[new s([0,1],a.length-1)];for(;b.length!=0;){let c=b.shift(),d=c.startNodeIdx(),f=d>=h,p=(()=>{let[,O]=a[c.level()],F=Math.min(c.endNodeIdx()+t,O);return f&&F<O?F+1:F})(),v=p-d,C=new DataView(await n(40*d,40*v));for(let O=d;O<p;O++){let F=O-d,W=40*F;if(u<C.getFloat64(W+0,!0)||l<C.getFloat64(W+8,!0)||i>C.getFloat64(W+16,!0)||o>C.getFloat64(W+24,!0))continue;let R=C.getBigUint64(W+32,!0);if(f){let ut=(()=>{if(!(O<r-1))return null;{let Ht=(F+1)*40;return C.getBigUint64(Ht+32,!0)-R}})(),Wt=O-h;yield[Number(R),Wt,Number(ut)];continue}let Dt=it.global.extraRequestThreshold()/40,G=b[b.length-1];if(G!==void 0&&G.level()==c.level()-1&&R<G.endNodeIdx()+Dt){G.extendEndNodeIdx(Number(R));continue}let Ut=(()=>{let ut=c.level()-1;return new s([Number(R),Number(R)+1],ut)})();G!==void 0&&(G.level(),Ut.level()),b.push(Ut)}}}const E=new Uint8Array([102,103,98,3,102,103,98,0]),T=4;class xt{constructor(t,e,n,s,i){w(this,"headerClient");w(this,"header");w(this,"headerLength");w(this,"indexLength");w(this,"nocache");this.headerClient=t,this.header=e,this.headerLength=n,this.indexLength=s,this.nocache=i}static async open(t,e){let n,s=new Bt(t,e),i=2024+(()=>{let a,h=0;for(a=0;a<3;a++)h+=be**a*ce;return h})();if(!new Uint8Array(await s.getRange(0,8,i,"header")).subarray(0,3).every((a,h)=>E[h]===a))throw Error("Not a FlatGeobuf file");if((n=new DataView(await s.getRange(8,4,i,"header")).getUint32(0,!0))>10485760||n<8)throw Error("Invalid header size");let o=await s.getRange(12,n,i,"header"),u=mt(new V(new Uint8Array(o))),l=It(u.featuresCount,u.indexNodeSize);return new xt(s,u,n,l,e)}async*selectBbox(t){let e=this.lengthBeforeTree(),n=this.headerClient,s=async function(l,a){return n.getRange(e+l,a,0,"index")},i=[],o=[];for await(let l of fe(this.header.featuresCount,this.header.indexNodeSize,t,s)){let[a,h]=l,[,,b]=l;if(b||(b=4),o.length==0){o.push([a,b,h]);continue}let c=o[o.length-1];a-(c[0]+c[1])>it.global.extraRequestThreshold()&&(i.push(o),o=[]),o.push([a,b,h])}this.headerClient.logUsage("header+index"),o.length>0&&i.push(o);let u=i.flatMap(l=>this.readFeatureBatch(l,this.nocache));yield*Z.merge(u)}lengthBeforeTree(){return E.length+T+this.headerLength}lengthBeforeFeatures(){return this.lengthBeforeTree()+this.indexLength}buildFeatureClient(t){return new Bt(this.headerClient.httpClient,t)}async*readFeatureBatch(t,e){let[n]=t[0],[s,i]=t[t.length-1],o=this.buildFeatureClient(e),u=s+i-n;for(let[l,,a]of t){let h=await this.readFeature(o,l,u);yield{id:a,feature:h},u=0}o.logUsage("feature")}async readFeature(t,e,n){let s,i=e+this.lengthBeforeFeatures();s=new DataView(await t.getRange(i,4,n,"feature length")).getUint32(0,!0);let o=new Uint8Array(await t.getRange(i+4,s,n,"feature data")),u=new Uint8Array(s+T);u.set(o,T);let l=new V(u);return l.setPosition(T),P.getRootAsFeature(l)}}class Bt{constructor(t,e){w(this,"httpClient");w(this,"bytesEverUsed",0);w(this,"bytesEverFetched",0);w(this,"buffer",new ArrayBuffer(0));w(this,"head",0);if(typeof t=="string")this.httpClient=new At(t,e);else if(t instanceof At)this.httpClient=t;else throw Error("Unknown source ")}async getRange(t,e,n,s){this.bytesEverUsed+=e;let i=t-this.head,o=i+e;if(i>=0&&o<=this.buffer.byteLength)return this.buffer.slice(i,o);let u=Math.max(e,n);return this.bytesEverFetched+=u,this.buffer=await this.httpClient.getRange(t,u,s),this.head=t,this.buffer.slice(0,e)}logUsage(t){t.split(" ")[0],(100*this.bytesEverUsed/this.bytesEverFetched).toFixed(2)}}class At{constructor(t,e){w(this,"url");w(this,"nocache");w(this,"requestsEverMade",0);w(this,"bytesEverRequested",0);this.url=t,this.nocache=e}async getRange(t,e,n){this.requestsEverMade+=1,this.bytesEverRequested+=e;let s={Range:`bytes=${t}-${t+e-1}`};return this.nocache&&(s["Cache-Control"]="no-cache, no-store"),(await fetch(this.url,{headers:s})).arrayBuffer()}}function pe(r){let t;for(let e of r){if(t===x.Unknown)break;let n=e.getGeometry?tt(e.getGeometry().getType()):tt(e.geometry.type);t===void 0?t=n:t!==n&&(t=x.Unknown)}if(t===void 0)throw Error("Could not infer geometry type for collection of features.");return t}function _e(r,t,e){if(!r.subarray(0,3).every((h,b)=>E[b]===h))throw Error("Not a FlatGeobuf file");let n=new V(r),s=n.readUint32(E.length);n.setPosition(E.length+T);let i=mt(n);e&&e(i);let o=E.length+T+s,{indexNodeSize:u,featuresCount:l}=i;u>0&&(o+=It(l,u));let a=[];for(;o<n.capacity();){let h=n.readUint32(o);n.setPosition(o+T);let b=P.getRootAsFeature(n);a.push(t(a.length,b,i)),o+=T+h}return a}async function*ye(r,t,e){let n,s=Qt(r),i=async d=>await s.slice(d),o=new Uint8Array(await i(8));if(!o.subarray(0,3).every((d,f)=>E[f]===d))throw Error("Not a FlatGeobuf file");o=new Uint8Array(await i(4));let u=new V(o),l=u.readUint32(0);o=new Uint8Array(await i(l));let a=mt(u=new V(o));e&&e(a);let{indexNodeSize:h,featuresCount:b}=a;if(h>0){let d=It(b,h);await i(d)}let c=0;for(;n=await we(i,a,t,c++);)yield n}async function*ge(r,t,e,n,s=!1){let i=await xt.open(r,s);for await(let o of(n&&n(i.header),i.selectBbox(t)))yield e(o.id,o.feature,i.header)}async function we(r,t,e,n){let s=new Uint8Array(await r(4,"feature length"));if(s.byteLength===0)return;let i=new V(s),o=i.readUint32(0);s=new Uint8Array(await r(o,"feature data"));let u=new Uint8Array(o+4);return u.set(s,4),(i=new V(u)).setPosition(T),e(n,P.getRootAsFeature(i),t)}function me(r,t=0){let e,n=new at,s=0;r.columns&&(s=S.createColumnsVector(n,r.columns.map(u=>function(l,a){let h=l.createString(a.name);return I.startColumn(l),I.addName(l,h),I.addType(l,a.type),I.endColumn(l)}(n,u))));let i=n.createString("L1");t&&(U.startCrs(n),U.addCode(n,t),e=U.endCrs(n)),S.startHeader(n),e&&S.addCrs(n,e),S.addFeaturesCount(n,BigInt(r.featuresCount)),S.addGeometryType(n,r.geometryType),S.addIndexNodeSize(n,0),s&&S.addColumns(n,s),S.addName(n,i);let o=S.endHeader(n);return n.finishSizePrefixed(o),n.asUint8Array()}function ve(r,t){return{name:t,type:function(e){if(typeof e=="boolean")return y.Bool;if(typeof e=="number")return e%1==0?y.Int:y.Double;if(typeof e=="string"||e===null)return y.String;if(typeof e=="object")return y.Json;throw Error(`Unknown type (value '${e}')`)}(r[t]),title:null,description:null,width:-1,precision:-1,scale:-1,nullable:!0,unique:!1,primary_key:!1}}const Ie={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class jt{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Ie[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const J=6378137,j=Math.PI*J,xe=[-j,-j,j,j],Fe=[-180,-85,180,85],K=J*Math.log(Math.tan(Math.PI/2));class L extends jt{constructor(t){super({code:t,units:"m",extent:xe,global:!0,worldExtent:Fe,getPointResolution:function(e,n){return e/Math.cosh(n[1]/J)}})}}const Nt=[new L("EPSG:3857"),new L("EPSG:102100"),new L("EPSG:102113"),new L("EPSG:900913"),new L("http://www.opengis.net/def/crs/EPSG/0/3857"),new L("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Pe(r,t,e,n){const s=r.length;e=e>1?e:2,n=n??e,t===void 0&&(e>2?t=r.slice():t=new Array(s));for(let i=0;i<s;i+=n){t[i]=j*r[i]/180;let o=J*Math.log(Math.tan(Math.PI*(+r[i+1]+90)/360));o>K?o=K:o<-K&&(o=-K),t[i+1]=o}return t}function Ue(r,t,e,n){const s=r.length;e=e>1?e:2,n=n??e,t===void 0&&(e>2?t=r.slice():t=new Array(s));for(let i=0;i<s;i+=n)t[i]=180*r[i]/j,t[i+1]=360*Math.atan(Math.exp(r[i+1]/J))/Math.PI-90;return t}const Oe=6378137,kt=[-180,-90,180,90],Se=Math.PI*Oe/180;class N extends jt{constructor(t,e){super({code:t,units:"degrees",extent:kt,axisOrientation:e,global:!0,metersPerUnit:Se,worldExtent:kt})}}const Mt=[new N("CRS:84"),new N("EPSG:4326","neu"),new N("urn:ogc:def:crs:OGC:1.3:CRS84"),new N("urn:ogc:def:crs:OGC:2:84"),new N("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new N("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new N("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let bt={};function st(r,t,e){const n=r.getCode(),s=t.getCode();n in bt||(bt[n]={}),bt[n][s]=e}function qt(r,t){if(t!==void 0){for(let e=0,n=r.length;e<n;++e)t[e]=r[e];t=t}else t=r.slice();return t}function Ce(r){r.getCode(),st(r,r,qt)}function Ee(r){r.forEach(Ce)}function Rt(r){Ee(r),r.forEach(function(t){r.forEach(function(e){t!==e&&st(t,e,qt)})})}function Ve(r,t,e,n){r.forEach(function(s){t.forEach(function(i){st(s,i,e),st(i,s,n)})})}function Te(){Rt(Nt),Rt(Mt),Ve(Mt,Nt,Pe,Ue)}Te();function Ft(r){let t,e,n=r.coordinates,s=[],i=[],o=tt(r.type),u=0;switch(r.type){case"Point":case"MultiPoint":case"LineString":ft(n,s,i);break;case"MultiLineString":case"Polygon":ft(n,s,i),n.length>1&&(t=n.map(l=>u+=l.length));break;case"MultiPolygon":e=n.map(l=>({type:"Polygon",coordinates:l})).map(Ft)}return{xy:s,z:i.length>0?i:void 0,ends:t,type:o,parts:e}}function zt(r){let t=tt(r.type),e=[];for(let n=0;n<r.geometries.length;n++){let s=r.geometries[n];s.type==="GeometryCollection"?e.push(zt(s)):e.push(Ft(s))}return{type:t,parts:e}}function gt(r,t){let e=t;if(e===x.Unknown&&(e=r.type()),e===x.GeometryCollection){let s=[];for(let i=0;i<r.partsLength();i++){let o=r.parts(i),u=o.type();s.push(gt(o,u))}return{type:x[e],geometries:s}}if(e===x.MultiPolygon){let s=[];for(let i=0;i<r.partsLength();i++)s.push(gt(r.parts(i),x.Polygon));return{type:x[e],coordinates:s.map(i=>i.coordinates)}}let n=function(s,i){let o=s.xyArray(),u=s.zArray();switch(i){case x.Point:{let l=Array.from(o);return u&&l.push(u[0]),l}case x.MultiPoint:case x.LineString:return ht(o,u);case x.MultiLineString:case x.Polygon:return function(l,a,h){let b;if(!h||h.length===0)return[ht(l,a)];let c=0,d=Array.from(h).map(f=>l.slice(c,c=f<<1));return a&&(c=0,b=Array.from(h).map(f=>a.slice(c,c=f))),d.map((f,p)=>ht(f,b?b[p]:void 0))}(o,u,s.endsArray())}}(r,e);return{type:x[e],coordinates:n}}function Pt(r,t,e){let n=e.columns;return{type:"Feature",id:r,geometry:gt(t.geometry(),e.geometryType),properties:ee(t,n)}}function Be(r,t=0){let e=function(l){let a=l.features[0].properties,h=null;return a&&(h=Object.keys(a).map(b=>ve(a,b))),{geometryType:pe(l.features),columns:h,envelope:null,featuresCount:l.features.length,indexNodeSize:0,crs:null,title:null,description:null,metadata:null}}(r),n=me(e,t),s=r.features.map(l=>te(l.geometry.type==="GeometryCollection"?zt(l.geometry):Ft(l.geometry),l.properties,e)),i=s.map(l=>l.length).reduce((l,a)=>l+a),o=new Uint8Array(E.length+n.length+i);o.set(n,E.length);let u=E.length+n.length;for(let l of s)o.set(l,u),u+=l.length;return o.set(E),o}function Ae(r,t){return{type:"FeatureCollection",features:_e(r,Pt,t)}}function Ne(r,t){return ye(r,Pt,t)}function ke(r,t,e,n=!1){return ge(r,t,Pt,e,n)}function Me(r,t=0){return Be(r,t)}function Re(r,t,e,n=!1){return r instanceof Uint8Array?Ae(r,e):r instanceof ReadableStream?Ne(r,e):ke(r,t,e,n)}const Le=Object.freeze(Object.defineProperty({__proto__:null,deserialize:Re,serialize:Me},Symbol.toStringTag,{value:"Module"}));export{I as Column,P as Feature,m as Geometry,Le as geojson};
