import{v as o,K as T,ak as C,aD as v,S as r,ac as S,le as w,lf as D,jj as b,b9 as $,aW as M,aX as I,n as O}from"./index-DECxckyg.js";import{C as x}from"./mat2df64-DDXwUeaJ-Tu7q-7Mk.js";import{b as E,d as V,C as k,Y as z,O as U,E as W,I as j,R}from"./drawSurfaces-DQUGW1oK-C0rwSN5m.js";import{K as c}from"./jsxFactory-Cua8zWVZ-C2AbQVXs.js";import"./vec32-Cj8pVsU0-_k_0y_aO.js";import"./common-CYWrYyJl-E8-sukrT.js";import"./geodesicUtils-DKS2UG72-ETyX6iOS.js";import"./projectionUtils-B-CplN3q-dCP8PmW1.js";import"./distanceOperator-CZDvZf3O-BlQBW3nb.js";import"./Point2D-CaHJVGk1-JqvJXjLr.js";import"./ProjectionTransformation-DQ4GElxa-BzvklnL-.js";import"./Envelope2D-DlBzXkgv-eKRxGysX.js";import"./Transformation2D-CXWnDKXs-bixc63yn.js";import"./SimpleGeometryCursor-DSF_YyIm-TAMgMsbK.js";import"./OperatorDefinitions-DJdq_wrt-DP7_WWTp.js";import"./apiConverter-CSuukuP9-D4KgSMsu.js";import"./jsonConverter-tsQ40CV0-pbYzQkwP.js";import"./simplifyOperator-BW9Vrh-l-BB2cQC-H.js";import"./operatorSimplify-CjcRb60U-0qN8ihNl.js";import"./mat2d-BQA-1WB--Pnyy0dhf.js";import"./quat-DQgq9Ar5-D4T-DUHh.js";import"./mat3f64-BnNZDR5l-Bz3OL2oI.js";import"./quatf64-C16JxGFv-BKWK1F8U.js";import"./vec42-D8CJyqHG-DnfLTeQH.js";import"./memoize-DvEt8OkT-Cy_RrfpZ.js";import"./ReactiveSet-CRNikQMW-UghFLFhZ.js";import"./diffUtils-BxG8DCnW-D0iSO3bg.js";import"./UpdatingHandles-Bd2FQ26N-CPeQVO1m.js";import"./elevationInfoUtils-Ccn2Wfoe-Dkd5S0ss.js";import"./ElevationInfo-DE5to86a-zZvCtC1M.js";import"./lengthUtils-C61nRlXw-CNiQkeeF.js";import"./ViewingMode-CdRKcXnc-Dab70bGf.js";import"./SnappingContext-OY7xJ98b-CYMfPV6C.js";import"./vec2-BnynUbeJ-CKtGJQAy.js";import"./vec2f64-CkowXrDb-3zFQ3LNH.js";import"./vec4f64-DD-nkcCV-CSNWKRqG.js";import"./plane-Cf3Koz3c-BErhslGI.js";import"./vectorStacks-5ZZtmT9E-DSFWRh8B.js";import"./mat4f64-xsZDPPj0-Dq35B4BL.js";import"./SketchViewModel-B0qFHK0t-BPVoqr27.js";import"./GraphicsLayer-BiEC2-gS-DSKnymkB.js";import"./GraphicsCollection-uWAVmks7-DJ4BOlOA.js";import"./Layer-DvVVmz9x-D2JZ_h1N.js";import"./TimeExtent-Cf2Pienb-DASHDtdu.js";import"./BlendLayer-DjW_5k0v-CiV_4sQK.js";import"./layerContainerType-ChWdCT09-G5sdAsSy.js";import"./jsonUtils-BwLwuQj7-s-55UT6y.js";import"./parser-CWccHtwJ-CKACZqwA.js";import"./mat4f32-BdRMyjXW-CWt6U0BP.js";import"./mat4-OOmHNWi7-BlAajtXL.js";import"./ScaleRangeLayer-x42fwED3-BPHyoz7r.js";import"./editableLayers-DFUBlMJy-snLFy9cR.js";import"./utils-Dd8gTonD-DUYRQ7Um.js";import"./Queue-DV3gpSdl-dEQtqDMO.js";import"./Version-CnwD6MZa-C2nxDhmR.js";import"./Cyclical-DgD7_U1C-DeKSo0c-.js";import"./quantityUtils-B1Ov7DZK-BxtSXfLN.js";import"./projectVectorToVector-DcyiGOWJ-CDN5YqHG.js";import"./projectPointToVector-BZJhoF_5-C6CtqXX8.js";import"./asyncUtils-BPUlNCrX-DKWscr2H.js";import"./Query-n1aoaaFC-DEpJ8fHn.js";import"./Field-BIQ-quF4-CUYPWLA1.js";import"./fieldType-PhcL4ff8-DZQJCxjF.js";import"./sphere-zPMQWhGG-DLIwZr6O.js";import"./mat3-DOnW3DjW-C3hbW9XY.js";import"./geodeticLengthOperator-DHGBHzf3-kIlow3Tp.js";import"./geodeticCurveType-D_etKnbP-CirnHLSB.js";import"./earcut-C6NeZYSh-Da0ULCQ5.js";import"./triangle-BM89wdHY-BGay_Mgz.js";import"./lineSegment-BAWQVP9P-CxLisQzg.js";import"./spatialReferenceEllipsoidUtils-BK0OQJn2-BUjoUZO0.js";import"./meshVertexSpaceUtils-CCr86FVF-Bvcxns11.js";import"./MeshLocalVertexSpace-Cfxtmv6L-CjFx57VF.js";import"./hydratedFeatures-oobA80ei-DiSx8hwM.js";import"./Scheduler-BV4C4cVP-DbnQCOIV.js";import"./debugFlags-8tOwPnHK-UNFV43EL.js";import"./intl-BAA1onnp-XtXh_4yZ.js";import"./uuid-Dj9mdEVg-BaKSCiyT.js";import"./sanitizerUtils-B1yRmbO2-B7KG_jBT.js";let i=class extends S{constructor(t){super(t),this.coordinates=void 0,this.strokeDash=[],this.strokeWidth=1,this.strokeColor=[0,0,0,1],this.strokeDashColor=[255,255,255,1],this.fillColor=[0,0,0,0],this.visible=!0,this.isDecoration=!0}get _strokeStyle(){const t=this.strokeColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _strokeBackgroundStyle(){const t=this.strokeDashColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _fillStyle(){const t=this.fillColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _renderCoordinates(){const t=[];if(!this.coordinates)return{coordinates:t,rect:w};const e=D(b($(w),this.coordinates),2*this.strokeWidth);e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]+.5),e[3]=Math.ceil(e[3]+.5);for(const s of this.coordinates)t.push([Math.floor(s[0]-e[0])+.5,Math.floor(s[1]-e[1])+.5]);return t.reverse(),{coordinates:t,rect:e}}render(){const{coordinates:t,rect:e}=this._renderCoordinates,s=M(e),a=I(e);return c("div",{classes:{"esri-outline-overlay-item":!0},styles:{left:e[0]+"px",top:e[1]+"px",width:s+"px",height:a+"px",visibility:this.visible?"visible":"hidden"}},c("svg",{height:a,styles:{display:"block"},width:s},c("polygon",{fill:this._fillStyle,points:t.map(([p,l])=>`${p},${l}`).join(" "),stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),c("polygon",{fill:"transparent",points:t.map(([p,l])=>`${p},${l}`).join(" "),stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.length?this.strokeDash.join(" "):void 0,"stroke-width":this.strokeWidth})))}renderCanvas(){}};o([r()],i.prototype,"coordinates",void 0),o([r()],i.prototype,"strokeDash",void 0),o([r()],i.prototype,"strokeWidth",void 0),o([r()],i.prototype,"strokeColor",void 0),o([r()],i.prototype,"strokeDashColor",void 0),o([r()],i.prototype,"fillColor",void 0),o([r()],i.prototype,"visible",void 0),o([r()],i.prototype,"isDecoration",void 0),o([r({readOnly:!0})],i.prototype,"_strokeStyle",null),o([r({readOnly:!0})],i.prototype,"_strokeBackgroundStyle",null),o([r({readOnly:!0})],i.prototype,"_fillStyle",null),o([r({readOnly:!0})],i.prototype,"_renderCoordinates",null),i=o([O("esri.views.overlay.OutlineOverlayItem")],i);let n=class extends T.EventedMixin(E){constructor(t){super(t),this.drawOperation=null,this._overlayItem=void 0,this.geometryType=null,this.mode=null,this.type="draw-screen"}initialize(){this.drawOperation=this._makeDrawOperation();const t=e=>{var s;return((s=this.drawOperation)==null?void 0:s.on(e,a=>{this._updateVisuals(),this.emit(e,a)}))??v()};this.addHandles([t("vertex-add"),t("vertex-remove"),t("vertex-update"),t("cursor-update"),t("complete")]),this.finishToolCreation()}destroy(){this.drawOperation=C(this.drawOperation),this._set("view",null)}get canRedo(){var t;return!!((t=this.drawOperation)!=null&&t.canRedo)}get canUndo(){var t;return!!((t=this.drawOperation)!=null&&t.canUndo)}set centeredToggled(t){this._set("centeredToggled",t),this._updateVisuals()}set enabled(t){const{drawOperation:e}=this;e&&(e.interactive=t),this._set("enabled",t)}set uniformSizeToggled(t){this._set("uniformSizeToggled",t),this._updateVisuals()}get updating(){var t;return((t=this.drawOperation)==null?void 0:t.updating)??!1}get cursor(){return this._get("cursor")??"crosshair"}set cursor(t){this._set("cursor",t);const{drawOperation:e}=this;e&&(e.cursor=t)}completeCreateOperation(){var t;(t=this.drawOperation)==null||t.complete()}onInputEvent(t){var e;this.destroyed||((e=this.drawOperation)==null||e.onInputEvent(t))}redo(){var t;(t=this.drawOperation)==null||t.redo()}undo(){var t;(t=this.drawOperation)==null||t.undo()}reset(){}_makeDrawOperation(){const{view:t}=this;return new V({view:t,manipulators:this.manipulators,geometryType:K(this.geometryType),drawingMode:this.mode,hasZ:!1,defaultZ:0,snapToSceneEnabled:!1,drawSurface:new k,hasM:!1,snappingManager:null,snappingVisualizer:null,graphic:null,cursor:this.cursor,automaticLengthMeasurementUtils:this.automaticLengthMeasurementUtils})}get coordinates(){var l,u,y;const{drawOperation:t}=this;if(!(t!=null&&t.geometryIncludingUncommittedVertices.length))return[];const{coordinateHelper:e}=t,s=t.committableVertex,a=t.committedVertices.slice();s!=null&&a.push(e.pointToArray(s));const p=a.length;switch(this.geometryType){case"point":return a.slice(0,1);case"circle":case"rectangle":{const m=new z(x,k.spatialReference),g=this.geometryType==="circle"?U:W,f=this.geometryType==="circle"?j:R;if(p===1&&t.isCompleted){const d=a[0],h=m.makeMapPoint(d[0]+B,d[1]);return((l=g([d,h],m,!0))==null?void 0:l.geometry.rings[0])??[]}if(p===2){const d=this.geometryType!=="rectangle",h=this.centeredToggled!==d,_=this.geometryType!=="rectangle";return(this.uniformSizeToggled!==_?(u=g(a,m,h))==null?void 0:u.geometry.rings[0]:(y=f(a,m,h))==null?void 0:y.geometry.rings[0])??[]}return[]}}return a}_updateVisuals(){var t;if(!this._overlayItem){const e=new i({strokeDash:[5],strokeDashColor:[255,255,255,255]});(t=this.view.overlay)==null||t.addItem(e),this.addHandles(v(()=>{var s;(s=this.view.overlay)==null||s.removeItem(e),e==null||e.destroy(),this._overlayItem=void 0})),this._overlayItem=e}this._overlayItem.coordinates=this.coordinates}onDeactivate(){var t,e;(t=this.drawOperation)!=null&&t.isCompleted||((e=this.drawOperation)==null||e.cancel())}};function K(t){switch(t){case"polygon":case"point":return t;case"circle":case"rectangle":return"segment"}}o([r({value:!1})],n.prototype,"centeredToggled",null),o([r()],n.prototype,"drawOperation",void 0),o([r({value:!0})],n.prototype,"enabled",null),o([r({value:!1})],n.prototype,"uniformSizeToggled",null),o([r({constructOnly:!0})],n.prototype,"geometryType",void 0),o([r({constructOnly:!0})],n.prototype,"mode",void 0),o([r({readOnly:!0})],n.prototype,"type",void 0),o([r({readOnly:!0})],n.prototype,"updating",null),o([r({constructOnly:!0,nonNullable:!0})],n.prototype,"view",void 0),o([r({constructOnly:!0})],n.prototype,"automaticLengthMeasurementUtils",void 0),o([r()],n.prototype,"cursor",null),n=o([O("esri.views.draw.DrawScreenTool")],n);const B=48;export{n as DrawScreenTool,K as geometryTypeToDrawOperationGeometryType};
