import{cf as h,u as f,N as m}from"./index-1o7Uo5_u.js";import{l as y,e as v}from"./infoFor3D-BeWnZejW-CnXQECJx.js";class T{constructor(s,e,r){this.assetName=s,this.assetMimeType=e,this.parts=r}equals(s){return this===s||this.assetName===s.assetName&&this.assetMimeType===s.assetMimeType&&h(this.parts,s.parts,(e,r)=>e.equals(r))}isOnService(s){return this.parts.every(e=>e.isOnService(s))}makeHash(){let s="";for(const e of this.parts)s+=e.partHash;return s}async toBlob(s){const{parts:e}=this;if(e.length===1)return e[0].toBlob(s);const r=await Promise.all(e.map(n=>n.toBlob(s)));return f(s),new Blob(r)}}class w{constructor(s,e){this.partUrl=s,this.partHash=e}equals(s){return this===s||this.partUrl===s.partUrl&&this.partHash===s.partHash}isOnService(s){return this.partUrl.startsWith(`${s.path}/assets/`)}async toBlob(s){const{data:e}=await m(this.partUrl,{responseType:"blob"});return f(s),e}}function B(t){return N(t==null?void 0:t.source)}const u=/^(model\/gltf\+json)|(model\/gltf-binary)$/,l=/\.(gltf|glb)/i;function N(t){switch(t==null?void 0:t.type){case"client":return Array.isArray(t.files)?t.files.some(i):i(t.files);case"service":return t.assets.some(i);case"loadable":return!0;default:return!1}}function i(t){if(t instanceof File){const{type:s,name:e}=t;return u.test(s)||l.test(e)}return u.test(t.assetMimeType)||l.test(t.assetName)}function H(t,s){if(!t)return!1;const{source:e}=t;return b(e,s)}function M(t,s){if(t===s)return!0;const{source:e}=t,{source:r}=s;if(e===r)return!0;if(e.type==="service"&&r.type==="service"){if(e.assets.length!==r.assets.length)return!1;const n=(a,c)=>a.assetName<c.assetName?-1:a.assetName>c.assetName?1:0,o=[...e.assets].sort(n),p=[...r.assets].sort(n);for(let a=0;a<o.length;++a)if(!o[a].equals(p[a]))return!1;return!0}return!1}function b(t,s){return t.type==="service"&&t.assets.every(e=>e.isOnService(s))}function O(t,s){return t instanceof File?y(t,s):v(t.assetMimeType,t.assetName,s)}function U(t){switch(t.type){case"client":return Array.isArray(t.files)?t.files:[t.files];case"service":return t.assets;case"loadable":return}}function q(t){return!!t.original}export{O as H,U as M,B as N,q as O,H as d,w as g,T as v,M as w};
