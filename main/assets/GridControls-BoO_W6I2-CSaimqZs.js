const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CPuo0G35-CrRCQ2Ya.js","./index-B5UpFGZX-BY7UCsxA.js","./jsxFactory-DN-m49_5-CUFCpKPo.js","./index-BeTPrQ6f.js","./index-BlWAJbpo.css","./intl-DRhjUnwt-Dihhq8dq.js","./messages-DQ10DjvF-6kk0dzjG.js","./uuid-CFz2qBzH-cIdlpVG-.js","./sanitizerUtils-CrdmaILo-DztC6Qnx.js","./guid-Dls486Er-CBh637k4.js","./useT9n-DLD4Ns9x-BMNOgwpk.js","./index-CZRmpYJQ-B_ZQ2kaU.js","./dom-cV1JHjxC-ECa-LXIB.js","./observers-CAhVhbXT-D_oY9tJ5.js","./keyed-BsTPRA5D-oS6cmwSg.js","./interactive-CoTGpEoh-DzPnGf4B.js","./useSetFocus-BJqFX1-H-ChkfMq9o.js","./form-D03n6FLW-C_W96jbq.js","./index-CwdFwT2M-5WGIIVNT.js","./index-CXfSk3I4-Bs_ihh4m.js","./floating-ui-yKM6nE1h-7HS70EnH.js","./debounce-BgMoWmzF-DQf8_AwT.js","./openCloseComponent-DHhaQPZ4-CCedQdfz.js","./static-I-rbCIK8-CmBWZ6Bh.js","./FloatingArrow-wReOH_xj-BY9KnqOX.js","./key-CZySMiwx-kmS7VeUz.js","./index-BJe6KWh2-Z1AFTVnh.js","./array-C6Ny8gbM-C9M-r-JU.js","./index-DsKoYdZK-CCdHKxmk.js","./useCancelable-Bx62O-42-BWQ6Sha4.js","./index-DhiKtjhW-kTAwhIPd.js","./label-C3m_eiKP-DS3cqnkb.js","./index-bZE3dpLT-CSjZXDJ4.js","./index-BbU6fgLG-UZ6TDQNO.js","./global-rS-q6-Uk-CTdXmhHJ.js","./index-DMFZlf9Z-B9K-JAa4.js","./customElement-R7RZTIol-BnJ-Elw1.js","./input-CREQlp6f-MVqFAf6a.js","./InternalLabel-BiuqGPFq-CpSD2G_N.js","./Validation-EOXLsGwz-3qHq6x6W.js","./index-CTg9MlSx-8dimOotN.js","./index-DPXhoKdb-BRi0pKCq.js"])))=>i.map(i=>d[i]);
import{bb as ce,P as K,as as R,aH as pe,bp as _,_ as S,j as de,aT as he,ar as $,ek as j,B as k,fX as Q,fG as ue,b8 as me,gz as Z,Y as ge,aj as ee,m as n,E as s,bO as ve,n as M,be as E,l as G,aW as _e,bk as ye}from"./index-BeTPrQ6f.js";import"./intl-DRhjUnwt-Dihhq8dq.js";import{e as fe}from"./unitFormatUtils-BbVpiips-i7yyYN--.js";import{U as be,C as we,V as l,b as Se,q as W}from"./jsxFactory-DN-m49_5-CUFCpKPo.js";import{g as B,i as Ce,V as N,_ as Me}from"./utils-DqlCEhl6-DBO0-7VG.js";import{r as te,i as Pe,c as I}from"./index-C3e3iuYi-s8xSrC2z.js";import{b as xe,W as ie,G as Ie}from"./projectionUtils-CsX1UTBu-DsZaU4xz.js";import{s as Te}from"./scaleUtils-Ckma21r5-DhwWQymd.js";import{n as q}from"./projectVectorToVector-OCoJKalB-CQIDHzSm.js";import{i as Re}from"./getDefaultUnitForView-CEAuCsu_-B1vEtX96.js";import{k as ke,z as Ee,M as Le,H as Oe}from"./gridUtils-DpRsTzHe-j68kmuS2.js";import{DrawGraphicTool2D as $e}from"./editingTools-Owi9EJyN-BIXDePDC.js";import{g as Ge,h as De,L as z,M as Ae}from"./SketchViewModel-BCVIeloG-Cwmt4M0t.js";import{n as Ve}from"./TextOverlayItem-5NFsakI7-CpLCqR0o.js";import{x as Ue}from"./number-BsNxu9Ry-D0lLRJTw.js";import{a as je,l as We,r as Be,P as Ne,p as qe,d as ze,u as Fe,c as He}from"./SketchTooltipInfo-EowXqHHv-Yp97uw3T.js";import{b as Ye}from"./substitute-Cl1SJAIb-D0XLv0xK.js";import"./messages-DQ10DjvF-6kk0dzjG.js";import"./Cyclical-Bzwh_QaL-CXh-hbnA.js";import"./quantityUtils-v7kjLywD-Cq6IoGLM.js";import"./uuid-CFz2qBzH-cIdlpVG-.js";import"./sanitizerUtils-CrdmaILo-DztC6Qnx.js";import"./Queue-CK6TduSr-C-T211SM.js";import"./signal-DHxLvooI-Bin-tnuW.js";import"./Version-DSJSGSLA-Cg87msWM.js";import"./draw-store-DwCnUTPl-Dp2Sl1TU.js";import"./GraphicsLayer-DPoztXf7-DWF8RDJT.js";import"./GraphicsCollection-CT-y6p3H-4XYPvC_j.js";import"./BlendLayer-D8oJmNCO-A0sTzbOF.js";import"./layerContainerType-CJrPp4UB-BIF7XAYP.js";import"./jsonUtils-Bl9MVnOR-Be8hf0yA.js";import"./parser-CXoJuqeV-C7irlk5U.js";import"./mat4f32-BdRMyjXW-CWt6U0BP.js";import"./mat4-R0VY9B_E-DoEP887i.js";import"./ScaleRangeLayer-DkZwCH6_-C95kTMqN.js";import"./ElevationInfo-tlrAM5SV-D86C1F9d.js";import"./lengthUtils-CopeXEyE-DjCEitlq.js";import"./layerViewUtils-BBTk5dU--BemaIlLi.js";import"./asyncUtils-Cu__bxqs-ecCTUaGV.js";import"./drapedUtils-D9z307XM-CQXlJXY2.js";import"./utils-C0LvbFCo-RMQaTNpt.js";import"./widget-Yo6nzRYu-BBI8jxq5.js";import"./UpdatingHandles-XotKWqvb-CyHJIoZx.js";import"./projectBuffer-CMNsPBq1-CMpE7Jo3.js";import"./zscale-PLuFqpaL-BIEnWBsg.js";import"./editableLayers-BTZOOiKD-ByJ-Oydo.js";import"./elevationInfoUtils-DFX5QvG8-DWLx2t7K.js";import"./projectPointToVector-BHS0gJJf-DOVZH8Fn.js";import"./vec32-CI1xtKog-DFVYRcgb.js";import"./Query-DKLDaFaA-I4zhlfzt.js";import"./Field-Dn1Bgq7n-CJCGLoNR.js";import"./fieldType-DvW5hpfa-DYUbIy_X.js";import"./vec2f64-CkowXrDb-3zFQ3LNH.js";import"./vec42-DHp-FUwt-Br7hmYJs.js";import"./vec4f64-DD-nkcCV-CSNWKRqG.js";import"./geodesicUtils-DHDMXkUY-CP5HeHA5.js";import"./plane-wUwHaY3K-ZwGBF7HQ.js";import"./vectorStacks-B2ngxq6F-myhPBoPk.js";import"./quatf64-C16JxGFv-BKWK1F8U.js";import"./sphere-CIGsF4vz-C3zVQu9y.js";import"./geodeticLengthOperator-CMi-Z1ZN-WUImro4E.js";import"./geodeticCurveType-D_etKnbP-CirnHLSB.js";import"./earcut-C6NeZYSh-P2HUZ781.js";import"./triangle-DA_o7I-u-CHbj6sRJ.js";import"./lineSegment-D8lwRkdT-CnWWOaLb.js";import"./spatialReferenceEllipsoidUtils-Ty3j4VoE-BUAsRqCF.js";import"./normalizeUtils-DK5542Ty-DtqBcgc2.js";import"./normalizeUtilsCommon-5DjefBp7-CQyUDMQp.js";import"./utils-CRANtbnc-C6zyufvL.js";import"./utils-t279O251-BBk6rV0U.js";import"./SnappingVisualizer2D-C1_WGevN-BkQ_4UbX.js";import"./TooltipInfoWithCoordinates-Ddvg_E_1-DHPxpvzo.js";import"./PointSnappingHint-NgOvzAAk-CFqn5eSp.js";import"./angularMeasurementUtils-CVK8K4WU-C6RO-Ta3.js";import"./editPlaneUtils-DVPHOAL2-C25USCi0.js";import"./drawSurfaces--K8ToToC-FllffqSc.js";import"./ReactiveSet-DP8oFB7N-DSfeDz8k.js";import"./diffUtils-D3O4EfgX-CznKxD4n.js";import"./SnappingContext-pR4ApgxC--JaBRde9.js";import"./rotate-ClH9iv5s-CoX5oM8l.js";import"./curveOperationUtils-ClbIvhut-17Ywjz26.js";import"./meshVertexSpaceUtils-EbHpWZGf-CmRuaT8m.js";import"./MeshLocalVertexSpace-CxmyTFZH-DhgfYuby.js";import"./hydratedFeatures-82j52esm-6EbRngQ4.js";import"./Scheduler-D_tOhFWn-SFGb1GBz.js";import"./debugFlags-vZXEBr68-Bc51Oe-E.js";import"./createUtils-QoBeynM5-wXx8RLRA.js";import"./distanceOperator-C3n_j88h-CjjOO0Zj.js";import"./Point2D-BVUQyGsf-qih0ZuJV.js";import"./Distance2DCalculator-CXhBP-8I-CW7HDKXX-kSux2duE.js";import"./ProjectionTransformation-BXUROh_s-kKBZ5FDB.js";import"./Envelope2D-2iYexKQo-BCKocNS7.js";import"./Transformation2D-CZCvoz9N-B-IhcWnl.js";import"./SimpleGeometryCursor-DSF_YyIm-TAMgMsbK.js";import"./OperatorDefinitions-DJdq_wrt-DP7_WWTp.js";import"./apiConverter-Djde5pBD-Dr3vspB4.js";import"./jsonConverter-CiKBkr5U-C590VlCu.js";import"./simplifyOperator-CK8t6p1S-COLMjdqn.js";import"./operatorSimplify-BRKLCaj2-DisWK8Yh.js";import"./mat2d-Cf4xHr3Z-u09Kv-lR.js";import"./mat2df64-VxtldH1S-CqyKAV7h.js";import"./quat-B6H0knG8-DtO1-hlf.js";import"./boundedPlane-CehKkKe3-4WekUEh5.js";import"./cimSymbolUtils-BJ01Nooc-BfOR3Irv.js";import"./utils-CIm5uQvO-CtKf129F.js";import"./defaultCIMValues-BWu-APou-XI-Li77m.js";import"./GraphicManipulator-CkOY4Z_k-BgpI7zKu.js";import"./colorUtils-DlmOacVt-BnN0T6wa.js";import"./drawUtils-IdZShl4g-YZikzVNa.js";import"./MeshTransform-DfLVYScT-Cq2gdNT7.js";import"./axisAngleDegrees-StGk9lM5-YzC5iFyo.js";import"./modeUtils-V6BDu_YT-Dq8o_RJK.js";import"./a11yUtils-tU3tY6-a-CmHbThdR.js";let v=class extends ge{constructor(e){super(e),this.center=new k,this.dynamicScaling=!0,this.majorLineColor=_.fromArray([115,115,115,1]),this.majorLineInterval=10,this.minorLineColor=_.fromArray([165,165,165,1]),this.rotateWithMap=!1,this.rotation=0,this.spacing=1,this.type="measured",this.units="miles"}};n([s()],v.prototype,"center",void 0),n([s()],v.prototype,"dynamicScaling",void 0),n([s()],v.prototype,"majorLineColor",void 0),n([s()],v.prototype,"majorLineInterval",void 0),n([s()],v.prototype,"minorLineColor",void 0),n([s()],v.prototype,"rotateWithMap",void 0),n([s()],v.prototype,"rotation",void 0),n([s()],v.prototype,"spacing",void 0),n([ve({measured:"measured"})],v.prototype,"type",void 0),n([s()],v.prototype,"units",void 0),v=n([M("esri.grids.MeasuredGrid")],v);const Xe={readOnly:!0,get(){return Re(this.view)}};let y=class extends ee{constructor(e){super(e),this.color=new _([255,127,0,1]),this.isDecoration=!0,this.length=34,this.rotation=0,this.thickness=2,this.visible=!0}get _strokeStyle(){return this.color.toCss(!0)}render(){const{x:e,y:t,length:i,thickness:r,rotation:o}=this,a=i/2,p=`0 0 ${i} ${i}`,d=`M${a} 0 V${i} M0 ${a} H${i}`;return l("div",{classes:{"esri-box-overlay-item":!0},dir:"ltr",styles:{left:`${(e??0)-a}px`,top:`${(t??0)-a}px`,width:`${i}px`,height:`${i}px`,transform:`rotate(${o}deg)`,visibility:this.visible?"visible":"hidden"}},l("svg",{styles:{overflow:"visible"},viewbox:p},l("path",{d,stroke:this._strokeStyle,"stroke-width":r})))}renderCanvas(){}};n([s()],y.prototype,"color",void 0),n([s()],y.prototype,"isDecoration",void 0),n([s()],y.prototype,"length",void 0),n([s()],y.prototype,"rotation",void 0),n([s()],y.prototype,"thickness",void 0),n([s()],y.prototype,"visible",void 0),n([s()],y.prototype,"x",void 0),n([s()],y.prototype,"y",void 0),n([s({readOnly:!0})],y.prototype,"_strokeStyle",null),y=n([M("esri.views.overlay.CrosshairOverlayItem")],y);function Je(e,t){const i=re(t);return[e[0].toFixed(i),e[1].toFixed(i)]}function re(e){return e>=500?6:e<500&&e>=50?7:e<50&&e>=5?8:9}function Ke(e,t){const i=e.includes(",")?",":" ",[r,o,a]=e.split(i).map(d=>{const h=d.trim();return h?Number(h):null});if(!L(r)||!L(o))return null;const p=new k({x:r,y:o,spatialReference:t||E.WGS84});return a&&(p.z=a,p.hasZ=!0),p}function L(e){return typeof e=="number"&&isFinite(e)}function F(e){return!!e&&L(e.x)&&L(e.y)}function H(e,t){if(e.spatialReference.isGeographic&&t){const[i,r]=Je([e.x,e.y],t);return`${i}, ${r}`}return`${e.x.toFixed(3)}, ${e.y.toFixed(3)}`}let u=class extends ee{constructor(e){super(e),this.conversionInfo=null,this.coordinateSegments=null,this._currentPattern=void 0,this.defaultPattern=null,this.name=null,this.viewModel=null}get currentPattern(){return(this._currentPattern||this.defaultPattern)??""}set currentPattern(e){this._currentPattern=e}get label(){return this.name??""}set label(e){this._overrideIfSome("label",e)}get hasDisplayProperties(){return!(!this.defaultPattern||!this.coordinateSegments)}get spatialReference(){var e;return this.name==="basemap"?this._viewSpatialReference:((e=this.conversionInfo)==null?void 0:e.spatialReference)??E.WGS84}set spatialReference(e){this._overrideIfSome("spatialReference",e)}get _viewSpatialReference(){var e,t;return((t=(e=this.viewModel)==null?void 0:e.view)==null?void 0:t.spatialReference)??E.WGS84}get _additionalCharactersPattern(){const e=this.coordinateSegments;if(!e)return null;const t=e.map(r=>r.alias),i=this.currentPattern.replaceAll(new RegExp(`["nsew${t.join()}]`,"gi"),"").replaceAll(" ","");return new RegExp(`[${i}]`,"g")}get test(){}async convert(e){var r;if(!F(e))throw new G("format:invalid-point","Could not convert invalid point.",{point:e});const t=(r=this.conversionInfo)==null?void 0:r.convert;if(t)return Promise.resolve().then(()=>t(e));const i=this._project(e,this.spatialReference);return{location:i,coordinate:this._getCoordinate(i)}}getConversionStrategy(){var t,i;const e=this._viewSpatialReference;return(t=this.conversionInfo)!=null&&t.convert||(i=this.viewModel)!=null&&i.formatterAvailable||this.name==="xy"&&(e.isWebMercator||e.isWGS84)||this.name==="basemap"?"client":"server"}getDisplayCoordinate(e){if(!e)return null;if(!this.coordinateSegments||!this.currentPattern)return e;let t=this.currentPattern;const i=this._getSegmentMatches(e,!1);for(let r=this.coordinateSegments.length-1;r>=0;r--){const o=this.coordinateSegments[r];t=t.replace(o.alias,i[r])}return t}_parseUserInput(e){const{defaultPattern:t,_additionalCharactersPattern:i,coordinateSegments:r}=this;if(!t||!i)return"";let o=t.replace(i,"");e=e.replace(i,"");const a=this._getSegmentMatches(e,!0);if(r)for(let p=r.length-1;p>=0;p--){const d=r[p];o=o.replace(d.alias,a[p])}return o}_getSegmentMatches(e,t){const i=new Array,{coordinateSegments:r}=this;if(!r)return i;for(let o=0;o<r.length;o++){const a=r[o],p=e.match(a.searchPattern);if(!p){i.push("");continue}let d=p[0];if(e=e.replace(d,"").trim(),a.substitution){const h=t?a.substitution.input(d):a.substitution.output(d);h&&(d=`${h}`)}i.push(d)}return i}async reverseConvert(e){var o,a;const t=this._parseUserInput(e),i=(o=this.conversionInfo)==null?void 0:o.reverseConvert;let r;if(i)r=i(t);else if(this.name==="xy"||this.name==="basemap")r=Ke(t,this.spatialReference);else if((a=this.viewModel)!=null&&a.formatterAvailable)switch(this.name){case"dd":case"ddm":case"dms":r=Ne(t,this.spatialReference);break;case"mgrs":{r=Be(t,this.spatialReference,"automatic");break}case"utm":{r=We(t,this.spatialReference,"latitude-band-indicators");break}case"usng":r=je(t,this.spatialReference);break;default:r=null}if(!r)throw new G("format:invalid-input","Could not parse input into point.",{coordinate:e});return this._project(r,this._viewSpatialReference)}_getCoordinate(e){var i,r,o;const t=((r=(i=this.viewModel)==null?void 0:i.view)==null?void 0:r.scale)??0;if(!F(e))throw new G("format:invalid-point","Could not transform invalid point into coordinate.",{point:e});if((o=this.viewModel)!=null&&o.formatterAvailable||this.name==="basemap"||this.name==="xy")switch(this.name){case"dd":case"ddm":case"dms":{const a=re(t);return He(e,this.name,a)}case"mgrs":return Fe(e,"automatic",5,!1);case"usng":return ze(e,5,!1);case"utm":return qe(e,"latitude-band-indicators",!0);default:return H(e,t)}return H(e,t)}_project(e,t){var i,r;if(_e(e.spatialReference,t)||!t)return e;if((i=this.viewModel)!=null&&i.formatterAvailable&&Ie())return ie(e,t);if(!((r=this.viewModel)!=null&&r.formatterAvailable)){const o=ye(e,t);if(o!=null)return o}return null}};n([s()],u.prototype,"conversionInfo",void 0),n([s()],u.prototype,"coordinateSegments",void 0),n([s()],u.prototype,"currentPattern",null),n([s()],u.prototype,"_currentPattern",void 0),n([s()],u.prototype,"label",null),n([s()],u.prototype,"defaultPattern",void 0),n([s({readOnly:!0})],u.prototype,"hasDisplayProperties",null),n([s()],u.prototype,"name",void 0),n([s({type:E})],u.prototype,"spatialReference",null),n([s()],u.prototype,"viewModel",void 0),n([s({readOnly:!0})],u.prototype,"_viewSpatialReference",null),n([s({readOnly:!0})],u.prototype,"_additionalCharactersPattern",null),u=n([M("esri.widgets.CoordinateConversion.support.Format")],u),Ue().decimal;const Qe="°‎",ne=e=>{if(e==null||isNaN(e))return 0;const t=e+180;return Math.trunc(Z(t,360))},Ze=e=>{let t=e;return t==null?0:(typeof t=="string"&&(t=parseInt(t,10)),isNaN(t)?0:Z(Math.trunc(t),360)-180)},Y=(e,t)=>{if(!e||t.length<3)return;const[i,r,o,a]=t,[p,d]=a===void 0?[1,.25]:[a,.25*a];e.majorLineColor=_.fromArray([i,r,o,p]),e.minorLineColor=_.fromArray([i,r,o,d])},X=Symbol("grid-interactivity");let c=class extends de{constructor(e){super(e),this._drawGraphicTool=null,this._keybindings=null,this._crosshairLabel=null,this._crosshairItem=null,this.snappingManager=null,this.snappingOptions=null,this.view=null,this.placementDisabled=!1,this._mostRecentlyShownGrid=null,this._sketchedVertexCount=0}initialize(){this.addHandles([he(()=>!this.displayEnabled,()=>{this.interactivePlacementState=null}),R(()=>{var e;return(e=this.view)==null?void 0:e.viewpoint},()=>{this._renderOverlays()}),R(()=>{var e;return(e=this.snappingOptions)==null?void 0:e.gridEnabled},e=>{e!=null&&this.trySetDisplayEnabled(e)}),R(()=>{var e;return(e=this.view)==null?void 0:e.grid},(e,t)=>{this._mostRecentlyShownGrid=!e&&t?t:null})])}destroy(){var e,t,i,r;this._resetGridPlacementState(),this._crosshairItem&&((t=(e=this.view)==null?void 0:e.overlay)==null||t.removeItem(this._crosshairItem),this._crosshairItem=$(this._crosshairItem)),this._crosshairLabel&&((r=(i=this.view)==null?void 0:i.overlay)==null||r.removeItem(this._crosshairLabel),this._crosshairLabel=$(this._crosshairLabel))}get displayEnabled(){var e;return!!((e=this.view)!=null&&e.grid)}get dynamicScaling(){var e;return((e=this.grid)==null?void 0:e.dynamicScaling)??!1}set dynamicScaling(e){this.grid&&(this.grid.dynamicScaling=e)}get grid(){var e;return((e=this.view)==null?void 0:e.grid)??this._mostRecentlyShownGrid}set gridColor(e){var a;if(e!=null&&e.equals((a=this.grid)==null?void 0:a.majorLineColor)||!e)return;const[t,i,r,o]=e.toArray();Y(this.grid,[t,i,r,o/255])}get gridColor(){var e;return(e=this.grid)==null?void 0:e.majorLineColor}get gridControlsEnabled(){return this.displayEnabled&&!this.interactivePlacementState}set interactivePlacementState(e){this._set("interactivePlacementState",e),this._resetGridPlacementState(),e&&this._startGridManipulation(e)}get majorLineInterval(){var e;return((e=this.grid)==null?void 0:e.majorLineInterval)??10}set majorLineInterval(e){this.grid&&(this.grid.majorLineInterval=e<1?1:e>15?15:e)}get rotateWithMap(){var e;return((e=this.grid)==null?void 0:e.rotateWithMap)??!1}set rotateWithMap(e){this.grid&&(this.grid.rotateWithMap=e)}get rotation(){var e;return((e=this.grid)==null?void 0:e.rotation)??-180}set rotation(e){this.grid&&(this.grid.rotation=e)}get snappingEnabled(){var e;return(this.grid&&((e=this.snappingOptions)==null?void 0:e.gridEnabled))??!1}set snappingEnabled(e){const{snappingOptions:t}=this;t&&(t.gridEnabled=e)}get spacing(){var e;return((e=this.grid)==null?void 0:e.spacing)??1}set spacing(e){this.grid&&e>0&&(this.grid.spacing=e)}get unit(){var e;return(e=this.grid)==null?void 0:e.units}set unit(e){this.grid&&(this.grid.units=e)}get gridOutOfScale(){return!this.dynamicScaling&&this._pixelsPerStride!=null&&this._pixelsPerStride<ke}get effectiveSpacingAfterDynamicScaling(){var e;return this.majorLineInterval<1||!this.dynamicScaling||!this.view||this._pixelsPerStride==null||!((e=this.grid)!=null&&e.spacing)?null:this.grid.spacing*Ee(this.majorLineInterval,this._pixelsPerStride,this.dynamicScaling)}get numericSpacingInputShouldBeVisible(){var e;return!!((e=this.view)!=null&&e.spatialReference)&&Le(this.view.spatialReference)}get _metersPerSRUnit(){if(!(this.view&&this.displayEnabled&&this.grid&&xe(this.grid.center.spatialReference,this.view.spatialReference)))return null;const e=ie(this.grid.center,this.view.spatialReference);return Oe(e)}get _pixelsPerStride(){var r;if(!((r=this.view)!=null&&r.scale)||!this.displayEnabled||!this.grid||this._metersPerSRUnit==null)return null;const e=this.grid,{scale:t,spatialReference:i}=this.view;return j(e.spacing,e.units,"meters")/(this._metersPerSRUnit*Te(t,i))}get _isPlacing(){if(!this._drawGraphicTool)return!1;const e=this.interactivePlacementState;return e==="place"||e==="interactive"&&this._sketchedVertexCount===0}get _isRotating(){if(!this._drawGraphicTool)return!1;const e=this.interactivePlacementState;return e==="rotate"||e==="interactive"&&this._sketchedVertexCount===1}get _isScaling(){return this._drawGraphicTool?this.interactivePlacementState==="interactive"&&this._sketchedVertexCount===1:!1}togglePlacementState(e){this.interactivePlacementState=this.interactivePlacementState===e?null:e}trySetDisplayEnabled(e){const{view:t}=this;if(t!=null&&t.ready)if(!t.grid&&e)if(this._mostRecentlyShownGrid)t.grid=this._mostRecentlyShownGrid;else{const i=this.defaultUnit==="imperial"?"feet":"meters";t.grid=new v({units:i,center:t.center??new k,rotateWithMap:!0}),Y(this.grid,[115,115,115])}else e||(t.grid=null);else K.getLogger(this).warn("Attempting to enable grid display while view is not ready")}async startPlacement(e){const{view:t,snappingManager:i}=this;if(!t)return;this._set("interactivePlacementState",e),this._sketchedVertexCount=0;const r=new $e({view:t,graphicProperties:{attributes:{[z]:z}},sketchOptions:{tooltips:{enabled:!0,visibleElements:{direction:!1,rotation:!1,totalLength:!1,elevation:!1,distance:!1,area:!1}}},geometryType:"polyline",mode:"click",snapToScene:!1,snappingManager:i,forceUniformSize:!0,centered:!1,cursor:this.interactivePlacementState==="interactive"||this.interactivePlacementState==="place"?"none":null,regularVerticesSymbol:void 0,activeVertexSymbol:et,activeLineSymbol:J,graphicSymbol:J,automaticAreaMeasurementUtils:await De(),automaticLengthMeasurementUtils:await Ge()});if(this._drawGraphicTool=r,t.addAndActivateTool(r),this._renderOverlays(),!this._keybindings){const o=new Ce;o.add(N.complete,()=>this._onDrawComplete()),o.add(N.vertexAdd,()=>{var a;return(a=this._drawGraphicTool)==null?void 0:a.drawOperation.commitStagedVertex()}),this._keybindings=o}this.addHandles([r.on("cursor-update",o=>this._onCursorUpdate(o)),r.on("complete",()=>this._onDrawComplete()),r.on("vertex-add",o=>this._onVertexAdd(o,e)),this._keybindings.register(t,Me.WIDGET)],X)}async _startGridManipulation(e){const{view:t}=this;if(!t)return void(this.interactivePlacementState=null);const i=new CustomEvent("before-placement",{cancelable:!0});this.emit("before-placement",i),i.defaultPrevented||await this.startPlacement(e)}_onCursorUpdate(e){var t;try{if(this._isPlacing){const i=e.vertices[0].coordinates;return void this._handlePlace(i)}if(this._drawGraphicTool.cursor=null,this._isRotating&&this._handleRotate(e.vertices[0].coordinates),this._isScaling){const i=(t=this._drawGraphicTool)==null?void 0:t.drawOperation.cursorVertex;this._handleScale(i)}}finally{this._renderOverlays()}}_onDrawComplete(){this._drawGraphicTool.cursor=null,this.interactivePlacementState=null}_onVertexAdd(e,t){const i=e.vertices[0].coordinates;this._isPlacing&&this._handlePlace(i),this._isRotating&&this._sketchedVertexCount>0&&this._handleRotate(i),this._isScaling&&this._sketchedVertexCount>0&&this._handleScale(q(i[0],i[1],void 0,this.view.spatialReference)),this._sketchedVertexCount++,this._drawGraphicTool.cursor=null,this._sketchedVertexCount!==2&&t==="interactive"||(this.interactivePlacementState=null),this._renderOverlays()}_handlePlace(e){const{grid:t,view:i}=this;t&&i&&(t.center=new k({x:e[0],y:e[1],spatialReference:i.spatialReference}))}_handleRotate(e){var U;const{grid:t,view:i}=this;if(!t||!i)return;(U=this._drawGraphicTool)==null||U.sketchOptions.tooltips.set("enabled",!1);const{x:r,y:o}=t.center,[a,p]=e,d=i.toScreen(t.center,{pickClosestTarget:!0}),h=d&&i.toMap(d),g=i.toScreen(q(a,p,void 0,i.spatialReference),{pickClosestTarget:!0}),b=g&&i.toMap(g),P=h?h.x:r,O=h?h.y:o,x=P-(b?b.x:a),A=O-(b?b.y:p);if(x===0&&A===0)return;const se=Math.atan2(A,x),V=me(se),oe=t.rotateWithMap,ae=i.viewpoint.rotation??0,le=oe?V:V-ae;t.rotation=Math.fround(le)%360}_handleScale(e){const{view:t,grid:i,_drawGraphicTool:r,interactivePlacementState:o,_metersPerSRUnit:a}=this;if(!(e&&t&&i&&r&&a))return;r.sketchOptions.tooltips.enabled=!1;const p=o==="interactive"?i.center:r.drawOperation.firstVertex;if(!p||!e)return;const d=t==null?void 0:t.toScreen(p),h=d&&t.toMap(d),g=t==null?void 0:t.toScreen(e),b=h??p,P=(g&&t.toMap(g))??e,O=Math.sqrt((b.x-P.x)**2+(b.y-P.y)**2),x=j(O*a,"meters",i.units);this.spacing=x}_renderOverlays(){this._renderCrosshairOverlay(),this._renderTextOverlay()}_renderTextOverlay(){const{grid:e,view:t,_drawGraphicTool:i}=this,r=this._getCrosshairLabel();if(!(e&&(t!=null&&t.overlay)&&i&&r))return;const o=t.toScreen(e.center,{pickClosestTarget:!0});o&&(r.position=[o.x+12,o.y+12]),this._isRotating?(r.text=`${ne(e.rotation)}${Qe}`,r.visible=!0):r.visible=!1}_renderCrosshairOverlay(){const{grid:e,view:t,_drawGraphicTool:i}=this;if(!e||!(t!=null&&t.overlay)||!i)return;const r=this._getCrosshair();if(!r)return;const o=t.toScreen(e.center);o&&(r.x=o.x,r.y=o.y,r.rotation=e.rotateWithMap?t.viewpoint.rotation-e.rotation:-e.rotation,r.visible=!!i)}_getCrosshairLabel(){if(this._crosshairLabel)return this._crosshairLabel;const{grid:e,view:t,_drawGraphicTool:i}=this;if(!e||!(t!=null&&t.overlay)||!i)return null;const r=new Ve({anchor:"top-left",fontSize:10,textColor:new _([21,21,21]),backgroundColor:new _([248,248,248]),padding:8,borderRadius:20});return t.overlay.addItem(r),this._crosshairLabel=r,r}_getCrosshair(){var i;const{_crosshairItem:e,view:t}=this;return t!=null&&t.overlay?e&&t.overlay.items.includes(e)?e:(this._crosshairItem=new y({color:t.effectiveTheme.accentColor,thickness:4,length:36,visible:!0}),(i=t.overlay)==null||i.addItem(this._crosshairItem),this._crosshairItem):null}_resetGridPlacementState(){var e,t;this.removeHandles(X),this._crosshairItem&&(this._crosshairItem.visible=!1),this._crosshairLabel&&(this._crosshairLabel.visible=!1),this._drawGraphicTool&&(((e=this.view)==null?void 0:e.activeTool)===this._drawGraphicTool&&(this.view.activeTool=null),(t=this.view)==null||t.tools.remove(this._drawGraphicTool)),this._drawGraphicTool=$(this._drawGraphicTool)}};n([s(Xe)],c.prototype,"defaultUnit",void 0),n([s({readOnly:!0})],c.prototype,"displayEnabled",null),n([s()],c.prototype,"dynamicScaling",null),n([s()],c.prototype,"grid",null),n([s()],c.prototype,"gridColor",null),n([s({readOnly:!0})],c.prototype,"gridControlsEnabled",null),n([s()],c.prototype,"interactivePlacementState",null),n([s()],c.prototype,"majorLineInterval",null),n([s()],c.prototype,"rotateWithMap",null),n([s()],c.prototype,"rotation",null),n([s()],c.prototype,"snappingEnabled",null),n([s()],c.prototype,"snappingManager",void 0),n([s({type:Ae})],c.prototype,"snappingOptions",void 0),n([s()],c.prototype,"spacing",null),n([s()],c.prototype,"unit",null),n([s()],c.prototype,"view",void 0),n([s({readOnly:!0})],c.prototype,"gridOutOfScale",null),n([s({readOnly:!0})],c.prototype,"effectiveSpacingAfterDynamicScaling",null),n([s({readOnly:!0})],c.prototype,"numericSpacingInputShouldBeVisible",null),n([s()],c.prototype,"placementDisabled",void 0),n([s()],c.prototype,"_metersPerSRUnit",null),n([s()],c.prototype,"_pixelsPerStride",null),n([s()],c.prototype,"_isPlacing",null),n([s()],c.prototype,"_isRotating",null),n([s()],c.prototype,"_isScaling",null),n([s()],c.prototype,"_mostRecentlyShownGrid",void 0),n([s()],c.prototype,"_sketchedVertexCount",void 0),c=n([M("esri.widgets.support.GridControls.GridControlsViewModel")],c);const J=new Q({width:0}),et=new ue({color:_.fromArray([0,0,0,0]),outline:new Q({color:_.fromArray([0,0,0,0])})}),w="esri-grid-controls",f={base:w,borderedSwitch:`${w}__switch--bordered`,container:`${w}__container`,numericInputsContainer:`${w}__numeric-inputs__container`,tilegroup:`${w}__tilegroup`,tile:`${w}__tile`,tileDisabled:`${w}__tile--disabled`,tileContent:`${w}__tile__content`,suffixedInputContainer:`${w}__input-with-suffix__container`,inlineIcon:`${w}__inline-icon`},C={widgetIcon:"grid-unit",gridTheme:{light:"circle",dark:"circle-area",custom:"palette"},placementState:{interactive:"maximum-territory-distance",place:"move",rotate:"rotate"},warning:"exclamation-mark-triangle"},T=_.fromArray([115,115,115]),D=_.fromArray([200,200,200]),tt=["interactive","place","rotate"];let m=class extends be{constructor(e,t){super(e,t),this.customColor=null,this.messages=null,this.messagesUnits=null,this.viewModel=new c,this.visibleElements=new te,ce(K.getLogger(this),"Grid Controls","arcgis-grid-controls",{version:"4.33"})}initialize(){this.addHandles([R(()=>this.viewModel.gridColor,e=>{!e||T.equals(e)||D.equals(e)||(this.customColor=e)},pe)])}loadDependencies(){return Promise.all([we({action:()=>S(()=>import("./index-CPuo0G35-CrRCQ2Ya.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]),import.meta.url),"action-bar":()=>S(()=>import("./index-CwdFwT2M-5WGIIVNT.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,10,11,12,13,0,14,15,16,17,19,20,21,22,23,24,25,26,27,28,29]),import.meta.url),label:()=>S(()=>import("./index-DhiKtjhW-kTAwhIPd.js"),__vite__mapDeps([30,2,3,4,5,6,7,8,31,12]),import.meta.url),icon:()=>S(()=>import("./index-CZRmpYJQ-B_ZQ2kaU.js"),__vite__mapDeps([11,2,3,4,5,6,7,8,12,13]),import.meta.url).then(e=>e.i),popover:()=>S(()=>import("./index-CXfSk3I4-Bs_ihh4m.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,9,10,11,12,13,0,14,15,16,17,20,21,22,23,24,25]),import.meta.url).then(e=>e.i),tooltip:()=>S(()=>import("./index-bZE3dpLT-CSjZXDJ4.js"),__vite__mapDeps([32,2,3,4,5,6,7,8,20,12,21,9,22,24,14]),import.meta.url),"color-picker":()=>S(()=>import("./index-BbU6fgLG-UZ6TDQNO.js"),__vite__mapDeps([33,2,3,4,5,6,7,8,14,12,15,16,34,11,13,35,36,37,25,17,31,38,39,10,40,1,9,41,23,29,21]),import.meta.url),"input-number":()=>S(()=>import("./index-CTg9MlSx-8dimOotN.js"),__vite__mapDeps([40,11,2,3,4,5,6,7,8,12,13,35,36,37,25,14,17,15,31,16,38,39,10]),import.meta.url)}),Pe()])}get icon(){return C.widgetIcon}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages.widgetLabel}set label(e){this._overrideIfSome("label",e)}get snappingManager(){return this.viewModel.snappingManager}set snappingManager(e){this.viewModel.snappingManager=e}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get theme(){const e=this.viewModel.gridColor;return e?T.equals(e)?"dark":D.equals(e)?"light":"custom":null}set theme(e){const{viewModel:t,customColor:i,view:r}=this;switch(e){case"light":t.gridColor=D;break;case"dark":t.gridColor=T;break;case"custom":t.gridColor=i??(r==null?void 0:r.effectiveTheme.accentColor)??T}}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return l("div",{"aria-label":this.label,class:this.classes(f.base,B.widget,B.panel)},l("div",{class:f.container},this._renderContent()))}_renderContent(){const{visibleElements:e}=this;return[e.gridEnabledToggle?this._renderEnabledToggle():null,e.placementButtons?this._renderGridPlacementButtons():null,e.numericInputs?this._renderNumericInputs():null,e.lineIntervalInput?this._renderIntervalInput():null,e.gridSnapEnabledToggle&&this.viewModel.snappingOptions?this._renderSnappingToggle():null,e.dynamicScaleToggle?this._renderDynamicScaleToggle():null,e.rotateWithMapToggle?this._renderRotateToggle():null,e.colorSelection?this._renderColorSelection():null]}_renderGridPlacementButtons(){const{interactivePlacementState:e,placementDisabled:t,gridControlsEnabled:i}=this.viewModel,r=t||!i;return l("calcite-label",{key:"grid-placement-buttons",scale:"s"},this.messages.placementOptions,l("calcite-action-bar",{expandDisabled:!0,layout:"horizontal"},tt.map(o=>this._renderPlacementModeButton(o,r,e))))}_renderPlacementModeButton(e,t,i){const r=this.messages.placementState[e],o=`__placement-action-${e}`;return l("div",null,l("calcite-action",{active:i===e,alignment:"center",disabled:t,icon:C.placementState[e],id:o,onclick:()=>this.viewModel.togglePlacementState(e),text:r}),l("calcite-tooltip",{overlayPositioning:"fixed",placement:"top",referenceElement:o},r))}_renderNumericInputs(){const{rotation:e,spacing:t,effectiveSpacingAfterDynamicScaling:i,numericSpacingInputShouldBeVisible:r,unit:o="meters"}=this.viewModel,a=this.messagesUnits.units[o].abbr,p=this.viewModel.gridControlsEnabled,d=i!=null&&i!==this.viewModel.spacing,h=`__spacing_input_scaled-${this.id}`;return l("div",{class:this.classes(f.numericInputsContainer)},[r?l("calcite-label",{key:"spacing-label",scale:"s"},l("span",null,this.messages.inputLabel.spacing,d?l("calcite-icon",{class:this.classes(f.inlineIcon),icon:C.warning,id:h,scale:"s",tabIndex:0}):void 0),l("div",{class:f.suffixedInputContainer},l("calcite-input-number",{disabled:!p,numberButtonType:"none",suffixText:a,value:`${t==null?void 0:t.toFixed(2)}`,onCalciteInputNumberChange:({currentTarget:g})=>{const b=parseFloat(g.value);this.viewModel.spacing=b,b!==this.viewModel.spacing&&(g.value=`${this.viewModel.spacing}`)}}),d?l("calcite-tooltip",{overlayPositioning:"fixed",placement:"leading",referenceElement:h},Ye(this.messages.warnings.dynamicSpacing,{actualSpacingIncludingUnit:fe(this.messagesUnits,i,o,2,"plural")})):void 0)):void 0,l("calcite-label",{key:"angle-label",scale:"s"},this.messages.inputLabel.angle,l("calcite-input-number",{disabled:!p,integer:!0,numberButtonType:"none",suffixText:this.messagesUnits.units.degrees.abbr,value:`${ne(e)}`,onCalciteInputNumberChange:({currentTarget:g})=>this.viewModel.rotation=Ze(g.value)}))])}_renderIntervalInput(){const{majorLineInterval:e,gridControlsEnabled:t}=this.viewModel;return l("div",{class:this.classes(f.numericInputsContainer)},l("calcite-label",{scale:"s"},this.messages.inputLabel.interval,l("calcite-input-number",{disabled:!t,integer:!0,max:15,min:1,numberButtonType:"vertical",value:`${e}`,onCalciteInputNumberChange:({currentTarget:i})=>{const r=Number.parseInt(i.value,10);this.viewModel.majorLineInterval=r,r!==this.viewModel.majorLineInterval&&(i.value=`${this.viewModel.majorLineInterval}`)}})))}_renderSnappingToggle(){const{snappingOptions:e,gridControlsEnabled:t}=this.viewModel;return l(I,{checked:!!((e==null?void 0:e.gridEnabled)??!1),disabled:!(t&&e),key:"grid-snap-enabled-toggle",label:this.messages.switchLabel.snap,onChange:i=>{var r;return(r=this.viewModel.snappingOptions)==null?void 0:r.set("gridEnabled",i)}})}_renderDynamicScaleToggle(){const{viewModel:e,messages:t}=this,i=this.visibleElements.outOfScaleWarning&&e.gridOutOfScale;return l(I,{checked:e.dynamicScaling,disabled:!e.gridControlsEnabled,hint:i?t.warnings.outOfScale:void 0,hintIcon:C.warning,hintKind:"warning",key:`grid-dynamic-scale-toggle-${this.id}`,label:t.switchLabel.scaling,onChange:r=>e.dynamicScaling=r})}_renderRotateToggle(){const{gridControlsEnabled:e,rotateWithMap:t}=this.viewModel;return l(I,{checked:t,disabled:!e,key:"grid-rotate-map-toggle",label:this.messages.switchLabel.rotateWithMap,onChange:i=>this.viewModel.rotateWithMap=i})}_renderEnabledToggle(){return l("div",{class:f.borderedSwitch},l(I,{checked:this.viewModel.displayEnabled,disabled:!!this.viewModel.interactivePlacementState,key:"grid-enabled-toggle",label:this.messages.switchLabel.display,onChange:e=>this.viewModel.trySetDisplayEnabled(e)}))}_renderColorSelection(){const{customColor:e}=this,t=`${this.id}--custom-grid-color-button`;return l("calcite-label",{scale:"s"},this.messages.inputLabel.theme,l("div",{class:f.tilegroup},[this._renderThemeTile({value:"dark"}),this._renderThemeTile({value:"light"}),this._renderThemeTile({value:"custom",id:t}),l("calcite-popover",{autoClose:!0,label:this.messages.gridLineColorPopoverLabel,overlayPositioning:"fixed",referenceElement:t},l("calcite-color-picker",{alphaChannel:!0,savedDisabled:!0,value:(e==null?void 0:e.toHex({digits:8}))??"#000000ff",onCalciteColorPickerChange:i=>{const r=_.fromHex(i.currentTarget.value);r&&(this.customColor=r,this.theme="custom")}}))]))}_renderThemeTile(e){const{theme:t}=this,{value:i}=e,r=this.messages.gridTheme[i],o=`${this.id}--theme_tile_${i}`,a=`${o}__label`,p=C.gridTheme[i],d=this.viewModel.gridControlsEnabled;return l("div",{class:Se({[f.tile]:!0,[f.tileDisabled]:!d}),id:e.id,role:"button"},l("input",{"aria-labelledby":a,checked:t===i,disabled:!d,id:o,name:`${this.id}--theme`,onchange:h=>{var g;this.theme=i,(g=h.target)==null||g.focus()},tabIndex:0,type:"radio"}),l("div",{class:f.tileContent},l("calcite-icon",{icon:p,scale:"l"}),l("calcite-label",{for:o,id:a},r)))}};n([s({type:_})],m.prototype,"customColor",void 0),n([s()],m.prototype,"icon",null),n([s()],m.prototype,"label",null),n([s(),W("esri/widgets/support/GridControls/t9n/GridControls")],m.prototype,"messages",void 0),n([s(),W("esri/core/t9n/Units")],m.prototype,"messagesUnits",void 0),n([s()],m.prototype,"snappingManager",null),n([s()],m.prototype,"snappingOptions",null),n([s()],m.prototype,"theme",null),n([s()],m.prototype,"view",null),n([s({type:c})],m.prototype,"viewModel",void 0),n([s({type:te,nonNullable:!0})],m.prototype,"visibleElements",void 0),m=n([M("esri.widgets.support.GridControls")],m);const ar=m;export{ar as default};
