import{iO as z}from"./index-uAe2c5m-.js";import{c as E,U as v}from"./Indices-DkAzsiH--JL5lz1jx.js";function F(i,n,r){const l=Array.isArray(i),e=l?i.length/n:i.byteLength/(4*n),A=l?i:new Uint32Array(i,0,e*n),g=(r==null?void 0:r.minReduction)??0,a=(r==null?void 0:r.originalIndices)||null,q=a?a.length:0,u=(r==null?void 0:r.componentOffsets)||null;let c=0;if(u)for(let t=0;t<u.length-1;t++){const s=u[t+1]-u[t];s>c&&(c=s)}else c=e;const w=Math.floor(1.1*c)+1;(h==null||h.length<2*w)&&(h=new Uint32Array(z(2*w)));for(let t=0;t<2*w;t++)h[t]=0;let f=0;const U=!!u&&!!a,b=U?q:e;let y=E(e);const p=new Uint32Array(q),O=1.96;let C=g!==0?Math.ceil(4*O*O/(g*g)*g*(1-g)):b,d=1,I=u?u[1]:b;for(let t=0;t<b;t++){if(t===C){const o=1-f/t;if(o+O*Math.sqrt(o*(1-o)/t)<g)return null;C*=2}if(t===I){for(let o=0;o<2*w;o++)h[o]=0;if(a)for(let o=u[d-1];o<u[d];o++)p[o]=y[a[o]];I=u[++d]}const s=U?a[t]:t,L=s*n,k=j(A,L,n);let m=k%w,x=f;for(;h[2*m+1]!==0;){if(h[2*m]===k){const o=h[2*m+1]-1;if(R(A,L,o*n,n)){x=y[o];break}}m++,m>=w&&(m-=w)}x===f&&(h[2*m]=k,h[2*m+1]=s+1,f++),y[s]=x}if(g!==0&&1-f/e<g)return null;if(U){for(let t=u[d-1];t<p.length;t++)p[t]=y[a[t]];y=v(p)}const M=l?new Array(f):new Uint32Array(f*n);f=0;for(let t=0;t<b;t++)y[t]===f&&(Z(A,(U?a[t]:t)*n,M,f*n,n),f++);if(a&&!U){const t=new Uint32Array(q);for(let s=0;s<t.length;s++)t[s]=y[a[s]];y=v(t)}return{buffer:Array.isArray(M)?M:M.buffer,indices:y,uniqueCount:f}}function R(i,n,r,l){for(let e=0;e<l;e++)if(i[n+e]!==i[r+e])return!1;return!0}function Z(i,n,r,l,e){for(let A=0;A<e;A++)r[l+A]=i[n+A]}function j(i,n,r){let l=0;for(let e=0;e<r;e++)l=i[n+e]+l|0,l=l+(l<<11)+(l>>>2)|0;return l>>>0}let h=null;export{F as v};
