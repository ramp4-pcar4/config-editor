const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CXn0Qeo5-BikhBr7G.js","./index-D0o7KJz6-CPX7tO-w.js","./jsxFactory-Cua8zWVZ-CthLb4jb.js","./index-aQr1pzMk.js","./index-BQSptJp9.css","./intl-BAA1onnp-ubjHiDMN.js","./uuid-Dj9mdEVg-BaKSCiyT.js","./sanitizerUtils-B1yRmbO2-B7KG_jBT.js","./guid-Dls486Er-CBh637k4.js","./useT9n-Cp7CFBMO-lGl9osPB.js","./index-DV38aJMs-BJQkz9HV.js","./dom-PjyVZjPa-B9g4yASx.js","./observers-CJ7vGAr1-B2Nl0uJU.js","./keyed-B9HAtbdo-BAVncOzA.js","./ref-XMc4F1eh-BRoZ_NEh.js","./interactive-EVx-Nhoa-Dng9ehHY.js","./component-DGkKmsFn-CnscdY-W.js","./index-DO-jU4VZ-BT8zawte.js","./index-Btp8sfgk-DF0Oekmp.js","./floating-ui-C_auppeo-CCug3BQR.js","./debounce-B9WUP9Xk-BvexrlwN.js","./openCloseComponent-CAhwMrL1-D0gM6pUE.js","./static-Dm6M7dSg-_X9q65Ea.js","./FloatingArrow-BFsffpOS-Hm3tcUWB.js","./key-CZySMiwx-kmS7VeUz.js","./index-BCOMKfi--CqBF2-wj.js","./array-C6Ny8gbM-C9M-r-JU.js","./index-B4aE1io5-v0Lzkq4s.js","./intersectsOperator-ZBnSpPTv-h7bhf_n3.js","./ProjectionTransformation-DQ4GElxa-B-5LitAV.js","./Envelope2D-DlBzXkgv-eKRxGysX.js","./Point2D-CaHJVGk1-JqvJXjLr.js","./Transformation2D-CXWnDKXs-bixc63yn.js","./SimpleGeometryCursor-DSF_YyIm-TAMgMsbK.js","./OperatorDefinitions-DJdq_wrt-DP7_WWTp.js","./jsonConverter-tsQ40CV0-Ds3ts1sY.js","./OperatorIntersects-u5auAqUh-O6qYow03.js","./apiConverter-CSuukuP9-B33Twu7m.js","./DrawScreenTool-CPEYpMPF-D_85raLe.js","./mat2df64-DDXwUeaJ-Tu7q-7Mk.js","./drawSurfaces-DQUGW1oK-Cyv0sdGJ.js","./vec32-Cj8pVsU0-rAn6oDuj.js","./common-CYWrYyJl-E8-sukrT.js","./geodesicUtils-DKS2UG72-CeOPBgTk.js","./projectionUtils-B-CplN3q-BbhRJk9h.js","./distanceOperator-CZDvZf3O-BYcwkajk.js","./simplifyOperator-BW9Vrh-l-DM_7k28J.js","./operatorSimplify-CjcRb60U-ChP9ia2B.js","./mat2d-BQA-1WB--Pnyy0dhf.js","./quat-DQgq9Ar5-NhE9rfpI.js","./mat3f64-BnNZDR5l-Bz3OL2oI.js","./quatf64-C16JxGFv-BKWK1F8U.js","./vec42-D8CJyqHG-DnfLTeQH.js","./memoize-DvEt8OkT-Cy_RrfpZ.js","./ReactiveSet-CRNikQMW-DFxcU30x.js","./diffUtils-BxG8DCnW-D9r0MZld.js","./UpdatingHandles-Bd2FQ26N-D0o90byg.js","./elevationInfoUtils-Ccn2Wfoe-7Qv8vGZC.js","./ElevationInfo-DE5to86a-Dif5vpxY.js","./lengthUtils-C61nRlXw-CzVJi303.js","./ViewingMode-CdRKcXnc-Dab70bGf.js","./SnappingContext-OY7xJ98b-DU9m8U_i.js","./vec2-BnynUbeJ-CKtGJQAy.js","./vec2f64-CkowXrDb-3zFQ3LNH.js","./vec4f64-DD-nkcCV-CSNWKRqG.js","./plane-Cf3Koz3c-CMtlASO9.js","./vectorStacks-5ZZtmT9E-Bv7Sf72y.js","./mat4f64-xsZDPPj0-Dq35B4BL.js","./SketchViewModel-B0qFHK0t-BTuGEowy.js","./GraphicsLayer-BiEC2-gS-f2Q6Nh51.js","./GraphicsCollection-uWAVmks7-KvlwAqnq.js","./Layer-DvVVmz9x-DXcwhpQA.js","./TimeExtent-Cf2Pienb-BYO88qJi.js","./BlendLayer-DjW_5k0v-CSXvsFcj.js","./layerContainerType-ChWdCT09-G5sdAsSy.js","./jsonUtils-BwLwuQj7-Bl4H4NPY.js","./parser-CWccHtwJ-BmmlC3EC.js","./mat4f32-BdRMyjXW-CWt6U0BP.js","./mat4-OOmHNWi7-DHX-Tx_w.js","./ScaleRangeLayer-x42fwED3-BqbNZfS1.js","./editableLayers-DFUBlMJy-DC6mxTZ5.js","./utils-Dd8gTonD-DroETE_5.js","./Queue-DV3gpSdl-DdymP2a7.js","./Version-CnwD6MZa-DfTCvK9g.js","./Cyclical-DgD7_U1C-BgcrDUEq.js","./quantityUtils-B1Ov7DZK-DnKxWiam.js","./projectVectorToVector-DcyiGOWJ-BAdltgHe.js","./projectPointToVector-BZJhoF_5-D8QAojxL.js","./asyncUtils-BPUlNCrX-CgQ-bqnN.js","./Query-n1aoaaFC-B-POeiNR.js","./Field-BIQ-quF4-BtlvGEij.js","./fieldType-PhcL4ff8-x0uMaf6W.js","./sphere-zPMQWhGG-C75YL2Lm.js","./mat3-DOnW3DjW-C3hbW9XY.js","./geodeticLengthOperator-DHGBHzf3-DNCLtrqI.js","./geodeticCurveType-D_etKnbP-CirnHLSB.js","./earcut-C6NeZYSh-Da0ULCQ5.js","./triangle-BM89wdHY-SwW9lpY9.js","./lineSegment-BAWQVP9P-ZXi9xCTQ.js","./spatialReferenceEllipsoidUtils-BK0OQJn2-CMEt8kso.js","./meshVertexSpaceUtils-CCr86FVF-hh4hgaxp.js","./MeshLocalVertexSpace-Cfxtmv6L-CoMZ3E57.js","./hydratedFeatures-oobA80ei-BknNjAAw.js","./Scheduler-BV4C4cVP-Zy2poEKN.js","./debugFlags-8tOwPnHK-DspbDTNZ.js","./index-BlA0IWNf-BNcwMC8x.js","./index-CjNVVdGY-BuwUaas1.js","./label-DeyAgFGa-B6y3C0Tf.js","./index-DGUkrUiU-DDBm-20E.js","./form-D_5VLLzu-CjU26Kh3.js","./index-CsuaBzKX-DR6Y5X37.js","./index-RR6plZPA-BIT1pfNf.js","./customElement-vwINhat1-22TlqRvj.js","./index-SHU2v0hF-BdgjjC1n.js","./dynamicClasses-CFULUtQ8-Bg5tAS65.js","./index-B_Cy04Um-X9jVfkR8.js","./resources6-Duvedxls-DbbvfBW6.js","./index-9QKYyV7q-BLCcgt4N.js","./_sortable-Bi1e6b9P-WK03rXRB.js","./index-BoYi6noz-DjbWpBGP.js","./index-lZpkjGTp-Bysh8oFd.js","./index-SxXZaKTz-CmkYRi0j.js","./Validation-DwCZur7y-CWj1DDEe.js","./Legend-BMS5EVNm-CTSvMVSS.js","./featureReductionUtils-CT3zJdMo-COEl9dk_.js","./EffectView-Bpu5U548-DZvuiWD8.js","./displayFilterUtils-DvWUbJDp-BlFMu0bf.js","./ExportImageParameters-CC1oba-O-Z8_Bjz1W.js","./scaleUtils-Br-smv3A-BbeNmaYp.js","./floorFilterUtils-4r-vVdzs-u-jw2p7F.js","./sublayerUtils-DUalPlkE-Ds59ngbJ.js","./pixelRangeUtils-DcEknavd-CueOHV1N.js","./jsonUtils-CzRaZnmS-slPQ_gr_.js","./typeUtils-CB2EGBWO-BLI0FabS.js","./ClassBreaksRenderer-Bq2XGpfI-4ERU6Qcc.js","./commonProperties-CJLeiNuA-BmstD1xT.js","./colorRamps-trM-CPFS-coe6frxf.js","./ColorStop-CL7v3R-A-CWDYnaFQ.js","./visualVariableUtils-BTS148WR-COpYdl2V.js","./RendererLegendOptions-Bil_IDab-Cy019d95.js","./LRUCache-DPWdPNTF-BhV6gJVw.js","./MemCache-qDGoejB7-Bz_y0gIH.js","./DictionaryScriptEvaluator-DW5hOK9A-QDplmcz_.js","./FieldsIndex-Bt0Y8aWr-BpPxKhnV.js","./UnknownTimeZone-DxjyzFvs-D03QDRmB.js","./timeZoneUtils-d5p0Jda1-DINixOSa.js","./ArcadeExpression-XjY3x7KV-C7Vuk4ae.js","./TimeOnly-CGkId3bj-Da-7Q4Fn.js","./enum-g1DWyQyu-Jw9m_iA7.js","./utils-BfXZnjCE-CI1-4GRM.js","./defaultCIMValues-BcSaJjm--58G-soMN.js","./enums-a_LDTPYU-CBIcy3mM.js","./heatmapUtils-DRTN9U3a-CoONj_Tq.js","./SimpleRenderer-C1YRhRzu-5zq6rydG.js","./UniqueValueRenderer-CLXHFtg9-DwONv5B5.js","./styleUtils-DBPDLVBX-CubQZ8CT.js","./rendererConversion-koUEkXyy-BHlkN55z.js","./cimSymbolUtils-DCedSSCN-Dgta8Y1z.js","./symbolUtils-D5Wjfwrf-BBxSDIGf.js","./utils-Cb2uXNfG-BRHzJTey.js","./colorUtils-Eg6lOlXm-VkhrseNv.js","./mat2df32-fg3OHsAI-BF2V2zqo.js","./webStyleSymbolUtils-r0H5toyk-HAApXC-7.js","./devEnvironmentUtils-CxrVv3RG-ktR0Kqgv.js","./heatmapRampUtils-IW6a557l-CZiAE6VN.js","./utils-CdIngiRE-B_bQkCnp.js","./previewCIMSymbol-CVZYVI5l-BVkaV5DP.js","./CIMSymbolHelper-34UsTwam-Czf_50t2.js","./BidiEngine-DusKzrO8-BlAgW8mu.js","./fontUtils-C37p4Hgq-B9EI6r10.js","./OptimizedGeometry-pzfNw1AT-DQmyFD5U.js","./memoryEstimations-DeWfxwaV-BEOBMvAl.js","./GeometryUtils-B8e3Iwyx-BZ8F7R_I.js","./definitions-MCCItX4r-o3EUznKY.js","./rasterizingUtils-1wASRzSP-vB261-s6.js","./floatRGBA-DRFmbkvz-Bbcow0tp.js","./vec2f32-hTAvipMV-C0AQcwEv.js","./Rect-DD6XS68q-D_hsV3ag.js","./BoundingBox-DlCd_wcU-DBB4UfPl.js","./CIMSymbolRasterizer-CHPajZH1-BAFvnorx.js","./CIMResourceManager-DyRf92xI-WSZrgHcz.js","./imageUtils-D3tfFRL_-CQReEzWX.js","./OverrideHelper-DgyARgwI-c8GsR7Fj.js","./callExpressionWithFeature-Bk8k1lJI-ChYU8ypG.js","./quantizationUtils-D907S7Bm-JcivzglI.js","./modeUtils-deizL-Tg-C4WiXKJs.js","./substitute-B3zxyWVi-BDGmS5en.js","./index-CK6nlFfs-DJ99onD6.js","./index-4OY0nObJ-C-yBnG8d.js","./customElement-DL8inR2X-do7LlDFG.js","./input-BpGQpkEK-CIPZph1Z.js","./index-CoujZeLU-C5fmXmsj.js","./utils-B0t9gNXC-Bg5iMy8w.js","./index-DbQfb_U2-KZf_9OE2.js","./resources5-GI0SvXPJ-DQyKCby-.js","./index-B-et6CSq-BDrNUajc.js","./GridControls-HOcRkVVE-Dt5rVc3K.js","./unitFormatUtils-FAypDaT5-CYycS-OR.js","./ByteSizeUnit-DL8UhsB0-B2-AmVRx.js","./SketchTooltipInfo-CkyYTifq-BSv201ZI.js","./MeshTransform-ByFk-Izc-DTlSS00a.js","./axisAngleDegrees-BTSCyz4U-qoidsW1f.js","./a11yUtils-CoCwThtH-CLYp1_Ta.js","./gridUtils-ZkKc2j-y-Bf9-NS1h.js","./normalizeUtils-u00NGW3M-8Ej-Vv-t.js","./normalizeUtilsCommon-ClagynAA-CvakA4bY.js","./utils-BO8hgPs3-R1XXoFdI.js","./utils-DpLVEUvg-CzvbbwOQ.js","./editingTools-7dqMzBcg-DsDdnb4r.js","./SnappingVisualizer2D-Di4uotAR-CGMBSSzB.js","./TooltipInfoWithCoordinates-Xxefy9Or-CSYZony3.js","./PointSnappingHint-OKXicQ1z-xbpjqpQD.js","./editPlaneUtils-DmK-4boe-w6XUGa7-.js","./boundedPlane-QDtjx5eO-Dx-oLj9s.js","./GraphicManipulator-D_ewLKOT-BMGhSXb7.js","./drapedUtils-DARF9dbf-Bqd8pPG3.js","./drawUtils-pJlGx3nm-CeXYJWOC.js","./draw-store-DnCf4IRI-BY4bSfym.js","./layerViewUtils-DLIaYA64-D47NUDfp.js","./utils-C0LvbFCo-RMQaTNpt.js","./widget-p2YDjs4S-CMTLwXqb.js","./TextOverlayItem-BwTcOTWP-CbblMoD7.js","./number-mnL_JN3f-B43aHrCU.js","./circle-icon-qM-Cul3g-DsLV7Twh.js","./edit-icon-BBpkepd0-DfFC2xvQ.js","./point-icon-Dd_kLleb-DcsCqKrZ.js","./polygon-icon-CnplOIHx-Dtmq8G5B.js","./polyline-icon-BmsBSMJm-C1zf3Ijy.js","./rectangle-icon-DaWElXKE-BRE9zRq5.js"])))=>i.map(i=>d[i]);
var Li=Object.defineProperty;var Nt=e=>{throw TypeError(e)};var Si=(e,t,i)=>t in e?Li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var $t=(e,t,i)=>Si(e,typeof t!="symbol"?t+"":t,i),vt=(e,t,i)=>t.has(e)||Nt("Cannot "+i);var Ze=(e,t,i)=>(vt(e,t,"read from private field"),i?i.call(e):t.get(e)),Fe=(e,t,i)=>t.has(e)?Nt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),bt=(e,t,i,l)=>(vt(e,t,"write to private field"),l?l.call(e,i):t.set(e,i),i),Je=(e,t,i)=>(vt(e,t,"access private method"),i);import{v as o,S as n,K as Ct,a0 as re,bv as Oi,l as st,ce as ki,Z as le,ao as Pi,_,b3 as at,aD as Ii,a6 as ge,a1 as L,a4 as Ke,aH as Xt,gb as Yt,aL as pt,ax as Lt,au as ei,ak as De,gc as Ri,gd as Ai,ge as xi,ac as oe,aO as Xe,a8 as ye,I as Di,gf as Vi,gg as Bi,gh as Ne,gi as Gi,gj as Fi,gk as Ni,gl as $i,fv as Hi,n as O,p as zi,a2 as K,fz as Ui,fA as Wi,gm as Ki,gn as ji,fL as Ht,fM as qi,fx as ti,go as Qi,fD as Zi,fP as Ji,g6 as Xi,aU as St,gp as Yi,ab as eo,a7 as to,gq as io,gr as oo,gs as ii,aG as so,a3 as wt,h as lo,gt as no,aj as zt,ai as ro,gu as ao,gv as po,g2 as co,eT as ho,eK as Ye,eJ as Ut,eu as uo,ba as Te,B as Ee,gw as go,gx as yo,gy as mo,gz as vo,gA as bo,gB as wo}from"./index-aQr1pzMk.js";import{y as Ot}from"./draw-store-DnCf4IRI-BY4bSfym.js";import _o from"./GraphicsLayer-BiEC2-gS-f2Q6Nh51.js";import{S as fo}from"./intl-BAA1onnp-ubjHiDMN.js";import{O as To,Q as Wt,w as oi,P as si,$ as Eo,E as li,r as Mo,k as $e}from"./SketchViewModel-B0qFHK0t-BTuGEowy.js";import{K as h,H as Co,P as be,V as me,W as ae,Z as ni,z as Lo}from"./jsxFactory-Cua8zWVZ-CthLb4jb.js";import{V as et,i as So,f as kt}from"./utils-Dd8gTonD-DroETE_5.js";import{f as lt}from"./layerViewUtils-DLIaYA64-D47NUDfp.js";import{g as ri}from"./asyncUtils-BPUlNCrX-CgQ-bqnN.js";import{x as Oo,y as ko}from"./drapedUtils-DARF9dbf-Bqd8pPG3.js";import{n as Kt}from"./utils-C0LvbFCo-RMQaTNpt.js";import{s as jt,o as Po}from"./widget-p2YDjs4S-CMTLwXqb.js";import{b as qt}from"./substitute-B3zxyWVi-BDGmS5en.js";import"./GraphicsCollection-uWAVmks7-KvlwAqnq.js";import"./Layer-DvVVmz9x-DXcwhpQA.js";import"./TimeExtent-Cf2Pienb-BYO88qJi.js";import"./BlendLayer-DjW_5k0v-CSXvsFcj.js";import"./layerContainerType-ChWdCT09-G5sdAsSy.js";import"./jsonUtils-BwLwuQj7-Bl4H4NPY.js";import"./parser-CWccHtwJ-BmmlC3EC.js";import"./mat4f32-BdRMyjXW-CWt6U0BP.js";import"./mat4-OOmHNWi7-DHX-Tx_w.js";import"./common-CYWrYyJl-E8-sukrT.js";import"./ScaleRangeLayer-x42fwED3-BqbNZfS1.js";import"./ElevationInfo-DE5to86a-Dif5vpxY.js";import"./lengthUtils-C61nRlXw-CzVJi303.js";import"./UpdatingHandles-Bd2FQ26N-D0o90byg.js";import"./projectionUtils-B-CplN3q-BbhRJk9h.js";import"./elevationInfoUtils-Ccn2Wfoe-7Qv8vGZC.js";import"./editableLayers-DFUBlMJy-DC6mxTZ5.js";import"./Cyclical-DgD7_U1C-BgcrDUEq.js";import"./quantityUtils-B1Ov7DZK-DnKxWiam.js";import"./vec2-BnynUbeJ-CKtGJQAy.js";import"./vec2f64-CkowXrDb-3zFQ3LNH.js";import"./vec32-Cj8pVsU0-rAn6oDuj.js";import"./projectVectorToVector-DcyiGOWJ-BAdltgHe.js";import"./projectPointToVector-BZJhoF_5-D8QAojxL.js";import"./geodesicUtils-DKS2UG72-CeOPBgTk.js";import"./Query-n1aoaaFC-B-POeiNR.js";import"./Field-BIQ-quF4-BtlvGEij.js";import"./fieldType-PhcL4ff8-x0uMaf6W.js";import"./vec42-D8CJyqHG-DnfLTeQH.js";import"./vec4f64-DD-nkcCV-CSNWKRqG.js";import"./plane-Cf3Koz3c-CMtlASO9.js";import"./vectorStacks-5ZZtmT9E-Bv7Sf72y.js";import"./mat3f64-BnNZDR5l-Bz3OL2oI.js";import"./mat4f64-xsZDPPj0-Dq35B4BL.js";import"./quatf64-C16JxGFv-BKWK1F8U.js";import"./sphere-zPMQWhGG-C75YL2Lm.js";import"./mat3-DOnW3DjW-C3hbW9XY.js";import"./geodeticLengthOperator-DHGBHzf3-DNCLtrqI.js";import"./geodeticCurveType-D_etKnbP-CirnHLSB.js";import"./earcut-C6NeZYSh-Da0ULCQ5.js";import"./triangle-BM89wdHY-SwW9lpY9.js";import"./lineSegment-BAWQVP9P-ZXi9xCTQ.js";import"./spatialReferenceEllipsoidUtils-BK0OQJn2-CMEt8kso.js";import"./uuid-Dj9mdEVg-BaKSCiyT.js";import"./sanitizerUtils-B1yRmbO2-B7KG_jBT.js";import"./Queue-DV3gpSdl-DdymP2a7.js";import"./Version-CnwD6MZa-DfTCvK9g.js";const Io=(e,t,i)=>{const l=e[t];return l?typeof l=="function"?l():Promise.resolve(l):new Promise((s,r)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(r.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==i?". Note that variables only represent file names one level deep.":""))))})};let U=class extends oe{constructor(e){super(e),this.colorSelection=!0,this.dynamicScaleToggle=!0,this.gridEnabledToggle=!0,this.numericInputs=!0,this.gridSnapEnabledToggle=!0,this.lineIntervalInput=!0,this.outOfScaleWarning=!0,this.placementButtons=!0,this.rotateWithMapToggle=!0}};o([n({type:Boolean,nonNullable:!0})],U.prototype,"colorSelection",void 0),o([n({type:Boolean,nonNullable:!0})],U.prototype,"dynamicScaleToggle",void 0),o([n({type:Boolean,nonNullable:!0})],U.prototype,"gridEnabledToggle",void 0),o([n({type:Boolean,nonNullable:!0})],U.prototype,"numericInputs",void 0),o([n({type:Boolean,nonNullable:!0})],U.prototype,"gridSnapEnabledToggle",void 0),o([n({type:Boolean,nonNullable:!0})],U.prototype,"lineIntervalInput",void 0),o([n({type:Boolean,nonNullable:!0})],U.prototype,"outOfScaleWarning",void 0),o([n({type:Boolean,nonNullable:!0})],U.prototype,"placementButtons",void 0),o([n({type:Boolean,nonNullable:!0})],U.prototype,"rotateWithMapToggle",void 0),U=o([O("esri.widgets.support.GridControls.VisibleElements")],U);const ai=U;let W=class extends oe{constructor(e){super(e),this.enabledToggle=!0,this.featureEnabledToggle=!0,this.gridEnabledToggle=!0,this.header=!1,this.layerList=!0,this.gridControls=!0,this.gridControlsElements=new ai({gridSnapEnabledToggle:!1,gridEnabledToggle:!1}),this.layerListToggleLayersButton=!0,this.selfEnabledToggle=!0}};o([n({type:Boolean,nonNullable:!0})],W.prototype,"enabledToggle",void 0),o([n({type:Boolean,nonNullable:!0})],W.prototype,"featureEnabledToggle",void 0),o([n({type:Boolean,nonNullable:!0})],W.prototype,"gridEnabledToggle",void 0),o([n({type:Boolean,nonNullable:!0})],W.prototype,"header",void 0),o([n({type:Boolean,nonNullable:!0})],W.prototype,"layerList",void 0),o([n({type:Boolean,nonNullable:!0})],W.prototype,"gridControls",void 0),o([n({type:ai,nonNullable:!0})],W.prototype,"gridControlsElements",void 0),o([n({type:Boolean,nonNullable:!0})],W.prototype,"layerListToggleLayersButton",void 0),o([n({type:Boolean,nonNullable:!0})],W.prototype,"selfEnabledToggle",void 0),W=o([O("esri.widgets.support.SnappingControls.VisibleElements")],W);const ht=W;let z=class extends oe{constructor(e){super(e),this.point=!0,this.polyline=!0,this.polygon=!0,this.rectangle=!0,this.circle=!0,this.multipoint=!0,this.mesh=!0,this.freehandPolyline=!1,this.freehandPolygon=!1}};o([n({type:Boolean,nonNullable:!0})],z.prototype,"point",void 0),o([n({type:Boolean,nonNullable:!0})],z.prototype,"polyline",void 0),o([n({type:Boolean,nonNullable:!0})],z.prototype,"polygon",void 0),o([n({type:Boolean,nonNullable:!0})],z.prototype,"rectangle",void 0),o([n({type:Boolean,nonNullable:!0})],z.prototype,"circle",void 0),o([n({type:Boolean,nonNullable:!0})],z.prototype,"multipoint",void 0),o([n({type:Boolean,nonNullable:!0})],z.prototype,"mesh",void 0),o([n({type:Boolean,nonNullable:!0})],z.prototype,"freehandPolyline",void 0),o([n({type:Boolean,nonNullable:!0})],z.prototype,"freehandPolygon",void 0),z=o([O("esri.widgets.Sketch.VisibleElements.CreateToolVisibilityMap")],z);let ke=class extends oe{constructor(e){super(e),this["rectangle-selection"]=!0,this["lasso-selection"]=!0,this["custom-selection"]=!0}};o([n({nonNullable:!0})],ke.prototype,"rectangle-selection",void 0),o([n({nonNullable:!0})],ke.prototype,"lasso-selection",void 0),o([n({nonNullable:!0})],ke.prototype,"custom-selection",void 0),ke=o([O("esri.widgets.Sketch.VisibleElements.SelectionToolVisibilityMap")],ke);let N=class extends oe{constructor(e){super(e),this.createTools=new z,this.directionModePicker=!1,this.duplicateButton=!0,this.deleteButton=!0,this.selectionCountLabel=!0,this.labelsToggle=!0,this.selectionTools=new ke,this.settingsMenu=!0,this.snappingControls=!0,this.snappingControlsElements=new ht,this.tooltipsToggle=!0,this.undoRedoMenu=!0}};o([n({type:z,nonNullable:!0})],N.prototype,"createTools",void 0),o([n({type:Boolean,nonNullable:!0})],N.prototype,"directionModePicker",void 0),o([n({type:Boolean,nonNullable:!0})],N.prototype,"duplicateButton",void 0),o([n({type:Boolean,nonNullable:!0})],N.prototype,"deleteButton",void 0),o([n({type:Boolean,nonNullable:!0})],N.prototype,"selectionCountLabel",void 0),o([n({type:Boolean,nonNullable:!0})],N.prototype,"labelsToggle",void 0),o([n({type:ke,nonNullable:!0})],N.prototype,"selectionTools",void 0),o([n({type:Boolean,nonNullable:!0})],N.prototype,"settingsMenu",void 0),o([n({type:Boolean,nonNullable:!0})],N.prototype,"snappingControls",void 0),o([n({type:ht,nonNullable:!0})],N.prototype,"snappingControlsElements",void 0),o([n({type:Boolean,nonNullable:!0})],N.prototype,"tooltipsToggle",void 0),o([n({type:Boolean,nonNullable:!0})],N.prototype,"undoRedoMenu",void 0),N=o([O("esri.widgets.Sketch.VisibleElements")],N);const x={groupSeparator:1,action:{s:32,m:48,l:64},splitButtonPart:{horizontal:{s:16,m:16,l:24},vertical:{s:16,m:24,l:40}}},pi={splitButton:{horizontal:"chevron-down",vertical:"ellipsis"},overflow:"ellipsis"};function di(e,t){var i;return e.vnodeSelector===t?[e]:((i=e.children)==null?void 0:i.flatMap(l=>di(l,t)))??[]}const Pt=e=>{let t=class extends e{constructor(){super(...arguments),this.priority=0,this.scale="m",this.slot=void 0,this.lastActiveKey=null,this.layout="horizontal"}destroy(){var i;(i=this.measurementManager)==null||i.managedElements.remove(this),this.measurementManager=null}set measurementManager(i){const l=this._get("measurementManager");i!==l&&(l&&l.managedElements.remove(this),this._set("measurementManager",i),i==null||i.managedElements.add(this))}set budgetedLength(i){this.budgetedLength!==i&&(this._set("budgetedLength",i),this.scheduleRender())}get actionChildren(){var i;return((i=this.children)==null?void 0:i.flatMap(l=>di(l,"calcite-action")))??[]}get activeChildElement(){var l;const i=this.actionChildren.find(s=>{var r;return((r=s.properties)==null?void 0:r.active)===!0});return i?(this._set("lastActiveKey",(l=i.properties)==null?void 0:l.key),i):this.lastActiveKey?this.actionChildren.find(s=>{var r;return((r=s.properties)==null?void 0:r.key)===this.lastActiveKey}):void 0}_handleClick(i){i!=null&&i.dataset&&"dataset"in i&&i.dataset.actionKey&&(this.lastActiveKey=i.dataset.actionKey)}};return o([n()],t.prototype,"priority",void 0),o([n()],t.prototype,"measurementManager",null),o([n()],t.prototype,"budgetedLength",null),o([n()],t.prototype,"actionChildren",null),o([n()],t.prototype,"activeChildElement",null),o([n()],t.prototype,"scale",void 0),o([n()],t.prototype,"slot",void 0),o([n()],t.prototype,"lastActiveKey",void 0),o([n()],t.prototype,"layout",void 0),t=o([O("esri.widgets.Sketch.support.ResponsiveToolbar.ToolbarGroupBase")],t),t},Qt=Symbol("on-resize-handle-key");let Me=class extends Pt(ae){constructor(e){super(e),this._measuredWidth=0,this._measuredHeight=0,this._measuredElement=null}destroy(){this._measuredElement=null}get lengthOptions(){return[this.layout==="horizontal"?this._measuredWidth:this._measuredHeight]}render(){return h("div",{afterCreate:e=>{this._measuredElement=e.firstElementChild,this.addHandles(Co(this._measuredElement,()=>{var t,i;this._measuredWidth=((t=this._measuredElement)==null?void 0:t.clientWidth)??0,this._measuredHeight=((i=this._measuredElement)==null?void 0:i.clientHeight)??0}),Qt)},afterRemoved:()=>this.removeHandles(Qt)},this.children)}};o([n()],Me.prototype,"_measuredWidth",void 0),o([n()],Me.prototype,"_measuredHeight",void 0),o([n()],Me.prototype,"lengthOptions",null),o([n()],Me.prototype,"_measuredElement",void 0),Me=o([O("esri.widgets.Sketch.support.ResponsiveToolbar.MeasuredContentGroup")],Me);var Ae;let Ce=(Ae=class extends Pt(ae){constructor(t){super(t),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return be({action:()=>_(()=>import("./index-CXn0Qeo5-BikhBr7G.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url),"action-group":()=>_(()=>import("./index-DO-jU4VZ-BT8zawte.js"),__vite__mapDeps([17,1,2,3,4,5,6,7,8,9,10,11,12,0,13,14,15,16,18,19,20,21,22,23,24,25,26]),import.meta.url).then(t=>t.i),"action-menu":()=>_(()=>import("./index-BCOMKfi--CqBF2-wj.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,12,0,13,14,15,16,18,19,20,21,22,23,24,26]),import.meta.url).then(t=>t.i)})}get minimumLength(){const{actionChildren:t,scale:i}=this;return t.length?this.allowCollapse?x.groupSeparator+x.action[i]*Math.min(t.length,2):x.groupSeparator+x.action[i]*t.length:0}get lengthOptions(){const{actionChildren:t,scale:i,minimumLength:l,allowCollapse:s,priority:r}=this,a=[l];if(t.length<=2||!s||r<1)return a;for(let d=1;d<t.length-1;d++)a.push(l+x.action[i]*d);return a}render(){if(!this.actionChildren.length)return h(ni,null,void 0);const{budgetedLength:t,actionChildren:i,activeChildElement:l,layout:s,slot:r,scale:a}=this,d=Math.floor(t/x.action[a]),p=[],c=[];if(d>=i.length)p.push(...i);else{const g=l??p.at(0);if(p.push(...i.slice(0,d-1)),c.push(...i.slice(d-1)),g&&c.includes(g)){const[v]=c.splice(c.indexOf(g),1),m=p.pop();p.push(v),m&&c.unshift(m)}}return h("calcite-action-group",{key:"overflow-button-group",layout:s,onclick:g=>this._handleClick(g.target),slot:r},p.map(g=>this._renderManagedAction(g)),c.length>0?h("calcite-action-menu",{key:"split-button-dropdown",label:this.messagesCommon.more,overlayPositioning:"fixed"},h("calcite-action",{icon:pi.overflow,key:"split-button-dropdown-trigger",scale:a,slot:"trigger",text:this.messagesCommon.more}),c.map(g=>this._renderManagedAction(g))):void 0)}_renderManagedAction(t){var i,l;return h("calcite-action",{...t==null?void 0:t.properties,"data-action-key":(i=t==null?void 0:t.properties)==null?void 0:i.key,text:((l=t==null?void 0:t.properties)==null?void 0:l.text)??""})}},Ae.vnodeSelector="calcite-action-group",Ae);o([n()],Ce.prototype,"allowCollapse",void 0),o([n()],Ce.prototype,"minimumLength",null),o([n(),me("esri/t9n/common")],Ce.prototype,"messagesCommon",void 0),o([n()],Ce.prototype,"lengthOptions",null),Ce=o([O("esri.widgets.Sketch.support.ResponsiveToolbar.OverflowGroup")],Ce);let ce=class extends oe{constructor(){super(...arguments),this.measuredElement=null,this.managedElements=new re,this.availableLength=0,this.layout="horizontal",this._resizeObserver=new ResizeObserver(()=>{this._measure()})}get _sortedElements(){return[...this.managedElements].sort((e,t)=>t.priority-e.priority)}connect(e){this._resizeObserver.disconnect(),this.measuredElement=e,this._resizeObserver.observe(e),this._measure()}allocate(){const e=new Map,{availableLength:t,_sortedElements:i}=this;let l=0;for(const s of i){const r=s.lengthOptions[0];e.set(s,r),l+=r}for(const s of i)for(;l<t;){const r=e.get(s);if(!r)break;const a=s.lengthOptions.find(p=>p>r);if(!a)break;const d=l-r+a;if(d>t)break;e.set(s,a),l=d}for(const[s,r]of e)s.budgetedLength=r}_measure(){const e=this.measuredElement;this.availableLength=e?this.layout==="horizontal"?e.clientWidth??0:e.clientHeight??0:0,this.allocate()}destroy(){this._resizeObserver.disconnect()}};o([n()],ce.prototype,"measuredElement",void 0),o([n()],ce.prototype,"managedElements",void 0),o([n()],ce.prototype,"_sortedElements",null),o([n()],ce.prototype,"availableLength",void 0),o([n()],ce.prototype,"layout",void 0),ce=o([O("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbarManager")],ce);const Ro={splitButtonBase:"esri-split-button--split-part"};var xe;let Le=(xe=class extends Pt(ae){constructor(t){super(t),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return be({action:()=>_(()=>import("./index-CXn0Qeo5-BikhBr7G.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url),"action-group":()=>_(()=>import("./index-DO-jU4VZ-BT8zawte.js"),__vite__mapDeps([17,1,2,3,4,5,6,7,8,9,10,11,12,0,13,14,15,16,18,19,20,21,22,23,24,25,26]),import.meta.url).then(t=>t.i),"action-menu":()=>_(()=>import("./index-BCOMKfi--CqBF2-wj.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,12,0,13,14,15,16,18,19,20,21,22,23,24,26]),import.meta.url).then(t=>t.i)})}get minimumLength(){const t=this.actionChildren;return t.length?t.length===1?x.action[this.scale]+x.groupSeparator:this.allowCollapse?x.action[this.scale]+x.splitButtonPart[this.layout][this.scale]+x.groupSeparator:x.action[this.scale]*t.length+x.groupSeparator:0}get lengthOptions(){const{actionChildren:t,minimumLength:i,layout:l,scale:s,priority:r,allowCollapse:a}=this;if(t.length<2||r<0||!a)return[i];const d=x.groupSeparator+x.action[s]*t.length;return[x.groupSeparator+x.action[s]+x.splitButtonPart[l][s],d]}render(){if(!this.actionChildren.length)return h(ni,null,void 0);const{actionChildren:t,minimumLength:i,budgetedLength:l,layout:s,slot:r,allowCollapse:a}=this,d=!a||t.length<2||l>i;return h("calcite-action-group",{key:"split-button-group",layout:s,onclick:p=>this._handleClick(p.target),slot:r},d?this._renderUnSplit():this._renderSplit())}_renderSplit(){const{activeChildElement:t,layout:i,actionChildren:l,scale:s,messagesCommon:r}=this,a=t??l.at(0);if(!a)return;const d=l.filter(p=>p!==a);return[this._renderManagedAction(a),h("calcite-action-menu",{key:"split-button-dropdown",label:r.more,overlayPositioning:"fixed",placement:i==="horizontal"?"bottom-end":"right-end"},h("calcite-action",{class:`${Ro.splitButtonBase}--${i}--${this.scale}`,compact:i==="horizontal",icon:pi.splitButton[i],key:"split-button-dropdown-trigger",scale:s,slot:"trigger",text:r.more}),d==null?void 0:d.map(p=>this._renderManagedAction(p)))]}_renderUnSplit(){return this.actionChildren.map(t=>this._renderManagedAction(t))}_renderManagedAction(t){var i,l;return h("calcite-action",{...t==null?void 0:t.properties,"data-action-key":(i=t==null?void 0:t.properties)==null?void 0:i.key,text:((l=t==null?void 0:t.properties)==null?void 0:l.text)??""})}},xe.vnodeSelector="calcite-action-group",xe);o([n()],Le.prototype,"minimumLength",null),o([n()],Le.prototype,"allowCollapse",void 0),o([n()],Le.prototype,"lengthOptions",null),o([n(),me("esri/t9n/common")],Le.prototype,"messagesCommon",void 0),Le=o([O("esri.widgets.Sketch.support.ResponsiveToolbar.SplitButton")],Le);const q="esri-responsive-toolbar",Q={rulerBase:`${q}__ruler`,rulerBarHorizontal:`${q}__ruler--bar`,rulerBarVertical:`${q}__ruler--bar--vertical`,rulerPadVertical:`${q}__ruler--pad--vertical`,rulerPadHorizontal:`${q}__ruler--pad--horizontal`,bar:`${q}__bar`,barHorizontal:`${q}__bar--horizontal`,barVertical:`${q}__bar--vertical`,pad:`${q}__pad`,padVertical:`${q}__pad--vertical`,padHorizontal:`${q}__pad--horizontal`};let ie=class extends ae{constructor(e){super(e),this.scale="m",this.barStyle="floating",this._measurementManager=new ce,this._managedWidgets=new Map}loadDependencies(){return be({"action-bar":()=>_(()=>import("./index-B4aE1io5-v0Lzkq4s.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,8,9,10,11,12,0,13,14,15,16,18,19,20,21,22,23,24,25,26,17]),import.meta.url)})}destroy(){this._measurementManager=De(this._measurementManager),this._managedWidgets.forEach(e=>e.destroy()),this._managedWidgets.clear()}set layout(e){const t=this._get("layout");this._set("layout",e),this._measurementManager&&(this._measurementManager.layout=e),t!==e&&this.scheduleRender()}get _barClasses(){const e=this.barStyle==="docked",t=this.layout==="vertical";return{[Q.barHorizontal]:e&&!t,[Q.barVertical]:e&&t,[Q.bar]:e,[Q.padHorizontal]:!e&&!t,[Q.padVertical]:!e&&t,[Q.pad]:!e}}render(){const{layout:e,scale:t,barStyle:i}=this,l={layout:e,scale:t,expandDisabled:!0,key:"measured-toolbar"},s=i==="docked"?e==="vertical"?Q.rulerBarVertical:Q.rulerBarHorizontal:e==="horizontal"?Q.rulerPadHorizontal:Q.rulerPadVertical;return h("div",null,h("div",{afterCreate:r=>{var a;(a=this._measurementManager)==null||a.connect(r)},class:this.classes(Q.rulerBase,s)}),h("calcite-action-bar",{...l,classes:this._barClasses,floating:i!=="docked",overflowActionsDisabled:!0},this._renderChildren()))}_renderChildren(){var l;if(!this.children)return;const e=this.children.filter(s=>{var r;return((r=s.properties)==null?void 0:r.key)!==void 0&&"group-kind"in s.properties}),t=new Set,i=e.map(s=>{const r=s.properties,a=r.key;t.add(a);const d=this.barStyle==="docked"?r.slot??void 0:void 0,p=r.priority??0,c=r["group-kind"]??"overflow-group",g=r["allow-collapse"]??!0,v=this._managedWidgets.get(a);if(v)return v.children=s.children,v.priority=p,"allowCollapse"in v&&(v.allowCollapse=g),v.slot=d,v.layout=this.layout,v.scale=this.scale,v.measurementManager=this._measurementManager,v;const m={scale:this.scale,priority:p,measurementManager:this._measurementManager,children:s.children,slot:d,layout:this.layout};switch(c){case"split-button":{const T=new Le({...m,allowCollapse:g});return this._managedWidgets.set(a,T),T}case"overflow-group":{const T=new Ce({...m,allowCollapse:g});return this._managedWidgets.set(a,T),T}case"measured-content":{const T=new Me({...m});return this._managedWidgets.set(a,T),T}}}).filter(ye);return Array.from(this._managedWidgets.keys()).filter(s=>!t.has(s)).forEach(s=>{var r;(r=this._managedWidgets.get(s))==null||r.destroy(),this._managedWidgets.delete(s)}),(l=this._measurementManager)==null||l.allocate(),i.map(s=>s.render())}};o([n()],ie.prototype,"scale",void 0),o([n({value:"horizontal"})],ie.prototype,"layout",null),o([n()],ie.prototype,"barStyle",void 0),o([n()],ie.prototype,"_measurementManager",void 0),o([n()],ie.prototype,"_managedWidgets",void 0),o([n()],ie.prototype,"_barClasses",null),ie=o([O("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbar")],ie);async function Ao(e){const{returnFeatureTitleFields:t,returnGeometry:i,selector:l,signal:s,sources:r,view:a}=e;if(!(r!=null&&r.length))return[];const{layers:d,layerViews:p,graphicsLayers:c}=xo(r),g=[];return await at(St(Promise.all([Bo({candidates:g,layers:d,returnFeatureTitleFields:t,returnGeometry:i,selector:l,signal:s,view:a}),Do({candidates:g,layerViews:p,returnGeometry:i,selector:l,signal:s,view:a}),$o({candidates:g,graphicsLayers:c,selector:l})]),s)),g}function xo(e){const t=[],i=[],l=[];return e.forEach(s=>{var r,a;Yi(s)||eo(s)||to(s)?t.push(s):(Xt(s)||Yt(s))&&((r=s.layers)!=null&&r.length)?t.push(...s.layers.toArray()):io(s)&&((a=s.sublayers)!=null&&a.length)?l.push(...s.sublayers.toArray()):oo(s)?l.push(s):lt(s)&&i.push(s)}),{layers:t,layerViews:i,graphicsLayers:l}}async function Do(e){const{candidates:t,layerViews:i,returnGeometry:l,selector:s,signal:r,view:a}=e;s.type!=="point"?await St(Promise.allSettled(i.map(async d=>{const p=Fo(d,s,a,l),c=await d.queryFeatures(p,{signal:r});ii(t,c.features)})),r):await Vo({candidates:t,layerViews:i,selector:s,view:a})}async function Vo({candidates:e,layerViews:t,selector:i,view:l}){const s=l.toScreen(i);if(!s)return;const r=t.map(d=>d.layer),{results:a}=await l.hitTest(s,{include:r});a.forEach(d=>{"graphic"in d&&d.graphic&&e.push(d.graphic)})}async function Bo(e){const{candidates:t,layers:i,returnFeatureTitleFields:l,returnGeometry:s,selector:r,signal:a,view:d}=e;await St(Promise.allSettled(i.map(async p=>{if("isTable"in p&&p.isTable)return;const c=No(p,r,d,l,s),g=await p.queryFeatures(c,{signal:a});ii(t,g.features)})),a)}function ci(e,t,i){return e.type==="point"?Oo(e,"renderer"in t?ko({renderer:t.renderer}):0,i):e}function Go(e,t,i){var p,c;const{fields:l,fieldsIndex:s}=e,r=new Set([e.objectIdField]);"globalIdField"in e&&e.globalIdField!=null&&s.has(e.globalIdField)&&r.add(s.get(e.globalIdField).name);const a="displayField"in e?e.displayField:null,d=ho({displayField:a,fields:l});if(d!=null&&s.has(d)&&r.add(d),"subtypeField"in e&&e.subtypeField!=null){const g=(p=s.get(e.subtypeField))==null?void 0:p.name;if(g!=null&&r.add(g),"utilityNetworks"in t.map&&((c=t.map.utilityNetworks)==null?void 0:c.length)){const v=s.get("assetgroup");v!=null&&v.name&&r.add(v.name);const m=s.get("assettype");m!=null&&m.name&&r.add(m.name)}}return(i||t.requiredFieldsOptions.featureTitleFields)&&"featureTitleFields"in e&&e.featureTitleFields&&e.featureTitleFields.forEach(g=>r.add(g)),Array.from(r.values())}function Fo(e,t,i,l=!0){const s=e.createQuery();return s.outFields=["*"],s.geometry=ci(t,e.layer,i),s.returnGeometry=l,s.outSpatialReference=i.spatialReference,s}function No(e,t,i,l=!1,s=!0){const r=e.createQuery();return r.outFields=Go(e,i,l),r.geometry=ci(t,e,i),r.returnGeometry=s,r.outSpatialReference=i.spatialReference,r}async function $o(e){const{candidates:t,graphicsLayers:i,selector:l}=e,s=i.flatMap(a=>a.graphics.toArray())??[];if(!(s!=null&&s.length)||!l)return;const r=await _(()=>import("./intersectsOperator-ZBnSpPTv-h7bhf_n3.js"),__vite__mapDeps([28,29,30,31,32,33,3,4,34,35,36,37]),import.meta.url).then(a=>a.i);r.accelerateGeometry(l),s.forEach(a=>{a.geometry&&a.geometry.type!=="mesh"&&r.execute(l,a.geometry)&&t.push(a)})}const Ho=100;let k=class extends Ct.EventedAccessor{constructor(e){super(e),this._completed=!1,this._isConstraintKeyDown=!1,this._processTask=null,this.createTool="rectangle",this.mode=null,this.persistSelection=!0,this.returnFeatureTitleFields=!1,this.returnGeometry=!0,this.selection=new re,this.selectionManager=null,this.selectOnComplete=!0,this.sources=null,this.toolName="",this.type="add",this._process=Oi(async(t,i)=>{const{callback:l,selector:s,completed:r}=t,a=ri(async d=>{const{effectiveSelectionManager:p,returnFeatureTitleFields:c,returnGeometry:g,selection:v,sources:m,view:T}=this;if(!(!(m!=null&&m.length)&&!p.sources.length)&&T){if(s&&m!=null){const j=await Ao({returnFeatureTitleFields:c,returnGeometry:g,selector:s,signal:d,sources:m,view:T});if(v.removeAll(),v.addMany(j),r&&this.persistSelection)switch(this.effectiveType){case"remove":p.updateSelection({current:[],added:[],removed:j});break;case"replace":p.clear(),p.updateSelection({current:j,added:[],removed:[]});break;default:p.updateSelection({current:j,added:[],removed:[]})}}l&&l()}else v.removeAll()});return zi(i,()=>a.abort()),this._processTask=a,a.promise},Ho),this._onOperationFinish=this._onOperationFinish.bind(this)}initialize(){this._setup()}get _defaultMode(){return this.createTool==="polygon"?"click":"hybrid"}get _selectionArea(){const e=this._tool.coordinates;if(e.length===0)return;const t=so(),i=this.view.spatialReference,l=r=>{t.x=r[0],t.y=r[1];const a=this.view.toMap(t);return[(a==null?void 0:a.x)??0,(a==null?void 0:a.y)??0]};if(e.length===1||e.every(([r,a])=>r===e[0][0]&&a===e[0][1])){const[r,a]=l(e[0]);return new st({x:r,y:a,spatialReference:i})}const s=e.map(l);if(s.length!==0)return ki(s)||s.reverse(),new le({spatialReference:i,rings:[s]})}get completed(){return this._completed}get effectiveSelectionManager(){return this.selectionManager??this.view.selectionManager}get effectiveType(){const e=this.type??"add";if(this._isConstraintKeyDown)switch(e){case"add":return"remove";case"remove":case"replace":return"add";default:return e}return e}get processingFinalSelection(){var e,t;return!(!this._processTask||!((t=(e=this._tool)==null?void 0:e.drawOperation)!=null&&t.isCompleted))}cancel(){this.selection.removeAll(),this._onOperationFinish(!0)}destroy(){this._toolImportController=Pi(this._toolImportController)}async _setup(){const{createTool:e,view:t}=this;if(await t.whenReady(),this.destroyed||this._toolImportController)return;const i=new AbortController;this._toolImportController=i;const[l,s]=await Promise.all([_(()=>import("./DrawScreenTool-CPEYpMPF-D_85raLe.js"),__vite__mapDeps([38,3,4,39,40,41,42,43,44,45,31,29,30,32,33,34,37,35,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,2,5,6,7]),import.meta.url),To()]);if(i.signal.aborted)return;const r=Symbol();try{this._tool=new l.DrawScreenTool({view:t,mode:this.mode??this._defaultMode,geometryType:e,cursor:e==="point"?"default":"crosshair",automaticLengthMeasurementUtils:s})}finally{this._toolImportController=null}this._tool?(this.selectOnComplete||this.addHandles(this._tool.on(["cursor-update","vertex-add","vertex-remove"],()=>{this._syncConstraintKeyDown(),at(this._process({selector:this._selectionArea}))}),r),this.addHandles([t.on("key-down",a=>{if(!a.repeat)switch(a.key){case et.constraint:this._tool.uniformSizeToggled=!0,a.stopPropagation();break;case et.center:this._tool.centeredToggled=!0,a.stopPropagation()}}),t.on("key-up",a=>{switch(a.key){case et.constraint:this._tool.uniformSizeToggled=!1,a.stopPropagation();break;case et.center:this._tool.centeredToggled=!1,a.stopPropagation()}}),this.selection.on("change",({added:a,removed:d})=>this.emit("selection-change",{operationType:this.effectiveType,added:a,removed:d})),this._tool.on("complete",async a=>{this._syncConstraintKeyDown(),this.removeHandles(r),a.aborted?this.cancel():(this._tool.cursor="progress",await this._process({selector:this._selectionArea,callback:this._onOperationFinish,completed:!0}))})],r),this.addHandles(Ii(()=>t.tools.remove(this._tool))),t.addAndActivateTool(this._tool)):ge.getLogger(this).warn("Unable to import Draw module. SelectionOperation failed to load.")}_syncConstraintKeyDown(){const{inputManager:e}=this.view;this._isConstraintKeyDown=So.invertType.some(t=>e.isModifierKeyDown(t))}_onOperationFinish(e=!1){var t;this.removeAllHandles(),(t=this._processTask)==null||t.abort(),this.emit("complete",{aborted:e,operationType:this.effectiveType,selection:this.selection.toArray(),toolName:this.toolName}),this._completed=!0}};o([n()],k.prototype,"_completed",void 0),o([n()],k.prototype,"_defaultMode",null),o([n()],k.prototype,"_isConstraintKeyDown",void 0),o([n()],k.prototype,"_processTask",void 0),o([n()],k.prototype,"_selectionArea",null),o([n()],k.prototype,"completed",null),o([n({constructOnly:!0})],k.prototype,"createTool",void 0),o([n()],k.prototype,"effectiveSelectionManager",null),o([n()],k.prototype,"effectiveType",null),o([n({constructOnly:!0})],k.prototype,"mode",void 0),o([n()],k.prototype,"persistSelection",void 0),o([n()],k.prototype,"processingFinalSelection",null),o([n()],k.prototype,"returnFeatureTitleFields",void 0),o([n()],k.prototype,"returnGeometry",void 0),o([n({readOnly:!0})],k.prototype,"selection",void 0),o([n({constructOnly:!0})],k.prototype,"selectionManager",void 0),o([n({constructOnly:!0})],k.prototype,"selectOnComplete",void 0),o([n()],k.prototype,"sources",void 0),o([n({constructOnly:!0})],k.prototype,"toolName",void 0),o([n({constructOnly:!0})],k.prototype,"type",void 0),o([n({constructOnly:!0})],k.prototype,"view",void 0),k=o([O("esri.widgets.support.Selector2D.SelectionOperation")],k);const zo=k;let I=class extends Ct.EventedAccessor{constructor(e){super(e),this._operationHandlesGroup=null,this.activeOperation=null,this.continuousSelectionEnabled=!1,this.defaultLassoToolOptions={createTool:"polygon",mode:"hybrid",toolName:"lasso"},this.defaultOperationType="add",this.defaultPointToolOptions={createTool:"point",toolName:"point"},this.defaultRectangleToolOptions={createTool:"rectangle",toolName:"rectangle"},this.layerViewPreferenceEnabled=!0,this.persistSelection=!0,this.selectionManager=null,this.returnFeatureTitleFields=!1,this.returnGeometry=!0,this.selectOnComplete=!0,this.sources=null,this.toolConfigs=[]}initialize(){this.addHandles([L(()=>this.effectiveSources,e=>{this.activeOperation&&(this.activeOperation.sources=e)})])}destroy(){this._operationHandlesGroup=Ke(this._operationHandlesGroup)}get effectiveSelectionManager(){var e;return this.selectionManager??((e=this.view)==null?void 0:e.selectionManager)}get effectiveSources(){var r;const{layerViewPreferenceEnabled:e,sources:t,view:i}=this,l=t??((r=this.effectiveSelectionManager)==null?void 0:r.sources);if(!(l!=null&&l.length))return[];const s=[];return l.forEach(a=>{if(lt(a))s.push(a);else if(Xt(a)||Yt(a))(a.layers||[]).forEach(d=>{const p=i?Wt(i,d):void 0,c=e&&lt(p)?p:d;s.push(c)});else if(e){const d=i?Wt(i,a):void 0,p=lt(d)?d:a;s.push(p)}else s.push(a)}),s}get layers(){return pt(ge.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources}set layers(e){pt(ge.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources=e}get state(){var e;return this.activeOperation?"active":(e=this.view)!=null&&e.ready&&this.effectiveSources.length?"ready":"disabled"}activate(e){const{state:t}=this,i=(e==null?void 0:e.view)||this.view,l=(e==null?void 0:e.sources)||this.effectiveSources;if(t==="disabled"||!i)return void ge.getLogger(this).warn("Unable to start selection operation.");t==="active"&&this.cancel();const s=new CustomEvent("before-activate",{cancelable:!0,detail:{toolName:(e==null?void 0:e.toolName)??null}});if(this.emit("before-activate",s),s.defaultPrevented)return;const r={type:this.defaultOperationType,persistSelection:this.persistSelection,returnFeatureTitleFields:this.returnFeatureTitleFields,returnGeometry:this.returnGeometry,selectOnComplete:this.selectOnComplete,selectionManager:this.effectiveSelectionManager,...e,sources:l,view:i},a=new zo({...r});return this._operationHandlesGroup=Lt([a.on("selection-change",d=>this.emit("selection-change",d)),a.once("complete",d=>this._onOperationComplete(d,r))]),this._set("activeOperation",a),a}activateTool(e){this.cancel();const t=this._getToolOptions(e);if(t)return this.activate(t);ge.getLogger(this).warn("Unable to activate tool: unable to determine options.")}cancel(){var e;(e=this.activeOperation)==null||e.cancel(),this._set("activeOperation",null)}toggleTool(e){const{activeOperation:t}=this;if(t){const i=t.toolName;if(this.cancel(),i===e)return}return this.activateTool(e)}_onOperationComplete(e,t){this._operationHandlesGroup=Ke(this._operationHandlesGroup),this._set("activeOperation",null),this.emit("complete",e),this.continuousSelectionEnabled&&!e.aborted&&this.activate(t)}_getToolOptions(e){return this.toolConfigs.find(t=>t.toolName===e)||(e==="lasso"?this.defaultLassoToolOptions:e==="point"?this.defaultPointToolOptions:e==="rectangle"?this.defaultRectangleToolOptions:void 0)}};o([n({readOnly:!0})],I.prototype,"activeOperation",void 0),o([n()],I.prototype,"continuousSelectionEnabled",void 0),o([n()],I.prototype,"defaultLassoToolOptions",void 0),o([n()],I.prototype,"defaultOperationType",void 0),o([n()],I.prototype,"defaultPointToolOptions",void 0),o([n()],I.prototype,"defaultRectangleToolOptions",void 0),o([n()],I.prototype,"effectiveSelectionManager",null),o([n()],I.prototype,"effectiveSources",null),o([n()],I.prototype,"layers",null),o([n()],I.prototype,"layerViewPreferenceEnabled",void 0),o([n()],I.prototype,"persistSelection",void 0),o([n()],I.prototype,"selectionManager",void 0),o([n()],I.prototype,"returnFeatureTitleFields",void 0),o([n()],I.prototype,"returnGeometry",void 0),o([n()],I.prototype,"selectOnComplete",void 0),o([n()],I.prototype,"sources",void 0),o([n({readOnly:!0})],I.prototype,"state",null),o([n()],I.prototype,"toolConfigs",void 0),o([n()],I.prototype,"view",void 0),I=o([O("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],I);const Uo=I;let he=class extends oe{constructor(e){super(e),this.chip=!0,this.lassoTool=!0,this.pan=!0,this.pointTool=!0,this.rectangleTool=!0}};o([n({type:Boolean,nonNullable:!0})],he.prototype,"chip",void 0),o([n({type:Boolean,nonNullable:!0})],he.prototype,"lassoTool",void 0),o([n({type:Boolean,nonNullable:!0})],he.prototype,"pan",void 0),o([n({type:Boolean,nonNullable:!0})],he.prototype,"pointTool",void 0),o([n({type:Boolean,nonNullable:!0})],he.prototype,"rectangleTool",void 0),he=o([O("esri.widgets.support.SelectionToolbar.VisibleElements")],he);const It=he,_t="esri-selection-toolbar",ft={base:_t,container:`${_t}__container`,toolButton:`${_t}__tool-button`};let E=class extends ae{constructor(e,t){super(e,t),this._viewModelHandlesGroup=null,this.disabled=!1,this.layout="horizontal",this.messages=null,this.scale="s",this.viewModel=new Uo,this.visibleElements=new It}initialize(){this._viewModelHandlesGroup=Lt([wt(()=>this.viewModel,"before-activate",e=>this.emit("before-activate",e)),wt(()=>this.viewModel,"complete",e=>this.emit("complete",e)),wt(()=>this.viewModel,"selection-change",e=>this.emit("selection-change",e))])}destroy(){this._viewModelHandlesGroup=Ke(this._viewModelHandlesGroup)}loadDependencies(){return be({action:()=>_(()=>import("./index-CXn0Qeo5-BikhBr7G.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url),"action-bar":()=>_(()=>import("./index-B4aE1io5-v0Lzkq4s.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,8,9,10,11,12,0,13,14,15,16,18,19,20,21,22,23,24,25,26,17]),import.meta.url),chip:()=>_(()=>import("./index-BlA0IWNf-BNcwMC8x.js"),__vite__mapDeps([105,10,2,3,4,5,6,7,11,12,14,16,15,24,9]),import.meta.url)})}get _effectiveDisabled(){return this.disabled||this.state==="disabled"}get activeOperation(){return this.viewModel.activeOperation}get continuousSelectionEnabled(){return this.viewModel.continuousSelectionEnabled}set continuousSelectionEnabled(e){this.viewModel.continuousSelectionEnabled=e}get defaultLassoToolOptions(){return this.viewModel.defaultLassoToolOptions}set defaultLassoToolOptions(e){this.viewModel.defaultLassoToolOptions=e}get defaultOperationType(){return this.viewModel.defaultOperationType}set defaultOperationType(e){this.viewModel.defaultOperationType=e}get defaultPointToolOptions(){return this.viewModel.defaultPointToolOptions}set defaultPointToolOptions(e){this.viewModel.defaultPointToolOptions=e}get defaultRectangleToolOptions(){return this.viewModel.defaultRectangleToolOptions}set defaultRectangleToolOptions(e){this.viewModel.defaultRectangleToolOptions=e}get effectiveSelectionManager(){return this.viewModel.effectiveSelectionManager}get effectiveSources(){return this.viewModel.effectiveSources}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layers(){return pt(ge.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources}set layers(e){pt(ge.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources=e}get layerViewPreferenceEnabled(){return this.viewModel.layerViewPreferenceEnabled}set layerViewPreferenceEnabled(e){this.viewModel.layerViewPreferenceEnabled=e}get persistSelection(){return this.viewModel.persistSelection}set persistSelection(e){this.viewModel.persistSelection=e}get returnFeatureTitleFields(){return this.viewModel.returnFeatureTitleFields}set returnFeatureTitleFields(e){this.viewModel.returnFeatureTitleFields=e}get returnGeometry(){return this.viewModel.returnGeometry}set returnGeometry(e){this.viewModel.returnGeometry=e}get selectOnComplete(){return this.viewModel.selectOnComplete}set selectOnComplete(e){this.viewModel.selectOnComplete=e}get selectionManager(){return this.viewModel.selectionManager}set selectionManager(e){this.viewModel.selectionManager=e}get state(){return this.viewModel.state}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get toolConfigs(){return this.viewModel.toolConfigs}set toolConfigs(e){this.viewModel.toolConfigs=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visibleToolCount(){const{visibleElements:e}=this;return this.toolConfigs.length+(e.lassoTool?1:0)+(e.rectangleTool?1:0)}activate(e){if(this.cancel(),!this._effectiveDisabled)return this.viewModel.activate(e)}activateTool(e){if(!this._effectiveDisabled)return this.viewModel.activateTool(e)}cancel(){this.viewModel.cancel()}toggleTool(e){if(!this._effectiveDisabled)return this.viewModel.toggleTool(e)}render(){return h("div",{"aria-label":this.label,class:this.classes(ft.base,kt.widget)},h("div",{class:ft.container},h("calcite-action-bar",{expandDisabled:!0,layout:"horizontal",scale:this.scale},this._renderDefaultTools(),this._renderCustomTools(),this._renderChip())))}_renderDefaultTools(){return[this._renderPanAction(),this._renderPointTool(),this._renderRectangleTool(),this._renderLassoTool()]}_renderPanAction(){if(!this.visibleElements.pan)return;const e=this.messages.pan,t=`${this.id}-tool-pan`;return this._renderAction({active:!this.activeOperation,disabled:this._effectiveDisabled,icon:"pan",id:t,key:t,onclick:()=>this.cancel(),text:e,title:e})}_renderChip(){if(!this.visibleElements.chip)return;const{effectiveSelectionManager:e}=this,t=(e==null?void 0:e.count)??0,i=fo(t);return h("calcite-chip",{appearance:"outline",closable:t>0,closed:t===0,disabled:this._effectiveDisabled||t===0,label:i,scale:this.scale,slot:"actions-end",title:this.messages.clearSelection,onCalciteChipClose:()=>e==null?void 0:e.clear()},i)}_renderCustomTools(){return this.toolConfigs.map(({toolName:e,icon:t})=>this._renderToolWithTooltip(e,t))}_renderPointTool(){if(this.visibleElements.pointTool)return this._renderToolWithTooltip("point","selection-set",this.messages.selectByPoint)}_renderLassoTool(){if(this.visibleElements.lassoTool)return this._renderToolWithTooltip("lasso","lasso-select",this.messages.selectByLasso)}_renderRectangleTool(){if(this.visibleElements.rectangleTool)return this._renderToolWithTooltip("rectangle","cursor-marquee",this.messages.selectByRectangle)}_renderToolWithTooltip(e,t,i=e){var s;const l=`${this.id}-tool-${e}`;return this._renderAction({active:((s=this.activeOperation)==null?void 0:s.toolName)===e,disabled:this._effectiveDisabled,icon:t||"selection",id:l,key:l,onclick:()=>this.toggleTool(e),text:i,title:i})}_renderAction(e){return h("calcite-action",{...e,bind:this,class:ft.toolButton,scale:this.scale})}};o([n()],E.prototype,"_effectiveDisabled",null),o([n()],E.prototype,"activeOperation",null),o([n()],E.prototype,"continuousSelectionEnabled",null),o([n()],E.prototype,"defaultLassoToolOptions",null),o([n()],E.prototype,"defaultOperationType",null),o([n()],E.prototype,"defaultPointToolOptions",null),o([n()],E.prototype,"defaultRectangleToolOptions",null),o([n()],E.prototype,"disabled",void 0),o([n()],E.prototype,"effectiveSelectionManager",null),o([n()],E.prototype,"effectiveSources",null),o([n()],E.prototype,"label",null),o([n()],E.prototype,"layers",null),o([n()],E.prototype,"layerViewPreferenceEnabled",null),o([n()],E.prototype,"layout",void 0),o([n(),me("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],E.prototype,"messages",void 0),o([n()],E.prototype,"persistSelection",null),o([n()],E.prototype,"returnFeatureTitleFields",null),o([n()],E.prototype,"returnGeometry",null),o([n()],E.prototype,"selectOnComplete",null),o([n()],E.prototype,"scale",void 0),o([n()],E.prototype,"selectionManager",null),o([n()],E.prototype,"state",null),o([n()],E.prototype,"sources",null),o([n()],E.prototype,"toolConfigs",null),o([n()],E.prototype,"view",null),o([n()],E.prototype,"viewModel",void 0),o([n({type:It,nonNullable:!0})],E.prototype,"visibleElements",void 0),o([n()],E.prototype,"visibleToolCount",null),E=o([O("esri.widgets.support.SelectionToolbar")],E);const Wo=E,Ko={absolute:"absolute-direction",relative:"relative-direction"},hi=()=>be({icon:()=>_(()=>import("./index-DV38aJMs-BJQkz9HV.js"),__vite__mapDeps([10,2,3,4,5,6,7,11,12]),import.meta.url).then(e=>e.i),label:()=>_(()=>import("./index-CjNVVdGY-BuwUaas1.js"),__vite__mapDeps([106,2,3,4,5,6,7,107,11]),import.meta.url),switch:()=>_(()=>import("./index-DGUkrUiU-DDBm-20E.js"),__vite__mapDeps([108,2,3,4,5,6,7,14,11,109,15,24,107,16]),import.meta.url),tooltip:()=>_(()=>import("./index-CsuaBzKX-DR6Y5X37.js"),__vite__mapDeps([110,2,3,4,5,6,7,14,19,11,20,8,21,23,13]),import.meta.url)}),He="esri-labeled-switch",ze={label:`${He}__label`,labelContent:`${He}__label-content`,iconInfo:`${He}__icon_info`,iconWarning:`${He}__icon_warning`,tooltip:`${He}__tooltip`};function Re({checked:e,disabled:t,hint:i,key:l,label:s,onChange:r,hintIcon:a,hintKind:d}){return h("calcite-label",{class:ze.label,disabled:t,key:l,layout:"inline-space-between",scale:"s"},i?h("div",{class:ze.labelContent,key:"label-content"},h("div",null,s),h("calcite-icon",{class:d!=="warning"?ze.iconInfo:ze.iconWarning,icon:a??"information",id:l,onclick:p=>p.stopPropagation(),onpointerdown:p=>{p.preventDefault(),p.stopPropagation();const c=p.target.nextElementSibling;c.open=!c.open},scale:"s",tabIndex:0}),h("calcite-tooltip",{class:ze.tooltip,overlayPositioning:"fixed",referenceElement:l},i)):s,h("calcite-switch",{checked:e,disabled:t,scale:"s",onCalciteSwitchChange:p=>r(p.currentTarget.checked)}))}let Se=class extends oe{constructor(e){super(e),this.directionModePicker=!1,this.header=!1,this.labelsToggle=!0,this.tooltipsToggle=!0}};o([n({type:Boolean,nonNullable:!0})],Se.prototype,"directionModePicker",void 0),o([n({type:Boolean,nonNullable:!0})],Se.prototype,"header",void 0),o([n({type:Boolean,nonNullable:!0})],Se.prototype,"labelsToggle",void 0),o([n({type:Boolean,nonNullable:!0})],Se.prototype,"tooltipsToggle",void 0),Se=o([O("esri.widgets.support.SketchTooltipControls.VisibleElements")],Se);const Rt=Se,tt="esri-sketch-tooltip-controls",it={base:tt,block:`${tt}__block`,blockContent:`${tt}__block-content`,radioButtonLabelWrapper:`${tt}__radio-button-label-wrapper`};let ue=class extends ae{constructor(e,t){super(e,t),this.viewModel=null,this.visibleElements=new Rt,this.sketchOptions=new oi,this.viewType=void 0,this._onTooltipsEnabledChange=i=>{this.sketchOptions.tooltips.enabled=i},this._onLabelsEnabledChange=i=>{this.sketchOptions.labels.enabled=i},this._onDirectionModeChange=i=>{this.sketchOptions.values.directionMode=i.currentTarget.selectedItem.value}}loadDependencies(){return Promise.all([be({block:()=>_(()=>import("./index-RR6plZPA-BIT1pfNf.js"),__vite__mapDeps([111,1,2,3,4,5,6,7,8,9,112,14,12,11,10,113,19,20,15,24,16,21,114,0,13,115,116,117,118,18,22,23,25,26]),import.meta.url),label:()=>_(()=>import("./index-CjNVVdGY-BuwUaas1.js"),__vite__mapDeps([106,2,3,4,5,6,7,107,11]),import.meta.url),icon:()=>_(()=>import("./index-DV38aJMs-BJQkz9HV.js"),__vite__mapDeps([10,2,3,4,5,6,7,11,12]),import.meta.url).then(e=>e.i),"radio-button":()=>_(()=>import("./index-BoYi6noz-DjbWpBGP.js"),__vite__mapDeps([119,2,3,4,5,6,7,14,26,11,109,15,107,16]),import.meta.url),"radio-button-group":()=>_(()=>import("./index-lZpkjGTp-Bysh8oFd.js"),__vite__mapDeps([120,10,2,3,4,5,6,7,11,12,121,16,122,14]),import.meta.url)}),hi()])}render(){const{label:e,visibleElements:t}=this,i=this._renderContent();return h("div",{"aria-label":e,class:this.classes(it.base,kt.widget)},i?h("calcite-block",{class:it.block,expanded:!0,heading:t.header?this.label:"",key:"content-block",label:this.label},h("div",{class:it.blockContent,key:"content"},i)):void 0)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}_renderContent(){const{visibleElements:e,viewType:t}=this,i=[e.tooltipsToggle?this._renderTooltipsToggle():null,e.labelsToggle&&t!=="2d"?this._renderLabelsToggle():null,e.directionModePicker?this._renderDirectionModePicker():null].filter(ye);return i.length===0?null:i}_renderTooltipsToggle(){const{messages:e,sketchOptions:t}=this;return h(Re,{checked:t.tooltips.effectiveEnabled,hint:e.tooltipsToggleHint,key:`${this.id}__tooltips`,label:e.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const{messages:e,sketchOptions:t}=this;return h(Re,{checked:t.labels.enabled,hint:e.labelsToggleHint,key:`${this.id}__labels`,label:e.labelsToggle,onChange:this._onLabelsEnabledChange})}_renderDirectionModePicker(){const{messages:e,sketchOptions:t}=this,{directionMode:i}=t.values;return h("calcite-label",{key:"direction-mode",layout:"default",scale:"s"},e.directionModePicker,h("calcite-radio-button-group",{key:"radio-button-group",layout:"horizontal",name:this.id,scale:"s",value:i,onCalciteRadioButtonGroupChange:this._onDirectionModeChange},this._renderDirectionModeOption("relative",i,e.directionModeRelative),this._renderDirectionModeOption("absolute",i,e.directionModeAbsolute)))}_renderDirectionModeOption(e,t,i){return h("calcite-label",{key:e,layout:"inline",scale:"s"},h("calcite-radio-button",{checked:e===t,scale:"s",value:e}),h("div",{class:it.radioButtonLabelWrapper,key:"label-wrapper"},h("calcite-icon",{icon:Ko[e],scale:"s"}),i))}};o([n()],ue.prototype,"label",null),o([n({type:Rt,nonNullable:!0})],ue.prototype,"visibleElements",void 0),o([n(),me("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],ue.prototype,"messages",void 0),o([n({nonNullable:!0,type:oi})],ue.prototype,"sketchOptions",void 0),o([n({type:String})],ue.prototype,"viewType",void 0),ue=o([O("esri.widgets.support.SketchTooltipControls")],ue);const jo=ue,qo={hide:"hide"};function dt(e){return(e==null?void 0:e.listMode)??void 0}function Qo(e){return e!=null&&"minScale"in e&&e.minScale!=null?e.minScale:void 0}function Zo(e){return e!=null&&"maxScale"in e&&e.maxScale!=null?e.maxScale:void 0}function Jo(e){if(!e)return"inherited";const t=Yo(gi(e)?e.layer:e);return t!=null?t?"independent":"inherited":"visibilityMode"in e&&e.visibilityMode!=null?e.visibilityMode:"independent"}function ui(e){if(e&&(!("type"in e)||e.type!=="wmts"))return"sublayers"in e?"sublayers":"layers"in e?"layers":void 0}function At(e){return dt(e)!==qo.hide}function Xo(e,t){if(!e||t==null||isNaN(t))return!1;const i=Qo(e),l=Zo(e),s=i!=null&&!isNaN(i)&&i>0&&t>i,r=l!=null&&!isNaN(l)&&l>0&&t<l;return s||r}function Zt(e){const t=e==null?void 0:e.layer;return t&&"layers"in t?t.layers:null}function gi(e){return e!=null&&"layer"in e&&e.layer!=null}function Yo(e){const t=es(e);return t!=null&&"supportsSublayerVisibility"in t?t.supportsSublayerVisibility:void 0}function es(e){return e&&"capabilities"in e&&e.capabilities!=null&&"exportMap"in e.capabilities?e.capabilities.exportMap:void 0}let F=class extends ei.IdentifiableMixin(ae){constructor(e,t){super(e,t),this._legend=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([L(()=>this._canCreateLegend,()=>this._createLegend(),K),L(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),K)])}destroy(){this._legend=De(this._legend)}get _canCreateLegend(){const{content:e,listItem:t}=this;if(!t)return!1;const i="legend";return e===i||e!=null&&!!Array.isArray(e)&&e.includes(i)}get _legendOptions(){const{listItem:e,_legendLayerInfo:t}=this,i=e==null?void 0:e.view;return t&&i?{view:i,layerInfos:[t]}:{}}get _legendLayerInfo(){var r;const e=(r=this.listItem)==null?void 0:r.layer;if(!e||e.type==="subtype-sublayer")return null;const t=gi(e)?e:null,i=e==null?void 0:e.parent,l=i!=null&&"type"in i&&i.type==="map-image"?t==null?void 0:t.source:null,s="";return l&&i?{layer:i,title:s,sublayerIds:[l.mapLayerId]}:{layer:e,title:s}}get disabled(){var l;const{listItem:e,_legend:t,content:i}=this;return!e||!(Array.isArray(i)&&i.length>1)&&!!t&&(!((l=t.activeLayerInfos)!=null&&l.length)||!e.visibleAtCurrentScale||!e.visible)}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){const{image:e}=this,t=this._getFirstWidget();return this._get("icon")??(!e&&t?t.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){var e;return this._get("title")||(((e=this._getFirstWidget())==null?void 0:e.label)??"")}set title(e){this._override("title",e)}render(){return h("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){const{_legend:t,disabled:i,open:l}=this;return e&&!i&&l?e==="legend"&&t?h("div",{key:"legend-widget"},t.render()):typeof e=="string"?h("div",{innerHTML:e,key:e}):jt(e)?h("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?h("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){const{content:e,open:t}=this;return t?Array.isArray(e)?e.map(i=>this._renderContent(i)):this._renderContent(e):null}async _createLegend(){if(De(this._legend),this._legend=null,!this._canCreateLegend)return;const{default:e}=await _(()=>import("./Legend-BMS5EVNm-CTSvMVSS.js"),__vite__mapDeps([123,3,4,2,5,6,7,124,125,76,77,78,42,75,126,127,128,129,130,131,132,133,134,135,136,137,138,59,139,140,141,142,83,143,144,145,146,147,148,149,150,151,152,52,64,153,154,55,155,156,157,158,159,88,160,161,48,162,163,164,81,82,72,165,166,167,168,169,170,171,172,173,174,175,62,176,177,178,179,180,181,182,183,184,185,186]),import.meta.url),t=new e(this._legendOptions);this._legend=t}_attachToNode(e){e.appendChild(this)}_updateLegend(){const e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return e==="legend"?this._legend:jt(e)?e:null}_getFirstWidget(){const{content:e}=this;return Array.isArray(e)?e.map(t=>this._getWidget(t)).find(t=>t):this._getWidget(e)}};o([n()],F.prototype,"_legend",void 0),o([n()],F.prototype,"_canCreateLegend",null),o([n()],F.prototype,"_legendOptions",null),o([n()],F.prototype,"_legendLayerInfo",null),o([n()],F.prototype,"content",void 0),o([n()],F.prototype,"disabled",null),o([n()],F.prototype,"flowEnabled",void 0),o([n()],F.prototype,"icon",null),o([n()],F.prototype,"image",void 0),o([n()],F.prototype,"listItem",void 0),o([n()],F.prototype,"open",void 0),o([n()],F.prototype,"title",null),o([n()],F.prototype,"visible",void 0),F=o([O("esri.widgets.LayerList.ListItemPanel")],F);const yi=F;var Ue;const ts=re.ofType({key:"type",defaultKeyValue:"button",base:Ri,typeMap:{button:Ai,toggle:xi}}),mi=re.ofType(ts),Tt="layer",ot="child-list-mode",is="hide";let M=Ue=class extends ei.IdentifiableMixin(oe){constructor(e){super(e),this.actionsSections=new mi,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(re.ofType(Ue)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.parent=null,this.view=null}initialize(){if(this.addHandles([L(()=>{var e;return[this.layer,(e=this.layer)==null?void 0:e.listMode,this.listModeDisabled]},()=>this._watchLayerProperties(this.layer),K),L(()=>this.checkPublishStatusEnabled,e=>this._updateChildrenPublishing(e),K),L(()=>this.view,e=>this._updateChildrenView(e),K),L(()=>this.panel,e=>this._setListItemOnPanel(e),K)]),typeof this.listItemCreatedFunction=="function"){const e={item:this};this.listItemCreatedFunction.call(null,e)}}destroy(){var e;(e=this.panel)==null||e.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){const{layerView:e,publishing:t}=this;if(!t&&e&&"connectionStatus"in e)return e.connectionStatus}get error(){var e;return(e=this.layer)==null?void 0:e.loadError}get incompatible(){const{layerView:e}=this;return!(!e||!("spatialReferenceSupported"in e))&&!e.spatialReferenceSupported}get layerView(){const{layer:e,view:t}=this;if(!e||!t||e.type==="sublayer")return null;const i=e.type==="subtype-sublayer"?e.parent:e;return t.allLayerViews.find(l=>l.layer===i)??null}set panel(e){const t=this._get("panel");e!==t&&e&&(t==null||t.destroy()),this._set("panel",e)}castPanel(e){var t;return(t=this.panel)!=null&&t.open&&!e.hasOwnProperty("open")&&(e.open=!0),e?new yi(e):null}get sortable(){var e;return((e=this.layer)==null?void 0:e.type)!=="knowledge-graph-sublayer"&&this._get("sortable")}set sortable(e){this._set("sortable",e)}get title(){const e=Xe(this,"layer.layer");return(!e||e&&Xe(this,"layer.layer.loaded"))&&Xe(this,"layer.title")||Xe(this,"layer.attributes.title")||""}set title(e){this._override("title",e)}get publishing(){var i;const{layer:e,checkPublishStatusEnabled:t}=this;return!!(t&&e&&"publishingInfo"in e&&((i=e.publishingInfo)==null?void 0:i.status)==="publishing")}get updating(){const{layerView:e,connectionStatus:t,layer:i,publishing:l}=this;return!l&&!t&&(e?e.updating:(i==null?void 0:i.loadStatus)==="loading"||!1)}get visible(){var e;return!!((e=this.layer)!=null&&e.visible)}set visible(e){const t=this.layer;t&&(t.visible=e)}get visibleAtCurrentScale(){var e,t;return((e=this.layerView)==null?void 0:e.visibleAtCurrentScale)??!Xo(this.layer,(t=this.view)==null?void 0:t.scale)}get visibleAtCurrentTimeExtent(){var e;return((e=this.layerView)==null?void 0:e.visibleAtCurrentTimeExtent)??!0}get visibilityMode(){return Jo(this.layer)}clone(){return new Ue({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(e){e&&(e.listItem=this)}_updateChildrenPublishing(e){var t;(t=this.children)==null||t.forEach(i=>i.checkPublishStatusEnabled=e)}_updateChildrenView(e){const t=this.children;t&&t.forEach(i=>i.view=e)}_createChildren(e){const{listModeDisabled:t,children:i}=this,l=e.filter(s=>!i.some(r=>r.layer===s));i.addMany(this._createChildItems(l,t))}_destroyChildren(e){const{children:t}=this,i=t.filter(l=>!!l.layer&&!e.includes(l.layer));t.destroyMany(i)}_sortChildren(e){this.children.sort((t,i)=>e.indexOf(i.layer)-e.indexOf(t.layer))}_destroyAllChildren(){this.removeHandles(ot),this.children.destroyAll()}_watchChildLayerListMode(e){this.removeHandles(ot),this.listModeDisabled||this.addHandles(e.toArray().map(t=>L(()=>t.listMode,()=>this._compileChildren(e))),ot)}_compileChildren(e){const t=this.listModeDisabled?e:e==null?void 0:e.filter(i=>dt(i)!==is);e!=null&&e.length?(this._createChildren(t),this._destroyChildren(t),this._sortChildren(t),this._watchChildLayerListMode(e)):this._destroyAllChildren()}_watchSublayerChanges(e){e&&this.addHandles(e.on("change",()=>this._compileChildren(e)),Tt)}_initializeChildLayers(e){this._compileChildren(e),this._watchSublayerChanges(e)}_createChildItems(e,t){return e.reverse().map(i=>t||At(i)?new Ue({layer:i,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(ye)}_watchLayerProperties(e){if(this.removeHandles(Tt),this.removeHandles(ot),!e)return;if((!this.listModeDisabled&&dt(e))==="hide-children")return void this.children.destroyAll();const t=ui(e);t&&this.addHandles(L(()=>e[t],i=>{e.hasOwnProperty(t)&&this._initializeChildLayers(i)},K),Tt)}};o([n({type:mi})],M.prototype,"actionsSections",void 0),o([n()],M.prototype,"actionsOpen",void 0),o([n()],M.prototype,"checkPublishStatusEnabled",void 0),o([n({type:re.ofType(M)})],M.prototype,"children",void 0),o([n()],M.prototype,"childrenSortable",void 0),o([n({readOnly:!0})],M.prototype,"connectionStatus",null),o([n({readOnly:!0})],M.prototype,"error",null),o([n()],M.prototype,"hidden",void 0),o([n({readOnly:!0})],M.prototype,"incompatible",null),o([n()],M.prototype,"layer",void 0),o([n({readOnly:!0})],M.prototype,"layerView",null),o([n()],M.prototype,"listItemCreatedFunction",void 0),o([n({nonNullable:!0})],M.prototype,"listModeDisabled",void 0),o([n()],M.prototype,"open",void 0),o([n({type:yi})],M.prototype,"panel",null),o([Di("panel")],M.prototype,"castPanel",null),o([n()],M.prototype,"parent",void 0),o([n({value:!0})],M.prototype,"sortable",null),o([n()],M.prototype,"title",null),o([n({readOnly:!0})],M.prototype,"publishing",null),o([n({readOnly:!0})],M.prototype,"updating",null),o([n()],M.prototype,"view",void 0),o([n()],M.prototype,"visible",null),o([n({readOnly:!0})],M.prototype,"visibleAtCurrentScale",null),o([n({readOnly:!0})],M.prototype,"visibleAtCurrentTimeExtent",null),o([n({readOnly:!0})],M.prototype,"visibilityMode",null),M=Ue=o([O("esri.widgets.LayerList.ListItem")],M);const xt=M,Z={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},os="hide",vi=re.ofType(xt);let ee=class extends Ct.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new vi,this.view=null}initialize(){this.addHandles([L(()=>{var e;return((e=this.view)==null?void 0:e.ready)===!0},()=>this._viewHandles(),K),L(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList()),L(()=>Kt(this.view)?this.view.inGeographicLayout:null,()=>this._compileList())],Z.view)}destroy(){this._removeAllItems(),this.view=null}get state(){const{view:e}=this;return e!=null&&e.ready?"ready":e?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(e=>e.children).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e,t,i,l){var m,T;const s=e==null?void 0:e.layer;if(!s||s.type==="subtype-sublayer"||s.type==="sublayer")return;const r=(T=(m=this.view)==null?void 0:m.map)==null?void 0:T.layers,a=t?Zt(t):r,d=i?Zt(i):r;if(!a||!d)return;const{operationalItems:p}=this,c=(t==null?void 0:t.children)||p,g=(i==null?void 0:i.children)||p,v=d.length-l;e.parent=i||null,c.remove(e),a.remove(s),g.includes(e)||g.add(e,v),d.includes(s)||d.add(s,v),this._compileList()}_createLayerViewHandles(e){this.removeHandles(Z.layerViews),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),Z.layerViews)}_createMapLayerHandles(e){this.removeHandles(Z.mapLayers),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),Z.mapLayers)}_createListItem(e){const{view:t,listItemCreatedFunction:i,checkPublishStatusEnabled:l,listModeDisabled:s}=this;return new xt({checkPublishStatusEnabled:l,listModeDisabled:s,layer:e,listItemCreatedFunction:i,view:t})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(t=>dt(t)!==os):void 0}_watchLayersListMode(e){this.removeHandles(Z.layerListMode),e&&!this.listModeDisabled&&this.addHandles(L(()=>e.filter(t=>"listMode"in t).map(t=>t.listMode).toArray(),()=>this._compileList()),Z.layerListMode)}_compileList(){var l,s;const e=(s=(l=this.view)==null?void 0:l.map)==null?void 0:s.layers,t=Kt(this.view)&&!this.view.inGeographicLayout?e==null?void 0:e.filter(({type:r})=>r==="link-chart"):e;this._watchLayersListMode(t);const i=this._getViewableLayers(t);i!=null&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createNewItems(e){const{operationalItems:t}=this;e.forEach(i=>{t.some(l=>l.layer===i)||t.add(this._createListItem(i))})}_removeItems(e){const{operationalItems:t}=this,i=[];t.forEach(l=>{l&&e&&e.includes(l.layer)||i.push(l)}),t.destroyMany(i)}_sortItems(e){const{operationalItems:t}=this;t.sort((i,l)=>{const s=e.indexOf(i.layer),r=e.indexOf(l.layer);return s>r?-1:s<r?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([Z.mapLayers,Z.layerViews,Z.viewLayers]),e!=null&&e.ready?this.addHandles([L(()=>{var t,i;return(i=(t=this.view)==null?void 0:t.map)==null?void 0:i.allLayers},t=>this._createMapLayerHandles(t),K),L(()=>{var t;return(t=this.view)==null?void 0:t.allLayerViews},t=>this._createLayerViewHandles(t),K)],Z.viewLayers):this._removeAllItems()}};o([n()],ee.prototype,"checkPublishStatusEnabled",void 0),o([n()],ee.prototype,"listItemCreatedFunction",void 0),o([n({nonNullable:!0})],ee.prototype,"listModeDisabled",void 0),o([n({type:vi})],ee.prototype,"operationalItems",void 0),o([n({readOnly:!0})],ee.prototype,"state",null),o([n()],ee.prototype,"totalItems",null),o([n()],ee.prototype,"view",void 0),ee=o([O("esri.widgets.LayerList.LayerListViewModel")],ee);const ss=ee,Dt=e=>ls(e)||ns(e),ls=e=>{if(!("type"in e))return!1;switch(e.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":case"subtype-sublayer":return!0;default:return!1}},ns=e=>{const t=ui(e);if(t!=null&&e.hasOwnProperty(t)&&e[t]!=null){for(const i of e[t])if(Dt(i))return!0}return!1},nt=(e,t)=>t!=null&&e!=null&&(t.test(e.title)?"self":!!e.children.some(i=>nt(i,t)!==!1)&&"children");var Et;let ne=Et=class extends xt{constructor(e){super(e),this.children=new re,this.parent=null}get enabled(){const{children:e}=this;if(e.length===0)return this.featureSource!=null&&this.featureSource.enabled?"enabled":"disabled";let t=!1,i=!1;for(const l of e){if(l.enabled==="indeterminate")return l.enabled;if(l.enabled==="enabled"?t=!0:l.enabled==="disabled"&&(i=!0),i&&t)return"indeterminate"}return i?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap(e=>{var t;return[(t=e.layer)==null?void 0:t.id,...e.childLayerIds]})}get featureSource(){const{layer:e,getFeatureSnappingSources:t}=this;return t().find(i=>i.layer===e)}_initializeChildLayers(e){if(!e)return;const t=e.filter(Dt);super._initializeChildLayers(t)}_createChildItems(e){return e.map(t=>At(t)?new Et({layer:t,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(ye).reverse()}};o([n()],ne.prototype,"enabled",null),o([n()],ne.prototype,"children",void 0),o([n()],ne.prototype,"childLayerIds",null),o([n()],ne.prototype,"featureSource",null),o([n({constructOnly:!0})],ne.prototype,"getFeatureSnappingSources",void 0),o([n()],ne.prototype,"parent",void 0),ne=Et=o([O("esri.widgets.support.SnappingControls.SnappingListItem")],ne);let Oe=class extends ss{constructor(){super(...arguments),this.featureSnappingSources=new re}get operationalItemsFlat(){return this.operationalItems.flatten(e=>e.children)}get selectableItems(){return this.operationalItemsFlat.filter(e=>{var t;return!((t=e.children)!=null&&t.length)})}_compileList(){var l,s;const e=(s=(l=this.view)==null?void 0:l.map)==null?void 0:s.layers;if(!e)return;const t=e.filter(Dt);this._watchLayersListMode(t);const i=this._getViewableLayers(t);i!=null&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createListItem(e){return new ne({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};o([n()],Oe.prototype,"featureSnappingSources",void 0),o([n()],Oe.prototype,"operationalItems",void 0),o([n()],Oe.prototype,"operationalItemsFlat",null),o([n()],Oe.prototype,"selectableItems",null),Oe=o([O("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],Oe);let te=class extends oe{constructor(e){super(e),this.layerListViewModel=new Oe,this.snappingOptions=new si,this.view=null}initialize(){this.addHandles([L(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:e,view:t})=>{e.view=t},K),L(()=>{var e;return{viewModel:this.layerListViewModel,sources:(e=this.snappingOptions)==null?void 0:e.featureSources}},({viewModel:e,sources:t})=>{e.featureSnappingSources=t},K)])}get allLayersEnabled(){var e;return(((e=this.layerListViewModel)==null?void 0:e.selectableItems)??[]).every(t=>t.enabled==="enabled")}get allLayersDisabled(){var e;return(((e=this.layerListViewModel)==null?void 0:e.selectableItems)??[]).every(t=>!t.enabled)}get layersEnabledCount(){var e,t;return((t=(e=this.layerListViewModel)==null?void 0:e.selectableItems)==null?void 0:t.filter(i=>i.enabled==="enabled").length)??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(e,t){e==null||e.forEach(i=>t?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i))}toggleSnappingForAllLayers(e){this.layerListViewModel.selectableItems.forEach(({layer:t})=>{const i=t==null?void 0:t.id;e?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i)})}enableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e);t&&(t.enabled=!0)}disableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e);t&&(t.enabled=!1)}updateEnabledFeatureSources(e){for(const t of this.snappingOptions.featureSources)At(t.layer)&&(t.enabled=e.includes(t.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find(t=>t.layer.id===e)}_makeSnappingSourceForLayer(e){var l;const t=(l=this.layerListViewModel.operationalItemsFlat.find(s=>{var r;return((r=s.layer)==null?void 0:r.id)===e}))==null?void 0:l.layer;if(!t)throw new lo("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);if(t.type==="group")return;const i=new Mo({layer:t});return this.snappingOptions.featureSources.add(i),i}};o([n()],te.prototype,"allLayersEnabled",null),o([n()],te.prototype,"allLayersDisabled",null),o([n({constructOnly:!0})],te.prototype,"layerListViewModel",void 0),o([n()],te.prototype,"layersEnabledCount",null),o([n({type:si,nonNullable:!0})],te.prototype,"snappingOptions",void 0),o([n()],te.prototype,"state",null),o([n()],te.prototype,"view",void 0),te=o([O("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],te);const rs=te,Y="esri-snapping-controls",J={base:Y,container:`${Y}__container`,toggleBlock:`${Y}__toggle-block`,layerListBlock:`${Y}__layer-list-block`,layerList:`${Y}__layer-list`,layerListFilter:`${Y}__layer-list__filter`,layerListButton:`${Y}__layer-list__button`,layerListItem:`${Y}__layer-list__item`,layerListGroup:`${Y}__layer-list__group`,nestedContainer:`${Y}__nested-container`};let R=class extends ae{constructor(e,t){super(e,t),this._defaultViewModel=null,this._layerListFilter=null,this._gridLoadTask=null,this.layerListOpen=!0,this.gridOptionsOpen=!1,this.messages=null,this.messagesCommon=null,this.snappingManager=null,this.visibleElements=new ht,this._enableSnappingSwitchChange=r=>{this.snappingOptions.enabled=r},this._featureEnabledSwitchChange=r=>{this.snappingOptions.featureEnabled=r},this._gridEnabledSwitchChange=r=>{this.snappingOptions.gridEnabled=r,r&&this._startLoadGrid()},this._selfEnabledSwitchChange=r=>{this.snappingOptions.selfEnabled=r},this._onToggleLayersButtonClick=r=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled),Lo(r.target)};const{snappingOptions:i,view:l,viewModel:s}=e;this.viewModel=s??(this._defaultViewModel=new rs({snappingOptions:i,view:l}))}normalizeCtorArgs(e){const{snappingOptions:t,view:i,viewModel:l,...s}=e;return s}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=De(this._defaultViewModel))}loadDependencies(){return Promise.all([be({block:()=>_(()=>import("./index-RR6plZPA-BIT1pfNf.js"),__vite__mapDeps([111,1,2,3,4,5,6,7,8,9,112,14,12,11,10,113,19,20,15,24,16,21,114,0,13,115,116,117,118,18,22,23,25,26]),import.meta.url),button:()=>_(()=>import("./index-CK6nlFfs-DJ99onD6.js"),__vite__mapDeps([187,1,2,3,4,5,6,7,8,9,10,11,12,14,22,109,15,107,16]),import.meta.url),input:()=>_(()=>import("./index-4OY0nObJ-C-yBnG8d.js"),__vite__mapDeps([188,10,2,3,4,5,6,7,11,12,121,189,190,14,24,13,22,109,15,107,16,122,9]),import.meta.url),list:()=>_(()=>import("./index-CoujZeLU-C5fmXmsj.js"),__vite__mapDeps([191,1,2,3,4,5,6,7,8,9,112,14,12,11,13,10,121,189,188,190,24,22,109,15,107,16,122,20,192]),import.meta.url),"list-item":()=>_(()=>import("./index-DbQfb_U2-KZf_9OE2.js"),__vite__mapDeps([193,10,2,3,4,5,6,7,11,12,113,14,19,20,8,15,24,16,21,114,1,9,0,13,115,116,117,118,192,194]),import.meta.url),checkbox:()=>_(()=>import("./index-B-et6CSq-BDrNUajc.js"),__vite__mapDeps([195,2,3,4,5,6,7,14,11,109,15,24,107,16]),import.meta.url),loader:()=>_(()=>import("./index-D0o7KJz6-CPX7tO-w.js"),__vite__mapDeps([1,2,3,4,5,6,7,8,9]),import.meta.url)}),hi()])}initialize(){this.addHandles(L(()=>{var e;return((e=this.view)==null?void 0:e.type)==="2d"&&!!this.view.grid},e=>{this.visibleElements.gridControls&&(this.snappingOptions.gridEnabled=e)}))}get _openAndReady(){return this.gridOptionsOpen&&this.snappingOptions.gridEnabled&&this.snappingOptions.enabled}get icon(){return"snap-to-point"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){e!==this._get("viewModel")&&(this._defaultViewModel!=null&&this._defaultViewModel===e||(this._defaultViewModel=De(this._defaultViewModel)),this._set("viewModel",e))}render(){const{label:e}=this;return h("div",{"aria-label":e,class:this.classes(J.base,kt.widget)},h("div",{class:J.container},this._renderContent()))}_renderContent(){var e;return[this._renderToggles(),this._renderLayerList(),((e=this.view)==null?void 0:e.type)==="2d"&&this.visibleElements.gridControls?this._renderGridOptions():null]}_renderToggles(){const{visibleElements:e,view:t}=this,i=[e.selfEnabledToggle?this._renderSelfEnabledToggle():null,e.featureEnabledToggle?this._renderFeatureEnabledToggle():null,e.gridEnabledToggle&&(t==null?void 0:t.type)==="2d"?this._renderGridEnabledToggle():null].filter(ye),l=[e.enabledToggle?this._renderEnabledToggle():null,i.length>0?h("div",{class:J.nestedContainer},i):null].filter(ye);return l.length===0?null:h("calcite-block",{class:J.toggleBlock,expanded:!0,heading:e.header?this.label:"",key:"toggle-block",label:this.label},l)}_renderEnabledToggle(){return h(Re,{checked:this.viewModel.snappingOptions.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:this.messages.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){return h(Re,{checked:this.viewModel.snappingOptions.selfEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:this.messages.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){return h(Re,{checked:this.viewModel.snappingOptions.featureEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,label:this.messages.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderGridEnabledToggle(){return h(Re,{checked:this.viewModel.snappingOptions.gridEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__grid-enabled-toggle`,label:this.messages.grid,onChange:this._gridEnabledSwitchChange})}_renderLayerList(){var a;if(!this.visibleElements.layerList)return null;const{messages:e,viewModel:t}=this,i=t.layerListViewModel.operationalItems.length>9?h("calcite-input",{class:J.layerListFilter,clearable:!0,placeholder:e==null?void 0:e.searchLayers,onCalciteInputInput:({currentTarget:{value:d}})=>{this._layerListFilter=d===""?null:new RegExp(d,"i")}}):null,l=this._secondaryElementsDisabled,s=this.layerListOpen&&!l,r=(a=t.layerListViewModel.operationalItems)==null?void 0:a.find(d=>!!d.children.length);return h("calcite-block",{class:J.layerListBlock,collapsible:!0,disabled:this._secondaryElementsDisabled,expanded:s,heading:e.snappingLayers,key:"list-block",onCalciteBlockToggle:d=>this.layerListOpen=d.currentTarget.expanded},i,this._renderToggleLayersButton(),h("calcite-list",{class:J.layerList,displayMode:r?"nested":"flat",label:e==null?void 0:e.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(t.layerListViewModel.operationalItems)))}_renderGridOptions(){var c;const{view:e,visibleElements:t,snappingManager:i,snappingOptions:l,_openAndReady:s}=this,{gridEnabled:r,enabled:a}=l;(s||(e==null?void 0:e.type)==="2d"&&e.grid)&&this._startLoadGrid();const d=(c=this._gridLoadTask)==null?void 0:c.value,p=d&&(e==null?void 0:e.type)==="2d"&&h(d,{snappingManager:i,snappingOptions:l,view:e,visibleElements:t.gridControlsElements});return h("calcite-block",{class:J.layerListBlock,collapsible:!0,disabled:!r||!a,expanded:s,heading:this.messages.gridOptionsHeading,key:"grid-block",onCalciteBlockClose:()=>this.gridOptionsOpen=!1,onCalciteBlockOpen:()=>this.gridOptionsOpen=!0},p??h("calcite-loader",{label:this.messagesCommon.loading,scale:"s",text:this.messagesCommon.loading}))}async _startLoadGrid(){var e;!this._gridLoadTask&&this.visibleElements.gridControls&&((e=this.view)==null?void 0:e.type)==="2d"&&(this._gridLoadTask=ri(async()=>(await _(async()=>{const{default:t}=await import("./GridControls-HOcRkVVE-Dt5rVc3K.js");return{default:t}},__vite__mapDeps([196,3,4,5,197,198,84,85,2,6,7,81,82,83,44,128,86,87,199,88,41,42,200,78,67,49,50,51,52,201,100,101,185,202,53,68,56,69,70,71,72,73,74,75,76,77,79,58,59,57,80,62,63,43,89,90,91,64,65,66,92,93,94,95,96,97,98,99,203,204,205,206,207,208,209,151,210,211,212,40,45,31,29,30,32,33,34,37,35,46,47,48,39,54,55,60,61,102,103,104,213,157,149,150,214,215,160,216,217,218,219,220,186,221,222]),import.meta.url)).default))}_renderLayerListItemCollection(e){const t=this._layerListFilter;return e.map(i=>{switch(t?nt(i,t):null){case"children":{const l=i.children.filter(s=>nt(s,t)!==!1);return this._renderLayerListItemGroup(i,l)}case"self":case null:return this._renderLayerListItemOrGroup(i);case!1:return nt(i.parent,t)==="self"?this._renderLayerListItemOrGroup(i):null}}).toArray().filter(ye)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const{viewModel:{allLayersEnabled:e},messages:t}=this,i=e?t.disableAllLayers:t.enableAllLayers;return h("calcite-button",{appearance:"transparent",class:J.layerListButton,label:i,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},i)}_renderLayerListItemOrGroup(e){if(e.children.length)return this._renderLayerListItemGroup(e);const{messages:{untitledLayer:t}}=this,i=e.title||t,l=()=>{var s;this.viewModel.toggleSnappingForLayers([(s=e.layer)==null?void 0:s.id],e.enabled!=="enabled")};return h("calcite-list-item",{class:J.layerListItem,key:`${this.id}-list-item-${e.uid}`,label:i,onCalciteListItemSelect:s=>{s.stopPropagation(),l()}},h("calcite-checkbox",{checked:e.enabled==="enabled",slot:"actions-start",onCalciteCheckboxChange:l}))}_renderLayerListItemGroup(e,t){const{messages:i}=this,{children:l,title:s}=e,r=s||i.untitledLayer,a=s&&s!==""?s:no(),d=!!(t!=null&&t.length),p=t??l,c=()=>{this.viewModel.toggleSnappingForLayers(e.childLayerIds,e.enabled!=="enabled")},g=p==null?void 0:p.find(v=>!!v.children.length);return h("calcite-list-item",{class:J.layerListGroup,expanded:d,key:a,label:r,onCalciteListItemSelect:v=>{v.stopPropagation(),c()}},h("calcite-checkbox",{checked:e.enabled==="enabled",indeterminate:e.enabled==="indeterminate",slot:"actions-start",onCalciteCheckboxChange:c}),h("calcite-list",{displayMode:g?"nested":"flat",label:i==null?void 0:i.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(p)))}get _enabledToggleDisabled(){const e=this.snappingOptions;return e.enabledToggled||e.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};o([n()],R.prototype,"_defaultViewModel",void 0),o([n()],R.prototype,"_layerListFilter",void 0),o([n()],R.prototype,"_gridLoadTask",void 0),o([n()],R.prototype,"_openAndReady",null),o([n()],R.prototype,"label",null),o([n({type:Boolean,nonNullable:!0})],R.prototype,"layerListOpen",void 0),o([n({type:Boolean,nonNullable:!0})],R.prototype,"gridOptionsOpen",void 0),o([n(),me("esri/widgets/support/SnappingControls/t9n/SnappingControls")],R.prototype,"messages",void 0),o([n(),me("esri/t9n/common")],R.prototype,"messagesCommon",void 0),o([n()],R.prototype,"snappingOptions",null),o([n()],R.prototype,"snappingManager",void 0),o([n()],R.prototype,"view",null),o([n()],R.prototype,"viewModel",null),o([n({type:ht,nonNullable:!0})],R.prototype,"visibleElements",void 0),o([n()],R.prototype,"_enabledToggleDisabled",null),o([n()],R.prototype,"_secondaryElementsDisabled",null),R=o([O("esri.widgets.support.SnappingControls")],R);const as=R,de="esri-sketch",se={base:de,vertical:`${de}--vertical`,docked:`${de}-bar`,floating:`${de}-pad`,chipHorizontal:`${de}__selection-count-chip--horizontal`,chipVertical:`${de}__selection-count-chip--vertical`,chipVerticalSmall:`${de}__selection-count-chip--vertical--s`,popoverWrapper:`${de}__popover-wrapper`},ps={point:"pin",polyline:"line",polygon:"polygon",rectangle:"rectangle",circle:"circle",multipoint:"pins",mesh:"i3d-building",freehandPolygon:"freehand-area",freehandPolyline:"freehand"};let f=class extends ae{constructor(e,t){super(e,t),this._activeCustomToolOptions=null,this._selectionToolbar=null,this._viewModelHandlesGroup=null,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.customToolOptions=null,this.customActions=null,this.toolbarKind="floating",this.contextualToolLocation="separate",this.groupCollapsePriorities=null,this.groupAllowCollapseOptions=null,this.messages=null,this.messagesCommon=null,this.visibleElements=new N,this._defaultViewModel=null,this._calcitePopoverReferenceElement=null,this._relativeLocation="top",this._popoverOpen=!1,this._activateCreateTool=this._activateCreateTool.bind(this),this.viewModel=(e==null?void 0:e.viewModel)||(this._defaultViewModel=new li({creationMode:(e==null?void 0:e.creationMode)??"continuous"}))}initialize(){const{layer:e,view:t}=this,i=(t==null?void 0:t.type)==="2d",l=new Wo({persistSelection:!1,visibleElements:new It({chip:!1,pan:!1,pointTool:!1,lassoTool:i,rectangleTool:i}),view:t,sources:e?[e]:null,scale:this.scale});this.addHandles([L(()=>this.viewModel,s=>{this._viewModelHandlesGroup=Ke(this._viewModelHandlesGroup),s&&(this._viewModelHandlesGroup=Lt([s.on("create",()=>this.scheduleRender()),s.on("update",()=>this.scheduleRender()),s.on("delete",r=>this.emit("delete",r)),s.on("undo",()=>this.scheduleRender()),s.on("redo",()=>this.scheduleRender()),L(()=>s.layer,r=>{this._selectionToolbar&&(this._selectionToolbar.sources=r?[r]:null)}),L(()=>s.view,r=>{this._selectionToolbar&&(this._selectionToolbar.view=r)}),L(()=>s.state,()=>this.notifyChange("state"))]))},zt),ro(()=>l.activeOperation,()=>this.viewModel.cancel()),l.on("complete",s=>this._onSelectionOperationComplete(s)),L(()=>{const{view:s,visibleElements:{selectionTools:r}}=this;return{lassoTool:(s==null?void 0:s.type)!=="3d"&&!!(r!=null&&r["lasso-selection"]),rectangleTool:(s==null?void 0:s.type)!=="3d"&&!!(r!=null&&r["rectangle-selection"])}},s=>{Object.assign(l.visibleElements,s)},zt)]),this._selectionToolbar=l}loadDependencies(){return be({action:()=>_(()=>import("./index-CXn0Qeo5-BikhBr7G.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url),chip:()=>_(()=>import("./index-BlA0IWNf-BNcwMC8x.js"),__vite__mapDeps([105,10,2,3,4,5,6,7,11,12,14,16,15,24,9]),import.meta.url),popover:()=>_(()=>import("./index-Btp8sfgk-DF0Oekmp.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,10,11,12,0,13,14,15,16,19,20,21,22,23,24]),import.meta.url).then(e=>e.i)})}destroy(){var e;(e=this._selectionToolbar)==null||e.destroy(),this._viewModelHandlesGroup=Ke(this._viewModelHandlesGroup)}get activeTool(){var s;const e=(s=this._selectionToolbar)==null?void 0:s.activeOperation;if(e)switch(e.toolName){case"lasso":return"lasso-selection";case"rectangle":return"rectangle-selection";case"default":return"custom-selection"}const t=this._effectiveAvailableCreateTools,{activeTool:i,activeCreateToolDrawMode:l}=this.viewModel;return i==="polygon"&&l==="freehand"&&(t!=null&&t.includes("freehandPolygon"))?"freehandPolygon":i==="polyline"&&l==="freehand"&&(t!=null&&t.includes("freehandPolyline"))?"freehandPolyline":this.viewModel.activeTool}get activeTooltip(){return this.viewModel.activeTooltip}get createGraphic(){return this.viewModel.createGraphic}get creationMode(){return this.viewModel.creationMode}set creationMode(e){this.viewModel.creationMode=e}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(e){this.viewModel.defaultUpdateOptions=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}set layout(e){this._set("layout",e),this._selectionToolbar&&(this._selectionToolbar.layout=e)}set scale(e){this._set("scale",e),this._selectionToolbar&&(this._selectionToolbar.scale=e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get state(){var e;return(e=this._selectionToolbar)!=null&&e.activeOperation?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get updateGraphics(){return this.viewModel.updateGraphics}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){const t=this._get("viewModel");e!==t&&(t&&t===this._defaultViewModel&&De(t),this._set("viewModel",e))}get _effectiveAvailableCreateTools(){const{availableCreateTools:e,view:t,visibleElements:i}=this,l=e==null?void 0:e.filter(s=>{var r;return!!((r=i.createTools)!=null&&r[s])});return(t==null?void 0:t.type)==="3d"?l==null?void 0:l.filter(s=>s!=="multipoint"):l}create(e,t,i){const l=(i==null?void 0:i.createOptions)??t;return this._activeCustomToolOptions=i,at(this.viewModel.create(e,l))}update(e,t){return at(this.viewModel.update(e,t))}complete(){this.viewModel.complete()}cancel(){var e;(e=this._selectionToolbar)==null||e.cancel(),this.viewModel.cancel(),this._activeCustomToolOptions=null}undo(){var e;this.viewModel.undo(),(e=this.view)==null||e.focus()}redo(){var e;this.viewModel.redo(),(e=this.view)==null||e.focus()}delete(){this.viewModel.delete()}duplicate(){return this.viewModel.duplicate()}dismissFloatingElements(){this._popoverOpen=!1}render(){var s,r,a,d;const{toolbarKind:e,layout:t,scale:i}=this,l=(s=this.customActions)==null?void 0:s.filter(p=>p.position==="selection-toolbar");return h("div",null,h("div",{classes:{[se.base]:!0,[se.floating]:e==="floating",[se.docked]:e==="docked",[se.vertical]:t==="vertical"}},h(ie,{barStyle:e,layout:t,scale:i},this._renderSelectionSetItemGroupInline(),h("div",{"allow-collapse":((r=this.groupAllowCollapseOptions)==null?void 0:r.get("selectionTools"))??!0,"group-kind":"split-button",key:"selection-split-button",priority:((a=this.groupCollapsePriorities)==null?void 0:a.get("selectionTools"))??$e.Low},this._renderDefaultSelectionButton(),(d=this._selectionToolbar)==null?void 0:d.render(),l==null?void 0:l.map(p=>this._renderToolbarItem(p))),this._renderCreateToolActionGroup(),this._renderUndoRedoMenuItemGroup(),this._renderSettingsMenuItemGroup()),this._renderSelectionSetToolbar(),this._renderSettingsMenuPopover()))}_renderSettingsMenuPopover(){const{messagesCommon:e,snappingOptions:t,view:i,viewModel:l,visibleElements:s}=this;if(!this._calcitePopoverReferenceElement)return;const r={directionModePicker:s.directionModePicker,labelsToggle:s.labelsToggle,tooltipsToggle:s.tooltipsToggle},a=this.layout==="horizontal"?this._relativeLocation==="top"?"bottom-end":"top-end":"right-end";return h("calcite-popover",{closable:!0,focusTrapDisabled:!0,heading:e.settings,label:e.settings,open:this._popoverOpen,overlayPositioning:"fixed",placement:a,referenceElement:this._calcitePopoverReferenceElement,scale:this.scale,onCalcitePopoverBeforeClose:()=>this._popoverOpen=!1,onCalcitePopoverBeforeOpen:d=>this._remeasurePopoverSizes(d.currentTarget),onCalcitePopoverClose:()=>this._refocusOnView()},h("div",{class:se.popoverWrapper},Object.values(r).includes(!0)?h(jo,{sketchOptions:l.sketchOptions,viewType:i==null?void 0:i.type,visibleElements:new Rt(r)}):void 0,s.snappingControls&&i&&t?h(as,{snappingManager:this.viewModel.snappingManager,snappingOptions:t,view:i,visibleElements:s.snappingControlsElements}):void 0))}_renderSelectionSetToolbar(){if(this.contextualToolLocation!=="separate")return;const e=this._renderSelectionSetItemGroup();return e!=null&&e.length?h(ie,{barStyle:this.toolbarKind,layout:this.layout,scale:this.scale},e):void 0}_renderSelectionSetItemGroupInline(){return this.contextualToolLocation==="separate"?[]:this._renderSelectionSetItemGroup()}_renderUndoRedoMenuItemGroup(){var e,t;return h("div",{"allow-collapse":((e=this.groupAllowCollapseOptions)==null?void 0:e.get("undoRedo"))??!0,"group-kind":"split-button",key:"undo-redo-menu",priority:((t=this.groupCollapsePriorities)==null?void 0:t.get("undoRedo"))??$e.Medium,slot:"actions-end"},this._renderUndoButton(),this._renderRedoButton())}_renderSettingsMenuItemGroup(){var l,s,r;const e=[],t=[];(l=this.customActions)==null||l.forEach(a=>{a.position==="settings-before"?t.push(a):a.position==="settings-after"&&e.push(a)});const i=[...t.map(a=>this._renderToolbarItem(a)),this._renderSettingsMenuButton(),...e.map(a=>this._renderToolbarItem(a))].filter(ye);if(i.length)return h("div",{"allow-collapse":((s=this.groupAllowCollapseOptions)==null?void 0:s.get("settings"))??!1,"group-kind":"overflow-group",key:"settings-menu",priority:((r=this.groupCollapsePriorities)==null?void 0:r.get("settings"))??$e.Max,slot:"actions-end"},i)}_renderSelectionSetItemGroup(){var s,r,a,d;if(!this.updateGraphics.length)return[];const e=this.contextualToolLocation==="inline-end"?"actions-end":void 0,t=(s=this.customActions)==null?void 0:s.filter(p=>p.position==="before-selection-set"),i=(r=this.customActions)==null?void 0:r.filter(p=>p.position==="after-selection-set"),l=((a=this.groupCollapsePriorities)==null?void 0:a.get("selectionSet"))??$e.High;return[h("div",{"group-kind":"measured-content",key:"selection-count-chip-group",priority:l,slot:e},this._renderFeatureCountChip()),h("div",{"allow-collapse":((d=this.groupAllowCollapseOptions)==null?void 0:d.get("selectionSet"))??!1,"group-kind":"overflow-group",key:"selection-set-tool-group",priority:l,slot:e},t==null?void 0:t.map(p=>this._renderToolbarItem(p)),this._renderDuplicateButton(),this._renderDeleteButton(),i==null?void 0:i.map(p=>this._renderToolbarItem(p)))]}_renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return[];const{messages:e,state:t}=this;return this._renderToolbarItem({id:"pointer-select",text:e.selectFeature,icon:"cursor",onclick:this._activateDefaultSelectTool,active:t==="ready"})}_renderCreateToolActionGroup(){var i,l,s,r;const e=((i=this._effectiveAvailableCreateTools)==null?void 0:i.flatMap(a=>this._renderBuiltInCreateToolItem(a)))??[],t=((l=this.customToolOptions)==null?void 0:l.flatMap(a=>this._renderCustomToolItem(a)))??[];return h("div",{"allow-collapse":((s=this.groupAllowCollapseOptions)==null?void 0:s.get("createTools"))??!0,"group-kind":"overflow-group",key:"create-tools-group",priority:((r=this.groupCollapsePriorities)==null?void 0:r.get("createTools"))??$e.High},e,t)}_renderBuiltInCreateToolItem(e){return this._renderToolbarItem({id:`${e}-button`,text:this.messages.draw[e],icon:ps[e],onclick:()=>this._activateCreateTool(e),active:this.activeTool===e&&!this._activeCustomToolOptions})}_renderCustomToolItem(e){var i;const{toolKey:t}=e;return this._renderToolbarItem({id:`custom-${e.toolKey}`,text:e.label,icon:e.icon,onclick:()=>this._activateCreateTool(e.toolName,null,e),active:((i=this._activeCustomToolOptions)==null?void 0:i.toolKey)===t})}_renderUndoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"undo-button",text:this.messages.undo,icon:"undo",disabled:!this.viewModel.canUndo(),onclick:this.undo,flipRTL:!0}):[]}_renderRedoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"redo-button",text:this.messages.redo,icon:"redo",disabled:!this.viewModel.canRedo(),onclick:this.redo,flipRTL:!0}):[]}_renderSettingsMenuButton(){return this.visibleElements.settingsMenu?this._renderToolbarItem({id:"settings-menu-action",text:this.messagesCommon.settings,icon:"gear",active:this._popoverOpen,onclick:()=>this._popoverOpen=!this._popoverOpen,afterCreate:e=>this._calcitePopoverReferenceElement=e,afterUpdate:e=>this._calcitePopoverReferenceElement=e,afterRemoved:()=>this._calcitePopoverReferenceElement=null}):[]}_renderFeatureCountChip(){if(!this.visibleElements.selectionCountLabel)return[];const{layout:e,messages:t,scale:i,id:l,updateGraphics:{length:s}}=this,r=qt(t.selectedCount,{count:s}),a=i==="s"?99:999,d=s>a?qt(t.selectedCountTruncated,{truncated:a}):s,p=i==="s"&&e==="vertical",c=p?`${l}-selection-chip-small`:`${l}-selection-chip`;return[p?h("span",{classes:{[se.chipVertical]:!0,[se.chipVerticalSmall]:this.scale==="s"},id:c,tabIndex:0,title:r},d):h("calcite-chip",{appearance:"outline",class:e==="horizontal"?se.chipHorizontal:se.chipVertical,id:c,kind:"brand",label:r,scale:i==="l"?"m":"s",tabIndex:0,title:e==="vertical"?r:void 0},e==="vertical"?d:r)]}_renderDuplicateButton(){if(!this.visibleElements.duplicateButton)return[];const{messages:e}=this;return this._renderToolbarItem({id:"duplicate",text:this.updateGraphics.length>1?e.duplicateFeatures:e.duplicateFeature,icon:"copy",onclick:this._onDuplicateSelect})}_renderDeleteButton(){if(!this.visibleElements.deleteButton)return[];const{messages:e}=this,t=this.updateGraphics.length>1?e.deleteFeatures:e.deleteFeature;return this._renderToolbarItem({id:"delete",text:t,icon:"trash",onclick:this.delete})}_renderToolbarItem({id:e,text:t,icon:i,disabled:l,onclick:s,active:r,flipRTL:a,afterCreate:d,afterUpdate:p,afterRemoved:c}){const g=`${this.id}-${e}`;return[h("calcite-action",{active:r,afterCreate:d,afterRemoved:c,afterUpdate:p,bind:this,"data-testid":e,disabled:l||this.state==="disabled",icon:i,iconFlipRtl:a??!1,id:g,key:e,onclick:s,scale:this.scale,text:t,title:t})]}_remeasurePopoverSizes(e){var t,i,l,s,r,a;try{const d=e.parentElement,p=(i=(t=this==null?void 0:this.view)==null?void 0:t.container)==null?void 0:i.getBoundingClientRect(),c=d==null?void 0:d.style;if(!(d&&p&&c&&((s=(l=this.view)==null?void 0:l.container)!=null&&s.contains(d))))return;const g=this._calcitePopoverReferenceElement;if(!g)return;const{bottom:v,top:m}=g.getBoundingClientRect();if(this.layout==="horizontal"){const j=v<p.height/2;j!==(this._relativeLocation==="top")&&(this._relativeLocation=j?"top":"bottom"),j?(c==null||c.setProperty("--sketch-view-height-offset",v-p.top+"px"),c==null||c.setProperty("--sketch-view-margin-offset","30px")):(c==null||c.setProperty("--sketch-view-height-offset",p.bottom-m+"px"),c==null||c.setProperty("--sketch-view-margin-offset","15px"))}else this.layout==="vertical"&&(c.setProperty("--sketch-view-height-offset","15px"),c.setProperty("--sketch-view-margin-offset","15px"));const T=(a=(r=e.shadowRoot)==null?void 0:r.querySelector("div.header"))==null?void 0:a.getBoundingClientRect().height;c.setProperty("--sketch-popover-header-offset",`${T}px`)}catch(d){ge.getLogger(this.declaredClass).warnOnce("Sketch failed to lay out settings menu.",d)}}_activateCreateTool(e,t,i){var s;const l=this._activeCustomToolOptions;if(i||l){if((i==null?void 0:i.toolKey)===(l==null?void 0:l.toolKey))return void this.cancel()}else if(this.activeTool===e)return void this.cancel();(s=this._selectionToolbar)==null||s.cancel(),this.create(e,t,i)}_onDuplicateSelect(){const e=this.duplicate(),t=this.viewModel.activeTool;t!=="transform"&&t!=="reshape"||this.update(e,{tool:t})}_onSelectionOperationComplete(e){const{viewModel:{defaultUpdateOptions:t}}=this,{selection:i}=e;if(!e.aborted&&i.length){const l=t.tool,s=i.length>1&&l==="reshape"?"transform":l;this.update(i,{...t,tool:s})}this.notifyChange("state")}_activateDefaultSelectTool(){var e;this.cancel(),(e=this.view)==null||e.focus()}_refocusOnView(){var e;this.activeTool&&((e=this.view)==null||e.focus())}};o([n()],f.prototype,"_activeCustomToolOptions",void 0),o([n()],f.prototype,"activeTool",null),o([n({readOnly:!0})],f.prototype,"activeTooltip",null),o([n({cast:e=>{if(!(e!=null&&e.length))return null;const t=new Set(["point","polyline","polygon","rectangle","circle","multipoint","freehandPolyline","freehandPolygon","mesh"]);return e.filter(i=>t.has(i))}})],f.prototype,"availableCreateTools",void 0),o([n({readOnly:!0})],f.prototype,"createGraphic",null),o([n()],f.prototype,"creationMode",null),o([n()],f.prototype,"customToolOptions",void 0),o([n()],f.prototype,"customActions",void 0),o([n()],f.prototype,"defaultCreateOptions",null),o([n()],f.prototype,"defaultUpdateOptions",null),o([n()],f.prototype,"icon",null),o([n()],f.prototype,"label",null),o([n()],f.prototype,"labelOptions",null),o([n()],f.prototype,"layer",null),o([n({type:["horizontal","vertical"],value:"horizontal"})],f.prototype,"layout",null),o([n({value:"m"})],f.prototype,"scale",null),o([n()],f.prototype,"toolbarKind",void 0),o([n()],f.prototype,"contextualToolLocation",void 0),o([n()],f.prototype,"groupCollapsePriorities",void 0),o([n()],f.prototype,"groupAllowCollapseOptions",void 0),o([n(),me("esri/widgets/Sketch/t9n/Sketch")],f.prototype,"messages",void 0),o([n(),me("esri/t9n/common")],f.prototype,"messagesCommon",void 0),o([n()],f.prototype,"snappingOptions",null),o([n()],f.prototype,"state",null),o([n()],f.prototype,"tooltipOptions",null),o([n({readOnly:!0})],f.prototype,"updateGraphics",null),o([n({type:Eo,nonNullable:!0})],f.prototype,"valueOptions",null),o([n()],f.prototype,"view",null),o([n({type:li}),Po(["create","update","undo","redo"])],f.prototype,"viewModel",null),o([n({type:N,nonNullable:!0})],f.prototype,"visibleElements",void 0),o([n()],f.prototype,"_effectiveAvailableCreateTools",null),o([n()],f.prototype,"_defaultViewModel",void 0),o([n()],f.prototype,"_calcitePopoverReferenceElement",void 0),o([n()],f.prototype,"_relativeLocation",void 0),o([n()],f.prototype,"_popoverOpen",void 0),f=o([O("esri.widgets.Sketch")],f);const ds=f,cs=(e,t)=>i=>us(i,e);var ct,je,qe,ve,bi,wi,_i;class hs extends go{constructor(i,l){var c;super(i,l);Fe(this,ve);Fe(this,ct,new Map);Fe(this,je);Fe(this,qe);new yo(i);const s=this,r=s.instance;let a=r.viewModel,d=r.visibleElements;const p=new Proxy(this.exports,{get(g,v,m){return v==="viewModel"?a:v==="visibleElements"?d:Reflect.get(g,v,m)}});if(bt(s,qe,r),s.instance=p,s.exports=p,a){const g={component:i,get exports(){return s.instance.viewModel}};mo(s).set("viewModel","viewModel"),i.addController(g),a=vo(i,new WeakRef(g),bo(i)-1,a,Ze(s,ct))}s.instance.visibleElements&&(d=Je(c=s,ve,bi).call(c,r))}hostConnected(){this.instance=Ze(this,qe),super.hostConnected()}hostLoad(){bt(this,je,L(()=>this.component.el.view,i=>{const l=this.instance;!("view"in l)&&typeof l.viewModel=="object"?l.viewModel.view=i:l.view=i,!("map"in l)&&typeof l.viewModel=="object"?l.viewModel.map=i==null?void 0:i.map:l.map=i==null?void 0:i.map},{sync:!0,initial:!0}))}hostUpdate(i){i.has("closed")&&(this.instance.visible=!this.component.closed)}hostLoaded(){const{el:i}=this.component;i.childElem??(i.childElem=document.createElement("div")),this.instance.container=i.childElem,this.component.closed!==void 0&&this.onLifecycle(()=>L(()=>this.instance.visible,l=>this.component.closed=!l,{initial:!0}))}hostDestroy(){var i;(i=Ze(this,je))==null||i.remove(),super.hostDestroy()}}ct=new WeakMap,je=new WeakMap,qe=new WeakMap,ve=new WeakSet,bi=function(i){return new Proxy(i.visibleElements,{get:(l,s)=>{if(typeof s=="symbol"||s in Promise.prototype)return l[s];const r=[s],a=Je(this,ve,wi).call(this,r);return wo(this.component,d=>{const p=d;this.component[p]=!1;let c=i.visibleElements??{},g;for(const m of r.slice(0,-1))if(typeof c[m]=="object"&&c[m]!==null)c=c[m];else{g=!!c[m];break}g===void 0&&(g=!!(c[r.slice(-1)[0]]??!0));const v=p.startsWith("hide")||p.startsWith("show")?p.startsWith("hide"):g;this.onUpdate(m=>{if(m.has(p)){const T=this.component[p];Je(this,ve,_i).call(this,r,T,v)}})},a)}})},wi=function(i){const l=new Proxy({},{get:(s,r)=>{const a=Reflect.get(s,r);return typeof r=="symbol"||r in Promise.prototype?a:(i.push(r),l)}});return l},_i=function(i,l,s){let r=this.instance.visibleElements??{};for(const d of i.slice(0,-1))(typeof r[d]!="object"||r[d]===null)&&(r[d]={}),r=r[d];const a=!!(s?!l:l);r[i.at(-1)]=a};const us=ao(hs),gs=Vi`@layer{arcgis-sketch{display:block}}`,ys=cs(ds),We=class We extends Bi{constructor(){super(),this.widget=ys(this),this.viewModel=this.widget.viewModel,this._defaultGraphicsLayer=null,this.activeTool=this.widget.activeTool,this.autoDestroyDisabled=!1,this.availableCreateTools=this.widget.availableCreateTools,this.createGraphic=this.widget.createGraphic,this.creationMode=this.widget.creationMode,this.defaultCreateOptions=this.widget.defaultCreateOptions,this.defaultGraphicsLayerDisabled=!1,this.defaultUpdateOptions=this.widget.defaultUpdateOptions,this.hideCreateToolsCircle=this.widget.visibleElements.createTools.circle,this.hideCreateToolsPoint=this.widget.visibleElements.createTools.point,this.hideCreateToolsPolygon=this.widget.visibleElements.createTools.polygon,this.hideCreateToolsPolyline=this.widget.visibleElements.createTools.polyline,this.hideCreateToolsRectangle=this.widget.visibleElements.createTools.rectangle,this.hideDuplicateButton=this.widget.visibleElements.duplicateButton,this.hideDeleteButton=this.widget.visibleElements.deleteButton,this.hideSelectionCountLabel=this.widget.visibleElements.selectionCountLabel,this.hideLabelsToggle=this.widget.visibleElements.labelsToggle,this.hideSelectionToolsLassoSelection=this.widget.visibleElements.selectionTools["lasso-selection"],this.hideSelectionToolsRectangleSelection=this.widget.visibleElements.selectionTools["rectangle-selection"],this.hideSettingsMenu=this.widget.visibleElements.settingsMenu,this.hideSnappingControls=this.widget.visibleElements.snappingControls,this.hideSnappingControlsElementsEnabledToggle=this.widget.visibleElements.snappingControlsElements.enabledToggle,this.hideSnappingControlsElementsFeatureEnabledToggle=this.widget.visibleElements.snappingControlsElements.featureEnabledToggle,this.hideSnappingControlsElementsLayerList=this.widget.visibleElements.snappingControlsElements.layerList,this.hideSnappingControlsElementsSelfEnabledToggle=this.widget.visibleElements.snappingControlsElements.selfEnabledToggle,this.hideTooltipsToggle=this.widget.visibleElements.tooltipsToggle,this.hideUndoRedoMenu=this.widget.visibleElements.undoRedoMenu,this.icon=this.widget.icon,this.label=this.widget.label,this.labelOptions=this.widget.labelOptions,this.layer=this.widget.layer,this.layout=this.widget.layout,this.pointSymbol=this.viewModel.pointSymbol,this.polygonSymbol=this.viewModel.polygonSymbol,this.polylineSymbol=this.viewModel.polylineSymbol,this.position="bottom-left",this.scale=this.widget.scale,this.toolbarKind=this.widget.toolbarKind,this.showSnappingControlsElementsHeader=this.widget.visibleElements.snappingControlsElements.header,this.snappingOptions=this.widget.snappingOptions,this.state=this.widget.state,this.tooltipOptions=this.widget.tooltipOptions,this.updateGraphics=this.widget.updateGraphics,this.arcgisCreate=Ne(()=>this.widget,"create"),this.arcgisDelete=Ne(()=>this.widget,"delete"),this.arcgisPropertyChange=Gi()("state"),this.arcgisReady=Fi(),this.arcgisRedo=Ne(()=>this.widget,"redo"),this.arcgisUndo=Ne(()=>this.widget,"undo"),this.arcgisUpdate=Ne(()=>this.widget,"update"),this.listen("arcgisReady",this._arcgisReadyHandler)}async cancel(){var t;(t=this.widget)==null||t.cancel()}async complete(){var t;(t=this.widget)==null||t.complete()}async create(t,i){var l;await((l=this.widget)==null?void 0:l.create(t,i))}async delete(){var t;(t=this.widget)==null||t.delete()}async destroy(){await this.manager.destroy()}async duplicate(){var t;(t=this.widget)==null||t.duplicate()}async redo(){var t;(t=this.widget)==null||t.redo()}async triggerUpdate(t,i){var l;(l=this.widget)==null||l.update(t,i)}async undo(){var t;(t=this.widget)==null||t.undo()}_arcgisReadyHandler(){var t,i;this.defaultGraphicsLayerDisabled||(this._defaultGraphicsLayer=new _o({title:"Sketch Layer"}),this.widget.layer=this._defaultGraphicsLayer,(i=(t=this.el.view)==null?void 0:t.map)==null||i.add(this.widget.layer),this.manager.onLifecycle(()=>L(()=>{var l;return(l=this.el.view)==null?void 0:l.map},(l,s)=>{if(this.widget.layer!==this._defaultGraphicsLayer)return;const r=this._defaultGraphicsLayer;s!=null&&s.allLayers.includes(r)&&s.allLayers.remove(r),l==null||l.add(r)})),this.manager.onDestroy(()=>{var l,s,r,a,d;this._defaultGraphicsLayer&&((s=(l=this.el.view)==null?void 0:l.map)!=null&&s.allLayers.includes(this._defaultGraphicsLayer))&&((a=(r=this.el.view)==null?void 0:r.map)==null||a.remove(this._defaultGraphicsLayer)),(d=this._defaultGraphicsLayer)==null||d.destroy(),this._defaultGraphicsLayer=null}))}};We.properties={activeTool:3,autoDestroyDisabled:5,availableCreateTools:0,createGraphic:0,creationMode:1,defaultCreateOptions:0,defaultGraphicsLayerDisabled:5,defaultUpdateOptions:0,hideCreateToolsCircle:5,hideCreateToolsPoint:5,hideCreateToolsPolygon:5,hideCreateToolsPolyline:5,hideCreateToolsRectangle:5,hideDuplicateButton:5,hideDeleteButton:5,hideSelectionCountLabel:5,hideLabelsToggle:5,hideSelectionToolsLassoSelection:5,hideSelectionToolsRectangleSelection:5,hideSettingsMenu:5,hideSnappingControls:5,hideSnappingControlsElementsEnabledToggle:5,hideSnappingControlsElementsFeatureEnabledToggle:5,hideSnappingControlsElementsLayerList:5,hideSnappingControlsElementsSelfEnabledToggle:5,hideTooltipsToggle:5,hideUndoRedoMenu:5,icon:1,label:1,labelOptions:0,layer:0,layout:1,pointSymbol:0,polygonSymbol:0,polylineSymbol:0,position:1,referenceElement:1,scale:1,toolbarKind:1,showSnappingControlsElementsHeader:5,snappingOptions:0,state:3,tooltipOptions:0,updateGraphics:0},We.shadowRootOptions=Ni,We.styles=gs;let Mt=We;$i("arcgis-sketch",Mt);const rt="RampDrawGraphicsLayer",ms=Hi({__name:"draw",setup(e){const{t}=Ui(),i=u=>t(u?`draw.${u}`:"draw.unknown"),l=Wi("iApi"),s=Ot();let r=null;const a=Ki("sketchEl");let d=null,p=null,c=null,g=null,v=!1,m=null,T=[];const j=ji([]),pe=u=>{var y;if(g&&(p==null||p.remove(g),g=null),!u)return;let b;switch((y=u.geometry)==null?void 0:y.type){case"point":case"multipoint":b=new uo({color:[255,255,0,.8],size:16,outline:{color:[255,165,0,1],width:3}});break;case"polyline":b=new Ut({color:[255,255,0,.8],width:6});break;default:b=new Ye({color:[255,255,0,.3],outline:{color:[255,165,0,1],width:3}})}g=new Te({geometry:u.geometry,symbol:b}),p==null||p.add(g)};Ht(()=>s.selectedGraphicId,(u,b)=>{if(!(!r||!p)){if(!u)r.cancel(),pe();else if(u!==b){const y=p.graphics.toArray().find(C=>C.attributes&&C.attributes.id===u);y&&(r.triggerUpdate([y]),pe(y))}}});const fi=async()=>{var P,X;if(!p||!r||s.activeTool!=="edit")return;await l.geo.map.viewPromise;const u=l.geo.map.esriView,b={x:u.width/2,y:u.height/2},y={x:b.x,y:b.y,width:20,height:20},C=(await u.hitTest(y)).results.filter(D=>{var G;return!("graphic"in D)||D.graphic.layer!==p?!1:!!((G=D.graphic.attributes)!=null&&G.id)});C.length>0?(c=C[0].graphic,r.triggerUpdate([c]),(P=c.attributes)!=null&&P.id&&s.selectGraphic(c.attributes.id),l.updateAlert(t("draw.graphic.selected",{type:i((X=c.attributes)==null?void 0:X.type)}))):(r.cancel(),c=null,s.clearSelection())},Ti=async()=>{if(!r||!s.activeTool)return;await l.geo.map.viewPromise;const u=l.geo.map.esriView,b={x:Math.floor(u.width/2),y:Math.floor(u.height/2)},y=u.toMap(b),C=u.extent,P=C.width,X=C.height,D=Math.min(P,X)/10;let G;switch(s.activeTool){case"point":G=new Te({geometry:new st({x:y.x,y:y.y,spatialReference:u.spatialReference}),symbol:r.pointSymbol});break;case"polyline":G=new Te({geometry:new Ee({paths:[[[y.x-D/2,y.y],[y.x+D/2,y.y]]],spatialReference:u.spatialReference}),symbol:r.polylineSymbol});break;case"polygon":case"rectangle":const w=D/2;G=new Te({geometry:new le({rings:[[[y.x-w,y.y-w],[y.x+w,y.y-w],[y.x+w,y.y+w],[y.x-w,y.y+w],[y.x-w,y.y-w]]],spatialReference:u.spatialReference}),symbol:r.polygonSymbol||new Ye({color:[0,255,0,.3],outline:{color:[0,255,0,1],width:1}})});break;case"circle":const S=D/2,Pe=36,Ve=[];for(let we=0;we<=Pe;we++){const Ie=we/Pe*2*Math.PI,V=y.x+S*Math.cos(Ie),Qe=y.y+S*Math.sin(Ie);Ve.push([V,Qe])}G=new Te({geometry:new le({rings:[Ve],spatialReference:u.spatialReference}),symbol:r.polygonSymbol||new Ye({color:[255,0,255,.3],outline:{color:[255,0,255,1],width:1}})});break;default:console.warn("Unknown tool type:",s.activeTool);return}if(G){const w=`graphic-${Date.now()}`;G.attributes={id:w,type:s.activeTool},p==null||p.add(G),s.addGraphic({id:w,type:s.activeTool,geometry:G.geometry,attributes:G.attributes}),s.activeTool!=="point"&&(s.clearSelection(),s.setActiveTool(null),r.cancel()),l.updateAlert(t("draw.graphic.created",{type:i(s.activeTool)}))}},Vt=u=>{var y;const b=(y=l.geo.map.esriView)==null?void 0:y.container;if(!(!document.activeElement||!(b!=null&&b.contains(document.activeElement))))switch(u.key){case"Enter":if(u.preventDefault(),s.activeTool&&s.activeTool!=="edit")if((s.activeTool==="polyline"||s.activeTool==="polygon")&&(v||T.length===0)){const P=l.geo.map.esriView,X={x:Math.floor(P.width/2),y:Math.floor(P.height/2)},D=P.toMap(X);v?(T.push([D.x,D.y]),s.activeTool==="polyline"?m.geometry=new Ee({paths:[T],spatialReference:P.spatialReference}):m.geometry=new le({rings:[T],spatialReference:P.spatialReference}),l.updateAlert(t("draw.multiPoint.pointAdded",{type:i(s.activeTool),count:T.length}))):(v=!0,T=[[D.x,D.y]],s.activeTool==="polyline"?m=new Te({geometry:new Ee({paths:[T],spatialReference:P.spatialReference}),symbol:(r==null?void 0:r.polylineSymbol)||new Ut({color:[0,0,255,1],width:2})}):m=new Te({geometry:new le({rings:[T],spatialReference:P.spatialReference}),symbol:(r==null?void 0:r.polygonSymbol)||new Ye({color:[0,255,0,.3],outline:{color:[0,255,0,1],width:1}})}),m.attributes={id:`temp-graphic-${Date.now()}`,type:s.activeTool},p==null||p.add(m),l.updateAlert(t("draw.multiPoint.started",{type:i(s.activeTool),count:1})))}else Ti();else fi();break;case"Delete":case"Backspace":const C=l.geo.map.esriView;v&&T.length>1?(u.preventDefault(),T.pop(),s.activeTool==="polyline"?m.geometry=new Ee({paths:[T],spatialReference:C.spatialReference}):m.geometry=new le({rings:[T],spatialReference:C.spatialReference}),m.set("geometry",m==null?void 0:m.geometry),l.updateAlert(t("draw.multiPoint.pointRemoved",{type:i(s.activeTool??void 0),count:T.length}))):v&&T.length===1?(u.preventDefault(),m&&(p==null||p.remove(m)),m=null,T=[],v=!1,l.updateAlert(t("draw.multiPoint.canceled"))):c&&(u.preventDefault(),r==null||r.delete(),p==null||p.remove(c),typeof s.removeGraphic=="function"&&s.removeGraphic(c.attributes.id),c=null,pe(void 0),l.updateAlert(t("draw.graphic.deleted")));break;case"Escape":s.setActiveTool(null),r==null||r.cancel(),c=null,pe(void 0),s.clearSelection(),l.updateAlert(t("draw.tool.canceled"));break}},Bt=u=>{var Qe;const b=l.geo.map.esriView.container;if(!document.activeElement||!(b!=null&&b.contains(document.activeElement))||!c||!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(u.key))return;u.preventDefault(),u.stopPropagation();const y=10,C=u.shiftKey,P=u.altKey,X=l.geo.map.esriView;let D=0,G=0;u.key==="ArrowLeft"&&(D=-y),u.key==="ArrowRight"&&(D=y),u.key==="ArrowUp"&&(G=-y),u.key==="ArrowDown"&&(G=y);const w=c.geometry;let S;if(w.type==="point")S={x:w.x,y:w.y};else{const A=w.extent;S={x:(A.xmin+A.xmax)/2,y:(A.ymin+A.ymax)/2}}const Pe=X.toScreen(new st({x:S.x,y:S.y,spatialReference:X.spatialReference}));Pe.x+=D,Pe.y+=G;const Ve=X.toMap(Pe),we=Ve.x-S.x,Ie=Ve.y-S.y;let V;if(w.type==="point")!C&&!P?V=new st({x:w.x+we,y:w.y+Ie,spatialReference:w.spatialReference}):C?(V=w.clone(),l.updateAlert(t("draw.point.resize.unsupported"))):P&&(V=w.clone(),l.updateAlert(t("draw.point.rotate.unsupported")));else if(w.type==="polyline"){if(!C&&!P){const A=w.paths.map(B=>B.map(([$,H])=>[$+we,H+Ie]));V=new Ee({paths:A,spatialReference:w.spatialReference})}else if(C){const A=w,B=u.key==="ArrowUp"||u.key==="ArrowRight"?1.05:.95,$=A.paths.map(H=>H.map(([_e,fe])=>[S.x+(_e-S.x)*B,S.y+(fe-S.y)*B]));V=new Ee({paths:$,spatialReference:w.spatialReference})}else if(P){const A=w,B=u.key==="ArrowLeft"?-.05:u.key==="ArrowRight"?.05:0;if(B!==0){const $=Math.cos(B),H=Math.sin(B),_e=A.paths.map(fe=>fe.map(([ut,gt])=>{const Be=ut-S.x,Ge=gt-S.y,yt=Be*$-Ge*H,mt=Be*H+Ge*$;return[S.x+yt,S.y+mt]}));V=new Ee({paths:_e,spatialReference:w.spatialReference})}else V=w.clone()}}else if(w.type==="polygon"){if(!C&&!P){const A=w.rings.map(B=>B.map(([$,H])=>[$+we,H+Ie]));V=new le({rings:A,spatialReference:w.spatialReference})}else if(C){const A=w,B=u.key==="ArrowUp"||u.key==="ArrowRight"?1.05:.95,$=A.rings.map(H=>H.map(([_e,fe])=>[S.x+(_e-S.x)*B,S.y+(fe-S.y)*B]));V=new le({rings:$,spatialReference:w.spatialReference})}else if(P){const A=w,B=u.key==="ArrowLeft"?-.05:u.key==="ArrowRight"?.05:0;if(B!==0){const $=Math.cos(B),H=Math.sin(B),_e=A.rings.map(fe=>fe.map(([ut,gt])=>{const Be=ut-S.x,Ge=gt-S.y,yt=Be*$-Ge*H,mt=Be*H+Ge*$;return[S.x+yt,S.y+mt]}));V=new le({rings:_e,spatialReference:w.spatialReference})}else V=w.clone()}}if(V){c.geometry=V,c.set("geometry",V),pe(c),(Qe=c.attributes)!=null&&Qe.id&&s.updateGraphicGeometry(c.attributes.id,V);const A=C?"resized":P?"rotated":"moved";l.updateAlert(t(`draw.graphic.${A}`))}},Ei=async u=>{const b=(await l.geo.map.esriView.hitTest(u)).results.find(y=>{var C;return"graphic"in y&&y.graphic.layer===p&&!!((C=y.graphic.attributes)!=null&&C.id)});b&&s.activeTool==="edit"?r==null||r.triggerUpdate([b.graphic]):(r==null||r.cancel(),c=null,s.clearSelection(),pe())},Mi=async()=>{var u,b;await l.geo.map.viewPromise,l.geo.layer.getLayer(rt)?p=l.geo.layer.getLayer(rt).esriLayer:(p=l.geo.layer.createLayer({id:rt,layerType:po.GRAPHIC,cosmetic:!0,system:!0,url:""}),await l.geo.map.addLayer(p)),p!=null&&p.esriLayer&&(p=p.esriLayer),Object.assign(a.value,{view:l.geo.map.esriView,layer:p,availableCreateTools:["point","multipoint","polyline","polygon","rectangle","circle"],updateOnGraphicClick:!0,visibleElements:{createTools:{point:!0,polyline:!0,polygon:!0,rectangle:!0,circle:!0},selectionTools:{enable:!0},settingsMenu:!1},defaultUpdateOptions:{highlightOptions:{enabled:!1}}}),l.geo.map.esriView.ui.add(a.value,"bottom-right"),(u=a.value)==null||u.addEventListener("arcgisCreate",y=>Ft(y.detail)),(b=a.value)==null||b.addEventListener("arcgisUpdate",y=>Ci(y.detail)),d={remove:()=>{var y;return(y=a.value)==null?void 0:y.removeEventListener("arcgisCreate",C=>Ft(C.detail))}},r=a.value,l.geo.map.esriView.on("click",Ei),document.addEventListener("keydown",Vt),document.addEventListener("keydown",Bt,{capture:!0})},Gt=()=>{r&&(l.geo.map.esriView&&l.geo.map.esriView.ui.remove(r),d&&d.remove(),r.destroy()),document.removeEventListener("keydown",Vt),document.removeEventListener("keydown",Bt,{capture:!0}),v=!1,m=null,T=[],r=null,p=null},Ft=u=>{if(u.state==="complete"){const b=u.graphic,y=`graphic-${Date.now()}`;b.attributes=b.attributes||{},b.attributes.id=y,s.addGraphic({id:y,type:u.tool,geometry:b.geometry,attributes:b.attributes}),u.tool!=="point"&&s.setActiveTool(null)}},Ci=u=>{var y,C,P;const b=u.graphics[0];if(b)if(u.state==="start"){if(s.activeTool!=="edit"){r.cancel();return}c=b,(y=b.attributes)!=null&&y.id&&(s.selectGraphic(b.attributes.id),l.updateAlert(t("draw.graphic.selected",{type:i((C=b.attributes)==null?void 0:C.type)})))}else u.state==="active"?pe(b):u.state==="complete"&&((P=b.attributes)!=null&&P.id)&&(s.updateGraphicGeometry(b.attributes.id,b.geometry),l.updateAlert(t("draw.graphic.updated")))};return qi(()=>{Mi(),j.push(l.event.on(ti.MAP_DESTROYED,()=>{Gt()}))}),Ht(()=>s.activeTool,u=>{r.cancel(),pe(),m=null,T=[],v=!1,u&&u!="edit"&&r.create(u)}),Qi(()=>{Gt(),j.forEach(u=>l.event.off(u))}),(u,b)=>(Zi(),Ji("arcgis-sketch",{ref_key:"sketchEl",ref:a,style:{display:"none"}},null,512))}}),Jt=[{type:"point"},{type:"polyline"},{type:"polygon"},{type:"circle"},{type:"rectangle"}];class vs extends co{constructor(i,l){super(i,l);$t(this,"store");this.store=Ot(this.$vApp.$pinia)}_parseConfig(i){if(!i){this.store.setSupportedTypes(Jt);return}if(i.types!==void 0){const l=(i.types===null?[]:i.types).filter(s=>s.enabled!==!1);this.store.setSupportedTypes(l)}else this.store.setSupportedTypes(Jt);i.defaultTool&&this.store.setActiveTool(i.defaultTool)}get graphicsLayerId(){return rt}}const bs={en:{"draw.multiPoint.started":"{type} drawing started with 1 point","draw.multiPoint.pointAdded":"Point added {count} points total","draw.multiPoint.pointRemoved":"Point removed {count} points remaining","draw.multiPoint.canceled":"Drawing canceled","draw.multiPoint.completed":"{type} completed with {count} points","draw.multiPoint.notEnoughPoints":"Not enough points for {type} minimum {min} required","draw.graphic.created":"{type} created","draw.graphic.selected":"{type} selected","draw.graphic.deselected":"Graphic deselected","draw.graphic.deleted":"Graphic deleted","draw.graphic.updated":"Graphic updated","draw.graphic.none":"No graphic found","draw.tool.canceled":"Drawing tool canceled","draw.point.resize.unsupported":"Resizing not supported for point graphics","draw.point.rotate.unsupported":"Rotation not supported for point graphics","draw.move.up":"Moved up","draw.move.down":"Moved down","draw.move.left":"Moved left","draw.move.right":"Moved right","draw.resize.increase":"Increased size","draw.resize.decrease":"Decreased size","draw.rotate.clockwise":"Rotated clockwise","draw.rotate.counterclockwise":"Rotated counter-clockwise","draw.button.point":"Draw point","draw.button.polyline":"Draw line","draw.button.polygon":"Draw polygon","draw.button.rectangle":"Draw rectangle","draw.button.circle":"Draw circle","draw.point.tooltip":"Draw point","draw.polyline.tooltip":"Draw polyline","draw.polygon.tooltip":"Draw polygon","draw.circle.tooltip":"Draw circle","draw.rectangle.tooltip":"Draw rectangle","draw.edit.tooltip":"Edit Mode","draw.graphic.moved":"Graphic moved","draw.shape":"shape","draw.point":"point","draw.multipoint":"multipoint","draw.polyline":"polyline","draw.polygon":"polygon","draw.rectangle":"rectangle","draw.circle":"circle","draw.unknown":"unknown"},fr:{"draw.multiPoint.started":"Dessin de {type} commenc avec 1 point","draw.multiPoint.pointAdded":"Point ajout","draw.multiPoint.pointRemoved":"Point supprim","draw.multiPoint.canceled":"Dessin annul","draw.multiPoint.completed":"{type} termin avec {count} points","draw.multiPoint.notEnoughPoints":"Pas assez de points pour {type}","draw.graphic.created":"{type} cr","draw.graphic.selected":"{type} slectionn","draw.graphic.deselected":"Graphique dslectionn","draw.graphic.deleted":"Graphique supprim","draw.graphic.updated":"Graphique mis  jour","draw.graphic.none":"Aucun graphique trouv","draw.tool.canceled":"Outil de dessin annul","draw.point.resize.unsupported":"Le redimensionnement n'est pas pris en charge pour les points","draw.point.rotate.unsupported":"La rotation n'est pas prise en charge pour les points","draw.move.up":"Dplac vers le haut","draw.move.down":"Dplac vers le bas","draw.move.left":"Dplac vers la gauche","draw.move.right":"Dplac vers la droite","draw.resize.increase":"Taille augmente","draw.resize.decrease":"Taille rduite","draw.rotate.clockwise":"Rotation dans le sens horaire","draw.rotate.counterclockwise":"Rotation dans le sens antihoraire","draw.button.point":"Dessiner un point","draw.button.polyline":"Dessiner une ligne","draw.button.polygon":"Dessiner un polygone","draw.button.rectangle":"Dessiner un rectangle","draw.button.circle":"Dessiner un cercle","draw.point.tooltip":"Dessiner un point","draw.polyline.tooltip":"Dessiner une polyligne","draw.polygon.tooltip":"Dessiner un polygone","draw.circle.tooltip":"Dessiner un cercle","draw.rectangle.tooltip":"Dessiner un rectangle","draw.edit.tooltip":"Mode dition","draw.graphic.moved":"Graphique dplac","draw.shape":"forme","draw.point":"indiquer","draw.multipoint":"multipoint","draw.polyline":"polyligne","draw.polygon":"polygone","draw.rectangle":"rectangle","draw.circle":"cercle","draw.unknown":"inconnue"}};class ws extends vs{async init(){const{el:t}=this.mount(ms,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(t.childNodes[0]),Object.entries(bs).forEach(i=>this.$iApi.$i18n.mergeLocaleMessage(...i)),this._parseConfig(this.config),Ot(this.$vApp.$pinia).supportedTypes.forEach(i=>{const l=`${i.type}-icon`;this.$iApi.component(l,Xi(Io(Object.assign({"./icons/circle-icon.vue":()=>_(()=>import("./circle-icon-qM-Cul3g-DsLV7Twh.js"),__vite__mapDeps([223,3,4]),import.meta.url),"./icons/edit-icon.vue":()=>_(()=>import("./edit-icon-BBpkepd0-DfFC2xvQ.js"),__vite__mapDeps([224,3,4]),import.meta.url),"./icons/point-icon.vue":()=>_(()=>import("./point-icon-Dd_kLleb-DcsCqKrZ.js"),__vite__mapDeps([225,3,4]),import.meta.url),"./icons/polygon-icon.vue":()=>_(()=>import("./polygon-icon-CnplOIHx-Dtmq8G5B.js"),__vite__mapDeps([226,3,4]),import.meta.url),"./icons/polyline-icon.vue":()=>_(()=>import("./polyline-icon-BmsBSMJm-C1zf3Ijy.js"),__vite__mapDeps([227,3,4]),import.meta.url),"./icons/rectangle-icon.vue":()=>_(()=>import("./rectangle-icon-DaWElXKE-BRE9zRq5.js"),__vite__mapDeps([228,3,4]),import.meta.url)}),`./icons/${i.type}-icon.vue`,3)))})}async added(){this.$iApi.event.on(ti.MAP_CREATED,()=>{this.init()})}}const Sl=Object.freeze(Object.defineProperty({__proto__:null,default:ws},Symbol.toStringTag,{value:"Module"}));export{Re as c,Ko as e,Sl as i,hi as n,ai as r};
