import{ad as i}from"./index-DRDU_nTl.js";import{e as m,t as y,r as C,z as M,V as d}from"./utils-BfXZnjCE-SvVDBGfQ.js";function b(e,o,r,a){if(e)if(e.type!=="CIMTextSymbol"){if(e.effects)for(const t of e.effects)u(t,o);if(e.symbolLayers)for(const t of e.symbolLayers){switch(t.type){case"CIMPictureMarker":case"CIMVectorMarker":P(t,o,a);break;case"CIMPictureStroke":case"CIMSolidStroke":case"CIMGradientStroke":!(a!=null&&a.preserveOutlineWidth)&&t.width&&(t.width*=o);break;case"CIMPictureFill":t.height&&(t.height*=o),t.offsetX&&(t.offsetX*=o),t.offsetY&&(t.offsetY*=o);break;case"CIMHatchFill":b(t.lineSymbol,o,!0,{...a,preserveOutlineWidth:!1}),t.offsetX&&(t.offsetX*=o),t.offsetY&&(t.offsetY*=o),t.separation&&(t.separation*=o)}if(t.effects)for(const s of t.effects)u(s,o)}}else e.height!=null&&(e.height*=o)}function P(e,o,r){if(e&&(e.markerPlacement&&g(e.markerPlacement,o),e.offsetX&&(e.offsetX*=o),e.offsetY&&(e.offsetY*=o),e.anchorPoint&&e.anchorPointUnits==="Absolute"&&(e.anchorPoint={x:e.anchorPoint.x*o,y:e.anchorPoint.y*o}),e.size=e.size!=null?e.size*o:0,e.type==="CIMVectorMarker"&&e.markerGraphics))for(const a of e.markerGraphics)e.scaleSymbolsProportionally||b(a.symbol,o,!0,r)}function g(e,o){switch(M(e)&&e.offset&&(e.offset*=o),e.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(e.customEndingOffset&&(e.customEndingOffset*=o),e.offsetAlongLine&&(e.offsetAlongLine*=o),e.placementTemplate&&e.placementTemplate.length){const r=e.placementTemplate.map(a=>a*o);e.placementTemplate=r}break;case"CIMMarkerPlacementAlongLineVariableSize":if(e.maxRandomOffset&&(e.maxRandomOffset*=o),e.placementTemplate&&e.placementTemplate.length){const r=e.placementTemplate.map(a=>a*o);e.placementTemplate=r}break;case"CIMMarkerPlacementOnLine":e.startPointOffset&&(e.startPointOffset*=o);break;case"CIMMarkerPlacementAtExtremities":e.offsetAlongLine&&(e.offsetAlongLine*=o);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":e.beginPosition&&(e.beginPosition*=o),e.endPosition&&(e.endPosition*=o);break;case"CIMMarkerPlacementPolygonCenter":e.offsetX&&(e.offsetX*=o),e.offsetY&&(e.offsetY*=o);break;case"CIMMarkerPlacementInsidePolygon":e.offsetX&&(e.offsetX*=o),e.offsetY&&(e.offsetY*=o),e.stepX&&(e.stepX*=o),e.stepY&&(e.stepY*=o)}}function u(e,o){switch(e.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":e.width&&(e.width*=o);break;case"CIMGeometricEffectBuffer":e.size&&(e.size*=o);break;case"CIMGeometricEffectCut":e.beginCut&&(e.beginCut*=o),e.endCut&&(e.endCut*=o),e.middleCut&&(e.middleCut*=o);break;case"CIMGeometricEffectDashes":if(e.customEndingOffset&&(e.customEndingOffset*=o),e.offsetAlongLine&&(e.offsetAlongLine*=o),e.dashTemplate&&e.dashTemplate.length){const r=e.dashTemplate.map(a=>a*o);e.dashTemplate=r}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":e.length&&(e.length*=o);break;case"CIMGeometricEffectMove":e.offsetX&&(e.offsetX*=o),e.offsetY&&(e.offsetY*=o);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":e.offset&&(e.offset*=o);break;case"CIMGeometricEffectRegularPolygon":e.radius&&(e.radius*=o);break;case"CIMGeometricEffectTaperedPolygon":e.fromWidth&&(e.fromWidth*=o),e.length&&(e.length*=o),e.toWidth&&(e.toWidth*=o);break;case"CIMGeometricEffectWave":e.amplitude&&(e.amplitude*=o),e.period&&(e.period*=o)}}function G(e){const o=[];return f(m(e),o),o.length?new i(d(o[0])):null}function f(e,o){var t;if(!e)return;let r;r=e.type==="CIMTextSymbol"?e.symbol:e;const a=e.type==="CIMPolygonSymbol";if(r!=null&&r.symbolLayers){for(const s of r.symbolLayers)if(!(s.colorLocked||a&&(y(s)||C(s)&&s.markerPlacement&&M(s.markerPlacement))))switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":s.tintColor&&c(o,s.tintColor);break;case"CIMVectorMarker":(t=s.markerGraphics)==null||t.forEach(n=>{f(n.symbol,o)});break;case"CIMSolidStroke":case"CIMSolidFill":c(o,s.color);break;case"CIMGradientFill":S(o,s);break;case"CIMHatchFill":f(s.lineSymbol,o)}}}function c(e,o){for(const r of e)if(r.join(".")===o.join("."))return;e.push(o)}function S(e,o){var r,a;switch((r=o.colorRamp)==null?void 0:r.type){case"CIMMultipartColorRamp":(a=o.colorRamp.colorRamps)==null||a.forEach(t=>{t.type==="CIMLinearContinuousColorRamp"&&k(e,t)});break;case"CIMLinearContinuousColorRamp":case"CIMPolarContinuousColorRamp":k(e,o.colorRamp)}}function k(e,o){o&&(o.fromColor&&c(e,o.fromColor),o.toColor&&c(e,o.toColor))}function T(e,o,r){o instanceof i||(o=new i(o));const a=m(e);a&&l(a,o)}function l(e,o,r){var s;if(!e)return;let a;a=e.type==="CIMTextSymbol"?e.symbol:e;const t=(a==null?void 0:a.type)==="CIMPolygonSymbol";if(a!=null&&a.symbolLayers)for(const n of a.symbolLayers){if(n.colorLocked||t&&(y(n)||C(n)&&n.markerPlacement&&M(n.markerPlacement)))continue;const p=o.toArray();switch(n.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":n.tintColor=p;break;case"CIMVectorMarker":(s=n.markerGraphics)==null||s.forEach(h=>{l(h.symbol,o)});break;case"CIMSolidStroke":case"CIMSolidFill":n.color=p;break;case"CIMGradientFill":E(n,o);break;case"CIMHatchFill":l(n.lineSymbol,o)}}}function E(e,o){var r,a;switch((r=e.colorRamp)==null?void 0:r.type){case"CIMMultipartColorRamp":(a=e.colorRamp.colorRamps)==null||a.forEach(t=>{t.type==="CIMLinearContinuousColorRamp"&&I(t,o)});break;case"CIMLinearContinuousColorRamp":case"CIMPolarContinuousColorRamp":I(e.colorRamp,o)}}function I(e,o){if(e&&(e.fromColor&&(e.fromColor=o.toArray()),e.toColor)){const r=o.clone();r.a=0,e.toColor=r.toArray()}}function A(e,o,r=!1){const a=m(e);if(r&&(o=360-o),(a==null?void 0:a.type)!=="CIMTextSymbol"){if((a==null?void 0:a.type)==="CIMPointSymbol"&&a.symbolLayers){const t=o-(a.angle||0);for(const s of a.symbolLayers)if(C(s)){let n=s.rotation||0;s.rotateClockwise?n-=t:n+=t,s.rotation=n}a.angle=o}}else a.angle=o}export{b as C,T as E,A as R,G as g};
