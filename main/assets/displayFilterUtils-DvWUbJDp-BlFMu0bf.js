import{eW as m,eX as x,eY as s,eZ as l,e_ as T}from"./index-aQr1pzMk.js";function E(n,r){return{...r,filterMode:n.mode}}function Y(n,r){return I(n,r).next().value??null}function F(n,r,e){const t=h(n);if(t&&(s(r,t[0])||l(e,t[1])))return"";const i=Array.from(I(n,r,e)),o=b(i,r,e)?"1=1":i.map(u=>u.where||"1=1").reduce((u,a)=>T(u,a),"");return o&&o!=="1=1"?o:""}function h(n){if(d(n)==="manual")return null;const r=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:e,maxScale:t}of n.filters)r[0]=Math.max(r[0],c(e)),r[1]=Math.min(r[1],f(t));return r}function*I(n,r,e){if(d(n)==="manual"){const t=n.filters.find(i=>i.id===n.activeFilterId);t&&(yield t)}else{typeof r=="object"&&(r=r.scale);for(const t of n.filters)p(t.minScale,t.maxScale,r,e)&&(yield t)}}function b(n,r,e){var o,u;if(n.length===0)return!0;const t=c((o=n.at(0))==null?void 0:o.minScale),i=f((u=n.at(-1))==null?void 0:u.maxScale);if(l(t,r)||s(i,e))return!0;for(let a=0;a<n.length-1;a++){const S=n[a],N=n[a+1];if(l(c(N.minScale),f(S.maxScale)))return!0}return!1}function p(n,r,e,t){return n=c(n),e=c(e),r=f(r),!(!m(e,n)&&(t??e)>n)&&!x(r,e)&&(t===void 0||!m(t,n))}function d(n){return"mode"in n?n.mode:n.filterMode}function c(n){return n||Number.POSITIVE_INFINITY}function f(n){return n||0}export{F as T,E as b,Y as x};
