import{av as v,ar as T,aj as C,mq as w,nE as S,kS as D,aM as $,az as b,aA as x,m as r,E as o,n as k}from"./index-BeTPrQ6f.js";import{o as M}from"./mat2df64-VxtldH1S-CqyKAV7h.js";import{v as I,h as V,i as f}from"./drawSurfaces--K8ToToC-FllffqSc.js";import{Y as z,L as U,z as E,Z as L,I as W}from"./createUtils-QoBeynM5-wXx8RLRA.js";import{V as c}from"./jsxFactory-DN-m49_5-CUFCpKPo.js";import"./elevationInfoUtils-DFX5QvG8-DWLx2t7K.js";import"./ElevationInfo-tlrAM5SV-D86C1F9d.js";import"./lengthUtils-CopeXEyE-DjCEitlq.js";import"./ReactiveSet-DP8oFB7N-DSfeDz8k.js";import"./diffUtils-D3O4EfgX-CznKxD4n.js";import"./UpdatingHandles-XotKWqvb-CyHJIoZx.js";import"./SnappingContext-pR4ApgxC--JaBRde9.js";import"./vec2f64-CkowXrDb-3zFQ3LNH.js";import"./vec32-CI1xtKog-DFVYRcgb.js";import"./vec42-DHp-FUwt-Br7hmYJs.js";import"./vec4f64-DD-nkcCV-CSNWKRqG.js";import"./plane-wUwHaY3K-ZwGBF7HQ.js";import"./vectorStacks-B2ngxq6F-myhPBoPk.js";import"./quatf64-C16JxGFv-BKWK1F8U.js";import"./SketchViewModel-BCVIeloG-Cwmt4M0t.js";import"./projectionUtils-CsX1UTBu-DsZaU4xz.js";import"./projectBuffer-CMNsPBq1-CMpE7Jo3.js";import"./zscale-PLuFqpaL-BIEnWBsg.js";import"./GraphicsLayer-DPoztXf7-DWF8RDJT.js";import"./GraphicsCollection-CT-y6p3H-4XYPvC_j.js";import"./BlendLayer-D8oJmNCO-A0sTzbOF.js";import"./layerContainerType-CJrPp4UB-BIF7XAYP.js";import"./jsonUtils-Bl9MVnOR-Be8hf0yA.js";import"./parser-CXoJuqeV-C7irlk5U.js";import"./mat4f32-BdRMyjXW-CWt6U0BP.js";import"./mat4-R0VY9B_E-DoEP887i.js";import"./ScaleRangeLayer-DkZwCH6_-C95kTMqN.js";import"./editableLayers-BTZOOiKD-ByJ-Oydo.js";import"./utils-DqlCEhl6-DBO0-7VG.js";import"./Queue-CK6TduSr-C-T211SM.js";import"./signal-DHxLvooI-Bin-tnuW.js";import"./Version-DSJSGSLA-Cg87msWM.js";import"./asyncUtils-Cu__bxqs-ecCTUaGV.js";import"./projectVectorToVector-OCoJKalB-CQIDHzSm.js";import"./projectPointToVector-BHS0gJJf-DOVZH8Fn.js";import"./Query-DKLDaFaA-I4zhlfzt.js";import"./Field-Dn1Bgq7n-CJCGLoNR.js";import"./fieldType-DvW5hpfa-DYUbIy_X.js";import"./geodesicUtils-DHDMXkUY-CP5HeHA5.js";import"./sphere-CIGsF4vz-C3zVQu9y.js";import"./quantityUtils-v7kjLywD-Cq6IoGLM.js";import"./geodeticLengthOperator-CMi-Z1ZN-WUImro4E.js";import"./geodeticCurveType-D_etKnbP-CirnHLSB.js";import"./earcut-C6NeZYSh-P2HUZ781.js";import"./triangle-DA_o7I-u-CHbj6sRJ.js";import"./lineSegment-D8lwRkdT-CnWWOaLb.js";import"./spatialReferenceEllipsoidUtils-Ty3j4VoE-BUAsRqCF.js";import"./rotate-ClH9iv5s-CoX5oM8l.js";import"./curveOperationUtils-ClbIvhut-17Ywjz26.js";import"./meshVertexSpaceUtils-EbHpWZGf-CmRuaT8m.js";import"./MeshLocalVertexSpace-CxmyTFZH-DhgfYuby.js";import"./hydratedFeatures-82j52esm-6EbRngQ4.js";import"./angularMeasurementUtils-CVK8K4WU-C6RO-Ta3.js";import"./Cyclical-Bzwh_QaL-CXh-hbnA.js";import"./Scheduler-D_tOhFWn-SFGb1GBz.js";import"./debugFlags-vZXEBr68-Bc51Oe-E.js";import"./distanceOperator-C3n_j88h-CjjOO0Zj.js";import"./Point2D-BVUQyGsf-qih0ZuJV.js";import"./Distance2DCalculator-CXhBP-8I-CW7HDKXX-kSux2duE.js";import"./ProjectionTransformation-BXUROh_s-kKBZ5FDB.js";import"./Envelope2D-2iYexKQo-BCKocNS7.js";import"./Transformation2D-CZCvoz9N-B-IhcWnl.js";import"./SimpleGeometryCursor-DSF_YyIm-TAMgMsbK.js";import"./OperatorDefinitions-DJdq_wrt-DP7_WWTp.js";import"./apiConverter-Djde5pBD-Dr3vspB4.js";import"./jsonConverter-CiKBkr5U-C590VlCu.js";import"./simplifyOperator-CK8t6p1S-COLMjdqn.js";import"./operatorSimplify-BRKLCaj2-DisWK8Yh.js";import"./mat2d-Cf4xHr3Z-u09Kv-lR.js";import"./quat-B6H0knG8-DtO1-hlf.js";import"./intl-DRhjUnwt-Dihhq8dq.js";import"./messages-DQ10DjvF-6kk0dzjG.js";import"./uuid-CFz2qBzH-cIdlpVG-.js";import"./sanitizerUtils-CrdmaILo-DztC6Qnx.js";let i=class extends C{constructor(t){super(t),this.coordinates=void 0,this.strokeDash=[],this.strokeWidth=1,this.strokeColor=[0,0,0,1],this.strokeDashColor=[255,255,255,1],this.fillColor=[0,0,0,0],this.visible=!0,this.isDecoration=!0}get _strokeStyle(){const t=this.strokeColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _strokeBackgroundStyle(){const t=this.strokeDashColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _fillStyle(){const t=this.fillColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _renderCoordinates(){const t=[];if(!this.coordinates)return{coordinates:t,rect:w};const e=S(D($(w),this.coordinates),2*this.strokeWidth);e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]+.5),e[3]=Math.ceil(e[3]+.5);for(const s of this.coordinates)t.push([Math.floor(s[0]-e[0])+.5,Math.floor(s[1]-e[1])+.5]);return t.reverse(),{coordinates:t,rect:e}}render(){const{coordinates:t,rect:e}=this._renderCoordinates,s=b(e),n=x(e);return c("div",{classes:{"esri-outline-overlay-item":!0},styles:{left:e[0]+"px",top:e[1]+"px",width:s+"px",height:n+"px",visibility:this.visible?"visible":"hidden"}},c("svg",{height:n,styles:{display:"block"},width:s},c("polygon",{fill:this._fillStyle,points:t.map(([p,l])=>`${p},${l}`).join(" "),stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),c("polygon",{fill:"transparent",points:t.map(([p,l])=>`${p},${l}`).join(" "),stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.length?this.strokeDash.join(" "):void 0,"stroke-width":this.strokeWidth})))}renderCanvas(){}};r([o()],i.prototype,"coordinates",void 0),r([o()],i.prototype,"strokeDash",void 0),r([o()],i.prototype,"strokeWidth",void 0),r([o()],i.prototype,"strokeColor",void 0),r([o()],i.prototype,"strokeDashColor",void 0),r([o()],i.prototype,"fillColor",void 0),r([o()],i.prototype,"visible",void 0),r([o()],i.prototype,"isDecoration",void 0),r([o({readOnly:!0})],i.prototype,"_strokeStyle",null),r([o({readOnly:!0})],i.prototype,"_strokeBackgroundStyle",null),r([o({readOnly:!0})],i.prototype,"_fillStyle",null),r([o({readOnly:!0})],i.prototype,"_renderCoordinates",null),i=r([k("esri.views.overlay.OutlineOverlayItem")],i);let a=class extends I{constructor(t){super(t),this.drawOperation=null,this._overlayItem=void 0,this.geometryType=null,this.mode=null,this.type="draw-screen"}initialize(){this.drawOperation=this._makeDrawOperation();const t=e=>{var s;return((s=this.drawOperation)==null?void 0:s.on(e,n=>{this._updateVisuals(),this.emit(e,n)}))??v()};this.addHandles([t("vertex-add"),t("vertex-remove"),t("vertex-update"),t("cursor-update"),t("complete")]),this.finishToolCreation()}destroy(){this.drawOperation=T(this.drawOperation),this._set("view",null)}get canRedo(){var t;return!!((t=this.drawOperation)!=null&&t.canRedo)}get canUndo(){var t;return!!((t=this.drawOperation)!=null&&t.canUndo)}set centeredToggled(t){this._set("centeredToggled",t),this._updateVisuals()}set enabled(t){const{drawOperation:e}=this;e&&(e.interactive=t),this._set("enabled",t)}set uniformSizeToggled(t){this._set("uniformSizeToggled",t),this._updateVisuals()}get updating(){var t;return((t=this.drawOperation)==null?void 0:t.updating)??!1}get cursor(){return this._get("cursor")??"crosshair"}set cursor(t){this._set("cursor",t);const{drawOperation:e}=this;e&&(e.cursor=t)}completeCreateOperation(){var t;(t=this.drawOperation)==null||t.complete()}onInputEvent(t){var e;this.destroyed||((e=this.drawOperation)==null||e.onInputEvent(t))}redo(){var t;(t=this.drawOperation)==null||t.redo()}undo(){var t;(t=this.drawOperation)==null||t.undo()}reset(){}_makeDrawOperation(){const{view:t}=this;return new V({view:t,manipulators:this.manipulators,geometryType:j(this.geometryType),drawingMode:this.mode,hasZ:!1,defaultZ:0,snapToSceneEnabled:!1,drawSurface:new f,hasM:!1,snappingManager:null,snappingVisualizer:null,graphic:null,cursor:this.cursor,automaticLengthMeasurementUtils:this.automaticLengthMeasurementUtils})}get coordinates(){var l,u,y;const{drawOperation:t}=this;if(!(t!=null&&t.geometryIncludingUncommittedVertices.length))return[];const{coordinateHelper:e}=t,s=t.committableVertex,n=t.committedVertices.slice();s!=null&&n.push(e.pointToArray(s));const p=n.length;switch(this.geometryType){case"point":return n.slice(0,1);case"circle":case"rectangle":{const d=new z(M,f.spatialReference),g=this.geometryType==="circle"?U:E,O=this.geometryType==="circle"?L:W;if(p===1&&t.isCompleted){const m=n[0],h=d.makeMapPoint(m[0]+H,m[1]);return((l=g([m,h],d,!0))==null?void 0:l.geometry.rings[0])??[]}if(p===2){const m=this.geometryType!=="rectangle",h=this.centeredToggled!==m,_=this.geometryType!=="rectangle";return(this.uniformSizeToggled!==_?(u=g(n,d,h))==null?void 0:u.geometry.rings[0]:(y=O(n,d,h))==null?void 0:y.geometry.rings[0])??[]}return[]}}return n}_updateVisuals(){var t;if(!this._overlayItem){const e=new i({strokeDash:[5],strokeDashColor:[255,255,255,255]});(t=this.view.overlay)==null||t.addItem(e),this.addHandles(v(()=>{var s;(s=this.view.overlay)==null||s.removeItem(e),e==null||e.destroy(),this._overlayItem=void 0})),this._overlayItem=e}this._overlayItem.coordinates=this.coordinates}onDeactivate(){var t,e;(t=this.drawOperation)!=null&&t.isCompleted||((e=this.drawOperation)==null||e.cancel())}};function j(t){switch(t){case"polygon":case"point":return t;case"circle":case"rectangle":return"segment"}}r([o({value:!1})],a.prototype,"centeredToggled",null),r([o()],a.prototype,"drawOperation",void 0),r([o({value:!0})],a.prototype,"enabled",null),r([o({value:!1})],a.prototype,"uniformSizeToggled",null),r([o({constructOnly:!0})],a.prototype,"geometryType",void 0),r([o({constructOnly:!0})],a.prototype,"mode",void 0),r([o({readOnly:!0})],a.prototype,"type",void 0),r([o({readOnly:!0})],a.prototype,"updating",null),r([o({constructOnly:!0,nonNullable:!0})],a.prototype,"view",void 0),r([o({constructOnly:!0})],a.prototype,"automaticLengthMeasurementUtils",void 0),r([o()],a.prototype,"cursor",null),a=r([k("esri.views.draw.DrawScreenTool")],a);const H=48;export{a as DrawScreenTool,j as geometryTypeToDrawOperationGeometryType};
