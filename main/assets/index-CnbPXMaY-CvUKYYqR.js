import{ar as I,as as N,a_ as S,aw as O,aR as T,gk as V,aG as p,ax as _,aS as D,aI as G,at as $,aJ as H,aK as J,az as P,aL as W,aC as x,gV as Y,aM as F,hm as K,aE as Q}from"./index-uAe2c5m-.js";const U={class:"swipe-container"},q=["id","aria-valuenow","aria-label","content"],X=["swipe-position","view"],j=I({__name:"swipe",props:{fixture:{type:S,required:!0},message:String},setup(k){const s=O("iApi"),w=T(),e=V("slider"),f=p(45),L=p(0),h=p(0),b=p(50),A=p(),t=p(),M=_(()=>{var y,u,d,c;const a=30+h.value-h.value,v=(y=e.value)!=null&&y.getBoundingClientRect()?((u=e.value)==null?void 0:u.getBoundingClientRect().right)-((d=e.value)==null?void 0:d.getBoundingClientRect().left):0,r=+f.value/90,l=(v-a)*r,o=(((c=e.value)==null?void 0:c.getBoundingClientRect().x)??0)+l+(a-5.25)/2;return b.value=o/s.$rootEl.clientWidth*100+.2,`${o}px`}),z=_(()=>`${L.value}px`),B=_(()=>`${-L.value/2-18}px`);D(()=>{var a;L.value=((a=s.$rootEl)==null?void 0:a.clientHeight)??1200});const C=()=>{var a;L.value=((a=s.$rootEl)==null?void 0:a.clientHeight)??L.value,h.value++,setTimeout(()=>{h.value++},50)},m=()=>{w.setOpacity(.1),e.value.style.background=""},g=()=>{w.setOpacity(1),e.value.style.background="inherit"};G(async()=>{var a,v,r,l,o,y;"ontouchstart"in document.documentElement||!window.matchMedia("(pointer:fine)").matches||(e.value.style.background="inherit"),window.addEventListener("resize",C),(a=e.value)==null||a.addEventListener("focus",m),(v=e.value)==null||v.addEventListener("blur",g),(r=e.value)==null||r.addEventListener("mouseover",m),(l=e.value)==null||l.addEventListener("mouseleave",g),(o=e.value)==null||o.addEventListener("touchstart",m),(y=e.value)==null||y.addEventListener("touchend",g),setTimeout(()=>{h.value++},50),await R(),s.event.on($.MAP_BASEMAPCHANGE,async u=>{var d,c;u.schemaChanged&&((d=t.value)==null||d.trailingLayers.forEach(n=>{var i;(i=t.value)==null||i.trailingLayers.remove(n)}),(c=t.value)==null||c.leadingLayers.forEach(n=>{var i;(i=t.value)==null||i.leadingLayers.remove(n)}),await R())}),s.event.on($.LAYER_RELOAD_END,u=>{var d,c;(d=t.value)==null||d.trailingLayers.forEach(n=>{var i,E;n.id===u.id&&((i=t.value)==null||i.trailingLayers.remove(n),(E=t.value)==null||E.trailingLayers.add(u.esriLayer))}),(c=t.value)==null||c.leadingLayers.forEach(n=>{var i,E;n.id===u.id&&((i=t.value)==null||i.leadingLayers.remove(n),(E=t.value)==null||E.leadingLayers.add(u.esriLayer))})}),s.event.on($.LAYER_REMOVE,u=>{var d,c;(d=t.value)==null||d.trailingLayers.forEach(n=>{var i;n.id===u.id&&((i=t.value)==null||i.trailingLayers.remove(n))}),(c=t.value)==null||c.leadingLayers.forEach(n=>{var i;n.id===u.id&&((i=t.value)==null||i.leadingLayers.remove(n))})})});const R=async()=>{await s.geo.map.viewPromise,A.value=s.geo.map.esriView;const a=["Nature","WFSLayer"],v=["Water","GeoMet"];a.forEach(r=>{s.geo.layer.awaitLayer(r,!0).then(l=>{var o;l.esriLayer?(o=t.value)==null||o.trailingLayers.add(l.esriLayer):console.warn(`Invalid layer instance: ${r}`)})}),v.forEach(r=>{s.geo.layer.awaitLayer(r,!0).then(l=>{var o;l.esriLayer?(o=t.value)==null||o.leadingLayers.add(l.esriLayer):console.warn(`Invalid layer instance: ${r}`)})})};return H(()=>{var a,v,r,l,o,y;window.removeEventListener("resize",C),(a=e.value)==null||a.removeEventListener("focus",()=>m),(v=e.value)==null||v.removeEventListener("blur",()=>g),(r=e.value)==null||r.removeEventListener("mouseover",m),(l=e.value)==null||l.removeEventListener("mouseleave",g),(o=e.value)==null||o.removeEventListener("touchstart",m),(y=e.value)==null||y.removeEventListener("touchend",g)}),(a,v)=>{const r=J("tippy");return P(),W("div",U,[x("div",{class:"verticalLine",style:Y({left:M.value,height:z.value,bottom:B.value})},null,4),F(x("input",{"onUpdate:modelValue":v[0]||(v[0]=l=>f.value=l),id:"layerSlider"+Q(s).$element._uid,class:"layerSliderElement",type:"range",ref_key:"slider",ref:e,min:"0","aria-valuemin":"0","aria-valuemax":"90","aria-valuenow":f.value,"aria-label":a.$t("map.layerSwipe.label"),max:"90",step:"0.5",content:a.$t("map.layerSwipe.drag"),style:{"z-index":10}},null,8,q),[[K,f.value],[r,{followCursor:!0,trigger:"mouseenter"}]]),x("arcgis-swipe",{direction:"horizontal","swipe-position":b.value,view:A.value,"auto-destroy-disable":"",ref_key:"swipeComponent",ref:t},null,8,X)])}}}),Z=N(j,[["__scopeId","data-v-0804fa06"]]);class ae extends S{async added(){const{el:s,destroy:w}=this.mount(Z,{app:this.$element,props:{message:"This is a swipe.",fixture:this}});s.childNodes[0]&&this.$vApp.$el.appendChild(s.childNodes[0]),this.removed=()=>{w()}}}export{ae as default};
