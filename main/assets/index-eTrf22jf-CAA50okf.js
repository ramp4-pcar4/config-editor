import{fv as k,fw as T,g2 as M,fA as z,fV as D,gm as G,fK as p,fB as _,fW as P,fM as V,fx as $,fN as W,fO as H,fD as Y,fP as q,fG as x,h3 as F,fQ as K,hw as Q,fI as U}from"./index-JysQxb7m.js";const J={class:"swipe-container"},j=["id","aria-valuenow","aria-label","content"],X=["swipe-position","view"],Z=k({__name:"swipe",props:{fixture:{type:M,required:!0},message:String},setup(B){const u=z("iApi"),w=D(),e=G("slider"),b=p(45),L=p(0),f=p(0),A=p(50),C=p(),a=p(),I=_(()=>{var m,h,i,s;const t=30+f.value-f.value,d=(m=e.value)!=null&&m.getBoundingClientRect()?((h=e.value)==null?void 0:h.getBoundingClientRect().right)-((i=e.value)==null?void 0:i.getBoundingClientRect().left):0,n=+b.value/90,l=(d-t)*n,v=(((s=e.value)==null?void 0:s.getBoundingClientRect().x)??0)+l+(t-5.25)/2;return A.value=v/u.$rootEl.clientWidth*100+.2,`${v}px`}),N=_(()=>`${L.value}px`),O=_(()=>`${-L.value/2-18}px`);P(()=>{var t;L.value=((t=u.$rootEl)==null?void 0:t.clientHeight)??1200});const S=()=>{var t;L.value=((t=u.$rootEl)==null?void 0:t.clientHeight)??L.value,f.value++,setTimeout(()=>{f.value++},50)},y=()=>{w.setOpacity(.1),e.value.style.background=""},g=()=>{w.setOpacity(1),e.value.style.background="inherit"};V(async()=>{var d,n,l,v,m,h;"ontouchstart"in document.documentElement||!window.matchMedia("(pointer:fine)").matches||(e.value.style.background="inherit"),window.addEventListener("resize",S),(d=e.value)==null||d.addEventListener("focus",y),(n=e.value)==null||n.addEventListener("blur",g),(l=e.value)==null||l.addEventListener("mouseover",y),(v=e.value)==null||v.addEventListener("mouseleave",g),(m=e.value)==null||m.addEventListener("touchstart",y),(h=e.value)==null||h.addEventListener("touchend",g),setTimeout(()=>{f.value++},50),await R();const t=()=>{var s;const i=(s=a.value)==null?void 0:s.querySelector(".arcgis-swipe__container");return i?(i.removeAttribute("tabindex"),!0):!1};if(!t()){const i=new MutationObserver((s,c)=>{t()&&c.disconnect()});i.observe(a.value,{childList:!0,subtree:!0,attributes:!1}),setTimeout(()=>i.disconnect(),5e3)}u.event.on($.MAP_BASEMAPCHANGE,async i=>{var s,c;i.schemaChanged&&((s=a.value)==null||s.trailingLayers.forEach(o=>{var r;(r=a.value)==null||r.trailingLayers.remove(o)}),(c=a.value)==null||c.leadingLayers.forEach(o=>{var r;(r=a.value)==null||r.leadingLayers.remove(o)}),await R())}),u.event.on($.LAYER_RELOAD_END,i=>{var s,c;(s=a.value)==null||s.trailingLayers.forEach(o=>{var r,E;o.id===i.id&&((r=a.value)==null||r.trailingLayers.remove(o),(E=a.value)==null||E.trailingLayers.add(i.esriLayer))}),(c=a.value)==null||c.leadingLayers.forEach(o=>{var r,E;o.id===i.id&&((r=a.value)==null||r.leadingLayers.remove(o),(E=a.value)==null||E.leadingLayers.add(i.esriLayer))})}),u.event.on($.LAYER_REMOVE,i=>{var s,c;(s=a.value)==null||s.trailingLayers.forEach(o=>{var r;o.id===i.id&&((r=a.value)==null||r.trailingLayers.remove(o))}),(c=a.value)==null||c.leadingLayers.forEach(o=>{var r;o.id===i.id&&((r=a.value)==null||r.leadingLayers.remove(o))})})});const R=async()=>{await u.geo.map.viewPromise,C.value=u.geo.map.esriView;const t=["Nature","WFSLayer"],d=["Water","GeoMet"];t.forEach(n=>{u.geo.layer.awaitLayer(n,!0).then(l=>{var v;l.esriLayer?(v=a.value)==null||v.trailingLayers.add(l.esriLayer):console.warn(`Invalid layer instance: ${n}`)})}),d.forEach(n=>{u.geo.layer.awaitLayer(n,!0).then(l=>{var v;l.esriLayer?(v=a.value)==null||v.leadingLayers.add(l.esriLayer):console.warn(`Invalid layer instance: ${n}`)})})};return W(()=>{var t,d,n,l,v,m;window.removeEventListener("resize",S),(t=e.value)==null||t.removeEventListener("focus",()=>y),(d=e.value)==null||d.removeEventListener("blur",()=>g),(n=e.value)==null||n.removeEventListener("mouseover",y),(l=e.value)==null||l.removeEventListener("mouseleave",g),(v=e.value)==null||v.removeEventListener("touchstart",y),(m=e.value)==null||m.removeEventListener("touchend",g)}),(t,d)=>{const n=H("tippy");return Y(),q("div",J,[x("div",{class:"verticalLine",style:F({left:I.value,height:N.value,bottom:O.value})},null,4),K(x("input",{"onUpdate:modelValue":d[0]||(d[0]=l=>b.value=l),id:"layerSlider"+U(u).$element._uid,class:"layerSliderElement",type:"range",ref_key:"slider",ref:e,min:"0","aria-valuemin":"0","aria-valuemax":"90","aria-valuenow":b.value,"aria-label":t.$t("map.layerSwipe.label"),max:"90",step:"0.5",content:t.$t("map.layerSwipe.drag"),style:{"z-index":10}},null,8,j),[[Q,b.value],[n,{followCursor:!0,trigger:"mouseenter"}]]),x("arcgis-swipe",{direction:"horizontal","swipe-position":A.value,view:C.value,"auto-destroy-disable":"",ref_key:"swipeComponent",ref:a},null,8,X)])}}}),ee=T(Z,[["__scopeId","data-v-4d9acbf1"]]);class te extends M{async added(){const{el:u,destroy:w}=this.mount(ee,{app:this.$element,props:{fixture:this}});u.childNodes[0]&&this.$vApp.$el.appendChild(u.childNodes[0]),this.removed=()=>{w()}}}export{te as default};
