var A=Object.defineProperty;var f=(s,i,e)=>i in s?A(s,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[i]=e;var o=(s,i,e)=>f(s,typeof i!="symbol"?i+"":i,e);import{h1 as c,fx as m,h2 as g,g2 as d}from"./index-DECxckyg.js";class v extends d{_parseConfig(i){if(i){const e=c(this.$vApp.$pinia);i.alwaysOn&&e.setAlwaysOn(!0);const t=i.extentSetIds;t&&Array.isArray(t)&&t.length>0&&e.setExtentSetIds(t)}}get config(){return super.config}}function r(s,i,e,t){const n=s-i,a=i+n/2,h=Math.min(n,e-t);return a>e?{min:e-h,max:e,changed:!0}:a<t?{min:t,max:t+h,changed:!0}:{min:i,max:s,changed:!1}}class u extends v{constructor(){super(...arguments);o(this,"schemaEH","");o(this,"extentEH","")}added(){this._parseConfig(this.config);const e=this.$vApp.$watch(()=>this.config,t=>this._parseConfig(t));this.removed=()=>{e(),c(this.$vApp.$pinia).$reset(),this.evtOff("schemaEH"),this.evtOff("extentEH")},this.schemaEH=this.$iApi.event.on(m.MAP_BASEMAPCHANGE,t=>{t.schemaChanged&&this.checkActive()}),this.$iApi.geo.map.created?this.checkActive():this.$iApi.event.once(m.MAP_CREATED,()=>{this.checkActive()})}checkActive(){const e=c(this.$vApp.$pinia);e.alwaysOn||e.extentSetIds.includes(this.$iApi.geo.map.getExtentSet().id)?e.active||(e.setActive(!0),this.extentEH=this.$iApi.event.on(m.MAP_EXTENTCHANGE,t=>{e.enforcing||this.enforceBoundary(t,!1)})):e.active&&(e.setActive(!1),this.evtOff("extentEH"))}evtOff(e){this[e]&&(this.$iApi.event.off(this[e]),this[e]="")}enforceBoundary(e,t){const n=this.$iApi.geo.map.getExtentSet().maximumExtent,a=r(e.xmax,e.xmin,n.xmax,n.xmin),h=r(e.ymax,e.ymin,n.ymax,n.ymin);if(h.changed||a.changed){t&&(this.$iApi.geo.map.esriView.extent=n.toESRI());const x=g.fromParams("extguard",a.min,h.min,a.max,h.max,e.sr),p=c(this.$vApp.$pinia);p.setEnforcing(!0),setTimeout(()=>{this.$iApi.geo.map.zoomMapTo(x,void 0,!0,400,"ease-in-out").then(()=>{p.setEnforcing(!1),this.enforceBoundary(this.$iApi.geo.map.getExtent(),!0)})},150)}}}export{u as default};
