import{i as A,u as Dn,I as On,m as vn}from"./TimeOnly-BFfVS_ja-C4MPGwCM.js";import{b5 as k,w as p,z as b,s as y,r as N,K as L,F as K,bf as Sn,aR as Mn,dt as Jn,c$ as Rn,cB as yn,C as W,d3 as In,H as X,D as nn,B as D,bm as Pn,b as jn,du as Ln,be as zn}from"./index-BeTPrQ6f.js";import{c as w}from"./enum-D3e-PyKo-Bl5V5br5.js";import{n as _}from"./ImmutableArray-CiJxhY8_-Kqx7aWRu.js";import{b as Yn,M as pn}from"./shared-DXZ65waB-BM-XH3jC.js";import{z as Gn,M as Vn}from"./number-BsNxu9Ry-D0lLRJTw.js";let tn=class{};class J{constructor(){}}function bn(n,t,r){if(n instanceof J&&!(n instanceof E)){const s=new E;return s.fn=n,s.parameterEvaluator=r,s.context=t,s}return n}class Dt extends J{constructor(t){super(),this.fn=t}createFunction(t){return(...r)=>this.fn(t,{preparsed:!0,arguments:r})}call(t,r){return this.fn(t,r)}marshalledCall(t,r,s,e){return e(t,r,(a,i,o)=>{o=o.map(c=>c instanceof J&&!(c instanceof E)?bn(c,t,e):c);const m=this.call(s,{args:o});return Mn(m)?m.then(c=>bn(c,s,e)):m})}}class E extends J{constructor(){super(...arguments),this.fn=null,this.context=null}createFunction(t){return this.fn.createFunction(this.context)}call(t,r){return this.fn.marshalledCall(t,r,this.context,this.parameterEvaluator)}marshalledCall(t,r,s){return this.fn.marshalledCall(t,r,this.context,this.parameterEvaluator)}}let I=class Nn extends _{constructor(t,r,s,e,a,i){super(t),this._lazyPt=[],this._hasZ=!1,this._hasM=!1,this._spRef=r,this._hasZ=s,this._hasM=e,this._cacheId=a,this._partId=i}get(t){if(this._lazyPt[t]===void 0){const r=this._elements[t];if(r===void 0)return;const s=new D(r[0],r[1],this._spRef);this._hasZ&&(s.z=r[2]),this._hasM&&(s.m=this._hasZ?r[3]:r[2]),s.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+t.toString(),this._lazyPt[t]=s}return this._lazyPt[t]}equalityTest(t){return t===this||t!==null&&t instanceof Nn&&t.getUniqueHash()===this.getUniqueHash()}getUniqueHash(){return this._cacheId.toString()+"-"+this._partId.toString()}};class rn extends _{constructor(t,r,s,e,a){super(t),this._lazyPath=[],this._hasZ=!1,this._hasM=!1,this._hasZ=s,this._hasM=e,this._spRef=r,this._cacheId=a}get(t){if(this._lazyPath[t]===void 0){const r=this._elements[t];if(r===void 0)return;this._lazyPath[t]=new I(r,this._spRef,this._hasZ,this._hasM,this._cacheId,t)}return this._lazyPath[t]}equalityTest(t){return t===this||t!==null&&t instanceof rn&&t.getUniqueHash()===this.getUniqueHash()}getUniqueHash(){return this._cacheId.toString()}}class $n{constructor(t){this.value=t}}class Hn{constructor(t){this.value=t}}const g={type:"VOID"},qn=Symbol("BREAK"),En=Symbol("CONTINUE");function R(n,t,r){return t===""||t==null||t===r||t===r?n:n=n.split(t).join(r)}function M(n){return n instanceof J}function en(n){return n instanceof tn}function O(n){return!!y(n)||!!b(n)||!!u(n)||!!h(n)||!!d(n)||!!p(n)||n===null||n===g}function Un(n,t){return n===void 0?t:n}function Qn(n){return n==null?"":N(n)||T(n)?"Array":u(n)?"Date":d(n)?"Time":h(n)?"DateOnly":y(n)?"String":p(n)?"Boolean":b(n)?"Number":(n==null?void 0:n.declaredClass)==="esri.arcade.Attachment"?"Attachment":(n==null?void 0:n.declaredClass)==="esri.arcade.Portal"?"Portal":(n==null?void 0:n.declaredClass)==="esri.arcade.Dictionary"?"Dictionary":cn(n)?"KnowledgeGraph":n instanceof tn?"Module":P(n)?"Feature":n instanceof D?"Point":n instanceof W?"Polygon":n instanceof X?"Polyline":n instanceof nn?"Multipoint":n instanceof K?"Extent":M(n)?"Function":on(n)?"FeatureSet":un(n)?"FeatureSetCollection":sn(n)?"Voxel":an(n)?"Pixel":n===g?"":typeof n=="number"&&isNaN(n)?"Number":"Unrecognized Type"}function Zn(n){return n===g}function V(n){return n instanceof k}function P(n){return(n==null?void 0:n.arcadeDeclaredClass)==="esri.arcade.Feature"}function sn(n){return(n==null?void 0:n.arcadeDeclaredClass)==="esri.arcade.Voxel"}function an(n){return(n==null?void 0:n.arcadeDeclaredClass)==="esri.arcade.Pixel"}function on(n){return(n==null?void 0:n.declaredRootClass)==="esri.arcade.featureset.support.FeatureSet"}function ln(n){return(n==null?void 0:n.declaredClass)==="esri.arcade.Dictionary"}function Bn(n){return ln(n)||P(n)||sn(n)||an(n)}function un(n){return(n==null?void 0:n.declaredRootClass)==="esri.arcade.featureSetCollection"}function cn(n){return(n==null?void 0:n.declaredClass)==="esri.rest.knowledgeGraph.KnowledgeGraph"}function T(n){return n instanceof _}function u(n){return n instanceof A}function h(n){return n instanceof On}function d(n){return n instanceof Dn}function U(n){return n!=null&&typeof n=="object"}function Kn(n,t,r,s,e){if(n.length<t||n.length>r)throw new w(s,"WrongNumberOfParameters",e)}function Wn(n){return n==null||Zn(n)||n===""}function Xn(n){return n<0?-Math.round(-n):Math.round(n)}function fn(n,t){return isNaN(n)||t==null||t===""?n.toString():(t=R(t,"‰",""),t=R(t,"¤",""),Gn(n,{pattern:t}))}function $(n,t){return t==null||t===""?n.toISOString(!0):n.toFormat(wn(t),{locale:Sn(),numberingSystem:"latn"})}function wn(n,t=!1){n=n.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let r="";const s=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|Z{1,5}|.)/g;for(const e of n.match(s)||[])switch(e){case"D":r+="d";break;case"DD":r+="dd";break;case"DDD":r+="o";break;case"d":r+="c";break;case"ddd":r+="ccc";break;case"dddd":r+="cccc";break;case"M":r+="L";break;case"MM":r+="LL";break;case"MMM":r+="LLL";break;case"MMMM":r+="LLLL";break;case"YY":r+="yy";break;case"Y":case"YYYY":r+="yyyy";break;case"Q":r+="q";break;case"Z":r+="Z";break;case"ZZ":r+="ZZ";break;case"ZZZ":r+="ZZZ";break;case"ZZZZ":r+=t?"[ZZZZ]":"ZZZZ";break;case"ZZZZZ":r+=t?"[ZZZZZ]":"ZZZZZ";break;case"S":r+="'S'";break;case"SS":r+="'SS'";break;case"SSS":r+="u";break;case"A":case"a":r+="a";break;case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":case"X":case"x":r+=e;break;default:e.length>=2&&e.startsWith("[")&&e.endsWith("]")?r+=`'${e.slice(1,-1)}'`:r+=`'${e}'`}return r}function l(n,t,r){switch(r){case">":return n>t;case"<":return n<t;case">=":return n>=t;case"<=":return n<=t}return!1}function nt(n,t,r){if(n===null){if(t===null||t===g)return l(null,null,r);if(b(t))return l(0,t,r);if(y(t)||p(t))return l(0,f(t),r);if(u(t))return l(0,t.toNumber(),r);if(d(t)||h(t))return l(n,t.toNumber(),r)}if(n===g){if(t===null||t===g)return l(null,null,r);if(b(t))return l(0,t,r);if(y(t)||p(t))return l(0,f(t),r);if(u(t))return l(0,t.toNumber(),r);if(d(t)||h(t))return l(n,t.toNumber(),r)}else if(b(n)){if(b(t))return l(n,t,r);if(p(t))return l(n,f(t),r);if(t===null||t===g)return l(n,0,r);if(y(t))return l(n,f(t),r);if(u(t)||d(t)||h(t))return l(n,t.toNumber(),r)}else if(y(n)){if(y(t))return l(C(n),C(t),r);if(u(t)||d(t)||h(t))return l(f(n),t.toNumber(),r);if(b(t))return l(f(n),t,r);if(t===null||t===g)return l(f(n),0,r);if(p(t))return l(f(n),f(t),r)}else if(u(n)){if(u(t))return n.timeZone!==t.timeZone&&(n.isUnknownTimeZone?n=A.arcadeDateAndZoneToArcadeDate(n,t.timeZone):t.isUnknownTimeZone&&(t=A.arcadeDateAndZoneToArcadeDate(t,n.timeZone))),l(n.toNumber(),t.toNumber(),r);if(t===null||t===g)return l(n.toNumber(),0,r);if(b(t))return l(n.toNumber(),t,r);if(p(t)||y(t))return l(n.toNumber(),f(t),r);if(d(t))throw new w(null,"CannotCompareDateAndTime",null);if(h(t))return l(n.toNumber(),t.toNumber(),r)}else if(p(n)){if(p(t))return l(n,t,r);if(b(t))return l(f(n),f(t),r);if(u(t)||d(t)||h(t))return l(f(n),t.toNumber(),r);if(t===null||t===g)return l(f(n),0,r);if(y(t))return l(f(n),f(t),r)}else if(h(n)){if(u(t))return l(n.toNumber(),t.toNumber(),r);if(t===null||t===g)return l(n.toNumber(),0,r);if(b(t))return l(n.toNumber(),t,r);if(p(t)||y(t))return l(n.toNumber(),f(t),r);if(d(t))throw new w(null,"CannotCompareDateAndTime",null);if(h(t))return l(n.toNumber(),t.toNumber(),r)}else if(d(n)){if(u(t))throw new w(null,"CannotCompareDateAndTime",null);if(t===null||t===g)return l(n.toNumber(),0,r);if(b(t))return l(n.toNumber(),t,r);if(p(t)||y(t))return l(n.toNumber(),f(t),r);if(d(t))return l(n.toNumber(),t.toNumber(),r);if(h(t))throw new w(null,"CannotCompareDateAndTime",null)}return!!Tn(n,t)&&(r==="<="||r===">=")}function Tn(n,t){if(n===t||n===null&&t===g||t===null&&n===g)return!0;if(u(n)&&u(t)||d(n)&&d(t)||h(n)&&h(t))return n.equals(t);if(n instanceof rn||n instanceof I)return n.equalityTest(t);if(n instanceof D&&t instanceof D){const r=n.cache._arcadeCacheId,s=t.cache._arcadeCacheId;if(r!=null)return r===s}return!!(U(n)&&U(t)&&(n._arcadeCacheId===t._arcadeCacheId&&n._arcadeCacheId!==void 0&&n._arcadeCacheId!==null||n._underlyingGraphic===t._underlyingGraphic&&n._underlyingGraphic!==void 0&&n._underlyingGraphic!==null))}function Cn(n,{useNumbersForDates:t}){let r="";for(const s in n){r!==""&&(r+=",");const e=n[s];e==null?r+=JSON.stringify(s)+":null":p(e)||b(e)||y(e)?r+=JSON.stringify(s)+":"+JSON.stringify(e):V(e)?r+=JSON.stringify(s)+":"+z(e):d(e)||h(e)?r+=`${JSON.stringify(s)}:${JSON.stringify(e.toString())}`:T(e)||Array.isArray(e)?r+=JSON.stringify(s)+":"+z(e,null,t):u(e)?r+=t?JSON.stringify(s)+":"+JSON.stringify(e.getTime()):JSON.stringify(s)+":"+e.stringify():e!==null&&typeof e=="object"&&"castToText"in e&&(r+=JSON.stringify(s)+":"+e.castToText(t))}return"{"+r+"}"}function C(n,t){if(y(n))return n;if(n===null)return"";if(b(n))return fn(n,t);if(p(n))return n.toString();if(u(n))return $(n,t);if(d(n)||h(n))return n.toFormat(t);if(n instanceof k)return JSON.stringify(n.toJSON());if(N(n)){const r=[];for(let s=0;s<n.length;s++)r[s]=Y(n[s]);return"["+r.join(",")+"]"}if(n instanceof _){const r=[];for(let s=0;s<n.length();s++)r[s]=Y(n.get(s));return"["+r.join(",")+"]"}return n!==null&&typeof n=="object"&&"castToText"in n?n.castToText():M(n)?"object, Function":n===g?"":en(n)?"object, Module":""}function tt(n){const t=[];if(n instanceof _){for(let r=0;r<n.length();r++)t[r]=f(n.get(r));return t}if(!N(n))return null;for(let r=0;r<n.length;r++)t[r]=f(n[r]);return t}function z(n,t,r=!1){if(y(n))return n;if(n===null)return"";if(b(n))return fn(n,t);if(p(n))return n.toString();if(u(n))return $(n,t);if(d(n)||h(n))return n.toFormat(t);if(n instanceof k)return n instanceof K?'{"xmin":'+n.xmin.toString()+',"ymin":'+n.ymin.toString()+","+(n.hasZ?'"zmin":'+n.zmin.toString()+",":"")+(n.hasM?'"mmin":'+n.mmin.toString()+",":"")+'"xmax":'+n.xmax.toString()+',"ymax":'+n.ymax.toString()+","+(n.hasZ?'"zmax":'+n.zmax.toString()+",":"")+(n.hasM?'"mmax":'+n.mmax.toString()+",":"")+'"spatialReference":'+Q(n.spatialReference)+"}":Q(n.toJSON(),(s,e)=>s.key===e.key?0:s.key==="spatialReference"?1:e.key==="spatialReference"||s.key<e.key?-1:s.key>e.key?1:0);if(N(n)){const s=[];for(let e=0;e<n.length;e++)s[e]=Y(n[e],r);return"["+s.join(",")+"]"}if(n instanceof _){const s=[];for(let e=0;e<n.length();e++)s[e]=Y(n.get(e),r);return"["+s.join(",")+"]"}return n!==null&&typeof n=="object"&&"castToText"in n?n.castToText(r):M(n)?"object, Function":n===g?"":en(n)?"object, Module":""}function Y(n,t=!1){if(n===null)return"null";if(p(n)||y(n))return JSON.stringify(n);if(b(n))return n.toString();if(n instanceof k||n instanceof _||Array.isArray(n))return z(n,null,t);if(u(n))return JSON.stringify(t?n.getTime():$(n,""));if(d(n)||h(n))return JSON.stringify(n.toString());if(n!==null&&typeof n=="object"){if("castToText"in n)return n.castToText(t)}else if(n===g)return"null";return"null"}function f(n,t){return b(n)?n:n===null||n===""?0:u(n)||h(n)||d(n)?NaN:p(n)?n?1:0:N(n)||n===""||n===void 0?NaN:t!==void 0&&y(n)?(t=R(t,"‰",""),t=R(t,"¤",""),Vn(n,{pattern:t})):n===g?0:Number(n)}function rt(n,t){if(u(n))return n;if(y(n)){const r=et(n,t);if(r)return A.dateTimeToArcadeDate(r)}return null}function et(n,t){const r=/ (\d\d)/,s=vn(t);let e=yn.fromISO(n,{zone:s});return e.isValid||r.test(n)&&(n=n.replace(r,"T$1"),e=yn.fromISO(n,{zone:t}),e.isValid)?e:null}function st(n){return p(n)?n:y(n)?(n=n.toLowerCase())==="true":!!b(n)&&n!==0&&!isNaN(n)}function at(n,t){const r=JSON.parse(n);return r&&!r.spatialReference&&(r.spatialReference=t),Pn(r)}function it(n,t){return n==null?null:(n.spatialReference!==null&&n.spatialReference!==void 0||(n.spatialReference=t),n)}function ot(n){if(n===null)return null;if(n instanceof D)return n.x==="NaN"||n.x===null||isNaN(n.x)?null:n;if(n instanceof W){if((n.curveRings??n.rings).length===0)return null;for(const t of n.curveRings??n.rings)if(t.length>0)return n;return null}if(n instanceof X){if((n.curvePaths??n.paths).length===0)return null;for(const t of n.curvePaths??n.paths)if(t.length>0)return n;return null}return n instanceof nn?n.points.length===0?null:n:n instanceof K?n.xmin==="NaN"||n.xmin===null||isNaN(n.xmin)?null:n:null}function _n(n,t){if(!n||!n.domain)return t;let r=null,s=null;if(u(t))r=t.toNumber();else if(h(t))r=t.toString();else if(d(t))r=t.toStorageString();else if(n.field.type==="string"||n.field.type==="esriFieldTypeString")r=C(t);else{if(t==null)return null;if(t==="")return t;r=f(t)}for(let e=0;e<n.domain.codedValues.length;e++){const a=n.domain.codedValues[e];a.code===r&&(s=a)}return s===null?C(t):s.name}function kn(n,t){if(!n||!n.domain)return t;let r=null;const s=C(t);for(let e=0;e<n.domain.codedValues.length;e++){const a=n.domain.codedValues[e];a.name===s&&(r=a)}return r===null?t:r.code}function H(n,t,r=null,s=null){if(!t||!t.fields)return null;let e,a,i=null;for(let S=0;S<t.fields.length;S++){const Z=t.fields[S];Z.name.toLowerCase()===n.toString().toLowerCase()&&(i=Z)}if(i===null)throw new w(null,"FieldNotFound",null,{key:n});let o=t.typeIdField,m="id",c=t.types;if(t.subtypeField&&(o=t.subtypeField,m="code",c=t.subtypes??[]),s===null&&r&&o)s=r.hasField(o)?r.field(o):null;else if(o&&s!==null){let S=!1;for(const Z of c||[])if(s===Z[m]){S=!0;break}if(!S){for(const Z of c||[])if(s===Z.name){s=Z[m],S=!0;break}}S||(s=null,r&&o&&(s=r.hasField(o)?r.field(o):null))}return s!=null&&c.some(S=>{var Z;return S[m]===s&&(e=(Z=S.domains)==null?void 0:Z[i.name],e&&e.type==="inherited"&&(e=gn(i.name,t),a=!0),!0)}),a||e||(e=gn(n,t)),{field:i,domain:e}}function gn(n,t){let r;return t.fields.some(s=>(s.name.toLowerCase()===n.toLowerCase()&&(r=s.domain),!!r)),r}function Q(n,t){t||(t={}),typeof t=="function"&&(t={cmp:t});const r=typeof t.cycles=="boolean"&&t.cycles,s=t.cmp&&(e=t.cmp,function(i){return function(o,m){const c={key:o,value:i[o]},S={key:m,value:i[m]};return e(c,S)}});var e;const a=[];return function i(o){if(o!=null&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o===void 0)return;if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);let m,c;if(Array.isArray(o)){for(c="[",m=0;m<o.length;m++)m&&(c+=","),c+=i(o[m])||"null";return c+"]"}if(o===null)return"null";if(a.includes(o)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}const S=a.push(o)-1,Z=Object.keys(o).sort(s==null?void 0:s(o));for(c="",m=0;m<Z.length;m++){const dn=Z[m],mn=i(o[dn]);mn&&(c&&(c+=","),c+=JSON.stringify(dn)+":"+mn)}return a.splice(S,1),"{"+c+"}"}(n)}function lt(n){if(n===null)return null;const t=[];for(const r of n)P(r)?t.push(r.geometry()):t.push(r);return t}function v(n,t){if(!(t instanceof D))throw new w(null,"InvalidParameter",null);n.push(t.hasZ?t.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])}function ut(n,t){if(N(n)||T(n)){let r=!1,s=!1,e=[],a=t;if(N(n)){for(const i of n)v(e,i);e.length>0&&(a=n[0].spatialReference,r=n[0].hasZ,s=n[0].hasM)}else if(n instanceof I)e=n._elements,e.length>0&&(r=n._hasZ,s=n._hasM,a=n.get(0).spatialReference);else{if(!T(n))throw new w(null,"InvalidParameter",null);for(const i of n.toArray())v(e,i);e.length>0&&(a=n.get(0).spatialReference,r=n.get(0).hasZ===!0,s=n.get(0).hasM===!0)}return e.length===0?null:(In(e)||(e=e.slice().reverse()),new W({rings:[e],spatialReference:a,hasZ:r,hasM:s}))}return n}function ct(n,t){if(N(n)||T(n)){let r=!1,s=!1,e=[],a=t;if(N(n)){for(const i of n)v(e,i);e.length>0&&(a=n[0].spatialReference,r=n[0].hasZ===!0,s=n[0].hasM===!0)}else if(n instanceof I)e=n._elements,e.length>0&&(r=n._hasZ,s=n._hasM,a=n.get(0).spatialReference);else if(T(n)){for(const i of n.toArray())v(e,i);e.length>0&&(a=n.get(0).spatialReference,r=n.get(0).hasZ===!0,s=n.get(0).hasM===!0)}return e.length===0?null:new X({paths:[e],spatialReference:a,hasZ:r,hasM:s})}return n}function ft(n,t){if(N(n)||T(n)){let r=!1,s=!1,e=[],a=t;if(N(n)){for(const i of n)v(e,i);e.length>0&&(a=n[0].spatialReference,r=n[0].hasZ===!0,s=n[0].hasM===!0)}else if(n instanceof I)e=n._elements,e.length>0&&(r=n._hasZ,s=n._hasM,a=n.get(0).spatialReference);else if(T(n)){for(const i of n.toArray())v(e,i);e.length>0&&(a=n.get(0).spatialReference,r=n.get(0).hasZ===!0,s=n.get(0).hasM===!0)}return e.length===0?null:new nn({points:e,spatialReference:a,hasZ:r,hasM:s})}return n}function ht(n,t=!0){if(n==null)return[];if(N(n)){const r=[];for(const s of n){const e=C(s);(t||e!=="")&&r.push(e)}return r}if(T(n)){const r=[];for(let s=0;s<n.length();s++){const e=C(n.get(s));(t||e!=="")&&r.push(e)}return r}if(O(n)){const r=C(n);if(t||r!=="")return[r]}return[]}let q=0;function dt(n){return q++,q%100==0?(q=0,new Promise(t=>{setTimeout(()=>{t(n)},0)})):n}function mt(n,t,r){switch(r){case"&":return n&t;case"|":return n|t;case"^":return n^t;case"<<":return n<<t;case">>":return n>>t;case">>>":return n>>>t}}function F(n,t=null){return n==null?null:p(n)||b(n)||y(n)?n:n instanceof k?(t==null?void 0:t.keepGeometryType)===!0?n:n.toJSON():n instanceof _?n.toArray().map(r=>F(r,t)):Array.isArray(n)?n.map(r=>F(r,t)):L(n)?n:u(n)?n.toJSDate():d(n)?n.toString():h(n)?n.toJSDate():n!==null&&typeof n=="object"&&n.castAsJson!==void 0?n.castAsJson(t):null}async function yt(n,t,r,s,e){const a=await hn(n,t,r);e[s]=a}async function hn(n,t=null,r=null){if(n instanceof _&&(n=n.toArray()),n==null)return null;if(O(n)||n instanceof k||L(n)||u(n))return F(n,r);if(Array.isArray(n)){const s=[],e=[];for(const a of n)a===null||O(a)||a instanceof k||L(a)||u(a)?e.push(F(a,r)):(e.push(null),s.push(yt(a,t,r,e.length-1,e)));return s.length>0&&await Promise.all(s),e}return n!==null&&typeof n=="object"&&n.castAsJsonAsync!==void 0?n.castAsJsonAsync(t,r):null}function j(n){return xn(n)?n.parent:n}function xn(n){return n&&"declaredClass"in n&&n.declaredClass==="esri.layers.support.SubtypeSublayer"}function pt(n){return n&&"declaredClass"in n&&n.declaredClass==="esri.layers.SubtypeGroupLayer"}function bt(n,t,r){const s=j(n.fullSchema());return s===null||!s.fields?null:H(t,s,n,r)}function gt(n){const t=j(n.fullSchema());return t===null?null:t.fields?t.subtypeField?{subtypeField:t.subtypeField,subtypes:t.subtypes?t.subtypes.map(r=>({name:r.name,code:r.code})):[]}:t.typeIdField?{subtypeField:t.typeIdField,subtypes:t.types?t.types.map(r=>({name:r.name,code:r.id})):[]}:null:null}function St(n,t,r,s){const e=j(n.fullSchema());if(e===null||!e.fields)return null;const a=H(t,e,n,s);if(r===void 0)try{r=n.field(t)}catch{return null}return _n(a,r)}function Nt(n,t,r,s){const e=j(n.fullSchema());if(e===null||!e.fields)return null;if(r===void 0){try{r=n.field(t)}catch{return null}return r}return kn(H(t,e,n,s),r)}function Zt(n){return(n==null?void 0:n.timeZone)??"system"}function wt(n){const t=j(n.fullSchema());if(t===null||!t.fields)return null;const r=[];for(const s of t.fields)r.push(Yn(s));return{objectIdField:t.objectIdField,globalIdField:t.globalIdField??"",geometryType:pn[t.geometryType]===void 0?"":pn[t.geometryType],fields:r}}function Tt(n,t){const r=A.systemTimeZoneCanonicalName;return n==="system"&&(n=r),{version:An,engineVersion:Ln,timeZone:n,userTimeZone:r,spatialReference:t instanceof zn?t.toJSON():t,application:jn.applicationName??"",engine:"web",locale:Sn()}}const An="1.34",Ot=Object.freeze(Object.defineProperty({__proto__:null,ImplicitResult:Hn,ReturnResult:$n,absRound:Xn,arcadeVersion:An,autoCastArrayOfPointsToMultiPoint:ft,autoCastArrayOfPointsToPolygon:ut,autoCastArrayOfPointsToPolyline:ct,autoCastFeatureToGeometry:lt,binaryOperator:mt,breakResult:qn,castAsJson:F,castAsJsonAsync:hn,castRecordToText:Cn,continueResult:En,defaultExecutingContext:Tt,defaultTimeZone:Zt,defaultUndefined:Un,equalityTest:Tn,featureDomainCodeLookup:Nt,featureDomainValueLookup:St,featureFullDomain:bt,featureSchema:wt,featureSubtypes:gt,fixNullGeometry:ot,fixSpatialReference:it,formatDate:$,formatNumber:fn,getDomain:H,getDomainCode:kn,getDomainValue:_n,getType:Qn,greaterThanLessThan:nt,isArray:N,isBoolean:p,isDate:u,isDateOnly:h,isDictionary:ln,isDictionaryLike:Bn,isEmpty:Wn,isFeature:P,isFeatureSet:on,isFeatureSetCollection:un,isFunctionParameter:M,isGeometry:V,isGraphic:Rn,isImmutableArray:T,isInteger:Jn,isJsDate:L,isKnowledgeGraph:cn,isModule:en,isNumber:b,isObject:U,isPixel:an,isSimpleType:O,isString:y,isSubtypeGrouplayer:pt,isSubtypeSublayer:xn,isTime:d,isVoid:Zn,isVoxel:sn,multiReplace:R,parseGeometryFromJson:at,pcCheck:Kn,stableStringify:Q,standardiseDateFormat:wn,tick:dt,toBoolean:st,toDate:rt,toNumber:f,toNumberArray:tt,toString:C,toStringArray:ht,toStringExplicit:z,voidOperation:g},Symbol.toStringTag,{value:"Module"}));function vt(n){Fn=n}let Fn;function B(n){return n===null?null:u(n)?n.clone():O(n)?n:V(n)?n.clone():T(n)?n.toArray().map(t=>B(t)):N(n)?n.map(t=>B(t)):P(n)?Fn.createFromArcadeFeature(n):un(n)||on(n)?n:ln(n)||(n==null?void 0:n.declaredClass)==="esri.arcade.Attachment"?n.deepClone():((n==null?void 0:n.declaredClass)==="esri.arcade.Portal"||cn(n)||n instanceof tn||M(n),n)}function G(n,t,r=!1,s=!1){if(n==null)return null;if(b(n)||p(n)||y(n)||u(n)||h(n)||d(n))return n;if(N(n)){const a=[];for(const i of n)a.push(G(i,t,r,s));return a}if(s&&V(n))return n;const e=new x;e.immutable=!1;for(const[a,i]of Object.entries(n))i!==void 0&&e.setField(a,G(i,t,r,s));return e.immutable=r,e}class x{constructor(t){this.declaredClass="esri.arcade.Dictionary",this.plain=!1,this.immutable=!0,t instanceof x?this.attributes=t.attributes:t==null?this.attributes=Object.create(null):Object.getPrototypeOf(t)!=null?this.attributes={__proto__:null,...t}:this.attributes=t}static containerEntry(t,r){return new x({__proto__:null,key:t,value:r})}static textFormatting(){const t=new x({__proto__:null,newline:`
`,tab:"	",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});return t.immutable=!1,t}field(t){const r=t.toLowerCase(),s=this.attributes[t];if(s!==void 0)return s;for(const e in this.attributes)if(e.toLowerCase()===r)return this.attributes[e];throw new w(null,"FieldNotFound",null,{key:t})}setField(t,r){if(this.immutable)throw new w(null,"Immutable",null);if(M(r))throw new w(null,"NoFunctionInDictionary",null);const s=t.toLowerCase();if(r instanceof Date&&(r=A.dateJSToArcadeDate(r)),this.attributes[t]===void 0){for(const e in this.attributes)if(e.toLowerCase()===s)return void(this.attributes[e]=r);this.attributes[t]=r}else this.attributes[t]=r}eraseField(t){if(this.immutable)throw new w(null,"Immutable",null);if(t in this.attributes)return void delete this.attributes[t];const r=t.toLowerCase();for(const s in this.attributes)if(s.toLowerCase()===r)return void delete this.attributes[s]}hasField(t){const r=t.toLowerCase();if(this.attributes[t]!==void 0)return!0;for(const s in this.attributes)if(s.toLowerCase()===r)return!0;return!1}keys(){let t=[];for(const r in this.attributes)t.push(r);return t=t.sort(),t}values(){return this.keys().map(t=>this.attributes[t])}entryCount(){return Object.keys(this.attributes).length}isEmpty(){return this.entryCount()<=0}castToText(t=!1){return Cn(this.attributes,{useNumbersForDates:t})}static convertObjectToArcadeDictionary(t,r,s=!0,e=!1){const a=new x;a.immutable=!1;for(const i in t){const o=t[i];o!==void 0&&a.setField(i.toString(),G(o,r,s,e))}return a.immutable=s,a}static convertJsonToArcade(t,r,s=!1,e=!1){return G(t,r,s,e)}castAsJson(t=null){const r=Object.create(null);for(let s in this.attributes){const e=this.attributes[s];e!==void 0&&(t!=null&&t.keyTranslate&&(s=t.keyTranslate(s)),r[s]=F(e,t))}return r}async castDictionaryValueAsJsonAsync(t,r,s,e=null,a){const i=await hn(s,e,a);return t[r]=i,i}async castAsJsonAsync(t=null,r=null){const s=Object.create(null),e=[];for(let a in this.attributes){const i=this.attributes[a];r!=null&&r.keyTranslate&&(a=r.keyTranslate(a)),i!==void 0&&(O(i)||i instanceof k||i instanceof A?s[a]=F(i,r):e.push(this.castDictionaryValueAsJsonAsync(s,a,i,t,r)))}return e.length>0&&await Promise.all(e),s}deepClone(){const t=new x;t.immutable=!1;for(const r of this.keys())t.setField(r,B(this.field(r)));return t}}export{ln as $,x as A,Tt as B,$n as C,Un as D,bt as E,M as F,wt as G,gt as H,P as I,Wn as J,St as K,V as L,I as M,it as N,O,rt as P,Nt as Q,nt as R,Dt as S,lt as T,on as U,sn as V,un as W,Zt as X,ot as Y,an as Z,C as _,En as a,ut as a0,ct as a1,ft as a2,tt as a3,tn as a4,B as a5,F as a6,vt as a7,ht as a8,dt as a9,xn as aa,H as ab,_n as ac,kn as ad,cn as ae,Bn as b,Ot as c,Cn as d,f as e,mt as f,g,Tn as h,J as i,d as j,Hn as k,u as l,h as m,bn as n,wn as o,Xn as p,E as q,Qn as r,st as s,rn as t,Zn as u,Kn as v,T as w,qn as x,z as y,R as z};
