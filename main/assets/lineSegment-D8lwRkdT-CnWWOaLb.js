import{i6 as y,eq as l,am as B}from"./index-BeTPrQ6f.js";import{L as F}from"./sphere-CIGsF4vz-C3zVQu9y.js";import{A as d,q as E,z as M,v as L,j as b,E as j,p as $}from"./vec32-CI1xtKog-DFVYRcgb.js";import{Y as g}from"./vectorStacks-B2ngxq6F-myhPBoPk.js";function x(t){return t?{origin:y(t.origin),vector:y(t.vector)}:{origin:l(),vector:l()}}function P(t,e){const n=S.get();return n.origin=t,n.vector=e,n}function X(t,e=x()){return Q(t.origin,t.vector,e)}function Q(t,e,n=x()){return d(n.origin,t),d(n.vector,e),n}function Y(t,e,n=x()){return d(n.origin,t),E(n.vector,e,t),n}function G(t,e){const n=E(g.get(),e,t.origin),u=M(t.vector,n),i=M(t.vector,t.vector),f=B(u/i,0,1),c=E(g.get(),j(g.get(),t.vector,f),n);return M(c,c)}function H(t,e,n){return R(t,e,0,1,n)}function I(t,e,n){return b(n,t.origin,j(n,t.vector,e))}function R(t,e,n,u,i){const{vector:f,origin:c}=t,p=E(g.get(),e,c),s=M(f,p)/L(f);return j(i,f,B(s,n,u)),b(i,i,t.origin)}function J(t,e){if(C(t,P(e.origin,e.direction),!1,q)){const{tA:n,pB:u,distance2:i}=q;if(n>=0&&n<=1)return i;if(n<0)return $(t.origin,u);if(n>1)return $(b(g.get(),t.origin,t.vector),u)}return null}function K(t,e,n){return!!C(t,e,!0,q)&&(d(n,q.pA),!0)}function C(t,e,n,u){const i=t.origin,f=b(g.get(),i,t.vector),c=e.origin,p=b(g.get(),c,e.vector),s=g.get(),r=g.get();if(s[0]=i[0]-c[0],s[1]=i[1]-c[1],s[2]=i[2]-c[2],r[0]=p[0]-c[0],r[1]=p[1]-c[1],r[2]=p[2]-c[2],Math.abs(r[0])<1e-6&&Math.abs(r[1])<1e-6&&Math.abs(r[2])<1e-6)return!1;const o=g.get();if(o[0]=f[0]-i[0],o[1]=f[1]-i[1],o[2]=f[2]-i[2],Math.abs(o[0])<1e-6&&Math.abs(o[1])<1e-6&&Math.abs(o[2])<1e-6)return!1;const k=s[0]*r[0]+s[1]*r[1]+s[2]*r[2],A=r[0]*o[0]+r[1]*o[1]+r[2]*o[2],D=s[0]*o[0]+s[1]*o[1]+s[2]*o[2],z=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],w=(o[0]*o[0]+o[1]*o[1]+o[2]*o[2])*z-A*A;if(Math.abs(w)<1e-6)return!1;let a=(k*A-D*z)/w,v=(k+A*a)/z;n&&(a=B(a,0,1),v=B(v,0,1));const m=g.get(),h=g.get();return m[0]=i[0]+a*o[0],m[1]=i[1]+a*o[1],m[2]=i[2]+a*o[2],h[0]=c[0]+v*r[0],h[1]=c[1]+v*r[1],h[2]=c[2]+v*r[2],u.tA=a,u.tB=v,u.pA=m,u.pB=h,u.distance2=$(m,h),!0}const q={tA:0,tB:0,pA:l(),pB:l(),distance2:0},S=new F(()=>x());export{Q as C,R as D,x as M,X as Q,Y as R,G as S,H as T,I as U,J as V,K as W,P as y};
