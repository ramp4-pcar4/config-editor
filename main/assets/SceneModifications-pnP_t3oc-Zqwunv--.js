import{bI as h,a7 as S,t as w,v,Y as J,aU as N,C as d,q as R,m as a,E as c,bP as O,n as g}from"./index-BeTPrQ6f.js";import{C as u}from"./persistable-vgejqKb5-CBqfEqX1.js";import{J as b,o as x}from"./projectionUtils-CsX1UTBu-DsZaU4xz.js";var m;let o=m=class extends J{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,r,s,t){var n;if((n=t.layer)!=null&&n.spatialReference&&!t.layer.spatialReference.equals(this.geometry.spatialReference)){if(!b(e.spatialReference,t.layer.spatialReference))return void((t==null?void 0:t.messages)&&t.messages.push(new N("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})));const p=new d;x(e,p,t.layer.spatialReference),r[s]=p.toJSON(t)}else r[s]=e.toJSON(t)}clone(){return new m({geometry:R(this.geometry),type:this.type})}};a([c({type:d}),u()],o.prototype,"geometry",void 0),a([O(["web-scene","portal-item"],"geometry")],o.prototype,"writeGeometry",null),a([c({type:["clip","mask","replace"],nonNullable:!0}),u()],o.prototype,"type",void 0),o=m=a([g("esri.layers.support.SceneModification")],o);var i;let l=i=class extends h(S.ofType(o)){constructor(e){super(e),this.url=null}clone(){return new i({url:this.url,items:this.items.map(e=>e.clone())})}toJSON(e){return this.toArray().map(r=>r.toJSON(e)).filter(r=>!!r.geometry)}static fromJSON(e,r){const s=new i;for(const t of e)s.add(o.fromJSON(t,r));return s}static async fromUrl(e,r,s){const t={url:w(e),origin:"service"},n=await v(e,{responseType:"json",signal:s==null?void 0:s.signal}),p=r.toJSON(),y=[];for(const f of n.data)y.push(o.fromJSON({...f,geometry:{spatialReference:p,...f.geometry}},t));return new i({url:e,items:y})}};a([c({type:String})],l.prototype,"url",void 0),l=i=a([g("esri.layers.support.SceneModifications")],l);export{l as p};
